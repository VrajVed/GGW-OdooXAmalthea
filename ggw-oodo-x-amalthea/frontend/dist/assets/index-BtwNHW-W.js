function w1(e,t){for(var r=0;r<t.length;r++){const n=t[r];if(typeof n!="string"&&!Array.isArray(n)){for(const a in n)if(a!=="default"&&!(a in e)){const i=Object.getOwnPropertyDescriptor(n,a);i&&Object.defineProperty(e,a,i.get?i:{enumerable:!0,get:()=>n[a]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const i of a)if(i.type==="childList")for(const l of i.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&n(l)}).observe(document,{childList:!0,subtree:!0});function r(a){const i={};return a.integrity&&(i.integrity=a.integrity),a.referrerPolicy&&(i.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?i.credentials="include":a.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(a){if(a.ep)return;a.ep=!0;const i=r(a);fetch(a.href,i)}})();function b1(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Lh={exports:{}},go={},Mh={exports:{}},Fe={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Fi=Symbol.for("react.element"),N1=Symbol.for("react.portal"),j1=Symbol.for("react.fragment"),S1=Symbol.for("react.strict_mode"),_1=Symbol.for("react.profiler"),E1=Symbol.for("react.provider"),T1=Symbol.for("react.context"),k1=Symbol.for("react.forward_ref"),C1=Symbol.for("react.suspense"),A1=Symbol.for("react.memo"),F1=Symbol.for("react.lazy"),md=Symbol.iterator;function P1(e){return e===null||typeof e!="object"?null:(e=md&&e[md]||e["@@iterator"],typeof e=="function"?e:null)}var Bh={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Uh=Object.assign,zh={};function ha(e,t,r){this.props=e,this.context=t,this.refs=zh,this.updater=r||Bh}ha.prototype.isReactComponent={};ha.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};ha.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function $h(){}$h.prototype=ha.prototype;function Bu(e,t,r){this.props=e,this.context=t,this.refs=zh,this.updater=r||Bh}var Uu=Bu.prototype=new $h;Uu.constructor=Bu;Uh(Uu,ha.prototype);Uu.isPureReactComponent=!0;var pd=Array.isArray,Wh=Object.prototype.hasOwnProperty,zu={current:null},Hh={key:!0,ref:!0,__self:!0,__source:!0};function Vh(e,t,r){var n,a={},i=null,l=null;if(t!=null)for(n in t.ref!==void 0&&(l=t.ref),t.key!==void 0&&(i=""+t.key),t)Wh.call(t,n)&&!Hh.hasOwnProperty(n)&&(a[n]=t[n]);var o=arguments.length-2;if(o===1)a.children=r;else if(1<o){for(var c=Array(o),d=0;d<o;d++)c[d]=arguments[d+2];a.children=c}if(e&&e.defaultProps)for(n in o=e.defaultProps,o)a[n]===void 0&&(a[n]=o[n]);return{$$typeof:Fi,type:e,key:i,ref:l,props:a,_owner:zu.current}}function O1(e,t){return{$$typeof:Fi,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function $u(e){return typeof e=="object"&&e!==null&&e.$$typeof===Fi}function R1(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(r){return t[r]})}var gd=/\/+/g;function Ko(e,t){return typeof e=="object"&&e!==null&&e.key!=null?R1(""+e.key):t.toString(36)}function gl(e,t,r,n,a){var i=typeof e;(i==="undefined"||i==="boolean")&&(e=null);var l=!1;if(e===null)l=!0;else switch(i){case"string":case"number":l=!0;break;case"object":switch(e.$$typeof){case Fi:case N1:l=!0}}if(l)return l=e,a=a(l),e=n===""?"."+Ko(l,0):n,pd(a)?(r="",e!=null&&(r=e.replace(gd,"$&/")+"/"),gl(a,t,r,"",function(d){return d})):a!=null&&($u(a)&&(a=O1(a,r+(!a.key||l&&l.key===a.key?"":(""+a.key).replace(gd,"$&/")+"/")+e)),t.push(a)),1;if(l=0,n=n===""?".":n+":",pd(e))for(var o=0;o<e.length;o++){i=e[o];var c=n+Ko(i,o);l+=gl(i,t,r,c,a)}else if(c=P1(e),typeof c=="function")for(e=c.call(e),o=0;!(i=e.next()).done;)i=i.value,c=n+Ko(i,o++),l+=gl(i,t,r,c,a);else if(i==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return l}function Gi(e,t,r){if(e==null)return e;var n=[],a=0;return gl(e,n,"","",function(i){return t.call(r,i,a++)}),n}function I1(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(r){(e._status===0||e._status===-1)&&(e._status=1,e._result=r)},function(r){(e._status===0||e._status===-1)&&(e._status=2,e._result=r)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var Wt={current:null},yl={transition:null},D1={ReactCurrentDispatcher:Wt,ReactCurrentBatchConfig:yl,ReactCurrentOwner:zu};function Gh(){throw Error("act(...) is not supported in production builds of React.")}Fe.Children={map:Gi,forEach:function(e,t,r){Gi(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return Gi(e,function(){t++}),t},toArray:function(e){return Gi(e,function(t){return t})||[]},only:function(e){if(!$u(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};Fe.Component=ha;Fe.Fragment=j1;Fe.Profiler=_1;Fe.PureComponent=Bu;Fe.StrictMode=S1;Fe.Suspense=C1;Fe.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=D1;Fe.act=Gh;Fe.cloneElement=function(e,t,r){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var n=Uh({},e.props),a=e.key,i=e.ref,l=e._owner;if(t!=null){if(t.ref!==void 0&&(i=t.ref,l=zu.current),t.key!==void 0&&(a=""+t.key),e.type&&e.type.defaultProps)var o=e.type.defaultProps;for(c in t)Wh.call(t,c)&&!Hh.hasOwnProperty(c)&&(n[c]=t[c]===void 0&&o!==void 0?o[c]:t[c])}var c=arguments.length-2;if(c===1)n.children=r;else if(1<c){o=Array(c);for(var d=0;d<c;d++)o[d]=arguments[d+2];n.children=o}return{$$typeof:Fi,type:e.type,key:a,ref:i,props:n,_owner:l}};Fe.createContext=function(e){return e={$$typeof:T1,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:E1,_context:e},e.Consumer=e};Fe.createElement=Vh;Fe.createFactory=function(e){var t=Vh.bind(null,e);return t.type=e,t};Fe.createRef=function(){return{current:null}};Fe.forwardRef=function(e){return{$$typeof:k1,render:e}};Fe.isValidElement=$u;Fe.lazy=function(e){return{$$typeof:F1,_payload:{_status:-1,_result:e},_init:I1}};Fe.memo=function(e,t){return{$$typeof:A1,type:e,compare:t===void 0?null:t}};Fe.startTransition=function(e){var t=yl.transition;yl.transition={};try{e()}finally{yl.transition=t}};Fe.unstable_act=Gh;Fe.useCallback=function(e,t){return Wt.current.useCallback(e,t)};Fe.useContext=function(e){return Wt.current.useContext(e)};Fe.useDebugValue=function(){};Fe.useDeferredValue=function(e){return Wt.current.useDeferredValue(e)};Fe.useEffect=function(e,t){return Wt.current.useEffect(e,t)};Fe.useId=function(){return Wt.current.useId()};Fe.useImperativeHandle=function(e,t,r){return Wt.current.useImperativeHandle(e,t,r)};Fe.useInsertionEffect=function(e,t){return Wt.current.useInsertionEffect(e,t)};Fe.useLayoutEffect=function(e,t){return Wt.current.useLayoutEffect(e,t)};Fe.useMemo=function(e,t){return Wt.current.useMemo(e,t)};Fe.useReducer=function(e,t,r){return Wt.current.useReducer(e,t,r)};Fe.useRef=function(e){return Wt.current.useRef(e)};Fe.useState=function(e){return Wt.current.useState(e)};Fe.useSyncExternalStore=function(e,t,r){return Wt.current.useSyncExternalStore(e,t,r)};Fe.useTransition=function(){return Wt.current.useTransition()};Fe.version="18.3.1";Mh.exports=Fe;var T=Mh.exports;const Xh=b1(T),L1=w1({__proto__:null,default:Xh},[T]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var M1=T,B1=Symbol.for("react.element"),U1=Symbol.for("react.fragment"),z1=Object.prototype.hasOwnProperty,$1=M1.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,W1={key:!0,ref:!0,__self:!0,__source:!0};function Kh(e,t,r){var n,a={},i=null,l=null;r!==void 0&&(i=""+r),t.key!==void 0&&(i=""+t.key),t.ref!==void 0&&(l=t.ref);for(n in t)z1.call(t,n)&&!W1.hasOwnProperty(n)&&(a[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps,t)a[n]===void 0&&(a[n]=t[n]);return{$$typeof:B1,type:e,key:i,ref:l,props:a,_owner:$1.current}}go.Fragment=U1;go.jsx=Kh;go.jsxs=Kh;Lh.exports=go;var s=Lh.exports,Oc={},Yh={exports:{}},ur={},Jh={exports:{}},qh={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(W,k){var K=W.length;W.push(k);e:for(;0<K;){var te=K-1>>>1,E=W[te];if(0<a(E,k))W[te]=k,W[K]=E,K=te;else break e}}function r(W){return W.length===0?null:W[0]}function n(W){if(W.length===0)return null;var k=W[0],K=W.pop();if(K!==k){W[0]=K;e:for(var te=0,E=W.length,B=E>>>1;te<B;){var L=2*(te+1)-1,U=W[L],ee=L+1,he=W[ee];if(0>a(U,K))ee<E&&0>a(he,U)?(W[te]=he,W[ee]=K,te=ee):(W[te]=U,W[L]=K,te=L);else if(ee<E&&0>a(he,K))W[te]=he,W[ee]=K,te=ee;else break e}}return k}function a(W,k){var K=W.sortIndex-k.sortIndex;return K!==0?K:W.id-k.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;e.unstable_now=function(){return i.now()}}else{var l=Date,o=l.now();e.unstable_now=function(){return l.now()-o}}var c=[],d=[],u=1,f=null,h=3,m=!1,v=!1,x=!1,y=typeof setTimeout=="function"?setTimeout:null,p=typeof clearTimeout=="function"?clearTimeout:null,g=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function w(W){for(var k=r(d);k!==null;){if(k.callback===null)n(d);else if(k.startTime<=W)n(d),k.sortIndex=k.expirationTime,t(c,k);else break;k=r(d)}}function b(W){if(x=!1,w(W),!v)if(r(c)!==null)v=!0,je(P);else{var k=r(d);k!==null&&q(b,k.startTime-W)}}function P(W,k){v=!1,x&&(x=!1,p(O),O=-1),m=!0;var K=h;try{for(w(k),f=r(c);f!==null&&(!(f.expirationTime>k)||W&&!D());){var te=f.callback;if(typeof te=="function"){f.callback=null,h=f.priorityLevel;var E=te(f.expirationTime<=k);k=e.unstable_now(),typeof E=="function"?f.callback=E:f===r(c)&&n(c),w(k)}else n(c);f=r(c)}if(f!==null)var B=!0;else{var L=r(d);L!==null&&q(b,L.startTime-k),B=!1}return B}finally{f=null,h=K,m=!1}}var M=!1,j=null,O=-1,R=5,I=-1;function D(){return!(e.unstable_now()-I<R)}function z(){if(j!==null){var W=e.unstable_now();I=W;var k=!0;try{k=j(!0,W)}finally{k?ne():(M=!1,j=null)}}else M=!1}var ne;if(typeof g=="function")ne=function(){g(z)};else if(typeof MessageChannel<"u"){var Ne=new MessageChannel,ue=Ne.port2;Ne.port1.onmessage=z,ne=function(){ue.postMessage(null)}}else ne=function(){y(z,0)};function je(W){j=W,M||(M=!0,ne())}function q(W,k){O=y(function(){W(e.unstable_now())},k)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(W){W.callback=null},e.unstable_continueExecution=function(){v||m||(v=!0,je(P))},e.unstable_forceFrameRate=function(W){0>W||125<W?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):R=0<W?Math.floor(1e3/W):5},e.unstable_getCurrentPriorityLevel=function(){return h},e.unstable_getFirstCallbackNode=function(){return r(c)},e.unstable_next=function(W){switch(h){case 1:case 2:case 3:var k=3;break;default:k=h}var K=h;h=k;try{return W()}finally{h=K}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(W,k){switch(W){case 1:case 2:case 3:case 4:case 5:break;default:W=3}var K=h;h=W;try{return k()}finally{h=K}},e.unstable_scheduleCallback=function(W,k,K){var te=e.unstable_now();switch(typeof K=="object"&&K!==null?(K=K.delay,K=typeof K=="number"&&0<K?te+K:te):K=te,W){case 1:var E=-1;break;case 2:E=250;break;case 5:E=1073741823;break;case 4:E=1e4;break;default:E=5e3}return E=K+E,W={id:u++,callback:k,priorityLevel:W,startTime:K,expirationTime:E,sortIndex:-1},K>te?(W.sortIndex=K,t(d,W),r(c)===null&&W===r(d)&&(x?(p(O),O=-1):x=!0,q(b,K-te))):(W.sortIndex=E,t(c,W),v||m||(v=!0,je(P))),W},e.unstable_shouldYield=D,e.unstable_wrapCallback=function(W){var k=h;return function(){var K=h;h=k;try{return W.apply(this,arguments)}finally{h=K}}}})(qh);Jh.exports=qh;var H1=Jh.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var V1=T,or=H1;function ie(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Qh=new Set,si={};function vs(e,t){sa(e,t),sa(e+"Capture",t)}function sa(e,t){for(si[e]=t,e=0;e<t.length;e++)Qh.add(t[e])}var on=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Rc=Object.prototype.hasOwnProperty,G1=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,yd={},vd={};function X1(e){return Rc.call(vd,e)?!0:Rc.call(yd,e)?!1:G1.test(e)?vd[e]=!0:(yd[e]=!0,!1)}function K1(e,t,r,n){if(r!==null&&r.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function Y1(e,t,r,n){if(t===null||typeof t>"u"||K1(e,t,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function Ht(e,t,r,n,a,i,l){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=n,this.attributeNamespace=a,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=i,this.removeEmptyString=l}var kt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){kt[e]=new Ht(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];kt[t]=new Ht(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){kt[e]=new Ht(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){kt[e]=new Ht(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){kt[e]=new Ht(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){kt[e]=new Ht(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){kt[e]=new Ht(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){kt[e]=new Ht(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){kt[e]=new Ht(e,5,!1,e.toLowerCase(),null,!1,!1)});var Wu=/[\-:]([a-z])/g;function Hu(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(Wu,Hu);kt[t]=new Ht(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(Wu,Hu);kt[t]=new Ht(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(Wu,Hu);kt[t]=new Ht(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){kt[e]=new Ht(e,1,!1,e.toLowerCase(),null,!1,!1)});kt.xlinkHref=new Ht("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){kt[e]=new Ht(e,1,!1,e.toLowerCase(),null,!0,!0)});function Vu(e,t,r,n){var a=kt.hasOwnProperty(t)?kt[t]:null;(a!==null?a.type!==0:n||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(Y1(t,r,a,n)&&(r=null),n||a===null?X1(t)&&(r===null?e.removeAttribute(t):e.setAttribute(t,""+r)):a.mustUseProperty?e[a.propertyName]=r===null?a.type===3?!1:"":r:(t=a.attributeName,n=a.attributeNamespace,r===null?e.removeAttribute(t):(a=a.type,r=a===3||a===4&&r===!0?"":""+r,n?e.setAttributeNS(n,t,r):e.setAttribute(t,r))))}var xn=V1.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Xi=Symbol.for("react.element"),Ps=Symbol.for("react.portal"),Os=Symbol.for("react.fragment"),Gu=Symbol.for("react.strict_mode"),Ic=Symbol.for("react.profiler"),Zh=Symbol.for("react.provider"),ex=Symbol.for("react.context"),Xu=Symbol.for("react.forward_ref"),Dc=Symbol.for("react.suspense"),Lc=Symbol.for("react.suspense_list"),Ku=Symbol.for("react.memo"),jn=Symbol.for("react.lazy"),tx=Symbol.for("react.offscreen"),wd=Symbol.iterator;function Ea(e){return e===null||typeof e!="object"?null:(e=wd&&e[wd]||e["@@iterator"],typeof e=="function"?e:null)}var et=Object.assign,Yo;function La(e){if(Yo===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);Yo=t&&t[1]||""}return`
`+Yo+e}var Jo=!1;function qo(e,t){if(!e||Jo)return"";Jo=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(d){var n=d}Reflect.construct(e,[],t)}else{try{t.call()}catch(d){n=d}e.call(t.prototype)}else{try{throw Error()}catch(d){n=d}e()}}catch(d){if(d&&n&&typeof d.stack=="string"){for(var a=d.stack.split(`
`),i=n.stack.split(`
`),l=a.length-1,o=i.length-1;1<=l&&0<=o&&a[l]!==i[o];)o--;for(;1<=l&&0<=o;l--,o--)if(a[l]!==i[o]){if(l!==1||o!==1)do if(l--,o--,0>o||a[l]!==i[o]){var c=`
`+a[l].replace(" at new "," at ");return e.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",e.displayName)),c}while(1<=l&&0<=o);break}}}finally{Jo=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?La(e):""}function J1(e){switch(e.tag){case 5:return La(e.type);case 16:return La("Lazy");case 13:return La("Suspense");case 19:return La("SuspenseList");case 0:case 2:case 15:return e=qo(e.type,!1),e;case 11:return e=qo(e.type.render,!1),e;case 1:return e=qo(e.type,!0),e;default:return""}}function Mc(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case Os:return"Fragment";case Ps:return"Portal";case Ic:return"Profiler";case Gu:return"StrictMode";case Dc:return"Suspense";case Lc:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case ex:return(e.displayName||"Context")+".Consumer";case Zh:return(e._context.displayName||"Context")+".Provider";case Xu:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case Ku:return t=e.displayName||null,t!==null?t:Mc(e.type)||"Memo";case jn:t=e._payload,e=e._init;try{return Mc(e(t))}catch{}}return null}function q1(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Mc(t);case 8:return t===Gu?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function zn(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function rx(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function Q1(e){var t=rx(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var a=r.get,i=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return a.call(this)},set:function(l){n=""+l,i.call(this,l)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(l){n=""+l},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function Ki(e){e._valueTracker||(e._valueTracker=Q1(e))}function nx(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),n="";return e&&(n=rx(e)?e.checked?"true":"false":e.value),e=n,e!==r?(t.setValue(e),!0):!1}function Cl(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function Bc(e,t){var r=t.checked;return et({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??e._wrapperState.initialChecked})}function bd(e,t){var r=t.defaultValue==null?"":t.defaultValue,n=t.checked!=null?t.checked:t.defaultChecked;r=zn(t.value!=null?t.value:r),e._wrapperState={initialChecked:n,initialValue:r,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function sx(e,t){t=t.checked,t!=null&&Vu(e,"checked",t,!1)}function Uc(e,t){sx(e,t);var r=zn(t.value),n=t.type;if(r!=null)n==="number"?(r===0&&e.value===""||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if(n==="submit"||n==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?zc(e,t.type,r):t.hasOwnProperty("defaultValue")&&zc(e,t.type,zn(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function Nd(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!(n!=="submit"&&n!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}r=e.name,r!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,r!==""&&(e.name=r)}function zc(e,t,r){(t!=="number"||Cl(e.ownerDocument)!==e)&&(r==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var Ma=Array.isArray;function Gs(e,t,r,n){if(e=e.options,t){t={};for(var a=0;a<r.length;a++)t["$"+r[a]]=!0;for(r=0;r<e.length;r++)a=t.hasOwnProperty("$"+e[r].value),e[r].selected!==a&&(e[r].selected=a),a&&n&&(e[r].defaultSelected=!0)}else{for(r=""+zn(r),t=null,a=0;a<e.length;a++){if(e[a].value===r){e[a].selected=!0,n&&(e[a].defaultSelected=!0);return}t!==null||e[a].disabled||(t=e[a])}t!==null&&(t.selected=!0)}}function $c(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(ie(91));return et({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function jd(e,t){var r=t.value;if(r==null){if(r=t.children,t=t.defaultValue,r!=null){if(t!=null)throw Error(ie(92));if(Ma(r)){if(1<r.length)throw Error(ie(93));r=r[0]}t=r}t==null&&(t=""),r=t}e._wrapperState={initialValue:zn(r)}}function ax(e,t){var r=zn(t.value),n=zn(t.defaultValue);r!=null&&(r=""+r,r!==e.value&&(e.value=r),t.defaultValue==null&&e.defaultValue!==r&&(e.defaultValue=r)),n!=null&&(e.defaultValue=""+n)}function Sd(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function ix(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Wc(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?ix(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var Yi,lx=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,r,n,a){MSApp.execUnsafeLocalFunction(function(){return e(t,r,n,a)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(Yi=Yi||document.createElement("div"),Yi.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=Yi.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function ai(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var Wa={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Z1=["Webkit","ms","Moz","O"];Object.keys(Wa).forEach(function(e){Z1.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),Wa[t]=Wa[e]})});function ox(e,t,r){return t==null||typeof t=="boolean"||t===""?"":r||typeof t!="number"||t===0||Wa.hasOwnProperty(e)&&Wa[e]?(""+t).trim():t+"px"}function cx(e,t){e=e.style;for(var r in t)if(t.hasOwnProperty(r)){var n=r.indexOf("--")===0,a=ox(r,t[r],n);r==="float"&&(r="cssFloat"),n?e.setProperty(r,a):e[r]=a}}var ey=et({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Hc(e,t){if(t){if(ey[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(ie(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(ie(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(ie(61))}if(t.style!=null&&typeof t.style!="object")throw Error(ie(62))}}function Vc(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Gc=null;function Yu(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var Xc=null,Xs=null,Ks=null;function _d(e){if(e=Ri(e)){if(typeof Xc!="function")throw Error(ie(280));var t=e.stateNode;t&&(t=No(t),Xc(e.stateNode,e.type,t))}}function ux(e){Xs?Ks?Ks.push(e):Ks=[e]:Xs=e}function dx(){if(Xs){var e=Xs,t=Ks;if(Ks=Xs=null,_d(e),t)for(e=0;e<t.length;e++)_d(t[e])}}function fx(e,t){return e(t)}function hx(){}var Qo=!1;function xx(e,t,r){if(Qo)return e(t,r);Qo=!0;try{return fx(e,t,r)}finally{Qo=!1,(Xs!==null||Ks!==null)&&(hx(),dx())}}function ii(e,t){var r=e.stateNode;if(r===null)return null;var n=No(r);if(n===null)return null;r=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(e=e.type,n=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!n;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(ie(231,t,typeof r));return r}var Kc=!1;if(on)try{var Ta={};Object.defineProperty(Ta,"passive",{get:function(){Kc=!0}}),window.addEventListener("test",Ta,Ta),window.removeEventListener("test",Ta,Ta)}catch{Kc=!1}function ty(e,t,r,n,a,i,l,o,c){var d=Array.prototype.slice.call(arguments,3);try{t.apply(r,d)}catch(u){this.onError(u)}}var Ha=!1,Al=null,Fl=!1,Yc=null,ry={onError:function(e){Ha=!0,Al=e}};function ny(e,t,r,n,a,i,l,o,c){Ha=!1,Al=null,ty.apply(ry,arguments)}function sy(e,t,r,n,a,i,l,o,c){if(ny.apply(this,arguments),Ha){if(Ha){var d=Al;Ha=!1,Al=null}else throw Error(ie(198));Fl||(Fl=!0,Yc=d)}}function ws(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function mx(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function Ed(e){if(ws(e)!==e)throw Error(ie(188))}function ay(e){var t=e.alternate;if(!t){if(t=ws(e),t===null)throw Error(ie(188));return t!==e?null:e}for(var r=e,n=t;;){var a=r.return;if(a===null)break;var i=a.alternate;if(i===null){if(n=a.return,n!==null){r=n;continue}break}if(a.child===i.child){for(i=a.child;i;){if(i===r)return Ed(a),e;if(i===n)return Ed(a),t;i=i.sibling}throw Error(ie(188))}if(r.return!==n.return)r=a,n=i;else{for(var l=!1,o=a.child;o;){if(o===r){l=!0,r=a,n=i;break}if(o===n){l=!0,n=a,r=i;break}o=o.sibling}if(!l){for(o=i.child;o;){if(o===r){l=!0,r=i,n=a;break}if(o===n){l=!0,n=i,r=a;break}o=o.sibling}if(!l)throw Error(ie(189))}}if(r.alternate!==n)throw Error(ie(190))}if(r.tag!==3)throw Error(ie(188));return r.stateNode.current===r?e:t}function px(e){return e=ay(e),e!==null?gx(e):null}function gx(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=gx(e);if(t!==null)return t;e=e.sibling}return null}var yx=or.unstable_scheduleCallback,Td=or.unstable_cancelCallback,iy=or.unstable_shouldYield,ly=or.unstable_requestPaint,st=or.unstable_now,oy=or.unstable_getCurrentPriorityLevel,Ju=or.unstable_ImmediatePriority,vx=or.unstable_UserBlockingPriority,Pl=or.unstable_NormalPriority,cy=or.unstable_LowPriority,wx=or.unstable_IdlePriority,yo=null,Wr=null;function uy(e){if(Wr&&typeof Wr.onCommitFiberRoot=="function")try{Wr.onCommitFiberRoot(yo,e,void 0,(e.current.flags&128)===128)}catch{}}var Pr=Math.clz32?Math.clz32:hy,dy=Math.log,fy=Math.LN2;function hy(e){return e>>>=0,e===0?32:31-(dy(e)/fy|0)|0}var Ji=64,qi=4194304;function Ba(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function Ol(e,t){var r=e.pendingLanes;if(r===0)return 0;var n=0,a=e.suspendedLanes,i=e.pingedLanes,l=r&268435455;if(l!==0){var o=l&~a;o!==0?n=Ba(o):(i&=l,i!==0&&(n=Ba(i)))}else l=r&~a,l!==0?n=Ba(l):i!==0&&(n=Ba(i));if(n===0)return 0;if(t!==0&&t!==n&&!(t&a)&&(a=n&-n,i=t&-t,a>=i||a===16&&(i&4194240)!==0))return t;if(n&4&&(n|=r&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=n;0<t;)r=31-Pr(t),a=1<<r,n|=e[r],t&=~a;return n}function xy(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function my(e,t){for(var r=e.suspendedLanes,n=e.pingedLanes,a=e.expirationTimes,i=e.pendingLanes;0<i;){var l=31-Pr(i),o=1<<l,c=a[l];c===-1?(!(o&r)||o&n)&&(a[l]=xy(o,t)):c<=t&&(e.expiredLanes|=o),i&=~o}}function Jc(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function bx(){var e=Ji;return Ji<<=1,!(Ji&4194240)&&(Ji=64),e}function Zo(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function Pi(e,t,r){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-Pr(t),e[t]=r}function py(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<r;){var a=31-Pr(r),i=1<<a;t[a]=0,n[a]=-1,e[a]=-1,r&=~i}}function qu(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var n=31-Pr(r),a=1<<n;a&t|e[n]&t&&(e[n]|=t),r&=~a}}var Me=0;function Nx(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var jx,Qu,Sx,_x,Ex,qc=!1,Qi=[],Pn=null,On=null,Rn=null,li=new Map,oi=new Map,_n=[],gy="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function kd(e,t){switch(e){case"focusin":case"focusout":Pn=null;break;case"dragenter":case"dragleave":On=null;break;case"mouseover":case"mouseout":Rn=null;break;case"pointerover":case"pointerout":li.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":oi.delete(t.pointerId)}}function ka(e,t,r,n,a,i){return e===null||e.nativeEvent!==i?(e={blockedOn:t,domEventName:r,eventSystemFlags:n,nativeEvent:i,targetContainers:[a]},t!==null&&(t=Ri(t),t!==null&&Qu(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,a!==null&&t.indexOf(a)===-1&&t.push(a),e)}function yy(e,t,r,n,a){switch(t){case"focusin":return Pn=ka(Pn,e,t,r,n,a),!0;case"dragenter":return On=ka(On,e,t,r,n,a),!0;case"mouseover":return Rn=ka(Rn,e,t,r,n,a),!0;case"pointerover":var i=a.pointerId;return li.set(i,ka(li.get(i)||null,e,t,r,n,a)),!0;case"gotpointercapture":return i=a.pointerId,oi.set(i,ka(oi.get(i)||null,e,t,r,n,a)),!0}return!1}function Tx(e){var t=as(e.target);if(t!==null){var r=ws(t);if(r!==null){if(t=r.tag,t===13){if(t=mx(r),t!==null){e.blockedOn=t,Ex(e.priority,function(){Sx(r)});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function vl(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=Qc(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(r===null){r=e.nativeEvent;var n=new r.constructor(r.type,r);Gc=n,r.target.dispatchEvent(n),Gc=null}else return t=Ri(r),t!==null&&Qu(t),e.blockedOn=r,!1;t.shift()}return!0}function Cd(e,t,r){vl(e)&&r.delete(t)}function vy(){qc=!1,Pn!==null&&vl(Pn)&&(Pn=null),On!==null&&vl(On)&&(On=null),Rn!==null&&vl(Rn)&&(Rn=null),li.forEach(Cd),oi.forEach(Cd)}function Ca(e,t){e.blockedOn===t&&(e.blockedOn=null,qc||(qc=!0,or.unstable_scheduleCallback(or.unstable_NormalPriority,vy)))}function ci(e){function t(a){return Ca(a,e)}if(0<Qi.length){Ca(Qi[0],e);for(var r=1;r<Qi.length;r++){var n=Qi[r];n.blockedOn===e&&(n.blockedOn=null)}}for(Pn!==null&&Ca(Pn,e),On!==null&&Ca(On,e),Rn!==null&&Ca(Rn,e),li.forEach(t),oi.forEach(t),r=0;r<_n.length;r++)n=_n[r],n.blockedOn===e&&(n.blockedOn=null);for(;0<_n.length&&(r=_n[0],r.blockedOn===null);)Tx(r),r.blockedOn===null&&_n.shift()}var Ys=xn.ReactCurrentBatchConfig,Rl=!0;function wy(e,t,r,n){var a=Me,i=Ys.transition;Ys.transition=null;try{Me=1,Zu(e,t,r,n)}finally{Me=a,Ys.transition=i}}function by(e,t,r,n){var a=Me,i=Ys.transition;Ys.transition=null;try{Me=4,Zu(e,t,r,n)}finally{Me=a,Ys.transition=i}}function Zu(e,t,r,n){if(Rl){var a=Qc(e,t,r,n);if(a===null)cc(e,t,n,Il,r),kd(e,n);else if(yy(a,e,t,r,n))n.stopPropagation();else if(kd(e,n),t&4&&-1<gy.indexOf(e)){for(;a!==null;){var i=Ri(a);if(i!==null&&jx(i),i=Qc(e,t,r,n),i===null&&cc(e,t,n,Il,r),i===a)break;a=i}a!==null&&n.stopPropagation()}else cc(e,t,n,null,r)}}var Il=null;function Qc(e,t,r,n){if(Il=null,e=Yu(n),e=as(e),e!==null)if(t=ws(e),t===null)e=null;else if(r=t.tag,r===13){if(e=mx(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Il=e,null}function kx(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(oy()){case Ju:return 1;case vx:return 4;case Pl:case cy:return 16;case wx:return 536870912;default:return 16}default:return 16}}var Tn=null,e0=null,wl=null;function Cx(){if(wl)return wl;var e,t=e0,r=t.length,n,a="value"in Tn?Tn.value:Tn.textContent,i=a.length;for(e=0;e<r&&t[e]===a[e];e++);var l=r-e;for(n=1;n<=l&&t[r-n]===a[i-n];n++);return wl=a.slice(e,1<n?1-n:void 0)}function bl(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function Zi(){return!0}function Ad(){return!1}function dr(e){function t(r,n,a,i,l){this._reactName=r,this._targetInst=a,this.type=n,this.nativeEvent=i,this.target=l,this.currentTarget=null;for(var o in e)e.hasOwnProperty(o)&&(r=e[o],this[o]=r?r(i):i[o]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?Zi:Ad,this.isPropagationStopped=Ad,this}return et(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=Zi)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=Zi)},persist:function(){},isPersistent:Zi}),t}var xa={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},t0=dr(xa),Oi=et({},xa,{view:0,detail:0}),Ny=dr(Oi),ec,tc,Aa,vo=et({},Oi,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:r0,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Aa&&(Aa&&e.type==="mousemove"?(ec=e.screenX-Aa.screenX,tc=e.screenY-Aa.screenY):tc=ec=0,Aa=e),ec)},movementY:function(e){return"movementY"in e?e.movementY:tc}}),Fd=dr(vo),jy=et({},vo,{dataTransfer:0}),Sy=dr(jy),_y=et({},Oi,{relatedTarget:0}),rc=dr(_y),Ey=et({},xa,{animationName:0,elapsedTime:0,pseudoElement:0}),Ty=dr(Ey),ky=et({},xa,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),Cy=dr(ky),Ay=et({},xa,{data:0}),Pd=dr(Ay),Fy={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Py={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Oy={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Ry(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=Oy[e])?!!t[e]:!1}function r0(){return Ry}var Iy=et({},Oi,{key:function(e){if(e.key){var t=Fy[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=bl(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?Py[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:r0,charCode:function(e){return e.type==="keypress"?bl(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?bl(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),Dy=dr(Iy),Ly=et({},vo,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Od=dr(Ly),My=et({},Oi,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:r0}),By=dr(My),Uy=et({},xa,{propertyName:0,elapsedTime:0,pseudoElement:0}),zy=dr(Uy),$y=et({},vo,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Wy=dr($y),Hy=[9,13,27,32],n0=on&&"CompositionEvent"in window,Va=null;on&&"documentMode"in document&&(Va=document.documentMode);var Vy=on&&"TextEvent"in window&&!Va,Ax=on&&(!n0||Va&&8<Va&&11>=Va),Rd=" ",Id=!1;function Fx(e,t){switch(e){case"keyup":return Hy.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Px(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Rs=!1;function Gy(e,t){switch(e){case"compositionend":return Px(t);case"keypress":return t.which!==32?null:(Id=!0,Rd);case"textInput":return e=t.data,e===Rd&&Id?null:e;default:return null}}function Xy(e,t){if(Rs)return e==="compositionend"||!n0&&Fx(e,t)?(e=Cx(),wl=e0=Tn=null,Rs=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Ax&&t.locale!=="ko"?null:t.data;default:return null}}var Ky={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Dd(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!Ky[e.type]:t==="textarea"}function Ox(e,t,r,n){ux(n),t=Dl(t,"onChange"),0<t.length&&(r=new t0("onChange","change",null,r,n),e.push({event:r,listeners:t}))}var Ga=null,ui=null;function Yy(e){Hx(e,0)}function wo(e){var t=Ls(e);if(nx(t))return e}function Jy(e,t){if(e==="change")return t}var Rx=!1;if(on){var nc;if(on){var sc="oninput"in document;if(!sc){var Ld=document.createElement("div");Ld.setAttribute("oninput","return;"),sc=typeof Ld.oninput=="function"}nc=sc}else nc=!1;Rx=nc&&(!document.documentMode||9<document.documentMode)}function Md(){Ga&&(Ga.detachEvent("onpropertychange",Ix),ui=Ga=null)}function Ix(e){if(e.propertyName==="value"&&wo(ui)){var t=[];Ox(t,ui,e,Yu(e)),xx(Yy,t)}}function qy(e,t,r){e==="focusin"?(Md(),Ga=t,ui=r,Ga.attachEvent("onpropertychange",Ix)):e==="focusout"&&Md()}function Qy(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return wo(ui)}function Zy(e,t){if(e==="click")return wo(t)}function ev(e,t){if(e==="input"||e==="change")return wo(t)}function tv(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Ir=typeof Object.is=="function"?Object.is:tv;function di(e,t){if(Ir(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var a=r[n];if(!Rc.call(t,a)||!Ir(e[a],t[a]))return!1}return!0}function Bd(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Ud(e,t){var r=Bd(e);e=0;for(var n;r;){if(r.nodeType===3){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=Bd(r)}}function Dx(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?Dx(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function Lx(){for(var e=window,t=Cl();t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch{r=!1}if(r)e=t.contentWindow;else break;t=Cl(e.document)}return t}function s0(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function rv(e){var t=Lx(),r=e.focusedElem,n=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&Dx(r.ownerDocument.documentElement,r)){if(n!==null&&s0(r)){if(t=n.start,e=n.end,e===void 0&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if(e=(t=r.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var a=r.textContent.length,i=Math.min(n.start,a);n=n.end===void 0?i:Math.min(n.end,a),!e.extend&&i>n&&(a=n,n=i,i=a),a=Ud(r,i);var l=Ud(r,n);a&&l&&(e.rangeCount!==1||e.anchorNode!==a.node||e.anchorOffset!==a.offset||e.focusNode!==l.node||e.focusOffset!==l.offset)&&(t=t.createRange(),t.setStart(a.node,a.offset),e.removeAllRanges(),i>n?(e.addRange(t),e.extend(l.node,l.offset)):(t.setEnd(l.node,l.offset),e.addRange(t)))}}for(t=[],e=r;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<t.length;r++)e=t[r],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var nv=on&&"documentMode"in document&&11>=document.documentMode,Is=null,Zc=null,Xa=null,eu=!1;function zd(e,t,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;eu||Is==null||Is!==Cl(n)||(n=Is,"selectionStart"in n&&s0(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),Xa&&di(Xa,n)||(Xa=n,n=Dl(Zc,"onSelect"),0<n.length&&(t=new t0("onSelect","select",null,t,r),e.push({event:t,listeners:n}),t.target=Is)))}function el(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var Ds={animationend:el("Animation","AnimationEnd"),animationiteration:el("Animation","AnimationIteration"),animationstart:el("Animation","AnimationStart"),transitionend:el("Transition","TransitionEnd")},ac={},Mx={};on&&(Mx=document.createElement("div").style,"AnimationEvent"in window||(delete Ds.animationend.animation,delete Ds.animationiteration.animation,delete Ds.animationstart.animation),"TransitionEvent"in window||delete Ds.transitionend.transition);function bo(e){if(ac[e])return ac[e];if(!Ds[e])return e;var t=Ds[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in Mx)return ac[e]=t[r];return e}var Bx=bo("animationend"),Ux=bo("animationiteration"),zx=bo("animationstart"),$x=bo("transitionend"),Wx=new Map,$d="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Xn(e,t){Wx.set(e,t),vs(t,[e])}for(var ic=0;ic<$d.length;ic++){var lc=$d[ic],sv=lc.toLowerCase(),av=lc[0].toUpperCase()+lc.slice(1);Xn(sv,"on"+av)}Xn(Bx,"onAnimationEnd");Xn(Ux,"onAnimationIteration");Xn(zx,"onAnimationStart");Xn("dblclick","onDoubleClick");Xn("focusin","onFocus");Xn("focusout","onBlur");Xn($x,"onTransitionEnd");sa("onMouseEnter",["mouseout","mouseover"]);sa("onMouseLeave",["mouseout","mouseover"]);sa("onPointerEnter",["pointerout","pointerover"]);sa("onPointerLeave",["pointerout","pointerover"]);vs("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));vs("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));vs("onBeforeInput",["compositionend","keypress","textInput","paste"]);vs("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));vs("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));vs("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ua="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),iv=new Set("cancel close invalid load scroll toggle".split(" ").concat(Ua));function Wd(e,t,r){var n=e.type||"unknown-event";e.currentTarget=r,sy(n,t,void 0,e),e.currentTarget=null}function Hx(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var n=e[r],a=n.event;n=n.listeners;e:{var i=void 0;if(t)for(var l=n.length-1;0<=l;l--){var o=n[l],c=o.instance,d=o.currentTarget;if(o=o.listener,c!==i&&a.isPropagationStopped())break e;Wd(a,o,d),i=c}else for(l=0;l<n.length;l++){if(o=n[l],c=o.instance,d=o.currentTarget,o=o.listener,c!==i&&a.isPropagationStopped())break e;Wd(a,o,d),i=c}}}if(Fl)throw e=Yc,Fl=!1,Yc=null,e}function He(e,t){var r=t[au];r===void 0&&(r=t[au]=new Set);var n=e+"__bubble";r.has(n)||(Vx(t,e,2,!1),r.add(n))}function oc(e,t,r){var n=0;t&&(n|=4),Vx(r,e,n,t)}var tl="_reactListening"+Math.random().toString(36).slice(2);function fi(e){if(!e[tl]){e[tl]=!0,Qh.forEach(function(r){r!=="selectionchange"&&(iv.has(r)||oc(r,!1,e),oc(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[tl]||(t[tl]=!0,oc("selectionchange",!1,t))}}function Vx(e,t,r,n){switch(kx(t)){case 1:var a=wy;break;case 4:a=by;break;default:a=Zu}r=a.bind(null,t,r,e),a=void 0,!Kc||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(a=!0),n?a!==void 0?e.addEventListener(t,r,{capture:!0,passive:a}):e.addEventListener(t,r,!0):a!==void 0?e.addEventListener(t,r,{passive:a}):e.addEventListener(t,r,!1)}function cc(e,t,r,n,a){var i=n;if(!(t&1)&&!(t&2)&&n!==null)e:for(;;){if(n===null)return;var l=n.tag;if(l===3||l===4){var o=n.stateNode.containerInfo;if(o===a||o.nodeType===8&&o.parentNode===a)break;if(l===4)for(l=n.return;l!==null;){var c=l.tag;if((c===3||c===4)&&(c=l.stateNode.containerInfo,c===a||c.nodeType===8&&c.parentNode===a))return;l=l.return}for(;o!==null;){if(l=as(o),l===null)return;if(c=l.tag,c===5||c===6){n=i=l;continue e}o=o.parentNode}}n=n.return}xx(function(){var d=i,u=Yu(r),f=[];e:{var h=Wx.get(e);if(h!==void 0){var m=t0,v=e;switch(e){case"keypress":if(bl(r)===0)break e;case"keydown":case"keyup":m=Dy;break;case"focusin":v="focus",m=rc;break;case"focusout":v="blur",m=rc;break;case"beforeblur":case"afterblur":m=rc;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":m=Fd;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":m=Sy;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":m=By;break;case Bx:case Ux:case zx:m=Ty;break;case $x:m=zy;break;case"scroll":m=Ny;break;case"wheel":m=Wy;break;case"copy":case"cut":case"paste":m=Cy;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":m=Od}var x=(t&4)!==0,y=!x&&e==="scroll",p=x?h!==null?h+"Capture":null:h;x=[];for(var g=d,w;g!==null;){w=g;var b=w.stateNode;if(w.tag===5&&b!==null&&(w=b,p!==null&&(b=ii(g,p),b!=null&&x.push(hi(g,b,w)))),y)break;g=g.return}0<x.length&&(h=new m(h,v,null,r,u),f.push({event:h,listeners:x}))}}if(!(t&7)){e:{if(h=e==="mouseover"||e==="pointerover",m=e==="mouseout"||e==="pointerout",h&&r!==Gc&&(v=r.relatedTarget||r.fromElement)&&(as(v)||v[cn]))break e;if((m||h)&&(h=u.window===u?u:(h=u.ownerDocument)?h.defaultView||h.parentWindow:window,m?(v=r.relatedTarget||r.toElement,m=d,v=v?as(v):null,v!==null&&(y=ws(v),v!==y||v.tag!==5&&v.tag!==6)&&(v=null)):(m=null,v=d),m!==v)){if(x=Fd,b="onMouseLeave",p="onMouseEnter",g="mouse",(e==="pointerout"||e==="pointerover")&&(x=Od,b="onPointerLeave",p="onPointerEnter",g="pointer"),y=m==null?h:Ls(m),w=v==null?h:Ls(v),h=new x(b,g+"leave",m,r,u),h.target=y,h.relatedTarget=w,b=null,as(u)===d&&(x=new x(p,g+"enter",v,r,u),x.target=w,x.relatedTarget=y,b=x),y=b,m&&v)t:{for(x=m,p=v,g=0,w=x;w;w=Ts(w))g++;for(w=0,b=p;b;b=Ts(b))w++;for(;0<g-w;)x=Ts(x),g--;for(;0<w-g;)p=Ts(p),w--;for(;g--;){if(x===p||p!==null&&x===p.alternate)break t;x=Ts(x),p=Ts(p)}x=null}else x=null;m!==null&&Hd(f,h,m,x,!1),v!==null&&y!==null&&Hd(f,y,v,x,!0)}}e:{if(h=d?Ls(d):window,m=h.nodeName&&h.nodeName.toLowerCase(),m==="select"||m==="input"&&h.type==="file")var P=Jy;else if(Dd(h))if(Rx)P=ev;else{P=Qy;var M=qy}else(m=h.nodeName)&&m.toLowerCase()==="input"&&(h.type==="checkbox"||h.type==="radio")&&(P=Zy);if(P&&(P=P(e,d))){Ox(f,P,r,u);break e}M&&M(e,h,d),e==="focusout"&&(M=h._wrapperState)&&M.controlled&&h.type==="number"&&zc(h,"number",h.value)}switch(M=d?Ls(d):window,e){case"focusin":(Dd(M)||M.contentEditable==="true")&&(Is=M,Zc=d,Xa=null);break;case"focusout":Xa=Zc=Is=null;break;case"mousedown":eu=!0;break;case"contextmenu":case"mouseup":case"dragend":eu=!1,zd(f,r,u);break;case"selectionchange":if(nv)break;case"keydown":case"keyup":zd(f,r,u)}var j;if(n0)e:{switch(e){case"compositionstart":var O="onCompositionStart";break e;case"compositionend":O="onCompositionEnd";break e;case"compositionupdate":O="onCompositionUpdate";break e}O=void 0}else Rs?Fx(e,r)&&(O="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(O="onCompositionStart");O&&(Ax&&r.locale!=="ko"&&(Rs||O!=="onCompositionStart"?O==="onCompositionEnd"&&Rs&&(j=Cx()):(Tn=u,e0="value"in Tn?Tn.value:Tn.textContent,Rs=!0)),M=Dl(d,O),0<M.length&&(O=new Pd(O,e,null,r,u),f.push({event:O,listeners:M}),j?O.data=j:(j=Px(r),j!==null&&(O.data=j)))),(j=Vy?Gy(e,r):Xy(e,r))&&(d=Dl(d,"onBeforeInput"),0<d.length&&(u=new Pd("onBeforeInput","beforeinput",null,r,u),f.push({event:u,listeners:d}),u.data=j))}Hx(f,t)})}function hi(e,t,r){return{instance:e,listener:t,currentTarget:r}}function Dl(e,t){for(var r=t+"Capture",n=[];e!==null;){var a=e,i=a.stateNode;a.tag===5&&i!==null&&(a=i,i=ii(e,r),i!=null&&n.unshift(hi(e,i,a)),i=ii(e,t),i!=null&&n.push(hi(e,i,a))),e=e.return}return n}function Ts(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function Hd(e,t,r,n,a){for(var i=t._reactName,l=[];r!==null&&r!==n;){var o=r,c=o.alternate,d=o.stateNode;if(c!==null&&c===n)break;o.tag===5&&d!==null&&(o=d,a?(c=ii(r,i),c!=null&&l.unshift(hi(r,c,o))):a||(c=ii(r,i),c!=null&&l.push(hi(r,c,o)))),r=r.return}l.length!==0&&e.push({event:t,listeners:l})}var lv=/\r\n?/g,ov=/\u0000|\uFFFD/g;function Vd(e){return(typeof e=="string"?e:""+e).replace(lv,`
`).replace(ov,"")}function rl(e,t,r){if(t=Vd(t),Vd(e)!==t&&r)throw Error(ie(425))}function Ll(){}var tu=null,ru=null;function nu(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var su=typeof setTimeout=="function"?setTimeout:void 0,cv=typeof clearTimeout=="function"?clearTimeout:void 0,Gd=typeof Promise=="function"?Promise:void 0,uv=typeof queueMicrotask=="function"?queueMicrotask:typeof Gd<"u"?function(e){return Gd.resolve(null).then(e).catch(dv)}:su;function dv(e){setTimeout(function(){throw e})}function uc(e,t){var r=t,n=0;do{var a=r.nextSibling;if(e.removeChild(r),a&&a.nodeType===8)if(r=a.data,r==="/$"){if(n===0){e.removeChild(a),ci(t);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=a}while(r);ci(t)}function In(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function Xd(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"){if(t===0)return e;t--}else r==="/$"&&t++}e=e.previousSibling}return null}var ma=Math.random().toString(36).slice(2),zr="__reactFiber$"+ma,xi="__reactProps$"+ma,cn="__reactContainer$"+ma,au="__reactEvents$"+ma,fv="__reactListeners$"+ma,hv="__reactHandles$"+ma;function as(e){var t=e[zr];if(t)return t;for(var r=e.parentNode;r;){if(t=r[cn]||r[zr]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=Xd(e);e!==null;){if(r=e[zr])return r;e=Xd(e)}return t}e=r,r=e.parentNode}return null}function Ri(e){return e=e[zr]||e[cn],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function Ls(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(ie(33))}function No(e){return e[xi]||null}var iu=[],Ms=-1;function Kn(e){return{current:e}}function Ge(e){0>Ms||(e.current=iu[Ms],iu[Ms]=null,Ms--)}function $e(e,t){Ms++,iu[Ms]=e.current,e.current=t}var $n={},Dt=Kn($n),Xt=Kn(!1),ds=$n;function aa(e,t){var r=e.type.contextTypes;if(!r)return $n;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var a={},i;for(i in r)a[i]=t[i];return n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=a),a}function Kt(e){return e=e.childContextTypes,e!=null}function Ml(){Ge(Xt),Ge(Dt)}function Kd(e,t,r){if(Dt.current!==$n)throw Error(ie(168));$e(Dt,t),$e(Xt,r)}function Gx(e,t,r){var n=e.stateNode;if(t=t.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var a in n)if(!(a in t))throw Error(ie(108,q1(e)||"Unknown",a));return et({},r,n)}function Bl(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||$n,ds=Dt.current,$e(Dt,e),$e(Xt,Xt.current),!0}function Yd(e,t,r){var n=e.stateNode;if(!n)throw Error(ie(169));r?(e=Gx(e,t,ds),n.__reactInternalMemoizedMergedChildContext=e,Ge(Xt),Ge(Dt),$e(Dt,e)):Ge(Xt),$e(Xt,r)}var Jr=null,jo=!1,dc=!1;function Xx(e){Jr===null?Jr=[e]:Jr.push(e)}function xv(e){jo=!0,Xx(e)}function Yn(){if(!dc&&Jr!==null){dc=!0;var e=0,t=Me;try{var r=Jr;for(Me=1;e<r.length;e++){var n=r[e];do n=n(!0);while(n!==null)}Jr=null,jo=!1}catch(a){throw Jr!==null&&(Jr=Jr.slice(e+1)),yx(Ju,Yn),a}finally{Me=t,dc=!1}}return null}var Bs=[],Us=0,Ul=null,zl=0,xr=[],mr=0,fs=null,tn=1,rn="";function ts(e,t){Bs[Us++]=zl,Bs[Us++]=Ul,Ul=e,zl=t}function Kx(e,t,r){xr[mr++]=tn,xr[mr++]=rn,xr[mr++]=fs,fs=e;var n=tn;e=rn;var a=32-Pr(n)-1;n&=~(1<<a),r+=1;var i=32-Pr(t)+a;if(30<i){var l=a-a%5;i=(n&(1<<l)-1).toString(32),n>>=l,a-=l,tn=1<<32-Pr(t)+a|r<<a|n,rn=i+e}else tn=1<<i|r<<a|n,rn=e}function a0(e){e.return!==null&&(ts(e,1),Kx(e,1,0))}function i0(e){for(;e===Ul;)Ul=Bs[--Us],Bs[Us]=null,zl=Bs[--Us],Bs[Us]=null;for(;e===fs;)fs=xr[--mr],xr[mr]=null,rn=xr[--mr],xr[mr]=null,tn=xr[--mr],xr[mr]=null}var ir=null,ar=null,Ke=!1,Cr=null;function Yx(e,t){var r=gr(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,t=e.deletions,t===null?(e.deletions=[r],e.flags|=16):t.push(r)}function Jd(e,t){switch(e.tag){case 5:var r=e.type;return t=t.nodeType!==1||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,ir=e,ar=In(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,ir=e,ar=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(r=fs!==null?{id:tn,overflow:rn}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},r=gr(18,null,null,0),r.stateNode=t,r.return=e,e.child=r,ir=e,ar=null,!0):!1;default:return!1}}function lu(e){return(e.mode&1)!==0&&(e.flags&128)===0}function ou(e){if(Ke){var t=ar;if(t){var r=t;if(!Jd(e,t)){if(lu(e))throw Error(ie(418));t=In(r.nextSibling);var n=ir;t&&Jd(e,t)?Yx(n,r):(e.flags=e.flags&-4097|2,Ke=!1,ir=e)}}else{if(lu(e))throw Error(ie(418));e.flags=e.flags&-4097|2,Ke=!1,ir=e}}}function qd(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;ir=e}function nl(e){if(e!==ir)return!1;if(!Ke)return qd(e),Ke=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!nu(e.type,e.memoizedProps)),t&&(t=ar)){if(lu(e))throw Jx(),Error(ie(418));for(;t;)Yx(e,t),t=In(t.nextSibling)}if(qd(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(ie(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"){if(t===0){ar=In(e.nextSibling);break e}t--}else r!=="$"&&r!=="$!"&&r!=="$?"||t++}e=e.nextSibling}ar=null}}else ar=ir?In(e.stateNode.nextSibling):null;return!0}function Jx(){for(var e=ar;e;)e=In(e.nextSibling)}function ia(){ar=ir=null,Ke=!1}function l0(e){Cr===null?Cr=[e]:Cr.push(e)}var mv=xn.ReactCurrentBatchConfig;function Fa(e,t,r){if(e=r.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(ie(309));var n=r.stateNode}if(!n)throw Error(ie(147,e));var a=n,i=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===i?t.ref:(t=function(l){var o=a.refs;l===null?delete o[i]:o[i]=l},t._stringRef=i,t)}if(typeof e!="string")throw Error(ie(284));if(!r._owner)throw Error(ie(290,e))}return e}function sl(e,t){throw e=Object.prototype.toString.call(t),Error(ie(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function Qd(e){var t=e._init;return t(e._payload)}function qx(e){function t(p,g){if(e){var w=p.deletions;w===null?(p.deletions=[g],p.flags|=16):w.push(g)}}function r(p,g){if(!e)return null;for(;g!==null;)t(p,g),g=g.sibling;return null}function n(p,g){for(p=new Map;g!==null;)g.key!==null?p.set(g.key,g):p.set(g.index,g),g=g.sibling;return p}function a(p,g){return p=Bn(p,g),p.index=0,p.sibling=null,p}function i(p,g,w){return p.index=w,e?(w=p.alternate,w!==null?(w=w.index,w<g?(p.flags|=2,g):w):(p.flags|=2,g)):(p.flags|=1048576,g)}function l(p){return e&&p.alternate===null&&(p.flags|=2),p}function o(p,g,w,b){return g===null||g.tag!==6?(g=yc(w,p.mode,b),g.return=p,g):(g=a(g,w),g.return=p,g)}function c(p,g,w,b){var P=w.type;return P===Os?u(p,g,w.props.children,b,w.key):g!==null&&(g.elementType===P||typeof P=="object"&&P!==null&&P.$$typeof===jn&&Qd(P)===g.type)?(b=a(g,w.props),b.ref=Fa(p,g,w),b.return=p,b):(b=kl(w.type,w.key,w.props,null,p.mode,b),b.ref=Fa(p,g,w),b.return=p,b)}function d(p,g,w,b){return g===null||g.tag!==4||g.stateNode.containerInfo!==w.containerInfo||g.stateNode.implementation!==w.implementation?(g=vc(w,p.mode,b),g.return=p,g):(g=a(g,w.children||[]),g.return=p,g)}function u(p,g,w,b,P){return g===null||g.tag!==7?(g=cs(w,p.mode,b,P),g.return=p,g):(g=a(g,w),g.return=p,g)}function f(p,g,w){if(typeof g=="string"&&g!==""||typeof g=="number")return g=yc(""+g,p.mode,w),g.return=p,g;if(typeof g=="object"&&g!==null){switch(g.$$typeof){case Xi:return w=kl(g.type,g.key,g.props,null,p.mode,w),w.ref=Fa(p,null,g),w.return=p,w;case Ps:return g=vc(g,p.mode,w),g.return=p,g;case jn:var b=g._init;return f(p,b(g._payload),w)}if(Ma(g)||Ea(g))return g=cs(g,p.mode,w,null),g.return=p,g;sl(p,g)}return null}function h(p,g,w,b){var P=g!==null?g.key:null;if(typeof w=="string"&&w!==""||typeof w=="number")return P!==null?null:o(p,g,""+w,b);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case Xi:return w.key===P?c(p,g,w,b):null;case Ps:return w.key===P?d(p,g,w,b):null;case jn:return P=w._init,h(p,g,P(w._payload),b)}if(Ma(w)||Ea(w))return P!==null?null:u(p,g,w,b,null);sl(p,w)}return null}function m(p,g,w,b,P){if(typeof b=="string"&&b!==""||typeof b=="number")return p=p.get(w)||null,o(g,p,""+b,P);if(typeof b=="object"&&b!==null){switch(b.$$typeof){case Xi:return p=p.get(b.key===null?w:b.key)||null,c(g,p,b,P);case Ps:return p=p.get(b.key===null?w:b.key)||null,d(g,p,b,P);case jn:var M=b._init;return m(p,g,w,M(b._payload),P)}if(Ma(b)||Ea(b))return p=p.get(w)||null,u(g,p,b,P,null);sl(g,b)}return null}function v(p,g,w,b){for(var P=null,M=null,j=g,O=g=0,R=null;j!==null&&O<w.length;O++){j.index>O?(R=j,j=null):R=j.sibling;var I=h(p,j,w[O],b);if(I===null){j===null&&(j=R);break}e&&j&&I.alternate===null&&t(p,j),g=i(I,g,O),M===null?P=I:M.sibling=I,M=I,j=R}if(O===w.length)return r(p,j),Ke&&ts(p,O),P;if(j===null){for(;O<w.length;O++)j=f(p,w[O],b),j!==null&&(g=i(j,g,O),M===null?P=j:M.sibling=j,M=j);return Ke&&ts(p,O),P}for(j=n(p,j);O<w.length;O++)R=m(j,p,O,w[O],b),R!==null&&(e&&R.alternate!==null&&j.delete(R.key===null?O:R.key),g=i(R,g,O),M===null?P=R:M.sibling=R,M=R);return e&&j.forEach(function(D){return t(p,D)}),Ke&&ts(p,O),P}function x(p,g,w,b){var P=Ea(w);if(typeof P!="function")throw Error(ie(150));if(w=P.call(w),w==null)throw Error(ie(151));for(var M=P=null,j=g,O=g=0,R=null,I=w.next();j!==null&&!I.done;O++,I=w.next()){j.index>O?(R=j,j=null):R=j.sibling;var D=h(p,j,I.value,b);if(D===null){j===null&&(j=R);break}e&&j&&D.alternate===null&&t(p,j),g=i(D,g,O),M===null?P=D:M.sibling=D,M=D,j=R}if(I.done)return r(p,j),Ke&&ts(p,O),P;if(j===null){for(;!I.done;O++,I=w.next())I=f(p,I.value,b),I!==null&&(g=i(I,g,O),M===null?P=I:M.sibling=I,M=I);return Ke&&ts(p,O),P}for(j=n(p,j);!I.done;O++,I=w.next())I=m(j,p,O,I.value,b),I!==null&&(e&&I.alternate!==null&&j.delete(I.key===null?O:I.key),g=i(I,g,O),M===null?P=I:M.sibling=I,M=I);return e&&j.forEach(function(z){return t(p,z)}),Ke&&ts(p,O),P}function y(p,g,w,b){if(typeof w=="object"&&w!==null&&w.type===Os&&w.key===null&&(w=w.props.children),typeof w=="object"&&w!==null){switch(w.$$typeof){case Xi:e:{for(var P=w.key,M=g;M!==null;){if(M.key===P){if(P=w.type,P===Os){if(M.tag===7){r(p,M.sibling),g=a(M,w.props.children),g.return=p,p=g;break e}}else if(M.elementType===P||typeof P=="object"&&P!==null&&P.$$typeof===jn&&Qd(P)===M.type){r(p,M.sibling),g=a(M,w.props),g.ref=Fa(p,M,w),g.return=p,p=g;break e}r(p,M);break}else t(p,M);M=M.sibling}w.type===Os?(g=cs(w.props.children,p.mode,b,w.key),g.return=p,p=g):(b=kl(w.type,w.key,w.props,null,p.mode,b),b.ref=Fa(p,g,w),b.return=p,p=b)}return l(p);case Ps:e:{for(M=w.key;g!==null;){if(g.key===M)if(g.tag===4&&g.stateNode.containerInfo===w.containerInfo&&g.stateNode.implementation===w.implementation){r(p,g.sibling),g=a(g,w.children||[]),g.return=p,p=g;break e}else{r(p,g);break}else t(p,g);g=g.sibling}g=vc(w,p.mode,b),g.return=p,p=g}return l(p);case jn:return M=w._init,y(p,g,M(w._payload),b)}if(Ma(w))return v(p,g,w,b);if(Ea(w))return x(p,g,w,b);sl(p,w)}return typeof w=="string"&&w!==""||typeof w=="number"?(w=""+w,g!==null&&g.tag===6?(r(p,g.sibling),g=a(g,w),g.return=p,p=g):(r(p,g),g=yc(w,p.mode,b),g.return=p,p=g),l(p)):r(p,g)}return y}var la=qx(!0),Qx=qx(!1),$l=Kn(null),Wl=null,zs=null,o0=null;function c0(){o0=zs=Wl=null}function u0(e){var t=$l.current;Ge($l),e._currentValue=t}function cu(e,t,r){for(;e!==null;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,n!==null&&(n.childLanes|=t)):n!==null&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===r)break;e=e.return}}function Js(e,t){Wl=e,o0=zs=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(Gt=!0),e.firstContext=null)}function wr(e){var t=e._currentValue;if(o0!==e)if(e={context:e,memoizedValue:t,next:null},zs===null){if(Wl===null)throw Error(ie(308));zs=e,Wl.dependencies={lanes:0,firstContext:e}}else zs=zs.next=e;return t}var is=null;function d0(e){is===null?is=[e]:is.push(e)}function Zx(e,t,r,n){var a=t.interleaved;return a===null?(r.next=r,d0(t)):(r.next=a.next,a.next=r),t.interleaved=r,un(e,n)}function un(e,t){e.lanes|=t;var r=e.alternate;for(r!==null&&(r.lanes|=t),r=e,e=e.return;e!==null;)e.childLanes|=t,r=e.alternate,r!==null&&(r.childLanes|=t),r=e,e=e.return;return r.tag===3?r.stateNode:null}var Sn=!1;function f0(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function em(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function nn(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Dn(e,t,r){var n=e.updateQueue;if(n===null)return null;if(n=n.shared,Pe&2){var a=n.pending;return a===null?t.next=t:(t.next=a.next,a.next=t),n.pending=t,un(e,r)}return a=n.interleaved,a===null?(t.next=t,d0(n)):(t.next=a.next,a.next=t),n.interleaved=t,un(e,r)}function Nl(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194240)!==0)){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,qu(e,r)}}function Zd(e,t){var r=e.updateQueue,n=e.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var a=null,i=null;if(r=r.firstBaseUpdate,r!==null){do{var l={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};i===null?a=i=l:i=i.next=l,r=r.next}while(r!==null);i===null?a=i=t:i=i.next=t}else a=i=t;r={baseState:n.baseState,firstBaseUpdate:a,lastBaseUpdate:i,shared:n.shared,effects:n.effects},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function Hl(e,t,r,n){var a=e.updateQueue;Sn=!1;var i=a.firstBaseUpdate,l=a.lastBaseUpdate,o=a.shared.pending;if(o!==null){a.shared.pending=null;var c=o,d=c.next;c.next=null,l===null?i=d:l.next=d,l=c;var u=e.alternate;u!==null&&(u=u.updateQueue,o=u.lastBaseUpdate,o!==l&&(o===null?u.firstBaseUpdate=d:o.next=d,u.lastBaseUpdate=c))}if(i!==null){var f=a.baseState;l=0,u=d=c=null,o=i;do{var h=o.lane,m=o.eventTime;if((n&h)===h){u!==null&&(u=u.next={eventTime:m,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var v=e,x=o;switch(h=t,m=r,x.tag){case 1:if(v=x.payload,typeof v=="function"){f=v.call(m,f,h);break e}f=v;break e;case 3:v.flags=v.flags&-65537|128;case 0:if(v=x.payload,h=typeof v=="function"?v.call(m,f,h):v,h==null)break e;f=et({},f,h);break e;case 2:Sn=!0}}o.callback!==null&&o.lane!==0&&(e.flags|=64,h=a.effects,h===null?a.effects=[o]:h.push(o))}else m={eventTime:m,lane:h,tag:o.tag,payload:o.payload,callback:o.callback,next:null},u===null?(d=u=m,c=f):u=u.next=m,l|=h;if(o=o.next,o===null){if(o=a.shared.pending,o===null)break;h=o,o=h.next,h.next=null,a.lastBaseUpdate=h,a.shared.pending=null}}while(!0);if(u===null&&(c=f),a.baseState=c,a.firstBaseUpdate=d,a.lastBaseUpdate=u,t=a.shared.interleaved,t!==null){a=t;do l|=a.lane,a=a.next;while(a!==t)}else i===null&&(a.shared.lanes=0);xs|=l,e.lanes=l,e.memoizedState=f}}function ef(e,t,r){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var n=e[t],a=n.callback;if(a!==null){if(n.callback=null,n=r,typeof a!="function")throw Error(ie(191,a));a.call(n)}}}var Ii={},Hr=Kn(Ii),mi=Kn(Ii),pi=Kn(Ii);function ls(e){if(e===Ii)throw Error(ie(174));return e}function h0(e,t){switch($e(pi,t),$e(mi,e),$e(Hr,Ii),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:Wc(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=Wc(t,e)}Ge(Hr),$e(Hr,t)}function oa(){Ge(Hr),Ge(mi),Ge(pi)}function tm(e){ls(pi.current);var t=ls(Hr.current),r=Wc(t,e.type);t!==r&&($e(mi,e),$e(Hr,r))}function x0(e){mi.current===e&&(Ge(Hr),Ge(mi))}var qe=Kn(0);function Vl(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var fc=[];function m0(){for(var e=0;e<fc.length;e++)fc[e]._workInProgressVersionPrimary=null;fc.length=0}var jl=xn.ReactCurrentDispatcher,hc=xn.ReactCurrentBatchConfig,hs=0,Ze=null,ft=null,mt=null,Gl=!1,Ka=!1,gi=0,pv=0;function Ft(){throw Error(ie(321))}function p0(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!Ir(e[r],t[r]))return!1;return!0}function g0(e,t,r,n,a,i){if(hs=i,Ze=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,jl.current=e===null||e.memoizedState===null?wv:bv,e=r(n,a),Ka){i=0;do{if(Ka=!1,gi=0,25<=i)throw Error(ie(301));i+=1,mt=ft=null,t.updateQueue=null,jl.current=Nv,e=r(n,a)}while(Ka)}if(jl.current=Xl,t=ft!==null&&ft.next!==null,hs=0,mt=ft=Ze=null,Gl=!1,t)throw Error(ie(300));return e}function y0(){var e=gi!==0;return gi=0,e}function Ur(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return mt===null?Ze.memoizedState=mt=e:mt=mt.next=e,mt}function br(){if(ft===null){var e=Ze.alternate;e=e!==null?e.memoizedState:null}else e=ft.next;var t=mt===null?Ze.memoizedState:mt.next;if(t!==null)mt=t,ft=e;else{if(e===null)throw Error(ie(310));ft=e,e={memoizedState:ft.memoizedState,baseState:ft.baseState,baseQueue:ft.baseQueue,queue:ft.queue,next:null},mt===null?Ze.memoizedState=mt=e:mt=mt.next=e}return mt}function yi(e,t){return typeof t=="function"?t(e):t}function xc(e){var t=br(),r=t.queue;if(r===null)throw Error(ie(311));r.lastRenderedReducer=e;var n=ft,a=n.baseQueue,i=r.pending;if(i!==null){if(a!==null){var l=a.next;a.next=i.next,i.next=l}n.baseQueue=a=i,r.pending=null}if(a!==null){i=a.next,n=n.baseState;var o=l=null,c=null,d=i;do{var u=d.lane;if((hs&u)===u)c!==null&&(c=c.next={lane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),n=d.hasEagerState?d.eagerState:e(n,d.action);else{var f={lane:u,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null};c===null?(o=c=f,l=n):c=c.next=f,Ze.lanes|=u,xs|=u}d=d.next}while(d!==null&&d!==i);c===null?l=n:c.next=o,Ir(n,t.memoizedState)||(Gt=!0),t.memoizedState=n,t.baseState=l,t.baseQueue=c,r.lastRenderedState=n}if(e=r.interleaved,e!==null){a=e;do i=a.lane,Ze.lanes|=i,xs|=i,a=a.next;while(a!==e)}else a===null&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function mc(e){var t=br(),r=t.queue;if(r===null)throw Error(ie(311));r.lastRenderedReducer=e;var n=r.dispatch,a=r.pending,i=t.memoizedState;if(a!==null){r.pending=null;var l=a=a.next;do i=e(i,l.action),l=l.next;while(l!==a);Ir(i,t.memoizedState)||(Gt=!0),t.memoizedState=i,t.baseQueue===null&&(t.baseState=i),r.lastRenderedState=i}return[i,n]}function rm(){}function nm(e,t){var r=Ze,n=br(),a=t(),i=!Ir(n.memoizedState,a);if(i&&(n.memoizedState=a,Gt=!0),n=n.queue,v0(im.bind(null,r,n,e),[e]),n.getSnapshot!==t||i||mt!==null&&mt.memoizedState.tag&1){if(r.flags|=2048,vi(9,am.bind(null,r,n,a,t),void 0,null),vt===null)throw Error(ie(349));hs&30||sm(r,t,a)}return a}function sm(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=Ze.updateQueue,t===null?(t={lastEffect:null,stores:null},Ze.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function am(e,t,r,n){t.value=r,t.getSnapshot=n,lm(t)&&om(e)}function im(e,t,r){return r(function(){lm(t)&&om(e)})}function lm(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!Ir(e,r)}catch{return!0}}function om(e){var t=un(e,1);t!==null&&Or(t,e,1,-1)}function tf(e){var t=Ur();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:yi,lastRenderedState:e},t.queue=e,e=e.dispatch=vv.bind(null,Ze,e),[t.memoizedState,e]}function vi(e,t,r,n){return e={tag:e,create:t,destroy:r,deps:n,next:null},t=Ze.updateQueue,t===null?(t={lastEffect:null,stores:null},Ze.updateQueue=t,t.lastEffect=e.next=e):(r=t.lastEffect,r===null?t.lastEffect=e.next=e:(n=r.next,r.next=e,e.next=n,t.lastEffect=e)),e}function cm(){return br().memoizedState}function Sl(e,t,r,n){var a=Ur();Ze.flags|=e,a.memoizedState=vi(1|t,r,void 0,n===void 0?null:n)}function So(e,t,r,n){var a=br();n=n===void 0?null:n;var i=void 0;if(ft!==null){var l=ft.memoizedState;if(i=l.destroy,n!==null&&p0(n,l.deps)){a.memoizedState=vi(t,r,i,n);return}}Ze.flags|=e,a.memoizedState=vi(1|t,r,i,n)}function rf(e,t){return Sl(8390656,8,e,t)}function v0(e,t){return So(2048,8,e,t)}function um(e,t){return So(4,2,e,t)}function dm(e,t){return So(4,4,e,t)}function fm(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function hm(e,t,r){return r=r!=null?r.concat([e]):null,So(4,4,fm.bind(null,t,e),r)}function w0(){}function xm(e,t){var r=br();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&p0(t,n[1])?n[0]:(r.memoizedState=[e,t],e)}function mm(e,t){var r=br();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&p0(t,n[1])?n[0]:(e=e(),r.memoizedState=[e,t],e)}function pm(e,t,r){return hs&21?(Ir(r,t)||(r=bx(),Ze.lanes|=r,xs|=r,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,Gt=!0),e.memoizedState=r)}function gv(e,t){var r=Me;Me=r!==0&&4>r?r:4,e(!0);var n=hc.transition;hc.transition={};try{e(!1),t()}finally{Me=r,hc.transition=n}}function gm(){return br().memoizedState}function yv(e,t,r){var n=Mn(e);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},ym(e))vm(t,r);else if(r=Zx(e,t,r,n),r!==null){var a=Ut();Or(r,e,n,a),wm(r,t,n)}}function vv(e,t,r){var n=Mn(e),a={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(ym(e))vm(t,a);else{var i=e.alternate;if(e.lanes===0&&(i===null||i.lanes===0)&&(i=t.lastRenderedReducer,i!==null))try{var l=t.lastRenderedState,o=i(l,r);if(a.hasEagerState=!0,a.eagerState=o,Ir(o,l)){var c=t.interleaved;c===null?(a.next=a,d0(t)):(a.next=c.next,c.next=a),t.interleaved=a;return}}catch{}finally{}r=Zx(e,t,a,n),r!==null&&(a=Ut(),Or(r,e,n,a),wm(r,t,n))}}function ym(e){var t=e.alternate;return e===Ze||t!==null&&t===Ze}function vm(e,t){Ka=Gl=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function wm(e,t,r){if(r&4194240){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,qu(e,r)}}var Xl={readContext:wr,useCallback:Ft,useContext:Ft,useEffect:Ft,useImperativeHandle:Ft,useInsertionEffect:Ft,useLayoutEffect:Ft,useMemo:Ft,useReducer:Ft,useRef:Ft,useState:Ft,useDebugValue:Ft,useDeferredValue:Ft,useTransition:Ft,useMutableSource:Ft,useSyncExternalStore:Ft,useId:Ft,unstable_isNewReconciler:!1},wv={readContext:wr,useCallback:function(e,t){return Ur().memoizedState=[e,t===void 0?null:t],e},useContext:wr,useEffect:rf,useImperativeHandle:function(e,t,r){return r=r!=null?r.concat([e]):null,Sl(4194308,4,fm.bind(null,t,e),r)},useLayoutEffect:function(e,t){return Sl(4194308,4,e,t)},useInsertionEffect:function(e,t){return Sl(4,2,e,t)},useMemo:function(e,t){var r=Ur();return t=t===void 0?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var n=Ur();return t=r!==void 0?r(t):t,n.memoizedState=n.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},n.queue=e,e=e.dispatch=yv.bind(null,Ze,e),[n.memoizedState,e]},useRef:function(e){var t=Ur();return e={current:e},t.memoizedState=e},useState:tf,useDebugValue:w0,useDeferredValue:function(e){return Ur().memoizedState=e},useTransition:function(){var e=tf(!1),t=e[0];return e=gv.bind(null,e[1]),Ur().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var n=Ze,a=Ur();if(Ke){if(r===void 0)throw Error(ie(407));r=r()}else{if(r=t(),vt===null)throw Error(ie(349));hs&30||sm(n,t,r)}a.memoizedState=r;var i={value:r,getSnapshot:t};return a.queue=i,rf(im.bind(null,n,i,e),[e]),n.flags|=2048,vi(9,am.bind(null,n,i,r,t),void 0,null),r},useId:function(){var e=Ur(),t=vt.identifierPrefix;if(Ke){var r=rn,n=tn;r=(n&~(1<<32-Pr(n)-1)).toString(32)+r,t=":"+t+"R"+r,r=gi++,0<r&&(t+="H"+r.toString(32)),t+=":"}else r=pv++,t=":"+t+"r"+r.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},bv={readContext:wr,useCallback:xm,useContext:wr,useEffect:v0,useImperativeHandle:hm,useInsertionEffect:um,useLayoutEffect:dm,useMemo:mm,useReducer:xc,useRef:cm,useState:function(){return xc(yi)},useDebugValue:w0,useDeferredValue:function(e){var t=br();return pm(t,ft.memoizedState,e)},useTransition:function(){var e=xc(yi)[0],t=br().memoizedState;return[e,t]},useMutableSource:rm,useSyncExternalStore:nm,useId:gm,unstable_isNewReconciler:!1},Nv={readContext:wr,useCallback:xm,useContext:wr,useEffect:v0,useImperativeHandle:hm,useInsertionEffect:um,useLayoutEffect:dm,useMemo:mm,useReducer:mc,useRef:cm,useState:function(){return mc(yi)},useDebugValue:w0,useDeferredValue:function(e){var t=br();return ft===null?t.memoizedState=e:pm(t,ft.memoizedState,e)},useTransition:function(){var e=mc(yi)[0],t=br().memoizedState;return[e,t]},useMutableSource:rm,useSyncExternalStore:nm,useId:gm,unstable_isNewReconciler:!1};function Tr(e,t){if(e&&e.defaultProps){t=et({},t),e=e.defaultProps;for(var r in e)t[r]===void 0&&(t[r]=e[r]);return t}return t}function uu(e,t,r,n){t=e.memoizedState,r=r(n,t),r=r==null?t:et({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var _o={isMounted:function(e){return(e=e._reactInternals)?ws(e)===e:!1},enqueueSetState:function(e,t,r){e=e._reactInternals;var n=Ut(),a=Mn(e),i=nn(n,a);i.payload=t,r!=null&&(i.callback=r),t=Dn(e,i,a),t!==null&&(Or(t,e,a,n),Nl(t,e,a))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var n=Ut(),a=Mn(e),i=nn(n,a);i.tag=1,i.payload=t,r!=null&&(i.callback=r),t=Dn(e,i,a),t!==null&&(Or(t,e,a,n),Nl(t,e,a))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=Ut(),n=Mn(e),a=nn(r,n);a.tag=2,t!=null&&(a.callback=t),t=Dn(e,a,n),t!==null&&(Or(t,e,n,r),Nl(t,e,n))}};function nf(e,t,r,n,a,i,l){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(n,i,l):t.prototype&&t.prototype.isPureReactComponent?!di(r,n)||!di(a,i):!0}function bm(e,t,r){var n=!1,a=$n,i=t.contextType;return typeof i=="object"&&i!==null?i=wr(i):(a=Kt(t)?ds:Dt.current,n=t.contextTypes,i=(n=n!=null)?aa(e,a):$n),t=new t(r,i),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=_o,e.stateNode=t,t._reactInternals=e,n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=a,e.__reactInternalMemoizedMaskedChildContext=i),t}function sf(e,t,r,n){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,n),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,n),t.state!==e&&_o.enqueueReplaceState(t,t.state,null)}function du(e,t,r,n){var a=e.stateNode;a.props=r,a.state=e.memoizedState,a.refs={},f0(e);var i=t.contextType;typeof i=="object"&&i!==null?a.context=wr(i):(i=Kt(t)?ds:Dt.current,a.context=aa(e,i)),a.state=e.memoizedState,i=t.getDerivedStateFromProps,typeof i=="function"&&(uu(e,t,i,r),a.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof a.getSnapshotBeforeUpdate=="function"||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(t=a.state,typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount(),t!==a.state&&_o.enqueueReplaceState(a,a.state,null),Hl(e,r,a,n),a.state=e.memoizedState),typeof a.componentDidMount=="function"&&(e.flags|=4194308)}function ca(e,t){try{var r="",n=t;do r+=J1(n),n=n.return;while(n);var a=r}catch(i){a=`
Error generating stack: `+i.message+`
`+i.stack}return{value:e,source:t,stack:a,digest:null}}function pc(e,t,r){return{value:e,source:null,stack:r??null,digest:t??null}}function fu(e,t){try{console.error(t.value)}catch(r){setTimeout(function(){throw r})}}var jv=typeof WeakMap=="function"?WeakMap:Map;function Nm(e,t,r){r=nn(-1,r),r.tag=3,r.payload={element:null};var n=t.value;return r.callback=function(){Yl||(Yl=!0,Nu=n),fu(e,t)},r}function jm(e,t,r){r=nn(-1,r),r.tag=3;var n=e.type.getDerivedStateFromError;if(typeof n=="function"){var a=t.value;r.payload=function(){return n(a)},r.callback=function(){fu(e,t)}}var i=e.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(r.callback=function(){fu(e,t),typeof n!="function"&&(Ln===null?Ln=new Set([this]):Ln.add(this));var l=t.stack;this.componentDidCatch(t.value,{componentStack:l!==null?l:""})}),r}function af(e,t,r){var n=e.pingCache;if(n===null){n=e.pingCache=new jv;var a=new Set;n.set(t,a)}else a=n.get(t),a===void 0&&(a=new Set,n.set(t,a));a.has(r)||(a.add(r),e=Lv.bind(null,e,t,r),t.then(e,e))}function lf(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function of(e,t,r,n,a){return e.mode&1?(e.flags|=65536,e.lanes=a,e):(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(t=nn(-1,1),t.tag=2,Dn(r,t,1))),r.lanes|=1),e)}var Sv=xn.ReactCurrentOwner,Gt=!1;function Lt(e,t,r,n){t.child=e===null?Qx(t,null,r,n):la(t,e.child,r,n)}function cf(e,t,r,n,a){r=r.render;var i=t.ref;return Js(t,a),n=g0(e,t,r,n,i,a),r=y0(),e!==null&&!Gt?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,dn(e,t,a)):(Ke&&r&&a0(t),t.flags|=1,Lt(e,t,n,a),t.child)}function uf(e,t,r,n,a){if(e===null){var i=r.type;return typeof i=="function"&&!k0(i)&&i.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(t.tag=15,t.type=i,Sm(e,t,i,n,a)):(e=kl(r.type,null,n,t,t.mode,a),e.ref=t.ref,e.return=t,t.child=e)}if(i=e.child,!(e.lanes&a)){var l=i.memoizedProps;if(r=r.compare,r=r!==null?r:di,r(l,n)&&e.ref===t.ref)return dn(e,t,a)}return t.flags|=1,e=Bn(i,n),e.ref=t.ref,e.return=t,t.child=e}function Sm(e,t,r,n,a){if(e!==null){var i=e.memoizedProps;if(di(i,n)&&e.ref===t.ref)if(Gt=!1,t.pendingProps=n=i,(e.lanes&a)!==0)e.flags&131072&&(Gt=!0);else return t.lanes=e.lanes,dn(e,t,a)}return hu(e,t,r,n,a)}function _m(e,t,r){var n=t.pendingProps,a=n.children,i=e!==null?e.memoizedState:null;if(n.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},$e(Ws,tr),tr|=r;else{if(!(r&1073741824))return e=i!==null?i.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,$e(Ws,tr),tr|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=i!==null?i.baseLanes:r,$e(Ws,tr),tr|=n}else i!==null?(n=i.baseLanes|r,t.memoizedState=null):n=r,$e(Ws,tr),tr|=n;return Lt(e,t,a,r),t.child}function Em(e,t){var r=t.ref;(e===null&&r!==null||e!==null&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function hu(e,t,r,n,a){var i=Kt(r)?ds:Dt.current;return i=aa(t,i),Js(t,a),r=g0(e,t,r,n,i,a),n=y0(),e!==null&&!Gt?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,dn(e,t,a)):(Ke&&n&&a0(t),t.flags|=1,Lt(e,t,r,a),t.child)}function df(e,t,r,n,a){if(Kt(r)){var i=!0;Bl(t)}else i=!1;if(Js(t,a),t.stateNode===null)_l(e,t),bm(t,r,n),du(t,r,n,a),n=!0;else if(e===null){var l=t.stateNode,o=t.memoizedProps;l.props=o;var c=l.context,d=r.contextType;typeof d=="object"&&d!==null?d=wr(d):(d=Kt(r)?ds:Dt.current,d=aa(t,d));var u=r.getDerivedStateFromProps,f=typeof u=="function"||typeof l.getSnapshotBeforeUpdate=="function";f||typeof l.UNSAFE_componentWillReceiveProps!="function"&&typeof l.componentWillReceiveProps!="function"||(o!==n||c!==d)&&sf(t,l,n,d),Sn=!1;var h=t.memoizedState;l.state=h,Hl(t,n,l,a),c=t.memoizedState,o!==n||h!==c||Xt.current||Sn?(typeof u=="function"&&(uu(t,r,u,n),c=t.memoizedState),(o=Sn||nf(t,r,o,n,h,c,d))?(f||typeof l.UNSAFE_componentWillMount!="function"&&typeof l.componentWillMount!="function"||(typeof l.componentWillMount=="function"&&l.componentWillMount(),typeof l.UNSAFE_componentWillMount=="function"&&l.UNSAFE_componentWillMount()),typeof l.componentDidMount=="function"&&(t.flags|=4194308)):(typeof l.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=c),l.props=n,l.state=c,l.context=d,n=o):(typeof l.componentDidMount=="function"&&(t.flags|=4194308),n=!1)}else{l=t.stateNode,em(e,t),o=t.memoizedProps,d=t.type===t.elementType?o:Tr(t.type,o),l.props=d,f=t.pendingProps,h=l.context,c=r.contextType,typeof c=="object"&&c!==null?c=wr(c):(c=Kt(r)?ds:Dt.current,c=aa(t,c));var m=r.getDerivedStateFromProps;(u=typeof m=="function"||typeof l.getSnapshotBeforeUpdate=="function")||typeof l.UNSAFE_componentWillReceiveProps!="function"&&typeof l.componentWillReceiveProps!="function"||(o!==f||h!==c)&&sf(t,l,n,c),Sn=!1,h=t.memoizedState,l.state=h,Hl(t,n,l,a);var v=t.memoizedState;o!==f||h!==v||Xt.current||Sn?(typeof m=="function"&&(uu(t,r,m,n),v=t.memoizedState),(d=Sn||nf(t,r,d,n,h,v,c)||!1)?(u||typeof l.UNSAFE_componentWillUpdate!="function"&&typeof l.componentWillUpdate!="function"||(typeof l.componentWillUpdate=="function"&&l.componentWillUpdate(n,v,c),typeof l.UNSAFE_componentWillUpdate=="function"&&l.UNSAFE_componentWillUpdate(n,v,c)),typeof l.componentDidUpdate=="function"&&(t.flags|=4),typeof l.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof l.componentDidUpdate!="function"||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),typeof l.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=v),l.props=n,l.state=v,l.context=c,n=d):(typeof l.componentDidUpdate!="function"||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),typeof l.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),n=!1)}return xu(e,t,r,n,i,a)}function xu(e,t,r,n,a,i){Em(e,t);var l=(t.flags&128)!==0;if(!n&&!l)return a&&Yd(t,r,!1),dn(e,t,i);n=t.stateNode,Sv.current=t;var o=l&&typeof r.getDerivedStateFromError!="function"?null:n.render();return t.flags|=1,e!==null&&l?(t.child=la(t,e.child,null,i),t.child=la(t,null,o,i)):Lt(e,t,o,i),t.memoizedState=n.state,a&&Yd(t,r,!0),t.child}function Tm(e){var t=e.stateNode;t.pendingContext?Kd(e,t.pendingContext,t.pendingContext!==t.context):t.context&&Kd(e,t.context,!1),h0(e,t.containerInfo)}function ff(e,t,r,n,a){return ia(),l0(a),t.flags|=256,Lt(e,t,r,n),t.child}var mu={dehydrated:null,treeContext:null,retryLane:0};function pu(e){return{baseLanes:e,cachePool:null,transitions:null}}function km(e,t,r){var n=t.pendingProps,a=qe.current,i=!1,l=(t.flags&128)!==0,o;if((o=l)||(o=e!==null&&e.memoizedState===null?!1:(a&2)!==0),o?(i=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(a|=1),$e(qe,a&1),e===null)return ou(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(l=n.children,e=n.fallback,i?(n=t.mode,i=t.child,l={mode:"hidden",children:l},!(n&1)&&i!==null?(i.childLanes=0,i.pendingProps=l):i=ko(l,n,0,null),e=cs(e,n,r,null),i.return=t,e.return=t,i.sibling=e,t.child=i,t.child.memoizedState=pu(r),t.memoizedState=mu,e):b0(t,l));if(a=e.memoizedState,a!==null&&(o=a.dehydrated,o!==null))return _v(e,t,l,n,o,a,r);if(i){i=n.fallback,l=t.mode,a=e.child,o=a.sibling;var c={mode:"hidden",children:n.children};return!(l&1)&&t.child!==a?(n=t.child,n.childLanes=0,n.pendingProps=c,t.deletions=null):(n=Bn(a,c),n.subtreeFlags=a.subtreeFlags&14680064),o!==null?i=Bn(o,i):(i=cs(i,l,r,null),i.flags|=2),i.return=t,n.return=t,n.sibling=i,t.child=n,n=i,i=t.child,l=e.child.memoizedState,l=l===null?pu(r):{baseLanes:l.baseLanes|r,cachePool:null,transitions:l.transitions},i.memoizedState=l,i.childLanes=e.childLanes&~r,t.memoizedState=mu,n}return i=e.child,e=i.sibling,n=Bn(i,{mode:"visible",children:n.children}),!(t.mode&1)&&(n.lanes=r),n.return=t,n.sibling=null,e!==null&&(r=t.deletions,r===null?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=n,t.memoizedState=null,n}function b0(e,t){return t=ko({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function al(e,t,r,n){return n!==null&&l0(n),la(t,e.child,null,r),e=b0(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function _v(e,t,r,n,a,i,l){if(r)return t.flags&256?(t.flags&=-257,n=pc(Error(ie(422))),al(e,t,l,n)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(i=n.fallback,a=t.mode,n=ko({mode:"visible",children:n.children},a,0,null),i=cs(i,a,l,null),i.flags|=2,n.return=t,i.return=t,n.sibling=i,t.child=n,t.mode&1&&la(t,e.child,null,l),t.child.memoizedState=pu(l),t.memoizedState=mu,i);if(!(t.mode&1))return al(e,t,l,null);if(a.data==="$!"){if(n=a.nextSibling&&a.nextSibling.dataset,n)var o=n.dgst;return n=o,i=Error(ie(419)),n=pc(i,n,void 0),al(e,t,l,n)}if(o=(l&e.childLanes)!==0,Gt||o){if(n=vt,n!==null){switch(l&-l){case 4:a=2;break;case 16:a=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:a=32;break;case 536870912:a=268435456;break;default:a=0}a=a&(n.suspendedLanes|l)?0:a,a!==0&&a!==i.retryLane&&(i.retryLane=a,un(e,a),Or(n,e,a,-1))}return T0(),n=pc(Error(ie(421))),al(e,t,l,n)}return a.data==="$?"?(t.flags|=128,t.child=e.child,t=Mv.bind(null,e),a._reactRetry=t,null):(e=i.treeContext,ar=In(a.nextSibling),ir=t,Ke=!0,Cr=null,e!==null&&(xr[mr++]=tn,xr[mr++]=rn,xr[mr++]=fs,tn=e.id,rn=e.overflow,fs=t),t=b0(t,n.children),t.flags|=4096,t)}function hf(e,t,r){e.lanes|=t;var n=e.alternate;n!==null&&(n.lanes|=t),cu(e.return,t,r)}function gc(e,t,r,n,a){var i=e.memoizedState;i===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:a}:(i.isBackwards=t,i.rendering=null,i.renderingStartTime=0,i.last=n,i.tail=r,i.tailMode=a)}function Cm(e,t,r){var n=t.pendingProps,a=n.revealOrder,i=n.tail;if(Lt(e,t,n.children,r),n=qe.current,n&2)n=n&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&hf(e,r,t);else if(e.tag===19)hf(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if($e(qe,n),!(t.mode&1))t.memoizedState=null;else switch(a){case"forwards":for(r=t.child,a=null;r!==null;)e=r.alternate,e!==null&&Vl(e)===null&&(a=r),r=r.sibling;r=a,r===null?(a=t.child,t.child=null):(a=r.sibling,r.sibling=null),gc(t,!1,a,r,i);break;case"backwards":for(r=null,a=t.child,t.child=null;a!==null;){if(e=a.alternate,e!==null&&Vl(e)===null){t.child=a;break}e=a.sibling,a.sibling=r,r=a,a=e}gc(t,!0,r,null,i);break;case"together":gc(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function _l(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function dn(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),xs|=t.lanes,!(r&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(ie(153));if(t.child!==null){for(e=t.child,r=Bn(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=Bn(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function Ev(e,t,r){switch(t.tag){case 3:Tm(t),ia();break;case 5:tm(t);break;case 1:Kt(t.type)&&Bl(t);break;case 4:h0(t,t.stateNode.containerInfo);break;case 10:var n=t.type._context,a=t.memoizedProps.value;$e($l,n._currentValue),n._currentValue=a;break;case 13:if(n=t.memoizedState,n!==null)return n.dehydrated!==null?($e(qe,qe.current&1),t.flags|=128,null):r&t.child.childLanes?km(e,t,r):($e(qe,qe.current&1),e=dn(e,t,r),e!==null?e.sibling:null);$e(qe,qe.current&1);break;case 19:if(n=(r&t.childLanes)!==0,e.flags&128){if(n)return Cm(e,t,r);t.flags|=128}if(a=t.memoizedState,a!==null&&(a.rendering=null,a.tail=null,a.lastEffect=null),$e(qe,qe.current),n)break;return null;case 22:case 23:return t.lanes=0,_m(e,t,r)}return dn(e,t,r)}var Am,gu,Fm,Pm;Am=function(e,t){for(var r=t.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};gu=function(){};Fm=function(e,t,r,n){var a=e.memoizedProps;if(a!==n){e=t.stateNode,ls(Hr.current);var i=null;switch(r){case"input":a=Bc(e,a),n=Bc(e,n),i=[];break;case"select":a=et({},a,{value:void 0}),n=et({},n,{value:void 0}),i=[];break;case"textarea":a=$c(e,a),n=$c(e,n),i=[];break;default:typeof a.onClick!="function"&&typeof n.onClick=="function"&&(e.onclick=Ll)}Hc(r,n);var l;r=null;for(d in a)if(!n.hasOwnProperty(d)&&a.hasOwnProperty(d)&&a[d]!=null)if(d==="style"){var o=a[d];for(l in o)o.hasOwnProperty(l)&&(r||(r={}),r[l]="")}else d!=="dangerouslySetInnerHTML"&&d!=="children"&&d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&d!=="autoFocus"&&(si.hasOwnProperty(d)?i||(i=[]):(i=i||[]).push(d,null));for(d in n){var c=n[d];if(o=a!=null?a[d]:void 0,n.hasOwnProperty(d)&&c!==o&&(c!=null||o!=null))if(d==="style")if(o){for(l in o)!o.hasOwnProperty(l)||c&&c.hasOwnProperty(l)||(r||(r={}),r[l]="");for(l in c)c.hasOwnProperty(l)&&o[l]!==c[l]&&(r||(r={}),r[l]=c[l])}else r||(i||(i=[]),i.push(d,r)),r=c;else d==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,o=o?o.__html:void 0,c!=null&&o!==c&&(i=i||[]).push(d,c)):d==="children"?typeof c!="string"&&typeof c!="number"||(i=i||[]).push(d,""+c):d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&(si.hasOwnProperty(d)?(c!=null&&d==="onScroll"&&He("scroll",e),i||o===c||(i=[])):(i=i||[]).push(d,c))}r&&(i=i||[]).push("style",r);var d=i;(t.updateQueue=d)&&(t.flags|=4)}};Pm=function(e,t,r,n){r!==n&&(t.flags|=4)};function Pa(e,t){if(!Ke)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:n.sibling=null}}function Pt(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,n=0;if(t)for(var a=e.child;a!==null;)r|=a.lanes|a.childLanes,n|=a.subtreeFlags&14680064,n|=a.flags&14680064,a.return=e,a=a.sibling;else for(a=e.child;a!==null;)r|=a.lanes|a.childLanes,n|=a.subtreeFlags,n|=a.flags,a.return=e,a=a.sibling;return e.subtreeFlags|=n,e.childLanes=r,t}function Tv(e,t,r){var n=t.pendingProps;switch(i0(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Pt(t),null;case 1:return Kt(t.type)&&Ml(),Pt(t),null;case 3:return n=t.stateNode,oa(),Ge(Xt),Ge(Dt),m0(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(e===null||e.child===null)&&(nl(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,Cr!==null&&(_u(Cr),Cr=null))),gu(e,t),Pt(t),null;case 5:x0(t);var a=ls(pi.current);if(r=t.type,e!==null&&t.stateNode!=null)Fm(e,t,r,n,a),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!n){if(t.stateNode===null)throw Error(ie(166));return Pt(t),null}if(e=ls(Hr.current),nl(t)){n=t.stateNode,r=t.type;var i=t.memoizedProps;switch(n[zr]=t,n[xi]=i,e=(t.mode&1)!==0,r){case"dialog":He("cancel",n),He("close",n);break;case"iframe":case"object":case"embed":He("load",n);break;case"video":case"audio":for(a=0;a<Ua.length;a++)He(Ua[a],n);break;case"source":He("error",n);break;case"img":case"image":case"link":He("error",n),He("load",n);break;case"details":He("toggle",n);break;case"input":bd(n,i),He("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!i.multiple},He("invalid",n);break;case"textarea":jd(n,i),He("invalid",n)}Hc(r,i),a=null;for(var l in i)if(i.hasOwnProperty(l)){var o=i[l];l==="children"?typeof o=="string"?n.textContent!==o&&(i.suppressHydrationWarning!==!0&&rl(n.textContent,o,e),a=["children",o]):typeof o=="number"&&n.textContent!==""+o&&(i.suppressHydrationWarning!==!0&&rl(n.textContent,o,e),a=["children",""+o]):si.hasOwnProperty(l)&&o!=null&&l==="onScroll"&&He("scroll",n)}switch(r){case"input":Ki(n),Nd(n,i,!0);break;case"textarea":Ki(n),Sd(n);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(n.onclick=Ll)}n=a,t.updateQueue=n,n!==null&&(t.flags|=4)}else{l=a.nodeType===9?a:a.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=ix(r)),e==="http://www.w3.org/1999/xhtml"?r==="script"?(e=l.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof n.is=="string"?e=l.createElement(r,{is:n.is}):(e=l.createElement(r),r==="select"&&(l=e,n.multiple?l.multiple=!0:n.size&&(l.size=n.size))):e=l.createElementNS(e,r),e[zr]=t,e[xi]=n,Am(e,t,!1,!1),t.stateNode=e;e:{switch(l=Vc(r,n),r){case"dialog":He("cancel",e),He("close",e),a=n;break;case"iframe":case"object":case"embed":He("load",e),a=n;break;case"video":case"audio":for(a=0;a<Ua.length;a++)He(Ua[a],e);a=n;break;case"source":He("error",e),a=n;break;case"img":case"image":case"link":He("error",e),He("load",e),a=n;break;case"details":He("toggle",e),a=n;break;case"input":bd(e,n),a=Bc(e,n),He("invalid",e);break;case"option":a=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},a=et({},n,{value:void 0}),He("invalid",e);break;case"textarea":jd(e,n),a=$c(e,n),He("invalid",e);break;default:a=n}Hc(r,a),o=a;for(i in o)if(o.hasOwnProperty(i)){var c=o[i];i==="style"?cx(e,c):i==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&lx(e,c)):i==="children"?typeof c=="string"?(r!=="textarea"||c!=="")&&ai(e,c):typeof c=="number"&&ai(e,""+c):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(si.hasOwnProperty(i)?c!=null&&i==="onScroll"&&He("scroll",e):c!=null&&Vu(e,i,c,l))}switch(r){case"input":Ki(e),Nd(e,n,!1);break;case"textarea":Ki(e),Sd(e);break;case"option":n.value!=null&&e.setAttribute("value",""+zn(n.value));break;case"select":e.multiple=!!n.multiple,i=n.value,i!=null?Gs(e,!!n.multiple,i,!1):n.defaultValue!=null&&Gs(e,!!n.multiple,n.defaultValue,!0);break;default:typeof a.onClick=="function"&&(e.onclick=Ll)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return Pt(t),null;case 6:if(e&&t.stateNode!=null)Pm(e,t,e.memoizedProps,n);else{if(typeof n!="string"&&t.stateNode===null)throw Error(ie(166));if(r=ls(pi.current),ls(Hr.current),nl(t)){if(n=t.stateNode,r=t.memoizedProps,n[zr]=t,(i=n.nodeValue!==r)&&(e=ir,e!==null))switch(e.tag){case 3:rl(n.nodeValue,r,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&rl(n.nodeValue,r,(e.mode&1)!==0)}i&&(t.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[zr]=t,t.stateNode=n}return Pt(t),null;case 13:if(Ge(qe),n=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(Ke&&ar!==null&&t.mode&1&&!(t.flags&128))Jx(),ia(),t.flags|=98560,i=!1;else if(i=nl(t),n!==null&&n.dehydrated!==null){if(e===null){if(!i)throw Error(ie(318));if(i=t.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(ie(317));i[zr]=t}else ia(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;Pt(t),i=!1}else Cr!==null&&(_u(Cr),Cr=null),i=!0;if(!i)return t.flags&65536?t:null}return t.flags&128?(t.lanes=r,t):(n=n!==null,n!==(e!==null&&e.memoizedState!==null)&&n&&(t.child.flags|=8192,t.mode&1&&(e===null||qe.current&1?ht===0&&(ht=3):T0())),t.updateQueue!==null&&(t.flags|=4),Pt(t),null);case 4:return oa(),gu(e,t),e===null&&fi(t.stateNode.containerInfo),Pt(t),null;case 10:return u0(t.type._context),Pt(t),null;case 17:return Kt(t.type)&&Ml(),Pt(t),null;case 19:if(Ge(qe),i=t.memoizedState,i===null)return Pt(t),null;if(n=(t.flags&128)!==0,l=i.rendering,l===null)if(n)Pa(i,!1);else{if(ht!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(l=Vl(e),l!==null){for(t.flags|=128,Pa(i,!1),n=l.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),t.subtreeFlags=0,n=r,r=t.child;r!==null;)i=r,e=n,i.flags&=14680066,l=i.alternate,l===null?(i.childLanes=0,i.lanes=e,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=l.childLanes,i.lanes=l.lanes,i.child=l.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=l.memoizedProps,i.memoizedState=l.memoizedState,i.updateQueue=l.updateQueue,i.type=l.type,e=l.dependencies,i.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return $e(qe,qe.current&1|2),t.child}e=e.sibling}i.tail!==null&&st()>ua&&(t.flags|=128,n=!0,Pa(i,!1),t.lanes=4194304)}else{if(!n)if(e=Vl(l),e!==null){if(t.flags|=128,n=!0,r=e.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),Pa(i,!0),i.tail===null&&i.tailMode==="hidden"&&!l.alternate&&!Ke)return Pt(t),null}else 2*st()-i.renderingStartTime>ua&&r!==1073741824&&(t.flags|=128,n=!0,Pa(i,!1),t.lanes=4194304);i.isBackwards?(l.sibling=t.child,t.child=l):(r=i.last,r!==null?r.sibling=l:t.child=l,i.last=l)}return i.tail!==null?(t=i.tail,i.rendering=t,i.tail=t.sibling,i.renderingStartTime=st(),t.sibling=null,r=qe.current,$e(qe,n?r&1|2:r&1),t):(Pt(t),null);case 22:case 23:return E0(),n=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==n&&(t.flags|=8192),n&&t.mode&1?tr&1073741824&&(Pt(t),t.subtreeFlags&6&&(t.flags|=8192)):Pt(t),null;case 24:return null;case 25:return null}throw Error(ie(156,t.tag))}function kv(e,t){switch(i0(t),t.tag){case 1:return Kt(t.type)&&Ml(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return oa(),Ge(Xt),Ge(Dt),m0(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return x0(t),null;case 13:if(Ge(qe),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(ie(340));ia()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return Ge(qe),null;case 4:return oa(),null;case 10:return u0(t.type._context),null;case 22:case 23:return E0(),null;case 24:return null;default:return null}}var il=!1,Ot=!1,Cv=typeof WeakSet=="function"?WeakSet:Set,ye=null;function $s(e,t){var r=e.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){tt(e,t,n)}else r.current=null}function yu(e,t,r){try{r()}catch(n){tt(e,t,n)}}var xf=!1;function Av(e,t){if(tu=Rl,e=Lx(),s0(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var a=n.anchorOffset,i=n.focusNode;n=n.focusOffset;try{r.nodeType,i.nodeType}catch{r=null;break e}var l=0,o=-1,c=-1,d=0,u=0,f=e,h=null;t:for(;;){for(var m;f!==r||a!==0&&f.nodeType!==3||(o=l+a),f!==i||n!==0&&f.nodeType!==3||(c=l+n),f.nodeType===3&&(l+=f.nodeValue.length),(m=f.firstChild)!==null;)h=f,f=m;for(;;){if(f===e)break t;if(h===r&&++d===a&&(o=l),h===i&&++u===n&&(c=l),(m=f.nextSibling)!==null)break;f=h,h=f.parentNode}f=m}r=o===-1||c===-1?null:{start:o,end:c}}else r=null}r=r||{start:0,end:0}}else r=null;for(ru={focusedElem:e,selectionRange:r},Rl=!1,ye=t;ye!==null;)if(t=ye,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,ye=e;else for(;ye!==null;){t=ye;try{var v=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(v!==null){var x=v.memoizedProps,y=v.memoizedState,p=t.stateNode,g=p.getSnapshotBeforeUpdate(t.elementType===t.type?x:Tr(t.type,x),y);p.__reactInternalSnapshotBeforeUpdate=g}break;case 3:var w=t.stateNode.containerInfo;w.nodeType===1?w.textContent="":w.nodeType===9&&w.documentElement&&w.removeChild(w.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(ie(163))}}catch(b){tt(t,t.return,b)}if(e=t.sibling,e!==null){e.return=t.return,ye=e;break}ye=t.return}return v=xf,xf=!1,v}function Ya(e,t,r){var n=t.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var a=n=n.next;do{if((a.tag&e)===e){var i=a.destroy;a.destroy=void 0,i!==void 0&&yu(t,r,i)}a=a.next}while(a!==n)}}function Eo(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var r=t=t.next;do{if((r.tag&e)===e){var n=r.create;r.destroy=n()}r=r.next}while(r!==t)}}function vu(e){var t=e.ref;if(t!==null){var r=e.stateNode;switch(e.tag){case 5:e=r;break;default:e=r}typeof t=="function"?t(e):t.current=e}}function Om(e){var t=e.alternate;t!==null&&(e.alternate=null,Om(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[zr],delete t[xi],delete t[au],delete t[fv],delete t[hv])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function Rm(e){return e.tag===5||e.tag===3||e.tag===4}function mf(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||Rm(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function wu(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.nodeType===8?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(r.nodeType===8?(t=r.parentNode,t.insertBefore(e,r)):(t=r,t.appendChild(e)),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=Ll));else if(n!==4&&(e=e.child,e!==null))for(wu(e,t,r),e=e.sibling;e!==null;)wu(e,t,r),e=e.sibling}function bu(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(n!==4&&(e=e.child,e!==null))for(bu(e,t,r),e=e.sibling;e!==null;)bu(e,t,r),e=e.sibling}var Nt=null,kr=!1;function vn(e,t,r){for(r=r.child;r!==null;)Im(e,t,r),r=r.sibling}function Im(e,t,r){if(Wr&&typeof Wr.onCommitFiberUnmount=="function")try{Wr.onCommitFiberUnmount(yo,r)}catch{}switch(r.tag){case 5:Ot||$s(r,t);case 6:var n=Nt,a=kr;Nt=null,vn(e,t,r),Nt=n,kr=a,Nt!==null&&(kr?(e=Nt,r=r.stateNode,e.nodeType===8?e.parentNode.removeChild(r):e.removeChild(r)):Nt.removeChild(r.stateNode));break;case 18:Nt!==null&&(kr?(e=Nt,r=r.stateNode,e.nodeType===8?uc(e.parentNode,r):e.nodeType===1&&uc(e,r),ci(e)):uc(Nt,r.stateNode));break;case 4:n=Nt,a=kr,Nt=r.stateNode.containerInfo,kr=!0,vn(e,t,r),Nt=n,kr=a;break;case 0:case 11:case 14:case 15:if(!Ot&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){a=n=n.next;do{var i=a,l=i.destroy;i=i.tag,l!==void 0&&(i&2||i&4)&&yu(r,t,l),a=a.next}while(a!==n)}vn(e,t,r);break;case 1:if(!Ot&&($s(r,t),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(o){tt(r,t,o)}vn(e,t,r);break;case 21:vn(e,t,r);break;case 22:r.mode&1?(Ot=(n=Ot)||r.memoizedState!==null,vn(e,t,r),Ot=n):vn(e,t,r);break;default:vn(e,t,r)}}function pf(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var r=e.stateNode;r===null&&(r=e.stateNode=new Cv),t.forEach(function(n){var a=Bv.bind(null,e,n);r.has(n)||(r.add(n),n.then(a,a))})}}function Sr(e,t){var r=t.deletions;if(r!==null)for(var n=0;n<r.length;n++){var a=r[n];try{var i=e,l=t,o=l;e:for(;o!==null;){switch(o.tag){case 5:Nt=o.stateNode,kr=!1;break e;case 3:Nt=o.stateNode.containerInfo,kr=!0;break e;case 4:Nt=o.stateNode.containerInfo,kr=!0;break e}o=o.return}if(Nt===null)throw Error(ie(160));Im(i,l,a),Nt=null,kr=!1;var c=a.alternate;c!==null&&(c.return=null),a.return=null}catch(d){tt(a,t,d)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)Dm(t,e),t=t.sibling}function Dm(e,t){var r=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(Sr(t,e),Lr(e),n&4){try{Ya(3,e,e.return),Eo(3,e)}catch(x){tt(e,e.return,x)}try{Ya(5,e,e.return)}catch(x){tt(e,e.return,x)}}break;case 1:Sr(t,e),Lr(e),n&512&&r!==null&&$s(r,r.return);break;case 5:if(Sr(t,e),Lr(e),n&512&&r!==null&&$s(r,r.return),e.flags&32){var a=e.stateNode;try{ai(a,"")}catch(x){tt(e,e.return,x)}}if(n&4&&(a=e.stateNode,a!=null)){var i=e.memoizedProps,l=r!==null?r.memoizedProps:i,o=e.type,c=e.updateQueue;if(e.updateQueue=null,c!==null)try{o==="input"&&i.type==="radio"&&i.name!=null&&sx(a,i),Vc(o,l);var d=Vc(o,i);for(l=0;l<c.length;l+=2){var u=c[l],f=c[l+1];u==="style"?cx(a,f):u==="dangerouslySetInnerHTML"?lx(a,f):u==="children"?ai(a,f):Vu(a,u,f,d)}switch(o){case"input":Uc(a,i);break;case"textarea":ax(a,i);break;case"select":var h=a._wrapperState.wasMultiple;a._wrapperState.wasMultiple=!!i.multiple;var m=i.value;m!=null?Gs(a,!!i.multiple,m,!1):h!==!!i.multiple&&(i.defaultValue!=null?Gs(a,!!i.multiple,i.defaultValue,!0):Gs(a,!!i.multiple,i.multiple?[]:"",!1))}a[xi]=i}catch(x){tt(e,e.return,x)}}break;case 6:if(Sr(t,e),Lr(e),n&4){if(e.stateNode===null)throw Error(ie(162));a=e.stateNode,i=e.memoizedProps;try{a.nodeValue=i}catch(x){tt(e,e.return,x)}}break;case 3:if(Sr(t,e),Lr(e),n&4&&r!==null&&r.memoizedState.isDehydrated)try{ci(t.containerInfo)}catch(x){tt(e,e.return,x)}break;case 4:Sr(t,e),Lr(e);break;case 13:Sr(t,e),Lr(e),a=e.child,a.flags&8192&&(i=a.memoizedState!==null,a.stateNode.isHidden=i,!i||a.alternate!==null&&a.alternate.memoizedState!==null||(S0=st())),n&4&&pf(e);break;case 22:if(u=r!==null&&r.memoizedState!==null,e.mode&1?(Ot=(d=Ot)||u,Sr(t,e),Ot=d):Sr(t,e),Lr(e),n&8192){if(d=e.memoizedState!==null,(e.stateNode.isHidden=d)&&!u&&e.mode&1)for(ye=e,u=e.child;u!==null;){for(f=ye=u;ye!==null;){switch(h=ye,m=h.child,h.tag){case 0:case 11:case 14:case 15:Ya(4,h,h.return);break;case 1:$s(h,h.return);var v=h.stateNode;if(typeof v.componentWillUnmount=="function"){n=h,r=h.return;try{t=n,v.props=t.memoizedProps,v.state=t.memoizedState,v.componentWillUnmount()}catch(x){tt(n,r,x)}}break;case 5:$s(h,h.return);break;case 22:if(h.memoizedState!==null){yf(f);continue}}m!==null?(m.return=h,ye=m):yf(f)}u=u.sibling}e:for(u=null,f=e;;){if(f.tag===5){if(u===null){u=f;try{a=f.stateNode,d?(i=a.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(o=f.stateNode,c=f.memoizedProps.style,l=c!=null&&c.hasOwnProperty("display")?c.display:null,o.style.display=ox("display",l))}catch(x){tt(e,e.return,x)}}}else if(f.tag===6){if(u===null)try{f.stateNode.nodeValue=d?"":f.memoizedProps}catch(x){tt(e,e.return,x)}}else if((f.tag!==22&&f.tag!==23||f.memoizedState===null||f===e)&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===e)break e;for(;f.sibling===null;){if(f.return===null||f.return===e)break e;u===f&&(u=null),f=f.return}u===f&&(u=null),f.sibling.return=f.return,f=f.sibling}}break;case 19:Sr(t,e),Lr(e),n&4&&pf(e);break;case 21:break;default:Sr(t,e),Lr(e)}}function Lr(e){var t=e.flags;if(t&2){try{e:{for(var r=e.return;r!==null;){if(Rm(r)){var n=r;break e}r=r.return}throw Error(ie(160))}switch(n.tag){case 5:var a=n.stateNode;n.flags&32&&(ai(a,""),n.flags&=-33);var i=mf(e);bu(e,i,a);break;case 3:case 4:var l=n.stateNode.containerInfo,o=mf(e);wu(e,o,l);break;default:throw Error(ie(161))}}catch(c){tt(e,e.return,c)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function Fv(e,t,r){ye=e,Lm(e)}function Lm(e,t,r){for(var n=(e.mode&1)!==0;ye!==null;){var a=ye,i=a.child;if(a.tag===22&&n){var l=a.memoizedState!==null||il;if(!l){var o=a.alternate,c=o!==null&&o.memoizedState!==null||Ot;o=il;var d=Ot;if(il=l,(Ot=c)&&!d)for(ye=a;ye!==null;)l=ye,c=l.child,l.tag===22&&l.memoizedState!==null?vf(a):c!==null?(c.return=l,ye=c):vf(a);for(;i!==null;)ye=i,Lm(i),i=i.sibling;ye=a,il=o,Ot=d}gf(e)}else a.subtreeFlags&8772&&i!==null?(i.return=a,ye=i):gf(e)}}function gf(e){for(;ye!==null;){var t=ye;if(t.flags&8772){var r=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:Ot||Eo(5,t);break;case 1:var n=t.stateNode;if(t.flags&4&&!Ot)if(r===null)n.componentDidMount();else{var a=t.elementType===t.type?r.memoizedProps:Tr(t.type,r.memoizedProps);n.componentDidUpdate(a,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var i=t.updateQueue;i!==null&&ef(t,i,n);break;case 3:var l=t.updateQueue;if(l!==null){if(r=null,t.child!==null)switch(t.child.tag){case 5:r=t.child.stateNode;break;case 1:r=t.child.stateNode}ef(t,l,r)}break;case 5:var o=t.stateNode;if(r===null&&t.flags&4){r=o;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&r.focus();break;case"img":c.src&&(r.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var d=t.alternate;if(d!==null){var u=d.memoizedState;if(u!==null){var f=u.dehydrated;f!==null&&ci(f)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(ie(163))}Ot||t.flags&512&&vu(t)}catch(h){tt(t,t.return,h)}}if(t===e){ye=null;break}if(r=t.sibling,r!==null){r.return=t.return,ye=r;break}ye=t.return}}function yf(e){for(;ye!==null;){var t=ye;if(t===e){ye=null;break}var r=t.sibling;if(r!==null){r.return=t.return,ye=r;break}ye=t.return}}function vf(e){for(;ye!==null;){var t=ye;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{Eo(4,t)}catch(c){tt(t,r,c)}break;case 1:var n=t.stateNode;if(typeof n.componentDidMount=="function"){var a=t.return;try{n.componentDidMount()}catch(c){tt(t,a,c)}}var i=t.return;try{vu(t)}catch(c){tt(t,i,c)}break;case 5:var l=t.return;try{vu(t)}catch(c){tt(t,l,c)}}}catch(c){tt(t,t.return,c)}if(t===e){ye=null;break}var o=t.sibling;if(o!==null){o.return=t.return,ye=o;break}ye=t.return}}var Pv=Math.ceil,Kl=xn.ReactCurrentDispatcher,N0=xn.ReactCurrentOwner,vr=xn.ReactCurrentBatchConfig,Pe=0,vt=null,lt=null,Et=0,tr=0,Ws=Kn(0),ht=0,wi=null,xs=0,To=0,j0=0,Ja=null,Vt=null,S0=0,ua=1/0,Yr=null,Yl=!1,Nu=null,Ln=null,ll=!1,kn=null,Jl=0,qa=0,ju=null,El=-1,Tl=0;function Ut(){return Pe&6?st():El!==-1?El:El=st()}function Mn(e){return e.mode&1?Pe&2&&Et!==0?Et&-Et:mv.transition!==null?(Tl===0&&(Tl=bx()),Tl):(e=Me,e!==0||(e=window.event,e=e===void 0?16:kx(e.type)),e):1}function Or(e,t,r,n){if(50<qa)throw qa=0,ju=null,Error(ie(185));Pi(e,r,n),(!(Pe&2)||e!==vt)&&(e===vt&&(!(Pe&2)&&(To|=r),ht===4&&En(e,Et)),Yt(e,n),r===1&&Pe===0&&!(t.mode&1)&&(ua=st()+500,jo&&Yn()))}function Yt(e,t){var r=e.callbackNode;my(e,t);var n=Ol(e,e===vt?Et:0);if(n===0)r!==null&&Td(r),e.callbackNode=null,e.callbackPriority=0;else if(t=n&-n,e.callbackPriority!==t){if(r!=null&&Td(r),t===1)e.tag===0?xv(wf.bind(null,e)):Xx(wf.bind(null,e)),uv(function(){!(Pe&6)&&Yn()}),r=null;else{switch(Nx(n)){case 1:r=Ju;break;case 4:r=vx;break;case 16:r=Pl;break;case 536870912:r=wx;break;default:r=Pl}r=Vm(r,Mm.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function Mm(e,t){if(El=-1,Tl=0,Pe&6)throw Error(ie(327));var r=e.callbackNode;if(qs()&&e.callbackNode!==r)return null;var n=Ol(e,e===vt?Et:0);if(n===0)return null;if(n&30||n&e.expiredLanes||t)t=ql(e,n);else{t=n;var a=Pe;Pe|=2;var i=Um();(vt!==e||Et!==t)&&(Yr=null,ua=st()+500,os(e,t));do try{Iv();break}catch(o){Bm(e,o)}while(!0);c0(),Kl.current=i,Pe=a,lt!==null?t=0:(vt=null,Et=0,t=ht)}if(t!==0){if(t===2&&(a=Jc(e),a!==0&&(n=a,t=Su(e,a))),t===1)throw r=wi,os(e,0),En(e,n),Yt(e,st()),r;if(t===6)En(e,n);else{if(a=e.current.alternate,!(n&30)&&!Ov(a)&&(t=ql(e,n),t===2&&(i=Jc(e),i!==0&&(n=i,t=Su(e,i))),t===1))throw r=wi,os(e,0),En(e,n),Yt(e,st()),r;switch(e.finishedWork=a,e.finishedLanes=n,t){case 0:case 1:throw Error(ie(345));case 2:rs(e,Vt,Yr);break;case 3:if(En(e,n),(n&130023424)===n&&(t=S0+500-st(),10<t)){if(Ol(e,0)!==0)break;if(a=e.suspendedLanes,(a&n)!==n){Ut(),e.pingedLanes|=e.suspendedLanes&a;break}e.timeoutHandle=su(rs.bind(null,e,Vt,Yr),t);break}rs(e,Vt,Yr);break;case 4:if(En(e,n),(n&4194240)===n)break;for(t=e.eventTimes,a=-1;0<n;){var l=31-Pr(n);i=1<<l,l=t[l],l>a&&(a=l),n&=~i}if(n=a,n=st()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*Pv(n/1960))-n,10<n){e.timeoutHandle=su(rs.bind(null,e,Vt,Yr),n);break}rs(e,Vt,Yr);break;case 5:rs(e,Vt,Yr);break;default:throw Error(ie(329))}}}return Yt(e,st()),e.callbackNode===r?Mm.bind(null,e):null}function Su(e,t){var r=Ja;return e.current.memoizedState.isDehydrated&&(os(e,t).flags|=256),e=ql(e,t),e!==2&&(t=Vt,Vt=r,t!==null&&_u(t)),e}function _u(e){Vt===null?Vt=e:Vt.push.apply(Vt,e)}function Ov(e){for(var t=e;;){if(t.flags&16384){var r=t.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var a=r[n],i=a.getSnapshot;a=a.value;try{if(!Ir(i(),a))return!1}catch{return!1}}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function En(e,t){for(t&=~j0,t&=~To,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-Pr(t),n=1<<r;e[r]=-1,t&=~n}}function wf(e){if(Pe&6)throw Error(ie(327));qs();var t=Ol(e,0);if(!(t&1))return Yt(e,st()),null;var r=ql(e,t);if(e.tag!==0&&r===2){var n=Jc(e);n!==0&&(t=n,r=Su(e,n))}if(r===1)throw r=wi,os(e,0),En(e,t),Yt(e,st()),r;if(r===6)throw Error(ie(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,rs(e,Vt,Yr),Yt(e,st()),null}function _0(e,t){var r=Pe;Pe|=1;try{return e(t)}finally{Pe=r,Pe===0&&(ua=st()+500,jo&&Yn())}}function ms(e){kn!==null&&kn.tag===0&&!(Pe&6)&&qs();var t=Pe;Pe|=1;var r=vr.transition,n=Me;try{if(vr.transition=null,Me=1,e)return e()}finally{Me=n,vr.transition=r,Pe=t,!(Pe&6)&&Yn()}}function E0(){tr=Ws.current,Ge(Ws)}function os(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(r!==-1&&(e.timeoutHandle=-1,cv(r)),lt!==null)for(r=lt.return;r!==null;){var n=r;switch(i0(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&Ml();break;case 3:oa(),Ge(Xt),Ge(Dt),m0();break;case 5:x0(n);break;case 4:oa();break;case 13:Ge(qe);break;case 19:Ge(qe);break;case 10:u0(n.type._context);break;case 22:case 23:E0()}r=r.return}if(vt=e,lt=e=Bn(e.current,null),Et=tr=t,ht=0,wi=null,j0=To=xs=0,Vt=Ja=null,is!==null){for(t=0;t<is.length;t++)if(r=is[t],n=r.interleaved,n!==null){r.interleaved=null;var a=n.next,i=r.pending;if(i!==null){var l=i.next;i.next=a,n.next=l}r.pending=n}is=null}return e}function Bm(e,t){do{var r=lt;try{if(c0(),jl.current=Xl,Gl){for(var n=Ze.memoizedState;n!==null;){var a=n.queue;a!==null&&(a.pending=null),n=n.next}Gl=!1}if(hs=0,mt=ft=Ze=null,Ka=!1,gi=0,N0.current=null,r===null||r.return===null){ht=1,wi=t,lt=null;break}e:{var i=e,l=r.return,o=r,c=t;if(t=Et,o.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var d=c,u=o,f=u.tag;if(!(u.mode&1)&&(f===0||f===11||f===15)){var h=u.alternate;h?(u.updateQueue=h.updateQueue,u.memoizedState=h.memoizedState,u.lanes=h.lanes):(u.updateQueue=null,u.memoizedState=null)}var m=lf(l);if(m!==null){m.flags&=-257,of(m,l,o,i,t),m.mode&1&&af(i,d,t),t=m,c=d;var v=t.updateQueue;if(v===null){var x=new Set;x.add(c),t.updateQueue=x}else v.add(c);break e}else{if(!(t&1)){af(i,d,t),T0();break e}c=Error(ie(426))}}else if(Ke&&o.mode&1){var y=lf(l);if(y!==null){!(y.flags&65536)&&(y.flags|=256),of(y,l,o,i,t),l0(ca(c,o));break e}}i=c=ca(c,o),ht!==4&&(ht=2),Ja===null?Ja=[i]:Ja.push(i),i=l;do{switch(i.tag){case 3:i.flags|=65536,t&=-t,i.lanes|=t;var p=Nm(i,c,t);Zd(i,p);break e;case 1:o=c;var g=i.type,w=i.stateNode;if(!(i.flags&128)&&(typeof g.getDerivedStateFromError=="function"||w!==null&&typeof w.componentDidCatch=="function"&&(Ln===null||!Ln.has(w)))){i.flags|=65536,t&=-t,i.lanes|=t;var b=jm(i,o,t);Zd(i,b);break e}}i=i.return}while(i!==null)}$m(r)}catch(P){t=P,lt===r&&r!==null&&(lt=r=r.return);continue}break}while(!0)}function Um(){var e=Kl.current;return Kl.current=Xl,e===null?Xl:e}function T0(){(ht===0||ht===3||ht===2)&&(ht=4),vt===null||!(xs&268435455)&&!(To&268435455)||En(vt,Et)}function ql(e,t){var r=Pe;Pe|=2;var n=Um();(vt!==e||Et!==t)&&(Yr=null,os(e,t));do try{Rv();break}catch(a){Bm(e,a)}while(!0);if(c0(),Pe=r,Kl.current=n,lt!==null)throw Error(ie(261));return vt=null,Et=0,ht}function Rv(){for(;lt!==null;)zm(lt)}function Iv(){for(;lt!==null&&!iy();)zm(lt)}function zm(e){var t=Hm(e.alternate,e,tr);e.memoizedProps=e.pendingProps,t===null?$m(e):lt=t,N0.current=null}function $m(e){var t=e;do{var r=t.alternate;if(e=t.return,t.flags&32768){if(r=kv(r,t),r!==null){r.flags&=32767,lt=r;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{ht=6,lt=null;return}}else if(r=Tv(r,t,tr),r!==null){lt=r;return}if(t=t.sibling,t!==null){lt=t;return}lt=t=e}while(t!==null);ht===0&&(ht=5)}function rs(e,t,r){var n=Me,a=vr.transition;try{vr.transition=null,Me=1,Dv(e,t,r,n)}finally{vr.transition=a,Me=n}return null}function Dv(e,t,r,n){do qs();while(kn!==null);if(Pe&6)throw Error(ie(327));r=e.finishedWork;var a=e.finishedLanes;if(r===null)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(ie(177));e.callbackNode=null,e.callbackPriority=0;var i=r.lanes|r.childLanes;if(py(e,i),e===vt&&(lt=vt=null,Et=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||ll||(ll=!0,Vm(Pl,function(){return qs(),null})),i=(r.flags&15990)!==0,r.subtreeFlags&15990||i){i=vr.transition,vr.transition=null;var l=Me;Me=1;var o=Pe;Pe|=4,N0.current=null,Av(e,r),Dm(r,e),rv(ru),Rl=!!tu,ru=tu=null,e.current=r,Fv(r),ly(),Pe=o,Me=l,vr.transition=i}else e.current=r;if(ll&&(ll=!1,kn=e,Jl=a),i=e.pendingLanes,i===0&&(Ln=null),uy(r.stateNode),Yt(e,st()),t!==null)for(n=e.onRecoverableError,r=0;r<t.length;r++)a=t[r],n(a.value,{componentStack:a.stack,digest:a.digest});if(Yl)throw Yl=!1,e=Nu,Nu=null,e;return Jl&1&&e.tag!==0&&qs(),i=e.pendingLanes,i&1?e===ju?qa++:(qa=0,ju=e):qa=0,Yn(),null}function qs(){if(kn!==null){var e=Nx(Jl),t=vr.transition,r=Me;try{if(vr.transition=null,Me=16>e?16:e,kn===null)var n=!1;else{if(e=kn,kn=null,Jl=0,Pe&6)throw Error(ie(331));var a=Pe;for(Pe|=4,ye=e.current;ye!==null;){var i=ye,l=i.child;if(ye.flags&16){var o=i.deletions;if(o!==null){for(var c=0;c<o.length;c++){var d=o[c];for(ye=d;ye!==null;){var u=ye;switch(u.tag){case 0:case 11:case 15:Ya(8,u,i)}var f=u.child;if(f!==null)f.return=u,ye=f;else for(;ye!==null;){u=ye;var h=u.sibling,m=u.return;if(Om(u),u===d){ye=null;break}if(h!==null){h.return=m,ye=h;break}ye=m}}}var v=i.alternate;if(v!==null){var x=v.child;if(x!==null){v.child=null;do{var y=x.sibling;x.sibling=null,x=y}while(x!==null)}}ye=i}}if(i.subtreeFlags&2064&&l!==null)l.return=i,ye=l;else e:for(;ye!==null;){if(i=ye,i.flags&2048)switch(i.tag){case 0:case 11:case 15:Ya(9,i,i.return)}var p=i.sibling;if(p!==null){p.return=i.return,ye=p;break e}ye=i.return}}var g=e.current;for(ye=g;ye!==null;){l=ye;var w=l.child;if(l.subtreeFlags&2064&&w!==null)w.return=l,ye=w;else e:for(l=g;ye!==null;){if(o=ye,o.flags&2048)try{switch(o.tag){case 0:case 11:case 15:Eo(9,o)}}catch(P){tt(o,o.return,P)}if(o===l){ye=null;break e}var b=o.sibling;if(b!==null){b.return=o.return,ye=b;break e}ye=o.return}}if(Pe=a,Yn(),Wr&&typeof Wr.onPostCommitFiberRoot=="function")try{Wr.onPostCommitFiberRoot(yo,e)}catch{}n=!0}return n}finally{Me=r,vr.transition=t}}return!1}function bf(e,t,r){t=ca(r,t),t=Nm(e,t,1),e=Dn(e,t,1),t=Ut(),e!==null&&(Pi(e,1,t),Yt(e,t))}function tt(e,t,r){if(e.tag===3)bf(e,e,r);else for(;t!==null;){if(t.tag===3){bf(t,e,r);break}else if(t.tag===1){var n=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(Ln===null||!Ln.has(n))){e=ca(r,e),e=jm(t,e,1),t=Dn(t,e,1),e=Ut(),t!==null&&(Pi(t,1,e),Yt(t,e));break}}t=t.return}}function Lv(e,t,r){var n=e.pingCache;n!==null&&n.delete(t),t=Ut(),e.pingedLanes|=e.suspendedLanes&r,vt===e&&(Et&r)===r&&(ht===4||ht===3&&(Et&130023424)===Et&&500>st()-S0?os(e,0):j0|=r),Yt(e,t)}function Wm(e,t){t===0&&(e.mode&1?(t=qi,qi<<=1,!(qi&130023424)&&(qi=4194304)):t=1);var r=Ut();e=un(e,t),e!==null&&(Pi(e,t,r),Yt(e,r))}function Mv(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),Wm(e,r)}function Bv(e,t){var r=0;switch(e.tag){case 13:var n=e.stateNode,a=e.memoizedState;a!==null&&(r=a.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(ie(314))}n!==null&&n.delete(t),Wm(e,r)}var Hm;Hm=function(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps||Xt.current)Gt=!0;else{if(!(e.lanes&r)&&!(t.flags&128))return Gt=!1,Ev(e,t,r);Gt=!!(e.flags&131072)}else Gt=!1,Ke&&t.flags&1048576&&Kx(t,zl,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;_l(e,t),e=t.pendingProps;var a=aa(t,Dt.current);Js(t,r),a=g0(null,t,n,e,a,r);var i=y0();return t.flags|=1,typeof a=="object"&&a!==null&&typeof a.render=="function"&&a.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Kt(n)?(i=!0,Bl(t)):i=!1,t.memoizedState=a.state!==null&&a.state!==void 0?a.state:null,f0(t),a.updater=_o,t.stateNode=a,a._reactInternals=t,du(t,n,e,r),t=xu(null,t,n,!0,i,r)):(t.tag=0,Ke&&i&&a0(t),Lt(null,t,a,r),t=t.child),t;case 16:n=t.elementType;e:{switch(_l(e,t),e=t.pendingProps,a=n._init,n=a(n._payload),t.type=n,a=t.tag=zv(n),e=Tr(n,e),a){case 0:t=hu(null,t,n,e,r);break e;case 1:t=df(null,t,n,e,r);break e;case 11:t=cf(null,t,n,e,r);break e;case 14:t=uf(null,t,n,Tr(n.type,e),r);break e}throw Error(ie(306,n,""))}return t;case 0:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:Tr(n,a),hu(e,t,n,a,r);case 1:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:Tr(n,a),df(e,t,n,a,r);case 3:e:{if(Tm(t),e===null)throw Error(ie(387));n=t.pendingProps,i=t.memoizedState,a=i.element,em(e,t),Hl(t,n,null,r);var l=t.memoizedState;if(n=l.element,i.isDehydrated)if(i={element:n,isDehydrated:!1,cache:l.cache,pendingSuspenseBoundaries:l.pendingSuspenseBoundaries,transitions:l.transitions},t.updateQueue.baseState=i,t.memoizedState=i,t.flags&256){a=ca(Error(ie(423)),t),t=ff(e,t,n,r,a);break e}else if(n!==a){a=ca(Error(ie(424)),t),t=ff(e,t,n,r,a);break e}else for(ar=In(t.stateNode.containerInfo.firstChild),ir=t,Ke=!0,Cr=null,r=Qx(t,null,n,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(ia(),n===a){t=dn(e,t,r);break e}Lt(e,t,n,r)}t=t.child}return t;case 5:return tm(t),e===null&&ou(t),n=t.type,a=t.pendingProps,i=e!==null?e.memoizedProps:null,l=a.children,nu(n,a)?l=null:i!==null&&nu(n,i)&&(t.flags|=32),Em(e,t),Lt(e,t,l,r),t.child;case 6:return e===null&&ou(t),null;case 13:return km(e,t,r);case 4:return h0(t,t.stateNode.containerInfo),n=t.pendingProps,e===null?t.child=la(t,null,n,r):Lt(e,t,n,r),t.child;case 11:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:Tr(n,a),cf(e,t,n,a,r);case 7:return Lt(e,t,t.pendingProps,r),t.child;case 8:return Lt(e,t,t.pendingProps.children,r),t.child;case 12:return Lt(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(n=t.type._context,a=t.pendingProps,i=t.memoizedProps,l=a.value,$e($l,n._currentValue),n._currentValue=l,i!==null)if(Ir(i.value,l)){if(i.children===a.children&&!Xt.current){t=dn(e,t,r);break e}}else for(i=t.child,i!==null&&(i.return=t);i!==null;){var o=i.dependencies;if(o!==null){l=i.child;for(var c=o.firstContext;c!==null;){if(c.context===n){if(i.tag===1){c=nn(-1,r&-r),c.tag=2;var d=i.updateQueue;if(d!==null){d=d.shared;var u=d.pending;u===null?c.next=c:(c.next=u.next,u.next=c),d.pending=c}}i.lanes|=r,c=i.alternate,c!==null&&(c.lanes|=r),cu(i.return,r,t),o.lanes|=r;break}c=c.next}}else if(i.tag===10)l=i.type===t.type?null:i.child;else if(i.tag===18){if(l=i.return,l===null)throw Error(ie(341));l.lanes|=r,o=l.alternate,o!==null&&(o.lanes|=r),cu(l,r,t),l=i.sibling}else l=i.child;if(l!==null)l.return=i;else for(l=i;l!==null;){if(l===t){l=null;break}if(i=l.sibling,i!==null){i.return=l.return,l=i;break}l=l.return}i=l}Lt(e,t,a.children,r),t=t.child}return t;case 9:return a=t.type,n=t.pendingProps.children,Js(t,r),a=wr(a),n=n(a),t.flags|=1,Lt(e,t,n,r),t.child;case 14:return n=t.type,a=Tr(n,t.pendingProps),a=Tr(n.type,a),uf(e,t,n,a,r);case 15:return Sm(e,t,t.type,t.pendingProps,r);case 17:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:Tr(n,a),_l(e,t),t.tag=1,Kt(n)?(e=!0,Bl(t)):e=!1,Js(t,r),bm(t,n,a),du(t,n,a,r),xu(null,t,n,!0,e,r);case 19:return Cm(e,t,r);case 22:return _m(e,t,r)}throw Error(ie(156,t.tag))};function Vm(e,t){return yx(e,t)}function Uv(e,t,r,n){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function gr(e,t,r,n){return new Uv(e,t,r,n)}function k0(e){return e=e.prototype,!(!e||!e.isReactComponent)}function zv(e){if(typeof e=="function")return k0(e)?1:0;if(e!=null){if(e=e.$$typeof,e===Xu)return 11;if(e===Ku)return 14}return 2}function Bn(e,t){var r=e.alternate;return r===null?(r=gr(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&14680064,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function kl(e,t,r,n,a,i){var l=2;if(n=e,typeof e=="function")k0(e)&&(l=1);else if(typeof e=="string")l=5;else e:switch(e){case Os:return cs(r.children,a,i,t);case Gu:l=8,a|=8;break;case Ic:return e=gr(12,r,t,a|2),e.elementType=Ic,e.lanes=i,e;case Dc:return e=gr(13,r,t,a),e.elementType=Dc,e.lanes=i,e;case Lc:return e=gr(19,r,t,a),e.elementType=Lc,e.lanes=i,e;case tx:return ko(r,a,i,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case Zh:l=10;break e;case ex:l=9;break e;case Xu:l=11;break e;case Ku:l=14;break e;case jn:l=16,n=null;break e}throw Error(ie(130,e==null?e:typeof e,""))}return t=gr(l,r,t,a),t.elementType=e,t.type=n,t.lanes=i,t}function cs(e,t,r,n){return e=gr(7,e,n,t),e.lanes=r,e}function ko(e,t,r,n){return e=gr(22,e,n,t),e.elementType=tx,e.lanes=r,e.stateNode={isHidden:!1},e}function yc(e,t,r){return e=gr(6,e,null,t),e.lanes=r,e}function vc(e,t,r){return t=gr(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function $v(e,t,r,n,a){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Zo(0),this.expirationTimes=Zo(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Zo(0),this.identifierPrefix=n,this.onRecoverableError=a,this.mutableSourceEagerHydrationData=null}function C0(e,t,r,n,a,i,l,o,c){return e=new $v(e,t,r,o,c),t===1?(t=1,i===!0&&(t|=8)):t=0,i=gr(3,null,null,t),e.current=i,i.stateNode=e,i.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},f0(i),e}function Wv(e,t,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Ps,key:n==null?null:""+n,children:e,containerInfo:t,implementation:r}}function Gm(e){if(!e)return $n;e=e._reactInternals;e:{if(ws(e)!==e||e.tag!==1)throw Error(ie(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Kt(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(ie(171))}if(e.tag===1){var r=e.type;if(Kt(r))return Gx(e,r,t)}return t}function Xm(e,t,r,n,a,i,l,o,c){return e=C0(r,n,!0,e,a,i,l,o,c),e.context=Gm(null),r=e.current,n=Ut(),a=Mn(r),i=nn(n,a),i.callback=t??null,Dn(r,i,a),e.current.lanes=a,Pi(e,a,n),Yt(e,n),e}function Co(e,t,r,n){var a=t.current,i=Ut(),l=Mn(a);return r=Gm(r),t.context===null?t.context=r:t.pendingContext=r,t=nn(i,l),t.payload={element:e},n=n===void 0?null:n,n!==null&&(t.callback=n),e=Dn(a,t,l),e!==null&&(Or(e,a,l,i),Nl(e,a,l)),l}function Ql(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function Nf(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function A0(e,t){Nf(e,t),(e=e.alternate)&&Nf(e,t)}function Hv(){return null}var Km=typeof reportError=="function"?reportError:function(e){console.error(e)};function F0(e){this._internalRoot=e}Ao.prototype.render=F0.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(ie(409));Co(e,t,null,null)};Ao.prototype.unmount=F0.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;ms(function(){Co(null,e,null,null)}),t[cn]=null}};function Ao(e){this._internalRoot=e}Ao.prototype.unstable_scheduleHydration=function(e){if(e){var t=_x();e={blockedOn:null,target:e,priority:t};for(var r=0;r<_n.length&&t!==0&&t<_n[r].priority;r++);_n.splice(r,0,e),r===0&&Tx(e)}};function P0(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function Fo(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function jf(){}function Vv(e,t,r,n,a){if(a){if(typeof n=="function"){var i=n;n=function(){var d=Ql(l);i.call(d)}}var l=Xm(t,n,e,0,null,!1,!1,"",jf);return e._reactRootContainer=l,e[cn]=l.current,fi(e.nodeType===8?e.parentNode:e),ms(),l}for(;a=e.lastChild;)e.removeChild(a);if(typeof n=="function"){var o=n;n=function(){var d=Ql(c);o.call(d)}}var c=C0(e,0,!1,null,null,!1,!1,"",jf);return e._reactRootContainer=c,e[cn]=c.current,fi(e.nodeType===8?e.parentNode:e),ms(function(){Co(t,c,r,n)}),c}function Po(e,t,r,n,a){var i=r._reactRootContainer;if(i){var l=i;if(typeof a=="function"){var o=a;a=function(){var c=Ql(l);o.call(c)}}Co(t,l,e,a)}else l=Vv(r,t,e,a,n);return Ql(l)}jx=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=Ba(t.pendingLanes);r!==0&&(qu(t,r|1),Yt(t,st()),!(Pe&6)&&(ua=st()+500,Yn()))}break;case 13:ms(function(){var n=un(e,1);if(n!==null){var a=Ut();Or(n,e,1,a)}}),A0(e,1)}};Qu=function(e){if(e.tag===13){var t=un(e,134217728);if(t!==null){var r=Ut();Or(t,e,134217728,r)}A0(e,134217728)}};Sx=function(e){if(e.tag===13){var t=Mn(e),r=un(e,t);if(r!==null){var n=Ut();Or(r,e,t,n)}A0(e,t)}};_x=function(){return Me};Ex=function(e,t){var r=Me;try{return Me=e,t()}finally{Me=r}};Xc=function(e,t,r){switch(t){case"input":if(Uc(e,r),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var n=r[t];if(n!==e&&n.form===e.form){var a=No(n);if(!a)throw Error(ie(90));nx(n),Uc(n,a)}}}break;case"textarea":ax(e,r);break;case"select":t=r.value,t!=null&&Gs(e,!!r.multiple,t,!1)}};fx=_0;hx=ms;var Gv={usingClientEntryPoint:!1,Events:[Ri,Ls,No,ux,dx,_0]},Oa={findFiberByHostInstance:as,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},Xv={bundleType:Oa.bundleType,version:Oa.version,rendererPackageName:Oa.rendererPackageName,rendererConfig:Oa.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:xn.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=px(e),e===null?null:e.stateNode},findFiberByHostInstance:Oa.findFiberByHostInstance||Hv,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var ol=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!ol.isDisabled&&ol.supportsFiber)try{yo=ol.inject(Xv),Wr=ol}catch{}}ur.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Gv;ur.createPortal=function(e,t){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!P0(t))throw Error(ie(200));return Wv(e,t,null,r)};ur.createRoot=function(e,t){if(!P0(e))throw Error(ie(299));var r=!1,n="",a=Km;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(n=t.identifierPrefix),t.onRecoverableError!==void 0&&(a=t.onRecoverableError)),t=C0(e,1,!1,null,null,r,!1,n,a),e[cn]=t.current,fi(e.nodeType===8?e.parentNode:e),new F0(t)};ur.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(ie(188)):(e=Object.keys(e).join(","),Error(ie(268,e)));return e=px(t),e=e===null?null:e.stateNode,e};ur.flushSync=function(e){return ms(e)};ur.hydrate=function(e,t,r){if(!Fo(t))throw Error(ie(200));return Po(null,e,t,!0,r)};ur.hydrateRoot=function(e,t,r){if(!P0(e))throw Error(ie(405));var n=r!=null&&r.hydratedSources||null,a=!1,i="",l=Km;if(r!=null&&(r.unstable_strictMode===!0&&(a=!0),r.identifierPrefix!==void 0&&(i=r.identifierPrefix),r.onRecoverableError!==void 0&&(l=r.onRecoverableError)),t=Xm(t,null,e,1,r??null,a,!1,i,l),e[cn]=t.current,fi(e),n)for(e=0;e<n.length;e++)r=n[e],a=r._getVersion,a=a(r._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[r,a]:t.mutableSourceEagerHydrationData.push(r,a);return new Ao(t)};ur.render=function(e,t,r){if(!Fo(t))throw Error(ie(200));return Po(null,e,t,!1,r)};ur.unmountComponentAtNode=function(e){if(!Fo(e))throw Error(ie(40));return e._reactRootContainer?(ms(function(){Po(null,null,e,!1,function(){e._reactRootContainer=null,e[cn]=null})}),!0):!1};ur.unstable_batchedUpdates=_0;ur.unstable_renderSubtreeIntoContainer=function(e,t,r,n){if(!Fo(r))throw Error(ie(200));if(e==null||e._reactInternals===void 0)throw Error(ie(38));return Po(e,t,r,!1,n)};ur.version="18.3.1-next-f1338f8080-20240426";function Ym(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Ym)}catch(e){console.error(e)}}Ym(),Yh.exports=ur;var Kv=Yh.exports,Sf=Kv;Oc.createRoot=Sf.createRoot,Oc.hydrateRoot=Sf.hydrateRoot;/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function bi(){return bi=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},bi.apply(this,arguments)}var Cn;(function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"})(Cn||(Cn={}));const _f="popstate";function Yv(e){e===void 0&&(e={});function t(n,a){let{pathname:i,search:l,hash:o}=n.location;return Eu("",{pathname:i,search:l,hash:o},a.state&&a.state.usr||null,a.state&&a.state.key||"default")}function r(n,a){return typeof a=="string"?a:Zl(a)}return qv(t,r,null,e)}function ot(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function Jm(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function Jv(){return Math.random().toString(36).substr(2,8)}function Ef(e,t){return{usr:e.state,key:e.key,idx:t}}function Eu(e,t,r,n){return r===void 0&&(r=null),bi({pathname:typeof e=="string"?e:e.pathname,search:"",hash:""},typeof t=="string"?pa(t):t,{state:r,key:t&&t.key||n||Jv()})}function Zl(e){let{pathname:t="/",search:r="",hash:n=""}=e;return r&&r!=="?"&&(t+=r.charAt(0)==="?"?r:"?"+r),n&&n!=="#"&&(t+=n.charAt(0)==="#"?n:"#"+n),t}function pa(e){let t={};if(e){let r=e.indexOf("#");r>=0&&(t.hash=e.substr(r),e=e.substr(0,r));let n=e.indexOf("?");n>=0&&(t.search=e.substr(n),e=e.substr(0,n)),e&&(t.pathname=e)}return t}function qv(e,t,r,n){n===void 0&&(n={});let{window:a=document.defaultView,v5Compat:i=!1}=n,l=a.history,o=Cn.Pop,c=null,d=u();d==null&&(d=0,l.replaceState(bi({},l.state,{idx:d}),""));function u(){return(l.state||{idx:null}).idx}function f(){o=Cn.Pop;let y=u(),p=y==null?null:y-d;d=y,c&&c({action:o,location:x.location,delta:p})}function h(y,p){o=Cn.Push;let g=Eu(x.location,y,p);d=u()+1;let w=Ef(g,d),b=x.createHref(g);try{l.pushState(w,"",b)}catch(P){if(P instanceof DOMException&&P.name==="DataCloneError")throw P;a.location.assign(b)}i&&c&&c({action:o,location:x.location,delta:1})}function m(y,p){o=Cn.Replace;let g=Eu(x.location,y,p);d=u();let w=Ef(g,d),b=x.createHref(g);l.replaceState(w,"",b),i&&c&&c({action:o,location:x.location,delta:0})}function v(y){let p=a.location.origin!=="null"?a.location.origin:a.location.href,g=typeof y=="string"?y:Zl(y);return g=g.replace(/ $/,"%20"),ot(p,"No window.location.(origin|href) available to create URL for href: "+g),new URL(g,p)}let x={get action(){return o},get location(){return e(a,l)},listen(y){if(c)throw new Error("A history only accepts one active listener");return a.addEventListener(_f,f),c=y,()=>{a.removeEventListener(_f,f),c=null}},createHref(y){return t(a,y)},createURL:v,encodeLocation(y){let p=v(y);return{pathname:p.pathname,search:p.search,hash:p.hash}},push:h,replace:m,go(y){return l.go(y)}};return x}var Tf;(function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"})(Tf||(Tf={}));function Qv(e,t,r){return r===void 0&&(r="/"),Zv(e,t,r)}function Zv(e,t,r,n){let a=typeof t=="string"?pa(t):t,i=O0(a.pathname||"/",r);if(i==null)return null;let l=qm(e);e2(l);let o=null;for(let c=0;o==null&&c<l.length;++c){let d=f2(i);o=c2(l[c],d)}return o}function qm(e,t,r,n){t===void 0&&(t=[]),r===void 0&&(r=[]),n===void 0&&(n="");let a=(i,l,o)=>{let c={relativePath:o===void 0?i.path||"":o,caseSensitive:i.caseSensitive===!0,childrenIndex:l,route:i};c.relativePath.startsWith("/")&&(ot(c.relativePath.startsWith(n),'Absolute route path "'+c.relativePath+'" nested under path '+('"'+n+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),c.relativePath=c.relativePath.slice(n.length));let d=Un([n,c.relativePath]),u=r.concat(c);i.children&&i.children.length>0&&(ot(i.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+d+'".')),qm(i.children,t,u,d)),!(i.path==null&&!i.index)&&t.push({path:d,score:l2(d,i.index),routesMeta:u})};return e.forEach((i,l)=>{var o;if(i.path===""||!((o=i.path)!=null&&o.includes("?")))a(i,l);else for(let c of Qm(i.path))a(i,l,c)}),t}function Qm(e){let t=e.split("/");if(t.length===0)return[];let[r,...n]=t,a=r.endsWith("?"),i=r.replace(/\?$/,"");if(n.length===0)return a?[i,""]:[i];let l=Qm(n.join("/")),o=[];return o.push(...l.map(c=>c===""?i:[i,c].join("/"))),a&&o.push(...l),o.map(c=>e.startsWith("/")&&c===""?"/":c)}function e2(e){e.sort((t,r)=>t.score!==r.score?r.score-t.score:o2(t.routesMeta.map(n=>n.childrenIndex),r.routesMeta.map(n=>n.childrenIndex)))}const t2=/^:[\w-]+$/,r2=3,n2=2,s2=1,a2=10,i2=-2,kf=e=>e==="*";function l2(e,t){let r=e.split("/"),n=r.length;return r.some(kf)&&(n+=i2),t&&(n+=n2),r.filter(a=>!kf(a)).reduce((a,i)=>a+(t2.test(i)?r2:i===""?s2:a2),n)}function o2(e,t){return e.length===t.length&&e.slice(0,-1).every((n,a)=>n===t[a])?e[e.length-1]-t[t.length-1]:0}function c2(e,t,r){let{routesMeta:n}=e,a={},i="/",l=[];for(let o=0;o<n.length;++o){let c=n[o],d=o===n.length-1,u=i==="/"?t:t.slice(i.length)||"/",f=u2({path:c.relativePath,caseSensitive:c.caseSensitive,end:d},u),h=c.route;if(!f)return null;Object.assign(a,f.params),l.push({params:a,pathname:Un([i,f.pathname]),pathnameBase:p2(Un([i,f.pathnameBase])),route:h}),f.pathnameBase!=="/"&&(i=Un([i,f.pathnameBase]))}return l}function u2(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[r,n]=d2(e.path,e.caseSensitive,e.end),a=t.match(r);if(!a)return null;let i=a[0],l=i.replace(/(.)\/+$/,"$1"),o=a.slice(1);return{params:n.reduce((d,u,f)=>{let{paramName:h,isOptional:m}=u;if(h==="*"){let x=o[f]||"";l=i.slice(0,i.length-x.length).replace(/(.)\/+$/,"$1")}const v=o[f];return m&&!v?d[h]=void 0:d[h]=(v||"").replace(/%2F/g,"/"),d},{}),pathname:i,pathnameBase:l,pattern:e}}function d2(e,t,r){t===void 0&&(t=!1),r===void 0&&(r=!0),Jm(e==="*"||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were '+('"'+e.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+e.replace(/\*$/,"/*")+'".'));let n=[],a="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(l,o,c)=>(n.push({paramName:o,isOptional:c!=null}),c?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(n.push({paramName:"*"}),a+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?a+="\\/*$":e!==""&&e!=="/"&&(a+="(?:(?=\\/|$))"),[new RegExp(a,t?void 0:"i"),n]}function f2(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return Jm(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+t+").")),e}}function O0(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let r=t.endsWith("/")?t.length-1:t.length,n=e.charAt(r);return n&&n!=="/"?null:e.slice(r)||"/"}function h2(e,t){t===void 0&&(t="/");let{pathname:r,search:n="",hash:a=""}=typeof e=="string"?pa(e):e;return{pathname:r?r.startsWith("/")?r:x2(r,t):t,search:g2(n),hash:y2(a)}}function x2(e,t){let r=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(a=>{a===".."?r.length>1&&r.pop():a!=="."&&r.push(a)}),r.length>1?r.join("/"):"/"}function wc(e,t,r,n){return"Cannot include a '"+e+"' character in a manually specified "+("`to."+t+"` field ["+JSON.stringify(n)+"].  Please separate it out to the ")+("`to."+r+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function m2(e){return e.filter((t,r)=>r===0||t.route.path&&t.route.path.length>0)}function Zm(e,t){let r=m2(e);return t?r.map((n,a)=>a===r.length-1?n.pathname:n.pathnameBase):r.map(n=>n.pathnameBase)}function ep(e,t,r,n){n===void 0&&(n=!1);let a;typeof e=="string"?a=pa(e):(a=bi({},e),ot(!a.pathname||!a.pathname.includes("?"),wc("?","pathname","search",a)),ot(!a.pathname||!a.pathname.includes("#"),wc("#","pathname","hash",a)),ot(!a.search||!a.search.includes("#"),wc("#","search","hash",a)));let i=e===""||a.pathname==="",l=i?"/":a.pathname,o;if(l==null)o=r;else{let f=t.length-1;if(!n&&l.startsWith("..")){let h=l.split("/");for(;h[0]==="..";)h.shift(),f-=1;a.pathname=h.join("/")}o=f>=0?t[f]:"/"}let c=h2(a,o),d=l&&l!=="/"&&l.endsWith("/"),u=(i||l===".")&&r.endsWith("/");return!c.pathname.endsWith("/")&&(d||u)&&(c.pathname+="/"),c}const Un=e=>e.join("/").replace(/\/\/+/g,"/"),p2=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),g2=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,y2=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function v2(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}const tp=["post","put","patch","delete"];new Set(tp);const w2=["get",...tp];new Set(w2);/**
 * React Router v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Ni(){return Ni=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Ni.apply(this,arguments)}const R0=T.createContext(null),b2=T.createContext(null),bs=T.createContext(null),Oo=T.createContext(null),mn=T.createContext({outlet:null,matches:[],isDataRoute:!1}),rp=T.createContext(null);function N2(e,t){let{relative:r}=t===void 0?{}:t;Di()||ot(!1);let{basename:n,navigator:a}=T.useContext(bs),{hash:i,pathname:l,search:o}=sp(e,{relative:r}),c=l;return n!=="/"&&(c=l==="/"?n:Un([n,l])),a.createHref({pathname:c,search:o,hash:i})}function Di(){return T.useContext(Oo)!=null}function ga(){return Di()||ot(!1),T.useContext(Oo).location}function np(e){T.useContext(bs).static||T.useLayoutEffect(e)}function Jn(){let{isDataRoute:e}=T.useContext(mn);return e?M2():j2()}function j2(){Di()||ot(!1);let e=T.useContext(R0),{basename:t,future:r,navigator:n}=T.useContext(bs),{matches:a}=T.useContext(mn),{pathname:i}=ga(),l=JSON.stringify(Zm(a,r.v7_relativeSplatPath)),o=T.useRef(!1);return np(()=>{o.current=!0}),T.useCallback(function(d,u){if(u===void 0&&(u={}),!o.current)return;if(typeof d=="number"){n.go(d);return}let f=ep(d,JSON.parse(l),i,u.relative==="path");e==null&&t!=="/"&&(f.pathname=f.pathname==="/"?t:Un([t,f.pathname])),(u.replace?n.replace:n.push)(f,u.state,u)},[t,n,l,i,e])}const S2=T.createContext(null);function _2(e){let t=T.useContext(mn).outlet;return t&&T.createElement(S2.Provider,{value:e},t)}function E2(){let{matches:e}=T.useContext(mn),t=e[e.length-1];return t?t.params:{}}function sp(e,t){let{relative:r}=t===void 0?{}:t,{future:n}=T.useContext(bs),{matches:a}=T.useContext(mn),{pathname:i}=ga(),l=JSON.stringify(Zm(a,n.v7_relativeSplatPath));return T.useMemo(()=>ep(e,JSON.parse(l),i,r==="path"),[e,l,i,r])}function T2(e,t){return k2(e,t)}function k2(e,t,r,n){Di()||ot(!1);let{navigator:a}=T.useContext(bs),{matches:i}=T.useContext(mn),l=i[i.length-1],o=l?l.params:{};l&&l.pathname;let c=l?l.pathnameBase:"/";l&&l.route;let d=ga(),u;if(t){var f;let y=typeof t=="string"?pa(t):t;c==="/"||(f=y.pathname)!=null&&f.startsWith(c)||ot(!1),u=y}else u=d;let h=u.pathname||"/",m=h;if(c!=="/"){let y=c.replace(/^\//,"").split("/");m="/"+h.replace(/^\//,"").split("/").slice(y.length).join("/")}let v=Qv(e,{pathname:m}),x=O2(v&&v.map(y=>Object.assign({},y,{params:Object.assign({},o,y.params),pathname:Un([c,a.encodeLocation?a.encodeLocation(y.pathname).pathname:y.pathname]),pathnameBase:y.pathnameBase==="/"?c:Un([c,a.encodeLocation?a.encodeLocation(y.pathnameBase).pathname:y.pathnameBase])})),i,r,n);return t&&x?T.createElement(Oo.Provider,{value:{location:Ni({pathname:"/",search:"",hash:"",state:null,key:"default"},u),navigationType:Cn.Pop}},x):x}function C2(){let e=L2(),t=v2(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),r=e instanceof Error?e.stack:null,a={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return T.createElement(T.Fragment,null,T.createElement("h2",null,"Unexpected Application Error!"),T.createElement("h3",{style:{fontStyle:"italic"}},t),r?T.createElement("pre",{style:a},r):null,null)}const A2=T.createElement(C2,null);class F2 extends T.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,r){return r.location!==t.location||r.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:r.error,location:r.location,revalidation:t.revalidation||r.revalidation}}componentDidCatch(t,r){console.error("React Router caught the following error during render",t,r)}render(){return this.state.error!==void 0?T.createElement(mn.Provider,{value:this.props.routeContext},T.createElement(rp.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function P2(e){let{routeContext:t,match:r,children:n}=e,a=T.useContext(R0);return a&&a.static&&a.staticContext&&(r.route.errorElement||r.route.ErrorBoundary)&&(a.staticContext._deepestRenderedBoundaryId=r.route.id),T.createElement(mn.Provider,{value:t},n)}function O2(e,t,r,n){var a;if(t===void 0&&(t=[]),r===void 0&&(r=null),n===void 0&&(n=null),e==null){var i;if(!r)return null;if(r.errors)e=r.matches;else if((i=n)!=null&&i.v7_partialHydration&&t.length===0&&!r.initialized&&r.matches.length>0)e=r.matches;else return null}let l=e,o=(a=r)==null?void 0:a.errors;if(o!=null){let u=l.findIndex(f=>f.route.id&&(o==null?void 0:o[f.route.id])!==void 0);u>=0||ot(!1),l=l.slice(0,Math.min(l.length,u+1))}let c=!1,d=-1;if(r&&n&&n.v7_partialHydration)for(let u=0;u<l.length;u++){let f=l[u];if((f.route.HydrateFallback||f.route.hydrateFallbackElement)&&(d=u),f.route.id){let{loaderData:h,errors:m}=r,v=f.route.loader&&h[f.route.id]===void 0&&(!m||m[f.route.id]===void 0);if(f.route.lazy||v){c=!0,d>=0?l=l.slice(0,d+1):l=[l[0]];break}}}return l.reduceRight((u,f,h)=>{let m,v=!1,x=null,y=null;r&&(m=o&&f.route.id?o[f.route.id]:void 0,x=f.route.errorElement||A2,c&&(d<0&&h===0?(B2("route-fallback"),v=!0,y=null):d===h&&(v=!0,y=f.route.hydrateFallbackElement||null)));let p=t.concat(l.slice(0,h+1)),g=()=>{let w;return m?w=x:v?w=y:f.route.Component?w=T.createElement(f.route.Component,null):f.route.element?w=f.route.element:w=u,T.createElement(P2,{match:f,routeContext:{outlet:u,matches:p,isDataRoute:r!=null},children:w})};return r&&(f.route.ErrorBoundary||f.route.errorElement||h===0)?T.createElement(F2,{location:r.location,revalidation:r.revalidation,component:x,error:m,children:g(),routeContext:{outlet:null,matches:p,isDataRoute:!0}}):g()},null)}var ap=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(ap||{}),ip=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(ip||{});function R2(e){let t=T.useContext(R0);return t||ot(!1),t}function I2(e){let t=T.useContext(b2);return t||ot(!1),t}function D2(e){let t=T.useContext(mn);return t||ot(!1),t}function lp(e){let t=D2(),r=t.matches[t.matches.length-1];return r.route.id||ot(!1),r.route.id}function L2(){var e;let t=T.useContext(rp),r=I2(),n=lp();return t!==void 0?t:(e=r.errors)==null?void 0:e[n]}function M2(){let{router:e}=R2(ap.UseNavigateStable),t=lp(ip.UseNavigateStable),r=T.useRef(!1);return np(()=>{r.current=!0}),T.useCallback(function(a,i){i===void 0&&(i={}),r.current&&(typeof a=="number"?e.navigate(a):e.navigate(a,Ni({fromRouteId:t},i)))},[e,t])}const Cf={};function B2(e,t,r){Cf[e]||(Cf[e]=!0)}function U2(e,t){e==null||e.v7_startTransition,e==null||e.v7_relativeSplatPath}function z2(e){return _2(e.context)}function Ve(e){ot(!1)}function $2(e){let{basename:t="/",children:r=null,location:n,navigationType:a=Cn.Pop,navigator:i,static:l=!1,future:o}=e;Di()&&ot(!1);let c=t.replace(/^\/*/,"/"),d=T.useMemo(()=>({basename:c,navigator:i,static:l,future:Ni({v7_relativeSplatPath:!1},o)}),[c,o,i,l]);typeof n=="string"&&(n=pa(n));let{pathname:u="/",search:f="",hash:h="",state:m=null,key:v="default"}=n,x=T.useMemo(()=>{let y=O0(u,c);return y==null?null:{location:{pathname:y,search:f,hash:h,state:m,key:v},navigationType:a}},[c,u,f,h,m,v,a]);return x==null?null:T.createElement(bs.Provider,{value:d},T.createElement(Oo.Provider,{children:r,value:x}))}function W2(e){let{children:t,location:r}=e;return T2(Tu(t),r)}new Promise(()=>{});function Tu(e,t){t===void 0&&(t=[]);let r=[];return T.Children.forEach(e,(n,a)=>{if(!T.isValidElement(n))return;let i=[...t,a];if(n.type===T.Fragment){r.push.apply(r,Tu(n.props.children,i));return}n.type!==Ve&&ot(!1),!n.props.index||!n.props.children||ot(!1);let l={id:n.props.id||i.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(l.children=Tu(n.props.children,i)),r.push(l)}),r}/**
 * React Router DOM v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function ku(){return ku=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},ku.apply(this,arguments)}function H2(e,t){if(e==null)return{};var r={},n=Object.keys(e),a,i;for(i=0;i<n.length;i++)a=n[i],!(t.indexOf(a)>=0)&&(r[a]=e[a]);return r}function V2(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function G2(e,t){return e.button===0&&(!t||t==="_self")&&!V2(e)}const X2=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],K2="6";try{window.__reactRouterVersion=K2}catch{}const Y2="startTransition",Af=L1[Y2];function J2(e){let{basename:t,children:r,future:n,window:a}=e,i=T.useRef();i.current==null&&(i.current=Yv({window:a,v5Compat:!0}));let l=i.current,[o,c]=T.useState({action:l.action,location:l.location}),{v7_startTransition:d}=n||{},u=T.useCallback(f=>{d&&Af?Af(()=>c(f)):c(f)},[c,d]);return T.useLayoutEffect(()=>l.listen(u),[l,u]),T.useEffect(()=>U2(n),[n]),T.createElement($2,{basename:t,children:r,location:o.location,navigationType:o.action,navigator:l,future:n})}const q2=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",Q2=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,eo=T.forwardRef(function(t,r){let{onClick:n,relative:a,reloadDocument:i,replace:l,state:o,target:c,to:d,preventScrollReset:u,viewTransition:f}=t,h=H2(t,X2),{basename:m}=T.useContext(bs),v,x=!1;if(typeof d=="string"&&Q2.test(d)&&(v=d,q2))try{let w=new URL(window.location.href),b=d.startsWith("//")?new URL(w.protocol+d):new URL(d),P=O0(b.pathname,m);b.origin===w.origin&&P!=null?d=P+b.search+b.hash:x=!0}catch{}let y=N2(d,{relative:a}),p=Z2(d,{replace:l,state:o,target:c,preventScrollReset:u,relative:a,viewTransition:f});function g(w){n&&n(w),w.defaultPrevented||p(w)}return T.createElement("a",ku({},h,{href:v||y,onClick:x||i?n:g,ref:r,target:c}))});var Ff;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(Ff||(Ff={}));var Pf;(function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})(Pf||(Pf={}));function Z2(e,t){let{target:r,replace:n,state:a,preventScrollReset:i,relative:l,viewTransition:o}=t===void 0?{}:t,c=Jn(),d=ga(),u=sp(e,{relative:l});return T.useCallback(f=>{if(G2(f,r)){f.preventDefault();let h=n!==void 0?n:Zl(d)===Zl(u);c(e,{replace:h,state:a,preventScrollReset:i,relative:l,viewTransition:o})}},[d,c,u,n,a,r,e,i,l,o])}/**
 * @license lucide-react v0.427.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ew=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),op=(...e)=>e.filter((t,r,n)=>!!t&&n.indexOf(t)===r).join(" ");/**
 * @license lucide-react v0.427.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var tw={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.427.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rw=T.forwardRef(({color:e="currentColor",size:t=24,strokeWidth:r=2,absoluteStrokeWidth:n,className:a="",children:i,iconNode:l,...o},c)=>T.createElement("svg",{ref:c,...tw,width:t,height:t,stroke:e,strokeWidth:n?Number(r)*24/Number(t):r,className:op("lucide",a),...o},[...l.map(([d,u])=>T.createElement(d,u)),...Array.isArray(i)?i:[i]]));/**
 * @license lucide-react v0.427.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ee=(e,t)=>{const r=T.forwardRef(({className:n,...a},i)=>T.createElement(rw,{ref:i,iconNode:t,className:op(`lucide-${ew(e)}`,n),...a}));return r.displayName=`${e}`,r};/**
 * @license lucide-react v0.427.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nw=Ee("Activity",[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]]);/**
 * @license lucide-react v0.427.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sw=Ee("Archive",[["rect",{width:"20",height:"5",x:"2",y:"3",rx:"1",key:"1wp1u1"}],["path",{d:"M4 8v11a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8",key:"1s80jp"}],["path",{d:"M10 12h4",key:"a56b0p"}]]);/**
 * @license lucide-react v0.427.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aw=Ee("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.427.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cp=Ee("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]);/**
 * @license lucide-react v0.427.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Of=Ee("Briefcase",[["path",{d:"M16 20V4a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16",key:"jecpp"}],["rect",{width:"20",height:"14",x:"2",y:"6",rx:"2",key:"i6l2r4"}]]);/**
 * @license lucide-react v0.427.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ji=Ee("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.427.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iw=Ee("ChartColumn",[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]);/**
 * @license lucide-react v0.427.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lw=Ee("ChartPie",[["path",{d:"M21 12c.552 0 1.005-.449.95-.998a10 10 0 0 0-8.953-8.951c-.55-.055-.998.398-.998.95v8a1 1 0 0 0 1 1z",key:"pzmjnu"}],["path",{d:"M21.21 15.89A10 10 0 1 1 8 2.83",key:"k2fpak"}]]);/**
 * @license lucide-react v0.427.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ow=Ee("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.427.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wn=Ee("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.427.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rf=Ee("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);/**
 * @license lucide-react v0.427.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qe=Ee("CircleCheck",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.427.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nr=Ee("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.427.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cw=Ee("Clipboard",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}]]);/**
 * @license lucide-react v0.427.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $t=Ee("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.427.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cu=Ee("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]);/**
 * @license lucide-react v0.427.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const da=Ee("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.427.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ns=Ee("EllipsisVertical",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]]);/**
 * @license lucide-react v0.427.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const up=Ee("FileCheck",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"m9 15 2 2 4-4",key:"1grp1n"}]]);/**
 * @license lucide-react v0.427.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wt=Ee("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.427.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qn=Ee("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-react v0.427.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uw=Ee("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);/**
 * @license lucide-react v0.427.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dw=Ee("LayoutDashboard",[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]]);/**
 * @license lucide-react v0.427.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fw=Ee("Link2",[["path",{d:"M9 17H7A5 5 0 0 1 7 7h2",key:"8i5ue5"}],["path",{d:"M15 7h2a5 5 0 1 1 0 10h-2",key:"1b9ql8"}],["line",{x1:"8",x2:"16",y1:"12",y2:"12",key:"1jonct"}]]);/**
 * @license lucide-react v0.427.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hw=Ee("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.427.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dp=Ee("Paperclip",[["path",{d:"m21.44 11.05-9.19 9.19a6 6 0 0 1-8.49-8.49l8.57-8.57A4 4 0 1 1 18 8.84l-8.59 8.57a2 2 0 0 1-2.83-2.83l8.49-8.48",key:"1u3ebp"}]]);/**
 * @license lucide-react v0.427.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xw=Ee("Pen",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]]);/**
 * @license lucide-react v0.427.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lr=Ee("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.427.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ro=Ee("Receipt",[["path",{d:"M4 2v20l2-1 2 1 2-1 2 1 2-1 2 1 2-1 2 1V2l-2 1-2-1-2 1-2-1-2 1-2-1-2 1Z",key:"q3az6g"}],["path",{d:"M16 8h-6a2 2 0 1 0 0 4h4a2 2 0 1 1 0 4H8",key:"1h4pet"}],["path",{d:"M12 17.5v-11",key:"1jc1ny"}]]);/**
 * @license lucide-react v0.427.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mw=Ee("Reply",[["polyline",{points:"9 17 4 12 9 7",key:"hvgpf2"}],["path",{d:"M20 18v-2a4 4 0 0 0-4-4H4",key:"5vmcpk"}]]);/**
 * @license lucide-react v0.427.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pn=Ee("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.427.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fp=Ee("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]]);/**
 * @license lucide-react v0.427.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hp=Ee("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.427.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xp=Ee("ShoppingCart",[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]]);/**
 * @license lucide-react v0.427.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pw=Ee("SquareCheckBig",[["path",{d:"M21 10.5V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h12.5",key:"1uzm8b"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.427.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gw=Ee("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]]);/**
 * @license lucide-react v0.427.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yw=Ee("Star",[["polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2",key:"8f66p6"}]]);/**
 * @license lucide-react v0.427.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vw=Ee("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]);/**
 * @license lucide-react v0.427.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const I0=Ee("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.427.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ww=Ee("TrendingDown",[["polyline",{points:"22 17 13.5 8.5 8.5 13.5 2 7",key:"1r2t7k"}],["polyline",{points:"16 17 22 17 22 11",key:"11uiuu"}]]);/**
 * @license lucide-react v0.427.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Li=Ee("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);/**
 * @license lucide-react v0.427.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qs=Ee("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.427.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const D0=Ee("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.427.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Au=Ee("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.427.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ze=Ee("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);function mp(e){var t,r,n="";if(typeof e=="string"||typeof e=="number")n+=e;else if(typeof e=="object")if(Array.isArray(e)){var a=e.length;for(t=0;t<a;t++)e[t]&&(r=mp(e[t]))&&(n&&(n+=" "),n+=r)}else for(r in e)e[r]&&(n&&(n+=" "),n+=r);return n}function bw(){for(var e,t,r=0,n="",a=arguments.length;r<a;r++)(e=arguments[r])&&(t=mp(e))&&(n&&(n+=" "),n+=t);return n}const L0="-",Nw=e=>{const t=Sw(e),{conflictingClassGroups:r,conflictingClassGroupModifiers:n}=e;return{getClassGroupId:l=>{const o=l.split(L0);return o[0]===""&&o.length!==1&&o.shift(),pp(o,t)||jw(l)},getConflictingClassGroupIds:(l,o)=>{const c=r[l]||[];return o&&n[l]?[...c,...n[l]]:c}}},pp=(e,t)=>{var l;if(e.length===0)return t.classGroupId;const r=e[0],n=t.nextPart.get(r),a=n?pp(e.slice(1),n):void 0;if(a)return a;if(t.validators.length===0)return;const i=e.join(L0);return(l=t.validators.find(({validator:o})=>o(i)))==null?void 0:l.classGroupId},If=/^\[(.+)\]$/,jw=e=>{if(If.test(e)){const t=If.exec(e)[1],r=t==null?void 0:t.substring(0,t.indexOf(":"));if(r)return"arbitrary.."+r}},Sw=e=>{const{theme:t,prefix:r}=e,n={nextPart:new Map,validators:[]};return Ew(Object.entries(e.classGroups),r).forEach(([i,l])=>{Fu(l,n,i,t)}),n},Fu=(e,t,r,n)=>{e.forEach(a=>{if(typeof a=="string"){const i=a===""?t:Df(t,a);i.classGroupId=r;return}if(typeof a=="function"){if(_w(a)){Fu(a(n),t,r,n);return}t.validators.push({validator:a,classGroupId:r});return}Object.entries(a).forEach(([i,l])=>{Fu(l,Df(t,i),r,n)})})},Df=(e,t)=>{let r=e;return t.split(L0).forEach(n=>{r.nextPart.has(n)||r.nextPart.set(n,{nextPart:new Map,validators:[]}),r=r.nextPart.get(n)}),r},_w=e=>e.isThemeGetter,Ew=(e,t)=>t?e.map(([r,n])=>{const a=n.map(i=>typeof i=="string"?t+i:typeof i=="object"?Object.fromEntries(Object.entries(i).map(([l,o])=>[t+l,o])):i);return[r,a]}):e,Tw=e=>{if(e<1)return{get:()=>{},set:()=>{}};let t=0,r=new Map,n=new Map;const a=(i,l)=>{r.set(i,l),t++,t>e&&(t=0,n=r,r=new Map)};return{get(i){let l=r.get(i);if(l!==void 0)return l;if((l=n.get(i))!==void 0)return a(i,l),l},set(i,l){r.has(i)?r.set(i,l):a(i,l)}}},gp="!",kw=e=>{const{separator:t,experimentalParseClassName:r}=e,n=t.length===1,a=t[0],i=t.length,l=o=>{const c=[];let d=0,u=0,f;for(let y=0;y<o.length;y++){let p=o[y];if(d===0){if(p===a&&(n||o.slice(y,y+i)===t)){c.push(o.slice(u,y)),u=y+i;continue}if(p==="/"){f=y;continue}}p==="["?d++:p==="]"&&d--}const h=c.length===0?o:o.substring(u),m=h.startsWith(gp),v=m?h.substring(1):h,x=f&&f>u?f-u:void 0;return{modifiers:c,hasImportantModifier:m,baseClassName:v,maybePostfixModifierPosition:x}};return r?o=>r({className:o,parseClassName:l}):l},Cw=e=>{if(e.length<=1)return e;const t=[];let r=[];return e.forEach(n=>{n[0]==="["?(t.push(...r.sort(),n),r=[]):r.push(n)}),t.push(...r.sort()),t},Aw=e=>({cache:Tw(e.cacheSize),parseClassName:kw(e),...Nw(e)}),Fw=/\s+/,Pw=(e,t)=>{const{parseClassName:r,getClassGroupId:n,getConflictingClassGroupIds:a}=t,i=[],l=e.trim().split(Fw);let o="";for(let c=l.length-1;c>=0;c-=1){const d=l[c],{modifiers:u,hasImportantModifier:f,baseClassName:h,maybePostfixModifierPosition:m}=r(d);let v=!!m,x=n(v?h.substring(0,m):h);if(!x){if(!v){o=d+(o.length>0?" "+o:o);continue}if(x=n(h),!x){o=d+(o.length>0?" "+o:o);continue}v=!1}const y=Cw(u).join(":"),p=f?y+gp:y,g=p+x;if(i.includes(g))continue;i.push(g);const w=a(x,v);for(let b=0;b<w.length;++b){const P=w[b];i.push(p+P)}o=d+(o.length>0?" "+o:o)}return o};function Ow(){let e=0,t,r,n="";for(;e<arguments.length;)(t=arguments[e++])&&(r=yp(t))&&(n&&(n+=" "),n+=r);return n}const yp=e=>{if(typeof e=="string")return e;let t,r="";for(let n=0;n<e.length;n++)e[n]&&(t=yp(e[n]))&&(r&&(r+=" "),r+=t);return r};function Rw(e,...t){let r,n,a,i=l;function l(c){const d=t.reduce((u,f)=>f(u),e());return r=Aw(d),n=r.cache.get,a=r.cache.set,i=o,o(c)}function o(c){const d=n(c);if(d)return d;const u=Pw(c,r);return a(c,u),u}return function(){return i(Ow.apply(null,arguments))}}const We=e=>{const t=r=>r[e]||[];return t.isThemeGetter=!0,t},vp=/^\[(?:([a-z-]+):)?(.+)\]$/i,Iw=/^\d+\/\d+$/,Dw=new Set(["px","full","screen"]),Lw=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,Mw=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,Bw=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,Uw=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,zw=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,Kr=e=>Zs(e)||Dw.has(e)||Iw.test(e),wn=e=>ya(e,"length",Yw),Zs=e=>!!e&&!Number.isNaN(Number(e)),bc=e=>ya(e,"number",Zs),Ra=e=>!!e&&Number.isInteger(Number(e)),$w=e=>e.endsWith("%")&&Zs(e.slice(0,-1)),ke=e=>vp.test(e),bn=e=>Lw.test(e),Ww=new Set(["length","size","percentage"]),Hw=e=>ya(e,Ww,wp),Vw=e=>ya(e,"position",wp),Gw=new Set(["image","url"]),Xw=e=>ya(e,Gw,qw),Kw=e=>ya(e,"",Jw),Ia=()=>!0,ya=(e,t,r)=>{const n=vp.exec(e);return n?n[1]?typeof t=="string"?n[1]===t:t.has(n[1]):r(n[2]):!1},Yw=e=>Mw.test(e)&&!Bw.test(e),wp=()=>!1,Jw=e=>Uw.test(e),qw=e=>zw.test(e),Qw=()=>{const e=We("colors"),t=We("spacing"),r=We("blur"),n=We("brightness"),a=We("borderColor"),i=We("borderRadius"),l=We("borderSpacing"),o=We("borderWidth"),c=We("contrast"),d=We("grayscale"),u=We("hueRotate"),f=We("invert"),h=We("gap"),m=We("gradientColorStops"),v=We("gradientColorStopPositions"),x=We("inset"),y=We("margin"),p=We("opacity"),g=We("padding"),w=We("saturate"),b=We("scale"),P=We("sepia"),M=We("skew"),j=We("space"),O=We("translate"),R=()=>["auto","contain","none"],I=()=>["auto","hidden","clip","visible","scroll"],D=()=>["auto",ke,t],z=()=>[ke,t],ne=()=>["",Kr,wn],Ne=()=>["auto",Zs,ke],ue=()=>["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],je=()=>["solid","dashed","dotted","double","none"],q=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],W=()=>["start","end","center","between","around","evenly","stretch"],k=()=>["","0",ke],K=()=>["auto","avoid","all","avoid-page","page","left","right","column"],te=()=>[Zs,ke];return{cacheSize:500,separator:":",theme:{colors:[Ia],spacing:[Kr,wn],blur:["none","",bn,ke],brightness:te(),borderColor:[e],borderRadius:["none","","full",bn,ke],borderSpacing:z(),borderWidth:ne(),contrast:te(),grayscale:k(),hueRotate:te(),invert:k(),gap:z(),gradientColorStops:[e],gradientColorStopPositions:[$w,wn],inset:D(),margin:D(),opacity:te(),padding:z(),saturate:te(),scale:te(),sepia:k(),skew:te(),space:z(),translate:z()},classGroups:{aspect:[{aspect:["auto","square","video",ke]}],container:["container"],columns:[{columns:[bn]}],"break-after":[{"break-after":K()}],"break-before":[{"break-before":K()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[...ue(),ke]}],overflow:[{overflow:I()}],"overflow-x":[{"overflow-x":I()}],"overflow-y":[{"overflow-y":I()}],overscroll:[{overscroll:R()}],"overscroll-x":[{"overscroll-x":R()}],"overscroll-y":[{"overscroll-y":R()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[x]}],"inset-x":[{"inset-x":[x]}],"inset-y":[{"inset-y":[x]}],start:[{start:[x]}],end:[{end:[x]}],top:[{top:[x]}],right:[{right:[x]}],bottom:[{bottom:[x]}],left:[{left:[x]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",Ra,ke]}],basis:[{basis:D()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",ke]}],grow:[{grow:k()}],shrink:[{shrink:k()}],order:[{order:["first","last","none",Ra,ke]}],"grid-cols":[{"grid-cols":[Ia]}],"col-start-end":[{col:["auto",{span:["full",Ra,ke]},ke]}],"col-start":[{"col-start":Ne()}],"col-end":[{"col-end":Ne()}],"grid-rows":[{"grid-rows":[Ia]}],"row-start-end":[{row:["auto",{span:[Ra,ke]},ke]}],"row-start":[{"row-start":Ne()}],"row-end":[{"row-end":Ne()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",ke]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",ke]}],gap:[{gap:[h]}],"gap-x":[{"gap-x":[h]}],"gap-y":[{"gap-y":[h]}],"justify-content":[{justify:["normal",...W()]}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal",...W(),"baseline"]}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[...W(),"baseline"]}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[g]}],px:[{px:[g]}],py:[{py:[g]}],ps:[{ps:[g]}],pe:[{pe:[g]}],pt:[{pt:[g]}],pr:[{pr:[g]}],pb:[{pb:[g]}],pl:[{pl:[g]}],m:[{m:[y]}],mx:[{mx:[y]}],my:[{my:[y]}],ms:[{ms:[y]}],me:[{me:[y]}],mt:[{mt:[y]}],mr:[{mr:[y]}],mb:[{mb:[y]}],ml:[{ml:[y]}],"space-x":[{"space-x":[j]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[j]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit","svw","lvw","dvw",ke,t]}],"min-w":[{"min-w":[ke,t,"min","max","fit"]}],"max-w":[{"max-w":[ke,t,"none","full","min","max","fit","prose",{screen:[bn]},bn]}],h:[{h:[ke,t,"auto","min","max","fit","svh","lvh","dvh"]}],"min-h":[{"min-h":[ke,t,"min","max","fit","svh","lvh","dvh"]}],"max-h":[{"max-h":[ke,t,"min","max","fit","svh","lvh","dvh"]}],size:[{size:[ke,t,"auto","min","max","fit"]}],"font-size":[{text:["base",bn,wn]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",bc]}],"font-family":[{font:[Ia]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",ke]}],"line-clamp":[{"line-clamp":["none",Zs,bc]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",Kr,ke]}],"list-image":[{"list-image":["none",ke]}],"list-style-type":[{list:["none","disc","decimal",ke]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[e]}],"placeholder-opacity":[{"placeholder-opacity":[p]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[e]}],"text-opacity":[{"text-opacity":[p]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...je(),"wavy"]}],"text-decoration-thickness":[{decoration:["auto","from-font",Kr,wn]}],"underline-offset":[{"underline-offset":["auto",Kr,ke]}],"text-decoration-color":[{decoration:[e]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:z()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",ke]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",ke]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[p]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[...ue(),Vw]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",Hw]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},Xw]}],"bg-color":[{bg:[e]}],"gradient-from-pos":[{from:[v]}],"gradient-via-pos":[{via:[v]}],"gradient-to-pos":[{to:[v]}],"gradient-from":[{from:[m]}],"gradient-via":[{via:[m]}],"gradient-to":[{to:[m]}],rounded:[{rounded:[i]}],"rounded-s":[{"rounded-s":[i]}],"rounded-e":[{"rounded-e":[i]}],"rounded-t":[{"rounded-t":[i]}],"rounded-r":[{"rounded-r":[i]}],"rounded-b":[{"rounded-b":[i]}],"rounded-l":[{"rounded-l":[i]}],"rounded-ss":[{"rounded-ss":[i]}],"rounded-se":[{"rounded-se":[i]}],"rounded-ee":[{"rounded-ee":[i]}],"rounded-es":[{"rounded-es":[i]}],"rounded-tl":[{"rounded-tl":[i]}],"rounded-tr":[{"rounded-tr":[i]}],"rounded-br":[{"rounded-br":[i]}],"rounded-bl":[{"rounded-bl":[i]}],"border-w":[{border:[o]}],"border-w-x":[{"border-x":[o]}],"border-w-y":[{"border-y":[o]}],"border-w-s":[{"border-s":[o]}],"border-w-e":[{"border-e":[o]}],"border-w-t":[{"border-t":[o]}],"border-w-r":[{"border-r":[o]}],"border-w-b":[{"border-b":[o]}],"border-w-l":[{"border-l":[o]}],"border-opacity":[{"border-opacity":[p]}],"border-style":[{border:[...je(),"hidden"]}],"divide-x":[{"divide-x":[o]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[o]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[p]}],"divide-style":[{divide:je()}],"border-color":[{border:[a]}],"border-color-x":[{"border-x":[a]}],"border-color-y":[{"border-y":[a]}],"border-color-s":[{"border-s":[a]}],"border-color-e":[{"border-e":[a]}],"border-color-t":[{"border-t":[a]}],"border-color-r":[{"border-r":[a]}],"border-color-b":[{"border-b":[a]}],"border-color-l":[{"border-l":[a]}],"divide-color":[{divide:[a]}],"outline-style":[{outline:["",...je()]}],"outline-offset":[{"outline-offset":[Kr,ke]}],"outline-w":[{outline:[Kr,wn]}],"outline-color":[{outline:[e]}],"ring-w":[{ring:ne()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[e]}],"ring-opacity":[{"ring-opacity":[p]}],"ring-offset-w":[{"ring-offset":[Kr,wn]}],"ring-offset-color":[{"ring-offset":[e]}],shadow:[{shadow:["","inner","none",bn,Kw]}],"shadow-color":[{shadow:[Ia]}],opacity:[{opacity:[p]}],"mix-blend":[{"mix-blend":[...q(),"plus-lighter","plus-darker"]}],"bg-blend":[{"bg-blend":q()}],filter:[{filter:["","none"]}],blur:[{blur:[r]}],brightness:[{brightness:[n]}],contrast:[{contrast:[c]}],"drop-shadow":[{"drop-shadow":["","none",bn,ke]}],grayscale:[{grayscale:[d]}],"hue-rotate":[{"hue-rotate":[u]}],invert:[{invert:[f]}],saturate:[{saturate:[w]}],sepia:[{sepia:[P]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[r]}],"backdrop-brightness":[{"backdrop-brightness":[n]}],"backdrop-contrast":[{"backdrop-contrast":[c]}],"backdrop-grayscale":[{"backdrop-grayscale":[d]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[u]}],"backdrop-invert":[{"backdrop-invert":[f]}],"backdrop-opacity":[{"backdrop-opacity":[p]}],"backdrop-saturate":[{"backdrop-saturate":[w]}],"backdrop-sepia":[{"backdrop-sepia":[P]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[l]}],"border-spacing-x":[{"border-spacing-x":[l]}],"border-spacing-y":[{"border-spacing-y":[l]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",ke]}],duration:[{duration:te()}],ease:[{ease:["linear","in","out","in-out",ke]}],delay:[{delay:te()}],animate:[{animate:["none","spin","ping","pulse","bounce",ke]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[b]}],"scale-x":[{"scale-x":[b]}],"scale-y":[{"scale-y":[b]}],rotate:[{rotate:[Ra,ke]}],"translate-x":[{"translate-x":[O]}],"translate-y":[{"translate-y":[O]}],"skew-x":[{"skew-x":[M]}],"skew-y":[{"skew-y":[M]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",ke]}],accent:[{accent:["auto",e]}],appearance:[{appearance:["none","auto"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",ke]}],"caret-color":[{caret:[e]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":z()}],"scroll-mx":[{"scroll-mx":z()}],"scroll-my":[{"scroll-my":z()}],"scroll-ms":[{"scroll-ms":z()}],"scroll-me":[{"scroll-me":z()}],"scroll-mt":[{"scroll-mt":z()}],"scroll-mr":[{"scroll-mr":z()}],"scroll-mb":[{"scroll-mb":z()}],"scroll-ml":[{"scroll-ml":z()}],"scroll-p":[{"scroll-p":z()}],"scroll-px":[{"scroll-px":z()}],"scroll-py":[{"scroll-py":z()}],"scroll-ps":[{"scroll-ps":z()}],"scroll-pe":[{"scroll-pe":z()}],"scroll-pt":[{"scroll-pt":z()}],"scroll-pr":[{"scroll-pr":z()}],"scroll-pb":[{"scroll-pb":z()}],"scroll-pl":[{"scroll-pl":z()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",ke]}],fill:[{fill:[e,"none"]}],"stroke-w":[{stroke:[Kr,wn,bc]}],stroke:[{stroke:[e,"none"]}],sr:["sr-only","not-sr-only"],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}},Zw=Rw(Qw);function Pu(...e){return Zw(bw(e))}const bp="http://localhost:5000",we={register:"/api/users/register",login:"/api/users/login",users:"/api/users",projects:"/api/projects",tasks:e=>`/api/projects/${e}/tasks`,expenses:"/api/expenses",timesheets:"/api/timesheets",salesOrders:"/api/sales-orders",purchaseOrders:"/api/purchase-orders",customerInvoices:"/api/customer-invoices",vendorBills:"/api/vendor-bills",dashboard:{stats:"/api/dashboard/stats",projects:"/api/dashboard/projects"}},be=async(e,t={})=>{const r=`${bp}${e}`,n=localStorage.getItem("user");let a,i,l;if(n)try{const c=JSON.parse(n);a=c==null?void 0:c.role,i=(c==null?void 0:c.id)||(c==null?void 0:c.user_id),l=c==null?void 0:c.email}catch{}const o={headers:{"Content-Type":"application/json",...a?{"x-user-role":a}:{},...i?{"x-user-id":i}:{},...l?{"x-user-email":l}:{}}};try{return await(await fetch(r,{...o,...t,headers:{...o.headers,...t.headers}})).json()}catch(c){throw console.error("API call error:",c),c}},eb=e=>{localStorage.setItem("user",JSON.stringify(e))},Gr=()=>{const e=localStorage.getItem("user");return e?JSON.parse(e):null},Lf=()=>{localStorage.removeItem("user")},yr={getAll:async()=>await be(we.projects,{method:"GET"}),getById:async e=>await be(`${we.projects}/${e}`,{method:"GET"}),create:async e=>await be(we.projects,{method:"POST",body:JSON.stringify(e)}),update:async(e,t)=>await be(`${we.projects}/${e}`,{method:"PUT",body:JSON.stringify(t)}),delete:async e=>await be(`${we.projects}/${e}`,{method:"DELETE"})},pr={getAll:async(e={})=>{const t=new URLSearchParams;Object.keys(e).forEach(n=>{e[n]!==void 0&&e[n]!==null&&e[n]!==""&&(Array.isArray(e[n])?e[n].forEach(a=>t.append(n,a)):t.append(n,e[n]))});const r=t.toString();return await be(`${we.expenses}${r?"?"+r:""}`,{method:"GET"})},getStats:async(e={})=>{const t=new URLSearchParams;Object.keys(e).forEach(n=>{e[n]!==void 0&&e[n]!==null&&e[n]!==""&&t.append(n,e[n])});const r=t.toString();return await be(`${we.expenses}/stats${r?"?"+r:""}`,{method:"GET"})},getById:async e=>await be(`${we.expenses}/${e}`,{method:"GET"}),create:async e=>await be(we.expenses,{method:"POST",body:JSON.stringify(e)}),update:async(e,t)=>await be(`${we.expenses}/${e}`,{method:"PUT",body:JSON.stringify(t)}),approve:async e=>await be(`${we.expenses}/${e}/approve`,{method:"PATCH"}),reject:async(e,t)=>await be(`${we.expenses}/${e}/reject`,{method:"PATCH",body:JSON.stringify({reason:t})}),addToInvoice:async(e,t)=>await be(`${we.expenses}/${e}/add-to-invoice`,{method:"PATCH",body:JSON.stringify(t)}),bulkApprove:async e=>await be(`${we.expenses}/bulk-approve`,{method:"POST",body:JSON.stringify({expense_ids:e})}),bulkReject:async(e,t)=>await be(`${we.expenses}/bulk-reject`,{method:"POST",body:JSON.stringify({expense_ids:e,reason:t})}),uploadReceipt:async e=>{const t=new FormData;t.append("receipt",e);const r=`${bp}${we.expenses}/upload-receipt`;try{return await(await fetch(r,{method:"POST",body:t})).json()}catch(n){throw console.error("Receipt upload error:",n),n}}},tb={getAll:async()=>await be(we.users,{method:"GET"}),getByEmail:async e=>await be(`${we.users}/${e}`,{method:"GET"})},za={getAll:async e=>await be(we.tasks(e),{method:"GET"}),create:async(e,t)=>await be(we.tasks(e),{method:"POST",body:JSON.stringify(t)}),update:async(e,t,r)=>await be(`${we.tasks(e)}/${t}`,{method:"PUT",body:JSON.stringify(r)})},$r={getAll:async(e={})=>{const t=new URLSearchParams;Object.keys(e).forEach(n=>{e[n]!==void 0&&e[n]!==null&&e[n]!==""&&(Array.isArray(e[n])?e[n].forEach(a=>t.append(n,a)):t.append(n,e[n]))});const r=t.toString();return await be(`${we.timesheets}${r?"?"+r:""}`,{method:"GET"})},getStats:async(e={})=>{const t=new URLSearchParams;Object.keys(e).forEach(n=>{e[n]!==void 0&&e[n]!==null&&e[n]!==""&&t.append(n,e[n])});const r=t.toString();return await be(`${we.timesheets}/stats${r?"?"+r:""}`,{method:"GET"})},getById:async e=>await be(`${we.timesheets}/${e}`,{method:"GET"}),create:async e=>await be(we.timesheets,{method:"POST",body:JSON.stringify(e)}),update:async(e,t)=>await be(`${we.timesheets}/${e}`,{method:"PUT",body:JSON.stringify(t)}),approve:async e=>await be(`${we.timesheets}/${e}/approve`,{method:"PATCH"}),reject:async(e,t)=>await be(`${we.timesheets}/${e}/reject`,{method:"PATCH",body:JSON.stringify({reason:t})}),bulkApprove:async e=>await be(`${we.timesheets}/bulk-approve`,{method:"POST",body:JSON.stringify({timesheet_ids:e})}),bulkReject:async(e,t)=>await be(`${we.timesheets}/bulk-reject`,{method:"POST",body:JSON.stringify({timesheet_ids:e,reason:t})}),getUserRates:async(e,t)=>{const r=new URLSearchParams;t&&r.append("date",t);const n=r.toString();return await be(`${we.timesheets}/user-rates/${e}${n?"?"+n:""}`,{method:"GET"})}},qr={getAll:async(e={})=>{const t=new URLSearchParams;Object.keys(e).forEach(n=>{e[n]!==void 0&&e[n]!==null&&e[n]!==""&&(Array.isArray(e[n])?e[n].forEach(a=>t.append(n,a)):t.append(n,e[n]))});const r=t.toString();return await be(`${we.salesOrders}${r?"?"+r:""}`,{method:"GET"})},getStats:async(e={})=>{const t=new URLSearchParams;Object.keys(e).forEach(n=>{e[n]!==void 0&&e[n]!==null&&e[n]!==""&&t.append(n,e[n])});const r=t.toString();return await be(`${we.salesOrders}/stats${r?"?"+r:""}`,{method:"GET"})},getById:async e=>await be(`${we.salesOrders}/${e}`,{method:"GET"}),create:async e=>await be(we.salesOrders,{method:"POST",body:JSON.stringify(e)}),update:async(e,t)=>await be(`${we.salesOrders}/${e}`,{method:"PUT",body:JSON.stringify(t)}),confirm:async e=>await be(`${we.salesOrders}/${e}/confirm`,{method:"PATCH"}),cancel:async e=>await be(`${we.salesOrders}/${e}/cancel`,{method:"PATCH"})},Qr={getAll:async(e={})=>{const t=new URLSearchParams;Object.keys(e).forEach(n=>{e[n]!==void 0&&e[n]!==null&&e[n]!==""&&(Array.isArray(e[n])?e[n].forEach(a=>t.append(n,a)):t.append(n,e[n]))});const r=t.toString();return await be(`${we.purchaseOrders}${r?"?"+r:""}`,{method:"GET"})},getStats:async(e={})=>{const t=new URLSearchParams;Object.keys(e).forEach(n=>{e[n]!==void 0&&e[n]!==null&&e[n]!==""&&t.append(n,e[n])});const r=t.toString();return await be(`${we.purchaseOrders}/stats${r?"?"+r:""}`,{method:"GET"})},getById:async e=>await be(`${we.purchaseOrders}/${e}`,{method:"GET"}),create:async e=>await be(we.purchaseOrders,{method:"POST",body:JSON.stringify(e)}),update:async(e,t)=>await be(`${we.purchaseOrders}/${e}`,{method:"PUT",body:JSON.stringify(t)}),confirm:async e=>await be(`${we.purchaseOrders}/${e}/confirm`,{method:"PATCH"}),cancel:async e=>await be(`${we.purchaseOrders}/${e}/cancel`,{method:"PATCH"})},Zr={getAll:async(e={})=>{const t=new URLSearchParams;Object.keys(e).forEach(n=>{e[n]!==void 0&&e[n]!==null&&e[n]!==""&&(Array.isArray(e[n])?e[n].forEach(a=>t.append(n,a)):t.append(n,e[n]))});const r=t.toString();return await be(`${we.customerInvoices}${r?"?"+r:""}`,{method:"GET"})},getStats:async(e={})=>{const t=new URLSearchParams;Object.keys(e).forEach(n=>{e[n]!==void 0&&e[n]!==null&&e[n]!==""&&t.append(n,e[n])});const r=t.toString();return await be(`${we.customerInvoices}/stats${r?"?"+r:""}`,{method:"GET"})},getById:async e=>await be(`${we.customerInvoices}/${e}`,{method:"GET"}),create:async e=>await be(we.customerInvoices,{method:"POST",body:JSON.stringify(e)}),update:async(e,t)=>await be(`${we.customerInvoices}/${e}`,{method:"PUT",body:JSON.stringify(t)}),post:async e=>await be(`${we.customerInvoices}/${e}/post`,{method:"PATCH"}),cancel:async e=>await be(`${we.customerInvoices}/${e}/cancel`,{method:"PATCH"})},en={getAll:async(e={})=>{const t=new URLSearchParams;Object.keys(e).forEach(n=>{e[n]!==void 0&&e[n]!==null&&e[n]!==""&&(Array.isArray(e[n])?e[n].forEach(a=>t.append(n,a)):t.append(n,e[n]))});const r=t.toString();return await be(`${we.vendorBills}${r?"?"+r:""}`,{method:"GET"})},getStats:async(e={})=>{const t=new URLSearchParams;Object.keys(e).forEach(n=>{e[n]!==void 0&&e[n]!==null&&e[n]!==""&&t.append(n,e[n])});const r=t.toString();return await be(`${we.vendorBills}/stats${r?"?"+r:""}`,{method:"GET"})},getById:async e=>await be(`${we.vendorBills}/${e}`,{method:"GET"}),create:async e=>await be(we.vendorBills,{method:"POST",body:JSON.stringify(e)}),update:async(e,t)=>await be(`${we.vendorBills}/${e}`,{method:"PUT",body:JSON.stringify(t)}),post:async e=>await be(`${we.vendorBills}/${e}/post`,{method:"PATCH"}),cancel:async e=>await be(`${we.vendorBills}/${e}/cancel`,{method:"PATCH"})},Mf={getStats:async()=>await be(we.dashboard.stats,{method:"GET"}),getProjects:async(e=null)=>{const t=new URLSearchParams;e&&t.append("status",e);const r=t.toString();return await be(`${we.dashboard.projects}${r?"?"+r:""}`,{method:"GET"})}},Np="/assets/logo-C-p5O994.png",rb=[{icon:dw,label:"Dashboard",path:"/dashboard"},{icon:wt,label:"Projects",path:"/projects"},{icon:pw,label:"Tasks",path:"/tasks"},{icon:Ro,label:"Expenses",path:"/expenses"},{icon:$t,label:"Timesheets",path:"/timesheets"}],Nc={icon:hp,label:"Settings",path:"/settings"};function nb(){const e=ga(),t=Jn(),[r,n]=T.useState(!1),[a,i]=T.useState(null),l=T.useState(null);T.useEffect(()=>{const g=Gr();i(g)},[]);const o=()=>{l.current&&clearTimeout(l.current),n(!0)},c=()=>{l.current=setTimeout(()=>{n(!1)},100)},d=g=>{if(!g)return"U";const w=g.trim().split(" ");return w.length===1?w[0].charAt(0).toUpperCase():(w[0].charAt(0)+w[w.length-1].charAt(0)).toUpperCase()},u=()=>(a==null?void 0:a.role)||"Project Manager",f=g=>{const w=`/app${g}`;return e.pathname===w},h=()=>{Lf(),t("/")},m=()=>{Lf(),t("/")},v=({item:g,isActive:w})=>{const b=g.icon;return s.jsxs(eo,{to:`/app${g.path}`,className:Pu("flex items-center gap-2 px-4 py-2 rounded-lg transition-colors text-sm",w?"bg-gray-100 text-gray-900 font-medium":"text-gray-700 hover:bg-gray-50"),children:[s.jsx(b,{className:"w-4 h-4"}),s.jsx("span",{children:g.label})]})},x=((a==null?void 0:a.role)||"").toLowerCase(),y=rb,p=x!=="employee";return s.jsx("nav",{className:"bg-white border-b border-gray-200 px-6 py-3 sticky top-0 z-40",children:s.jsxs("div",{className:"flex items-center justify-between max-w-full",children:[s.jsx("div",{className:"flex items-center gap-3 flex-shrink-0",children:s.jsx("img",{src:Np,alt:"OneFlow Logo",className:"h-20 w-auto cursor-pointer",onClick:h,title:"Logout"})}),s.jsxs("div",{className:"flex items-center gap-1 flex-1 justify-center overflow-x-auto overflow-y-visible",children:[y.map(g=>s.jsx(v,{item:g,isActive:f(g.path)},g.path)),p&&s.jsx(v,{item:Nc,isActive:f(Nc.path)},Nc.path),s.jsx(v,{item:{icon:cp,label:"Notifications",path:"/notifications"},isActive:f("/notifications")},"/notifications")]}),s.jsx("div",{className:"flex items-center gap-3 flex-shrink-0",children:s.jsxs("div",{className:"relative",onMouseEnter:o,onMouseLeave:c,children:[s.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 rounded-lg hover:bg-gray-50 cursor-pointer",children:[s.jsx("div",{className:"w-9 h-9 bg-[#714b67] rounded-full flex items-center justify-center",children:s.jsx("span",{className:"text-white font-semibold text-sm",children:d(a==null?void 0:a.full_name)})}),s.jsx(Wn,{className:"w-4 h-4 text-gray-400"})]}),r&&s.jsxs("div",{className:"absolute right-0 top-full w-56 bg-white rounded-lg shadow-lg border border-gray-200 py-2 z-50 mt-1",children:[s.jsxs("div",{className:"px-4 py-3 border-b border-gray-100",children:[s.jsx("p",{className:"text-sm font-semibold text-gray-900",children:(a==null?void 0:a.full_name)||"User"}),s.jsx("p",{className:"text-xs text-gray-500 mt-1",children:u()}),s.jsx("p",{className:"text-xs text-gray-400 mt-1",children:a==null?void 0:a.email})]}),s.jsxs("button",{onClick:m,className:"w-full px-4 py-2 text-left text-sm text-red-600 hover:bg-red-50 flex items-center gap-2 transition-colors",children:[s.jsx(hw,{className:"w-4 h-4"}),"Logout"]})]})]})})]})})}function sb(){return s.jsxs("div",{className:"flex flex-col min-h-screen bg-white",children:[s.jsx(nb,{}),s.jsx("main",{className:"flex-1 overflow-y-auto",children:s.jsx(z2,{})})]})}const ab={Weekly:"bg-gray-100 text-gray-700",Monthly:"bg-gray-100 text-gray-700",Product:"bg-gray-100 text-gray-700",Business:"bg-gray-100 text-gray-700",Personal:"bg-gray-100 text-gray-700"};function ib({note:e}){const t=a=>a.split(" ").map(i=>i[0]).join("").toUpperCase().slice(0,2),r=a=>{const i=["bg-gray-400","bg-gray-500","bg-gray-600","bg-gray-700","bg-gray-800"],l=a.split("").reduce((o,c)=>o+c.charCodeAt(0),0);return i[l%i.length]},n=()=>e.image?e.image==="document"?s.jsx("div",{className:"mt-3 rounded-lg overflow-hidden bg-gray-100 h-32 flex items-center justify-center",children:s.jsxs("div",{className:"text-center",children:[s.jsx("svg",{className:"w-12 h-12 mx-auto text-gray-400 mb-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),s.jsx("p",{className:"text-xs text-gray-500",children:"Document"})]})}):e.image==="chart"?s.jsx("div",{className:"mt-3 rounded-lg overflow-hidden bg-gray-100 h-32 flex items-center justify-center",children:s.jsx("div",{className:"w-full h-full p-4",children:s.jsx("div",{className:"flex items-end justify-between h-full gap-2",children:[40,60,45,80,55,70,90].map((a,i)=>s.jsx("div",{className:"flex-1 bg-gray-600 rounded-t",style:{height:`${a}%`}},i))})})}):e.image==="products"?s.jsx("div",{className:"mt-3 rounded-lg overflow-hidden bg-gray-100 h-32 flex items-center justify-center",children:s.jsx("div",{className:"grid grid-cols-3 gap-2 p-4",children:[1,2,3,4,5,6].map(a=>s.jsx("div",{className:"w-full h-12 bg-white rounded border border-gray-200"},a))})}):null:null;return s.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-5 hover:shadow-md transition-shadow cursor-pointer shadow-sm",children:[s.jsx("div",{className:"flex flex-wrap gap-2 mb-3",children:e.badges.map(a=>s.jsx("span",{className:`px-2.5 py-1 rounded-full text-xs font-medium ${ab[a]||"bg-gray-100 text-gray-700"}`,children:a},a))}),s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:e.title}),e.description&&s.jsx("p",{className:"text-sm text-gray-600 mb-3 line-clamp-3",children:e.description}),n(),s.jsxs("div",{className:"flex items-center justify-between mt-4 pt-4 border-t border-gray-100",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:`w-8 h-8 ${r(e.user.name)} rounded-full flex items-center justify-center`,children:s.jsx("span",{className:"text-xs font-semibold text-white",children:t(e.user.name)})}),s.jsx("span",{className:"text-sm text-gray-600",children:e.user.name})]}),s.jsx("span",{className:"text-xs text-gray-500",children:e.date})]})]})}const lb=[{id:1,title:"Product Team Meeting",description:"This monthly progress agenda is following this items: Introduction to Newest Product Plan, Monthly Revenue updates for each.",badges:["Weekly","Product"],user:{name:"Floyd Miles",avatar:"FM"},date:"Mar 5 04:25",image:null},{id:2,title:"Product Team Meeting",description:"This monthly progress agenda is following this items: Introduction to Newest Product Plan, Monthly Revenue updates for each.",badges:["Monthly","Business"],user:{name:"Dianne Russell",avatar:"DR"},date:"Apr 11 18:30",image:null},{id:3,title:"HR Interview",description:"This monthly progress agenda is following this items: Introduction to Newest Product Plan, Monthly Revenue updates for each.",badges:["Personal","Business"],user:{name:"Annette Black",avatar:"AB"},date:"Jun 23 14:31",image:null},{id:4,title:"Monthly Team Progress",description:"This monthly progress agenda is following this items: Introduction to Newest Product Plan, Monthly Revenue updates for each.",badges:["Monthly","Product"],user:{name:"Robert Fox",avatar:"RF"},date:"Jan 31 09:53",image:null},{id:5,title:"Product Team Meeting",description:"Some Summaries of this weeks meeting with some conclusion we get: Some of our product uploaded improved",badges:["Monthly","Business"],user:{name:"Brooklyn Simmons",avatar:"BS"},date:"Aug 15 10:29",image:null},{id:6,title:"Document Images",description:"Report Document of Weekly Meetings.",badges:["Personal"],user:{name:"Cameron Williamson",avatar:"CW"},date:"Dec 30 21:28",image:"document"},{id:7,title:"Weekly Team Progress",description:"This weekly progress agenda is following this items: Introduction to Newest Product Plan, Monthly Revenue updates for each.",badges:["Weekly","Product"],user:{name:"Dianne Russell",avatar:"DR"},date:"Feb 4 19:08",image:null},{id:8,title:"Revenue Progress",description:"",badges:["Business"],user:{name:"Ronald Richards",avatar:"RR"},date:"May 22 04:43",image:"chart"},{id:9,title:"Monthly Products",description:"Report Document of Weekly Meetings.",badges:["Product"],user:{name:"Albert Flores",avatar:"AF"},date:"Oct 4 15:49",image:"products"}];function ob(){return s.jsxs("div",{className:"h-full bg-gray-50",children:[s.jsx("header",{className:"bg-white border-b border-gray-200 px-8 py-6",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-6 flex-1",children:[s.jsx("h1",{className:"text-2xl font-semibold text-gray-900",children:"Notes"}),s.jsxs("div",{className:"relative flex-1 max-w-md",children:[s.jsx(pn,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),s.jsx("input",{type:"text",placeholder:"Q Search",className:"w-full pl-10 pr-4 py-2.5 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-400 focus:border-transparent text-sm"})]}),s.jsx("a",{href:"#",className:"text-sm text-gray-600 hover:text-gray-900",children:"Help Center"})]}),s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsxs("div",{className:"flex items-center gap-2 cursor-pointer hover:bg-gray-50 rounded-lg px-3 py-2",children:[s.jsx("div",{className:"w-8 h-8 bg-gray-700 rounded-full flex items-center justify-center",children:s.jsx("span",{className:"text-white font-semibold text-sm",children:"BF"})}),s.jsx("span",{className:"text-sm font-medium text-gray-900",children:"Brian F."}),s.jsx(Wn,{className:"w-4 h-4 text-gray-400"})]}),s.jsx("button",{className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white rounded-lg hover:bg-gray-50",style:{border:"1.5px solid #714b67"},children:"Sort By"}),s.jsx("button",{className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white rounded-lg hover:bg-gray-50",style:{border:"1.5px solid #714b67"},children:"Filter"}),s.jsx("button",{className:"px-4 py-2 text-sm font-medium text-white rounded-lg hover:opacity-90 transition-opacity",style:{backgroundColor:"#714b67"},children:"+ Add Notes"})]})]})}),s.jsx("div",{className:"p-8",children:s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 max-w-7xl mx-auto",children:lb.map(e=>s.jsx(ib,{note:e},e.id))})})]})}function cb({project:e,onEdit:t,onDelete:r,onOpen:n}){var l;const[a,i]=T.useState(!1);return s.jsxs("div",{onClick:o=>{try{if(o.target instanceof Element&&o.target.closest(".kebab"))return}catch{}n&&n()},className:"bg-white rounded-lg shadow-sm hover:shadow-md transition-transform transform hover:-translate-y-1 p-4 cursor-pointer w-full",children:[s.jsxs("div",{className:"flex items-start justify-between",children:[s.jsx("div",{className:"flex-1"}),(t||r)&&s.jsxs("div",{className:"relative kebab",children:[s.jsx("button",{onClick:o=>{o.stopPropagation(),i(c=>!c)},className:"p-1 rounded hover:bg-gray-100",children:s.jsx(ns,{className:"w-4 h-4 text-gray-600"})}),a&&s.jsxs("div",{onClick:o=>o.stopPropagation(),className:"absolute right-0 mt-2 bg-white border rounded shadow z-20",children:[s.jsx("button",{onClick:()=>{i(!1),n&&n()},className:"block px-4 py-2 text-sm",children:"Open"}),t&&s.jsx("button",{onClick:()=>{i(!1),t&&t()},className:"block px-4 py-2 text-sm",children:"Edit"}),r&&s.jsx("button",{onClick:()=>{i(!1),r&&r()},className:"block px-4 py-2 text-sm text-red-600",children:"Delete"})]})]})]}),e.image&&e.image.base64&&s.jsx("div",{className:"mt-3",children:s.jsx("img",{src:e.image.base64,alt:e.name,className:"w-full h-32 object-cover rounded-lg"})}),e.image&&e.image.url&&s.jsx("div",{className:"mt-3",children:s.jsx("img",{src:`http://localhost:5000${e.image.url}`,alt:e.name,className:"w-full h-32 object-cover rounded-lg"})}),s.jsxs("div",{className:"mt-3",children:[s.jsx("h4",{className:"text-md font-semibold text-gray-900",children:e.name}),s.jsx("p",{className:"mt-3 text-sm text-gray-600 leading-relaxed",children:e.description})]}),s.jsxs("div",{className:"mt-4",children:[s.jsx("div",{className:"w-full bg-gray-100 rounded h-2 overflow-hidden",children:s.jsx("div",{className:"h-2 bg-purple-600",style:{width:`${e.progress??0}%`}})}),s.jsxs("div",{className:"flex items-center justify-between mt-2 text-sm text-gray-600",children:[s.jsxs("div",{children:[s.jsxs("div",{children:[e.start,"  ",e.due]}),s.jsxs("div",{className:"text-xs text-gray-500",children:[e.tasks," tasks"]})]}),s.jsx("div",{className:"flex items-center gap-2",children:s.jsx("div",{className:"w-8 h-8 rounded-full bg-gray-700 text-white flex items-center justify-center text-sm",children:(((l=e.manager)==null?void 0:l.name)||"").split(" ").map(o=>o[0]).join("").slice(0,2)})})]})]})]})}function ub({project:e,onClose:t,onCreate:r,onUpdate:n}){var m;const[a,i]=T.useState({name:"",status:"New",start:"",due:"",tasks:0,progress:0,manager:{name:""},description:"",image:null}),[l,o]=T.useState(null),[c,d]=T.useState(!1);T.useEffect(()=>{var v,x;e&&(i({...e}),(v=e.image)!=null&&v.base64?o(e.image.base64):(x=e.image)!=null&&x.url&&o(`http://localhost:5000${e.image.url}`))},[e]);function u(v){var p;const x=(p=v.target.files)==null?void 0:p[0];if(!x)return;if(!x.type.startsWith("image/")){alert("Please select an image file");return}if(x.size>5*1024*1024){alert("Image size must be less than 5MB");return}d(!0);const y=new FileReader;y.onloadend=()=>{const g=y.result;o(g),i(w=>({...w,image:{base64:g,filename:x.name,mimetype:x.type,size:x.size}})),d(!1)},y.onerror=()=>{alert("Failed to read image file"),d(!1)},y.readAsDataURL(x)}function f(){o(null),i(v=>({...v,image:null}))}function h(v){v.preventDefault();const x={...a};e&&e.id?n&&n(x):r&&r(x)}return s.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 overflow-y-auto",children:[s.jsx("div",{className:"absolute inset-0 bg-black opacity-30",onClick:t}),s.jsxs("form",{onSubmit:h,className:"relative bg-white rounded-lg shadow-lg w-full max-w-2xl z-10 my-8 flex flex-col max-h-[95vh]",children:[s.jsxs("div",{className:"flex items-center justify-between p-6 pb-4 border-b bg-white rounded-t-lg sticky top-0 z-10",children:[s.jsx("h3",{className:"text-lg font-semibold",children:e?"Edit Project":"New Project"}),s.jsx("button",{type:"button",onClick:t,children:s.jsx(ze,{className:"w-5 h-5 text-gray-600"})})]}),s.jsx("div",{className:"p-6 overflow-y-auto flex-1",children:s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm text-gray-700",children:"Name"}),s.jsx("input",{required:!0,value:a.name,onChange:v=>i(x=>({...x,name:v.target.value})),className:"mt-1 w-full border rounded px-3 py-2"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm text-gray-700",children:"Status"}),s.jsxs("select",{value:a.status,onChange:v=>i(x=>({...x,status:v.target.value})),className:"mt-1 w-full border rounded px-3 py-2",children:[s.jsx("option",{children:"New"}),s.jsx("option",{children:"In Progress"}),s.jsx("option",{children:"Completed"})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm text-gray-700",children:"Start"}),s.jsx("input",{type:"date",value:a.start,onChange:v=>i(x=>({...x,start:v.target.value})),className:"mt-1 w-full border rounded px-3 py-2"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm text-gray-700",children:"Due"}),s.jsx("input",{type:"date",value:a.due,onChange:v=>i(x=>({...x,due:v.target.value})),className:"mt-1 w-full border rounded px-3 py-2"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm text-gray-700",children:"Tasks"}),s.jsx("input",{type:"number",min:0,value:a.tasks,onChange:v=>i(x=>({...x,tasks:Number(v.target.value)})),className:"mt-1 w-full border rounded px-3 py-2"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm text-gray-700",children:"Manager Name"}),s.jsx("input",{value:((m=a.manager)==null?void 0:m.name)||"",onChange:v=>i(x=>({...x,manager:{...x.manager,name:v.target.value}})),className:"mt-1 w-full border rounded px-3 py-2"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm text-gray-700",children:"Progress (%)"}),s.jsx("input",{type:"number",min:0,max:100,value:a.progress,onChange:v=>i(x=>({...x,progress:Number(v.target.value)})),className:"mt-1 w-full border rounded px-3 py-2"})]}),s.jsxs("div",{className:"md:col-span-2",children:[s.jsx("label",{className:"block text-sm text-gray-700",children:"Description"}),s.jsx("textarea",{value:a.description,onChange:v=>i(x=>({...x,description:v.target.value})),className:"mt-1 w-full border rounded px-3 py-2 h-28"})]}),s.jsxs("div",{className:"md:col-span-2",children:[s.jsx("label",{className:"block text-sm text-gray-700 mb-2",children:"Project Image"}),l?s.jsxs("div",{className:"relative",children:[s.jsx("img",{src:l,alt:"Preview",className:"w-full h-48 object-cover rounded-lg border-2 border-gray-200"}),s.jsx("button",{type:"button",onClick:f,className:"absolute top-2 right-2 p-2 bg-red-500 text-white rounded-full hover:bg-red-600 transition-colors shadow-lg",title:"Remove image",children:s.jsx(I0,{className:"w-4 h-4"})})]}):s.jsxs("label",{className:"flex flex-col items-center justify-center w-full h-48 border-2 border-gray-300 border-dashed rounded-lg cursor-pointer bg-gray-50 hover:bg-gray-100 transition-colors",children:[s.jsxs("div",{className:"flex flex-col items-center justify-center pt-5 pb-6",children:[s.jsx(D0,{className:"w-10 h-10 mb-3 text-gray-400"}),s.jsxs("p",{className:"mb-2 text-sm text-gray-500",children:[s.jsx("span",{className:"font-semibold",children:"Click to upload"})," or drag and drop"]}),s.jsx("p",{className:"text-xs text-gray-500",children:"PNG, JPG, GIF up to 5MB"})]}),s.jsx("input",{type:"file",className:"hidden",accept:"image/*",onChange:u,disabled:c})]}),c&&s.jsx("p",{className:"mt-2 text-sm text-gray-500",children:"Uploading image..."})]})]})}),s.jsx("div",{className:"p-6 pt-4 border-t bg-white rounded-b-lg sticky bottom-0 z-10",children:s.jsxs("div",{className:"flex justify-end gap-3",children:[s.jsx("button",{type:"button",onClick:t,className:"px-4 py-2 rounded bg-white border hover:bg-gray-50 transition-colors",children:"Cancel"}),s.jsx("button",{type:"submit",className:"px-4 py-2 rounded text-white hover:opacity-90 transition-opacity",style:{backgroundColor:"#714b67"},children:e?"Save":"Create"})]})})]})]})}const db=["New","In Progress","Completed"];function fb(){const e=Jn(),[t,r]=T.useState([]),[n,a]=T.useState(""),[i,l]=T.useState("Newest"),[o,c]=T.useState(!1),[d,u]=T.useState(null),[f,h]=T.useState(null),[m,v]=T.useState(!0),[x,y]=T.useState(null),p=Gr(),g=((p==null?void 0:p.role)||"").toLowerCase()==="employee";T.useEffect(()=>{w()},[]);async function w(){try{v(!0),y(null);const I=await yr.getAll();I.success?r(I.data):y(I.message||"Failed to load projects")}catch(I){console.error("Error fetching projects:",I),y("Unable to connect to server. Please try again.")}finally{v(!1)}}function b(){g||(u(null),c(!0))}async function P(I){if(!g)try{const D=await yr.create(I);D.success?(await w(),c(!1),h("Project created successfully"),setTimeout(()=>h(null),2800)):(h(D.message||"Failed to create project"),setTimeout(()=>h(null),3e3))}catch(D){console.error("Error creating project:",D),h("Failed to create project. Please try again."),setTimeout(()=>h(null),3e3)}}async function M(I){if(!g)try{const D=await yr.update(I.id,I);D.success?(await w(),c(!1),h("Project updated successfully"),setTimeout(()=>h(null),2200)):(h(D.message||"Failed to update project"),setTimeout(()=>h(null),3e3))}catch(D){console.error("Error updating project:",D),h("Failed to update project. Please try again."),setTimeout(()=>h(null),3e3)}}async function j(I){if(!g&&window.confirm("Delete this project? This action cannot be undone."))try{const D=await yr.delete(I);D.success?(await w(),setSelectedProjectId(null),h("Project deleted successfully"),setTimeout(()=>h(null),2e3)):(h(D.message||"Failed to delete project"),setTimeout(()=>h(null),3e3))}catch(D){console.error("Error deleting project:",D),h("Failed to delete project. Please try again."),setTimeout(()=>h(null),3e3)}}const O=t.filter(I=>{const D=n.trim().toLowerCase();return D?`${I.name} ${I.description||""}`.toLowerCase().includes(D):!0});function R(I){return i==="Name"?I.sort((D,z)=>D.name.localeCompare(z.name)):i==="Progress"?I.sort((D,z)=>z.tasks-D.tasks):i==="Due"?I.sort((D,z)=>new Date(D.due||0)-new Date(z.due||0)):I.sort((D,z)=>new Date(z.start||0)-new Date(D.start||0))}return s.jsxs("div",{className:"h-full bg-gray-50",children:[s.jsx("header",{className:"bg-white border-b border-gray-200 px-8 py-6",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-6 flex-1",children:[s.jsx("h1",{className:"text-2xl font-semibold text-gray-900",children:"Projects"}),s.jsxs("div",{className:"relative flex-1 max-w-md",children:[s.jsx(pn,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),s.jsx("input",{value:n,onChange:I=>a(I.target.value),type:"text",placeholder:"Search projects",className:"w-full pl-10 pr-4 py-2.5 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-400 focus:border-transparent text-sm",disabled:m})]})]}),s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsxs("select",{value:i,onChange:I=>l(I.target.value),className:"px-3 py-2 rounded-lg text-sm border border-gray-200 bg-white",disabled:m,children:[s.jsx("option",{children:"Newest"}),s.jsx("option",{children:"Name"}),s.jsx("option",{children:"Progress"}),s.jsx("option",{children:"Due"})]}),!g&&s.jsxs("button",{onClick:b,className:"px-4 py-2 text-sm font-medium text-white rounded-lg hover:opacity-90 transition-opacity disabled:opacity-50",style:{backgroundColor:"#714b67"},disabled:m,children:[s.jsx(lr,{className:"inline w-4 h-4 mr-2"})," New Project"]})]})]})}),s.jsxs("div",{className:"p-6",children:[m&&s.jsx("div",{className:"flex items-center justify-center h-64",children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"inline-block animate-spin rounded-full h-12 w-12 border-b-2 border-gray-900 mb-4"}),s.jsx("p",{className:"text-gray-600",children:"Loading projects..."})]})}),x&&!m&&s.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 mb-4",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("svg",{className:"w-5 h-5 text-red-600",fill:"currentColor",viewBox:"0 0 20 20",children:s.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})}),s.jsx("span",{className:"text-red-800 font-medium",children:x})]}),s.jsx("button",{onClick:w,className:"text-red-600 hover:text-red-800 font-medium text-sm",children:"Retry"})]})}),!m&&!x&&s.jsx("div",{className:"flex gap-6 overflow-x-auto pb-6",children:db.map(I=>{const D=R(O.filter(z=>z.status===I));return s.jsxs("div",{className:"min-w-[300px] flex-shrink-0",children:[s.jsxs("div",{className:"flex items-center justify-between mb-3",children:[s.jsx("h3",{className:"text-lg font-medium text-gray-900",children:I}),s.jsx("div",{className:"text-sm text-gray-600",children:D.length})]}),s.jsx("div",{className:"space-y-4",children:D.map(z=>s.jsx(cb,{project:z,onEdit:g?void 0:()=>{u(z),c(!0)},onDelete:g?void 0:()=>j(z.id),onOpen:()=>e(`/app/projects/${z.id}`)},z.id))})]},I)})})]}),o&&s.jsx(ub,{project:d,onClose:()=>c(!1),onCreate:P,onUpdate:M}),f&&s.jsx("div",{className:"fixed right-6 bottom-6 bg-gray-900 text-white px-4 py-2 rounded shadow",children:f})]})}function hb(){var M;const{projectId:e}=E2(),t=Jn(),[r,n]=T.useState(null),[a,i]=T.useState([]),[l,o]=T.useState(!0),[c,d]=T.useState("overview"),u=Gr(),f=(u==null?void 0:u.role)==="employee";T.useEffect(()=>{e&&h()},[e]);const h=async()=>{try{o(!0);const[j,O]=await Promise.all([yr.getById(e),za.getAll(e)]);j.success&&n(j.data),O.success&&i(O.data)}catch(j){console.error("Error loading project details:",j)}finally{o(!1)}},m=()=>{if(!r||!a)return null;const j=a.length,O=a.filter(E=>E.state==="done").length,R=a.filter(E=>E.state==="in_progress").length,I=a.filter(E=>E.state==="blocked").length,D=a.filter(E=>E.due_date&&new Date(E.due_date)<new Date&&E.state!=="done").length,z=a.reduce((E,B)=>E+(B.estimate_hours||0),0),ne=a.filter(E=>E.state==="done").reduce((E,B)=>E+(B.estimate_hours||0),0),Ne=j>0?Math.round(O/j*100):0,ue=r.budget||0,je=ue*(r.progress/100)||0,q=ue-je,W=ue*1.3,k=je,K=W-ue,te=W*(r.progress/100)-k;return{totalTasks:j,completedTasks:O,inProgressTasks:R,blockedTasks:I,delayedTasks:D,taskCompletionRate:Ne,totalEstimatedHours:z,completedHours:ne,budgetAmount:ue,budgetUsed:je,budgetRemaining:q,budgetUsagePercent:ue>0?Math.round(je/ue*100):0,estimatedRevenue:W,actualCost:k,estimatedProfit:K,currentProfit:te,profitMargin:W>0?Math.round(K/W*100):0}},v=j=>({planned:"bg-blue-100 text-blue-700 border-blue-200",in_progress:"bg-yellow-100 text-yellow-700 border-yellow-200",New:"bg-blue-100 text-blue-700 border-blue-200","In Progress":"bg-yellow-100 text-yellow-700 border-yellow-200",Completed:"bg-green-100 text-green-700 border-green-200",completed:"bg-green-100 text-green-700 border-green-200",on_hold:"bg-gray-100 text-gray-700 border-gray-200"})[j]||"bg-gray-100 text-gray-700 border-gray-200",x=j=>({todo:"bg-gray-100 text-gray-700",in_progress:"bg-blue-100 text-blue-700",done:"bg-green-100 text-green-700",blocked:"bg-red-100 text-red-700"})[j]||"bg-gray-100 text-gray-700",y=j=>({low:"text-gray-600",medium:"text-yellow-600",high:"text-orange-600",critical:"text-red-600"})[j]||"text-gray-600",p=j=>{if(!j)return{level:"Low",color:"text-green-600",bgColor:"bg-green-50"};let O=0;return j.delayedTasks>0&&(O+=2),j.blockedTasks>0&&(O+=1),j.budgetUsagePercent>90?O+=2:j.budgetUsagePercent>75&&(O+=1),j.taskCompletionRate<30&&(O+=1),O>=4?{level:"High",color:"text-red-600",bgColor:"bg-red-50"}:O>=2?{level:"Medium",color:"text-yellow-600",bgColor:"bg-yellow-50"}:{level:"Low",color:"text-green-600",bgColor:"bg-green-50"}},g=j=>`${j.toLocaleString()}`,w=j=>j?new Date(j).toLocaleDateString("en-GB",{day:"2-digit",month:"short",year:"numeric"}):"Not set";if(l)return s.jsx("div",{className:"h-full bg-gray-50 flex items-center justify-center",children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-[#714b67] mx-auto mb-4"}),s.jsx("p",{className:"text-gray-600",children:"Loading project details..."})]})});if(!r)return s.jsx("div",{className:"h-full bg-gray-50 flex items-center justify-center",children:s.jsxs("div",{className:"text-center",children:[s.jsx("p",{className:"text-gray-600",children:"Project not found"}),s.jsx("button",{onClick:()=>t("/app/projects"),className:"mt-4 px-4 py-2 bg-[#714b67] text-white rounded-lg hover:bg-[#5a3a52]",children:"Back to Projects"})]})});const b=m(),P=p(b);return s.jsxs("div",{className:"h-full bg-gray-50 overflow-auto",children:[s.jsxs("div",{className:"bg-gradient-to-r from-[#714b67] to-[#8a5a7f] text-white sticky top-0 z-10 shadow-md",children:[s.jsxs("div",{className:"px-8 py-6",children:[s.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[s.jsx("button",{onClick:()=>t("/app/projects"),className:"p-2 hover:bg-white hover:bg-opacity-20 rounded-lg transition-colors",children:s.jsx(aw,{className:"w-6 h-6"})}),s.jsx("div",{className:"flex-1",children:s.jsx("h1",{className:"text-3xl font-bold text-white",children:r.name})})]}),s.jsxs("div",{className:"flex items-center gap-4 text-sm text-white ml-14",children:[s.jsx("span",{className:`px-3 py-1 rounded-full border ${v(r.status)} bg-white`,children:r.status}),s.jsxs("span",{className:"flex items-center gap-1 text-white",children:[s.jsx(ji,{className:"w-4 h-4"}),w(r.start)," - ",w(r.due)]}),s.jsxs("span",{className:"flex items-center gap-1 text-white",children:[s.jsx(Au,{className:"w-4 h-4"}),((M=r.manager)==null?void 0:M.name)||"Unassigned"]})]})]}),s.jsx("div",{className:"px-8 pb-4",children:s.jsx("div",{className:"flex gap-2",children:(()=>{const j=[{id:"overview",label:"Overview",icon:nw},{id:"tasks",label:"Tasks",icon:Qe}];return f||j.push({id:"financials",label:"Financials",icon:Cu}),j})().map(j=>{const O=j.icon;return s.jsxs("button",{onClick:()=>d(j.id),className:`px-6 py-2.5 flex items-center gap-2 font-medium transition-all rounded-lg ${c===j.id?"bg-white text-[#714b67] shadow-md":"bg-white bg-opacity-20 text-white hover:bg-opacity-30"}`,children:[s.jsx(O,{className:"w-4 h-4"}),j.label]},j.id)})})})]}),s.jsxs("div",{className:"p-8",children:[c==="overview"&&s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[s.jsxs("div",{className:"bg-white rounded-lg p-6 border border-gray-200 shadow-sm",children:[s.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[s.jsx("div",{className:"p-2 bg-purple-50 rounded-lg",children:s.jsx(vw,{className:"w-5 h-5 text-[#714b67]"})}),s.jsx("h3",{className:"font-semibold text-gray-900",children:"Overall Progress"})]}),s.jsxs("div",{className:"mb-3",children:[s.jsxs("div",{className:"flex justify-between items-center mb-2",children:[s.jsx("span",{className:"text-sm text-gray-600",children:"Completion"}),s.jsxs("span",{className:"text-2xl font-bold text-gray-900",children:[r.progress,"%"]})]}),s.jsx("div",{className:"w-full bg-gray-200 rounded-full h-3",children:s.jsx("div",{className:"bg-[#714b67] h-3 rounded-full transition-all",style:{width:`${r.progress}%`}})})]}),s.jsxs("p",{className:"text-xs text-gray-500 mt-2",children:[b.completedTasks," of ",b.totalTasks," tasks completed"]})]}),s.jsxs("div",{className:"bg-white rounded-lg p-6 border border-gray-200 shadow-sm",children:[s.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[s.jsx("div",{className:"p-2 bg-purple-50 rounded-lg",children:s.jsx(Qe,{className:"w-5 h-5 text-[#714b67]"})}),s.jsx("h3",{className:"font-semibold text-gray-900",children:"Task Success Rate"})]}),s.jsx("div",{className:"mb-3",children:s.jsxs("div",{className:"flex justify-between items-center mb-2",children:[s.jsx("span",{className:"text-sm text-gray-600",children:"Completed"}),s.jsxs("span",{className:"text-2xl font-bold text-gray-900",children:[b.taskCompletionRate,"%"]})]})}),s.jsx("p",{className:"text-xs text-gray-500",children:b.completedTasks>0?`${b.completedTasks} out of ${b.totalTasks} tasks completed`:"No tasks completed yet"})]}),s.jsxs("div",{className:"bg-white rounded-lg p-6 border border-gray-200 shadow-sm",children:[s.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[s.jsx("div",{className:"p-2 bg-purple-50 rounded-lg",children:s.jsx(Qs,{className:"w-5 h-5 text-[#714b67]"})}),s.jsx("h3",{className:"font-semibold text-gray-900",children:"Risk Level"})]}),s.jsx("div",{className:"mb-3",children:s.jsx("span",{className:"text-2xl font-bold text-[#714b67]",children:P.level})}),s.jsxs("ul",{className:"text-xs text-gray-600 space-y-1",children:[s.jsxs("li",{children:[" ",b.delayedTasks," delayed tasks"]}),s.jsxs("li",{children:[" ",b.blockedTasks," blocked tasks"]}),s.jsxs("li",{children:[" Budget used: ",b.budgetUsagePercent,"%"]})]})]})]}),s.jsxs("div",{className:"bg-white rounded-lg p-6 border border-gray-200 shadow-sm",children:[s.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[s.jsx("div",{className:"p-2 bg-purple-50 rounded-lg",children:s.jsx(Cu,{className:"w-5 h-5 text-[#714b67]"})}),s.jsx("h3",{className:"font-semibold text-gray-900 text-lg",children:"Financial Overview"})]}),s.jsxs("div",{className:`grid grid-cols-1 ${f?"md:grid-cols-3":"md:grid-cols-4"} gap-6 mb-6`,children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Budget"}),s.jsx("p",{className:"text-2xl font-bold text-gray-900",children:g(b.budgetAmount)})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Spent"}),s.jsx("p",{className:"text-2xl font-bold text-gray-900",children:g(b.budgetUsed)})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Remaining"}),s.jsx("p",{className:"text-2xl font-bold text-gray-900",children:g(b.budgetRemaining)})]}),!f&&s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Est. Revenue"}),s.jsx("p",{className:"text-2xl font-bold text-gray-900",children:g(b.estimatedRevenue)})]})]}),s.jsxs("div",{children:[s.jsxs("div",{className:"flex justify-between mb-2",children:[s.jsx("span",{className:"text-sm text-gray-600",children:"Budget Usage"}),s.jsxs("span",{className:"text-sm font-semibold text-gray-900",children:[b.budgetUsagePercent,"%"]})]}),s.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2.5",children:s.jsx("div",{className:"bg-[#714b67] h-2.5 rounded-full",style:{width:`${Math.min(b.budgetUsagePercent,100)}%`}})}),f&&s.jsx("p",{className:"text-xs text-gray-500 mt-3",children:"Additional financial metrics are restricted for your role."})]})]}),r.description&&s.jsxs("div",{className:"bg-white rounded-lg p-6 border border-gray-200 shadow-sm",children:[s.jsx("h3",{className:"font-semibold text-gray-900 mb-3",children:"Project Description"}),s.jsx("p",{className:"text-gray-600 leading-relaxed",children:r.description})]})]}),c==="tasks"&&s.jsx("div",{className:"space-y-4",children:s.jsxs("div",{className:"bg-white rounded-lg p-6 border border-gray-200 shadow-sm",children:[s.jsxs("h3",{className:"font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[s.jsx(Qe,{className:"w-5 h-5 text-[#714b67]"}),f?"My Assigned Tasks":"All Tasks"," (",f?a.filter(j=>j.assignee_email===(u==null?void 0:u.email)).length:a.length,")"]}),(f?a.filter(j=>j.assignee_email===(u==null?void 0:u.email)).length===0:a.length===0)?s.jsxs("div",{className:"text-center py-8 text-gray-500",children:[s.jsx(Qe,{className:"w-12 h-12 mx-auto mb-3 text-gray-300"}),s.jsx("p",{children:f?"No tasks assigned to you yet":"No tasks created yet"})]}):s.jsx("div",{className:"space-y-3",children:(f?a.filter(j=>j.assignee_email===(u==null?void 0:u.email)):a).map(j=>{var O,R;return s.jsxs("div",{className:"p-4 border border-gray-200 rounded-lg hover:shadow-md transition-shadow",children:[s.jsxs("div",{className:"flex items-start justify-between mb-2",children:[s.jsx("h4",{className:"font-medium text-gray-900",children:j.name}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:`px-2 py-1 rounded text-xs font-medium ${x(j.state)}`,children:(O=j.state)==null?void 0:O.replace("_"," ").toUpperCase()}),s.jsx("span",{className:`text-xs font-medium ${y(j.priority)}`,children:(R=j.priority)==null?void 0:R.toUpperCase()})]})]}),j.description&&s.jsx("p",{className:"text-sm text-gray-600 mb-2",children:j.description}),s.jsxs("div",{className:"flex items-center gap-4 text-xs text-gray-500",children:[j.assignee_email&&s.jsxs("span",{className:"flex items-center gap-1",children:[s.jsx(Au,{className:"w-3 h-3"}),j.assignee_email]}),j.due_date&&s.jsxs("span",{className:"flex items-center gap-1",children:[s.jsx(ji,{className:"w-3 h-3"}),"Due: ",w(j.due_date)]}),j.estimate_hours&&s.jsxs("span",{className:"flex items-center gap-1",children:[s.jsx($t,{className:"w-3 h-3"}),j.estimate_hours,"h"]})]})]},j.id)})})]})}),c==="financials"&&s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[s.jsxs("div",{className:"bg-white rounded-lg p-6 border border-gray-200 shadow-sm",children:[s.jsxs("h3",{className:"font-semibold text-gray-900 mb-6 flex items-center gap-2",children:[s.jsx(lw,{className:"w-5 h-5 text-[#714b67]"}),"Budget Breakdown"]}),s.jsxs("div",{className:"space-y-6",children:[s.jsx("div",{className:"flex items-center justify-center mb-6",children:s.jsxs("div",{className:"relative w-48 h-48",children:[s.jsxs("svg",{className:"w-48 h-48 transform -rotate-90",children:[s.jsx("circle",{cx:"96",cy:"96",r:"80",stroke:"#e5e7eb",strokeWidth:"20",fill:"none"}),s.jsx("circle",{cx:"96",cy:"96",r:"80",stroke:"#714b67",strokeWidth:"20",fill:"none",strokeDasharray:`${b.budgetUsagePercent/100*502.4} 502.4`,className:"transition-all duration-1000"})]}),s.jsxs("div",{className:"absolute inset-0 flex flex-col items-center justify-center",children:[s.jsxs("span",{className:"text-3xl font-bold text-[#714b67]",children:[b.budgetUsagePercent,"%"]}),s.jsx("span",{className:"text-xs text-gray-500 mt-1",children:"Used"})]})]})}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex justify-between items-center p-3 bg-purple-50 rounded-lg",children:[s.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Total Budget"}),s.jsx("span",{className:"text-lg font-bold text-gray-900",children:g(b.budgetAmount)})]}),s.jsxs("div",{className:"flex justify-between items-center p-3 bg-gray-50 rounded-lg",children:[s.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Amount Spent"}),s.jsx("span",{className:"text-lg font-bold text-[#714b67]",children:g(b.budgetUsed)})]}),s.jsxs("div",{className:"flex justify-between items-center p-3 bg-gray-50 rounded-lg",children:[s.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Remaining"}),s.jsx("span",{className:"text-lg font-bold text-gray-600",children:g(b.budgetRemaining)})]})]})]})]}),s.jsxs("div",{className:"bg-white rounded-lg p-6 border border-gray-200 shadow-sm",children:[s.jsxs("h3",{className:"font-semibold text-gray-900 mb-6 flex items-center gap-2",children:[s.jsx(Li,{className:"w-5 h-5 text-[#714b67]"}),"Revenue & Profit"]}),s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{children:[s.jsxs("div",{className:"flex justify-between items-center mb-2",children:[s.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Estimated Revenue"}),s.jsx("span",{className:"text-lg font-bold text-gray-900",children:g(b.estimatedRevenue)})]}),s.jsx("div",{className:"h-12 bg-gray-100 rounded-lg overflow-hidden",children:s.jsx("div",{className:"h-full bg-gradient-to-r from-[#714b67] to-[#8a5a7f] flex items-center justify-end pr-3 transition-all duration-1000",style:{width:"100%"},children:s.jsx("span",{className:"text-white text-xs font-medium",children:"100%"})})})]}),s.jsxs("div",{children:[s.jsxs("div",{className:"flex justify-between items-center mb-2",children:[s.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Estimated Profit"}),s.jsx("span",{className:"text-lg font-bold text-gray-900",children:g(b.estimatedProfit)})]}),s.jsx("div",{className:"h-12 bg-gray-100 rounded-lg overflow-hidden",children:s.jsx("div",{className:"h-full bg-[#714b67] flex items-center justify-end pr-3 transition-all duration-1000",style:{width:`${b.profitMargin}%`},children:s.jsxs("span",{className:"text-white text-xs font-medium",children:[b.profitMargin,"%"]})})})]}),s.jsxs("div",{children:[s.jsxs("div",{className:"flex justify-between items-center mb-2",children:[s.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Current Profit"}),s.jsx("span",{className:"text-lg font-bold text-gray-900",children:g(b.currentProfit)})]}),s.jsx("div",{className:"h-12 bg-gray-100 rounded-lg overflow-hidden",children:s.jsx("div",{className:"h-full bg-gray-400 flex items-center justify-end pr-3 transition-all duration-1000",style:{width:`${b.currentProfit/b.estimatedProfit*100}%`},children:s.jsxs("span",{className:"text-white text-xs font-medium",children:[Math.round(b.currentProfit/b.estimatedProfit*100),"%"]})})})]}),s.jsxs("div",{className:"pt-4 border-t flex justify-between items-center",children:[s.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Profit Margin"}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:"w-24 h-2 bg-gray-100 rounded-full overflow-hidden",children:s.jsx("div",{className:"h-full bg-[#714b67]",style:{width:`${b.profitMargin}%`}})}),s.jsxs("span",{className:"text-xl font-bold text-[#714b67]",children:[b.profitMargin,"%"]})]})]})]})]})]}),s.jsxs("div",{className:"bg-white rounded-lg p-6 border border-gray-200 shadow-sm",children:[s.jsxs("h3",{className:"font-semibold text-gray-900 mb-6 flex items-center gap-2",children:[s.jsx(iw,{className:"w-5 h-5 text-[#714b67]"}),"Cost Analysis"]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[s.jsxs("div",{className:"col-span-2",children:[s.jsxs("div",{className:"flex justify-between items-center mb-4",children:[s.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Project Costs vs Budget"}),s.jsx("span",{className:"text-lg font-bold text-gray-900",children:g(b.actualCost)})]}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{children:[s.jsxs("div",{className:"flex justify-between text-xs text-gray-500 mb-1",children:[s.jsx("span",{children:"Budget Allocated"}),s.jsx("span",{children:g(b.budgetAmount)})]}),s.jsx("div",{className:"h-8 bg-gray-100 rounded-lg overflow-hidden",children:s.jsx("div",{className:"h-full bg-gray-300 w-full"})})]}),s.jsxs("div",{children:[s.jsxs("div",{className:"flex justify-between text-xs text-gray-500 mb-1",children:[s.jsx("span",{children:"Actual Cost"}),s.jsx("span",{children:g(b.actualCost)})]}),s.jsx("div",{className:"h-8 bg-gray-100 rounded-lg overflow-hidden",children:s.jsx("div",{className:"h-full bg-[#714b67] transition-all duration-1000",style:{width:`${b.actualCost/b.budgetAmount*100}%`}})})]})]})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"p-4 bg-purple-50 rounded-lg border border-purple-100",children:[s.jsx("p",{className:"text-xs text-gray-600 mb-1",children:"Cost per Hour"}),s.jsxs("p",{className:"text-2xl font-bold text-[#714b67]",children:[g(b.completedHours>0?b.actualCost/b.completedHours:0),"/h"]}),s.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[b.completedHours,"h completed"]})]}),s.jsxs("div",{className:"p-4 bg-gray-50 rounded-lg border border-gray-200",children:[s.jsx("p",{className:"text-xs text-gray-600 mb-1",children:"Return on Investment"}),s.jsxs("p",{className:"text-2xl font-bold text-[#714b67]",children:[b.actualCost>0?Math.round(b.currentProfit/b.actualCost*100):0,"%"]}),s.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"ROI Ratio"})]})]})]})]})]})]})]})}function xb({task:e,onClick:t}){var n;const r=a=>{const i=["bg-gray-600","bg-gray-700","bg-slate-600","bg-zinc-600","bg-neutral-600"],l=a.split("").reduce((o,c)=>o+c.charCodeAt(0),0);return i[l%i.length]};return s.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 hover:shadow-md transition-all cursor-pointer overflow-hidden",onClick:t,children:[e.coverImage?s.jsx("div",{className:"h-32 overflow-hidden",children:s.jsx("img",{src:e.coverImage,alt:e.title,className:"w-full h-full object-cover"})}):s.jsx("div",{className:"h-32 bg-gradient-to-br from-purple-100 to-pink-100 flex items-center justify-center",children:s.jsx("span",{className:"text-4xl opacity-30",children:""})}),s.jsxs("div",{className:"p-5",children:[e.project&&s.jsx("div",{className:"mb-2",children:s.jsxs("span",{className:"text-xs font-medium text-gray-600",children:["Project: ",s.jsx("span",{className:"text-gray-900",children:e.project})]})}),s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:e.title}),s.jsx("p",{className:"text-sm text-gray-600 mb-4 line-clamp-2",children:e.description}),s.jsx("div",{className:"mb-4",children:s.jsx("span",{className:"text-xs text-gray-500",children:e.dueDate})}),s.jsx("div",{className:"mb-4",children:s.jsxs("span",{className:"text-xs text-gray-600",children:[((n=e.taskList)==null?void 0:n.length)||e.tasks||0," tasks"]})}),s.jsx("div",{className:"flex items-center justify-start pt-3 border-t border-gray-100",children:s.jsx("div",{className:"flex items-center -space-x-2",children:e.assignedUsers.map((a,i)=>s.jsx("div",{className:`w-8 h-8 ${r(a.name)} rounded-full flex items-center justify-center border-2 border-white`,title:a.name,children:s.jsx("span",{className:"text-xs font-semibold text-white",children:a.initials})},i))})})]})]})}function jc({title:e,count:t,tasks:r,isCompleted:n=!1,onTaskClick:a}){return s.jsx("div",{className:"flex-shrink-0 w-[400px]",children:s.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 h-full",children:[s.jsx("div",{className:"mb-4",children:s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsx("h3",{className:"text-base font-semibold text-gray-900",children:e}),s.jsx("span",{className:"text-sm text-gray-500 bg-white px-2.5 py-1 rounded-full",children:t})]})}),s.jsx("div",{className:"space-y-4",children:r.map(i=>s.jsx(xb,{task:i,onClick:()=>a(i)},i.id))})]})})}function mb({isOpen:e,onClose:t,task:r}){const[n,a]=T.useState(!1),[i,l]=T.useState(2);if(!e)return null;const o=r||{title:"Monthly Product Discussion",description:"Monthly Product Discussion by Design and Marketing Teams with CEO to Plan our future products sales and reports",project:"RD Sales",badges:["Feedback","Bug"],dueDate:"24 Jan 2023",assignedUsers:[{name:"Floyd Miles",initials:"FM"},{name:"Dianne Russell",initials:"DR"},{name:"Annette Black",initials:"AB"}]},c=u=>u.split(" ").map(f=>f[0]).join("").toUpperCase().slice(0,2),d=u=>{const f=["bg-gray-400","bg-gray-500","bg-gray-600","bg-gray-700","bg-gray-800"],h=u.split("").reduce((m,v)=>m+v.charCodeAt(0),0);return f[h%f.length]};return s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:s.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-5xl max-h-[90vh] overflow-hidden flex flex-col",children:[s.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Project:"}),s.jsx("span",{className:"text-sm font-semibold text-gray-900",children:o.project||o.title})]}),s.jsx("div",{className:"flex items-center gap-1 ml-auto mr-4",children:[...Array(5)].map((u,f)=>s.jsx(yw,{className:`w-4 h-4 cursor-pointer ${f<i?"fill-yellow-400 text-yellow-400":"text-gray-300"}`,onClick:()=>l(f+1)},f))}),s.jsxs("div",{className:"relative",children:[s.jsx("button",{onClick:()=>a(!n),className:"text-gray-400 hover:text-gray-600 p-1",children:s.jsx(ns,{className:"w-5 h-5"})}),n&&s.jsxs("div",{className:"absolute right-0 mt-2 w-48 bg-white rounded-lg shadow-lg border border-gray-200 py-1 z-10",children:[s.jsx("button",{className:"w-full px-4 py-2 text-left text-sm text-gray-700 hover:bg-gray-50",children:"Edit"}),s.jsx("button",{className:"w-full px-4 py-2 text-left text-sm text-gray-700 hover:bg-gray-50",children:"Delete"}),s.jsx("button",{className:"w-full px-4 py-2 text-left text-sm text-gray-700 hover:bg-gray-50",children:"Change Cover"})]})]})]}),o.badges&&o.badges.length>0&&s.jsx("div",{className:"flex flex-wrap gap-2 mb-3",children:o.badges.map((u,f)=>s.jsx("span",{className:`px-3 py-1 rounded-md text-xs font-medium ${u.toLowerCase()==="feedback"?"bg-green-100 text-green-700":u.toLowerCase()==="bug"?"bg-red-100 text-red-700":"bg-gray-100 text-gray-700"}`,children:u},f))}),s.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:o.title})]}),s.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-600 transition-colors ml-4",children:s.jsx(ze,{className:"w-5 h-5"})})]}),s.jsx("div",{className:"flex-1 overflow-y-auto",children:s.jsxs("div",{className:"flex",children:[s.jsxs("div",{className:"flex-1 p-6 border-r border-gray-200",children:[s.jsx("div",{className:"mb-6",children:s.jsxs("div",{className:"relative bg-gradient-to-br from-purple-100 to-pink-100 rounded-lg overflow-hidden h-48 flex items-center justify-center group",children:[s.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:s.jsx(uw,{className:"w-12 h-12 text-purple-300"})}),s.jsx("button",{className:"absolute bottom-4 right-4 bg-white px-4 py-2 rounded-lg text-sm font-medium text-gray-700 opacity-0 group-hover:opacity-100 transition-opacity shadow-md hover:shadow-lg",children:"Change Cover"})]})}),s.jsxs("div",{className:"mb-6",children:[s.jsx("h3",{className:"text-sm font-semibold text-gray-900 mb-2",children:"Description"}),s.jsx("p",{className:"text-sm text-gray-600",children:o.description||"No description available"})]}),s.jsxs("div",{className:"mb-6",children:[s.jsx("div",{className:"flex items-center justify-between mb-3",children:s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Rf,{className:"w-4 h-4 text-gray-400"}),s.jsx("h3",{className:"text-sm font-semibold text-gray-900",children:"Task Checklist"})]})}),s.jsx("div",{className:"space-y-2 mb-3",children:["Prepare Design Document","Document Signature","Pitch Deck Presentation Design"].map((u,f)=>s.jsxs("div",{className:"flex items-center justify-between p-2 hover:bg-gray-50 rounded",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("input",{type:"checkbox",className:"w-4 h-4 text-gray-600 border-gray-300 rounded"}),s.jsx("span",{className:"text-sm text-gray-700",children:u})]}),s.jsx("button",{className:"text-gray-400 hover:text-gray-600",children:s.jsx(ns,{className:"w-4 h-4"})})]},f))}),s.jsx("button",{className:"text-sm text-gray-600 hover:text-gray-900 font-medium",children:"+ Add Item"})]}),s.jsxs("div",{className:"mb-6",children:[s.jsx("div",{className:"flex items-center justify-between mb-3",children:s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Rf,{className:"w-4 h-4 text-gray-400"}),s.jsx("h3",{className:"text-sm font-semibold text-gray-900",children:"Daily Sprint"})]})}),s.jsx("div",{className:"space-y-2 mb-3",children:["Prepare Design Document","Document Signature"].map((u,f)=>s.jsxs("div",{className:"flex items-center justify-between p-2 hover:bg-gray-50 rounded",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("input",{type:"checkbox",className:"w-4 h-4 text-gray-600 border-gray-300 rounded"}),s.jsx("span",{className:"text-sm text-gray-700",children:u})]}),s.jsx("button",{className:"text-gray-400 hover:text-gray-600",children:s.jsx(ns,{className:"w-4 h-4"})})]},f))}),s.jsx("button",{className:"text-sm text-gray-600 hover:text-gray-900 font-medium",children:"+ Add Item"})]}),s.jsx("div",{className:"mb-6",children:s.jsx("button",{className:"w-full py-2 text-sm font-medium text-white rounded-lg hover:opacity-90 transition-opacity",style:{backgroundColor:"#714b67"},children:"+ Add New Checklist"})}),s.jsxs("div",{className:"mb-6",children:[s.jsx("label",{className:"block text-sm font-semibold text-gray-900 mb-2",children:"Add Your Comment"}),s.jsxs("div",{className:"relative",children:[s.jsx("input",{type:"text",placeholder:"Add Your Comment",className:"w-full px-4 py-2 pr-20 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-400 focus:border-transparent text-sm"}),s.jsxs("div",{className:"absolute right-2 top-1/2 transform -translate-y-1/2 flex items-center gap-2",children:[s.jsx("button",{className:"text-gray-400 hover:text-gray-600",children:s.jsx(dp,{className:"w-4 h-4"})}),s.jsx("button",{className:"text-gray-400 hover:text-gray-600",children:s.jsx(fp,{className:"w-4 h-4"})})]})]})]}),s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsx("h3",{className:"text-sm font-semibold text-gray-900",children:"Activity"}),s.jsx("button",{className:"text-sm text-gray-600 hover:text-gray-900 font-medium",children:"Hide Activity Details"})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx("div",{className:"w-8 h-8 bg-gray-600 rounded-full flex items-center justify-center flex-shrink-0",children:s.jsx("span",{className:"text-xs font-semibold text-white",children:"FE"})}),s.jsxs("div",{className:"flex-1",children:[s.jsxs("p",{className:"text-sm text-gray-700",children:[s.jsx("span",{className:"font-medium",children:"Frank Edward"})," mentioned you in a comment in Design Team Reports ",s.jsx("span",{className:"font-medium",children:"@brianf"})," have you update this design so we can use it on next meeting?"]}),s.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"3 hours ago | Design Team"})]}),s.jsx("button",{className:"text-gray-400 hover:text-gray-600 flex-shrink-0",children:s.jsx(ns,{className:"w-4 h-4"})})]}),s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx("div",{className:"w-8 h-8 bg-gray-500 rounded-full flex items-center justify-center flex-shrink-0",children:s.jsx("span",{className:"text-xs font-semibold text-white",children:"JW"})}),s.jsxs("div",{className:"flex-1",children:[s.jsxs("p",{className:"text-sm text-gray-700",children:[s.jsx("span",{className:"font-medium",children:"James Wong"})," Changed the due date of Monthly Team Meeting to Sep 12"]}),s.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Aug 24 | Design Team"})]}),s.jsx("button",{className:"text-gray-400 hover:text-gray-600 flex-shrink-0",children:s.jsx(ns,{className:"w-4 h-4"})})]})]})]})]}),s.jsxs("div",{className:"w-64 p-6 bg-gray-50",children:[s.jsxs("div",{className:"mb-6",children:[s.jsx("h3",{className:"text-sm font-semibold text-gray-900 mb-3",children:"Member"}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:"flex -space-x-2",children:(o.assignedUsers||[]).map((u,f)=>s.jsx("div",{className:`w-8 h-8 ${d(u.name)} rounded-full flex items-center justify-center border-2 border-white`,title:u.name,children:s.jsx("span",{className:"text-xs font-semibold text-white",children:u.initials||c(u.name)})},f))}),s.jsx("button",{className:"w-8 h-8 border-2 border-dashed border-gray-300 rounded-full flex items-center justify-center text-gray-400 hover:border-gray-400 hover:text-gray-600 transition-colors",children:s.jsx(lr,{className:"w-4 h-4"})})]})]}),s.jsxs("div",{className:"mb-6",children:[s.jsx("h3",{className:"text-sm font-semibold text-gray-900 mb-3",children:"Due Date"}),s.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 bg-white border border-gray-300 rounded-lg",children:[s.jsx(ji,{className:"w-4 h-4 text-gray-400"}),s.jsx("span",{className:"text-sm text-gray-700 flex-1",children:o.dueDate||"No due date"}),s.jsx("svg",{className:"w-4 h-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]})]}),s.jsxs("div",{className:"mb-6",children:[s.jsxs("div",{className:"flex items-center justify-between mb-3",children:[s.jsx("h3",{className:"text-sm font-semibold text-gray-900",children:"Labels"}),s.jsx("button",{className:"text-gray-400 hover:text-gray-600",children:s.jsx(lr,{className:"w-4 h-4"})})]}),s.jsxs("div",{className:"flex flex-wrap gap-2",children:[s.jsx("span",{className:"px-2.5 py-1 rounded-full text-xs font-medium bg-amber-100 text-amber-800",children:"Internal"}),s.jsx("span",{className:"px-2.5 py-1 rounded-full text-xs font-medium bg-green-100 text-green-800",children:"Marketing"})]})]}),s.jsx("div",{children:s.jsxs("div",{className:"flex items-center justify-between mb-3",children:[s.jsx("h3",{className:"text-sm font-semibold text-gray-900",children:"Attachment"}),s.jsx("button",{className:"text-gray-400 hover:text-gray-600",children:s.jsx(lr,{className:"w-4 h-4"})})]})})]})]})})]})})}function pb({project:e,isOpen:t,onClose:r,onAddTask:n,onEditTask:a,onDeleteTask:i}){return!t||!e?null:s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:s.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-3xl max-h-[85vh] overflow-hidden flex flex-col",children:[s.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[s.jsx("span",{className:"text-sm text-gray-500",children:"Project:"}),s.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:e.project||e.title})]}),s.jsx("p",{className:"text-sm text-gray-600",children:e.description})]}),s.jsx("button",{onClick:r,className:"text-gray-400 hover:text-gray-600 transition-colors ml-4",children:s.jsx(ze,{className:"w-5 h-5"})})]}),s.jsxs("div",{className:"flex-1 overflow-y-auto p-6",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Tasks"}),n&&s.jsxs("button",{onClick:()=>n(e),className:"flex items-center gap-2 px-4 py-2 text-sm font-medium text-white rounded-lg hover:opacity-90 transition-opacity",style:{backgroundColor:"#714b67"},children:[s.jsx(lr,{className:"w-4 h-4"}),"Add Task"]})]}),s.jsx("div",{className:"space-y-3",children:e.taskList&&e.taskList.length>0?e.taskList.map((l,o)=>s.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg hover:bg-gray-100 transition-colors",children:[s.jsxs("div",{className:"flex-1",children:[s.jsx("h4",{className:"text-sm font-medium text-gray-900",children:l.title}),s.jsx("p",{className:"text-xs text-gray-600 mt-1",children:l.description}),l.deadline&&s.jsxs("span",{className:"text-xs text-gray-500 mt-1 inline-block",children:["Due: ",new Date(l.deadline).toLocaleDateString()]})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[a&&s.jsx("button",{onClick:()=>a(l,e),className:"p-2 text-gray-600 hover:text-gray-900 hover:bg-gray-200 rounded transition-colors",title:"Edit Task",children:s.jsx(xw,{className:"w-4 h-4"})}),i&&s.jsx("button",{onClick:()=>i(l.id,e.projectId),className:"p-2 text-red-600 hover:text-red-900 hover:bg-red-100 rounded transition-colors",title:"Delete Task",children:s.jsx(I0,{className:"w-4 h-4"})})]})]},l.id||o)):s.jsx("div",{className:"text-center py-8 text-gray-500",children:s.jsx("p",{children:'No tasks yet. Click "Add Task" to create one.'})})})]})]})})}const gb=[{id:1,name:"Alex User",initials:"AU",email:"alex@example.com"},{id:2,name:"Floyd Miles",initials:"FM",email:"floyd@example.com"},{id:3,name:"Dianne Russell",initials:"DR",email:"dianne@example.com"},{id:4,name:"Annette Black",initials:"AB",email:"annette@example.com"},{id:5,name:"Unknown User",initials:"U",email:"unknown@example.com"},{id:6,name:"Frank Edward",initials:"FE",email:"frank@example.com"},{id:7,name:"James Wong",initials:"JW",email:"james@example.com"}];function yb({task:e,project:t,isOpen:r,onClose:n,onSave:a}){const[i,l]=T.useState("description"),[o,c]=T.useState({title:"",description:"",tags:[],deadline:"",coverImage:null,assignee:"",state:"new",priority:"medium"}),[d,u]=T.useState(""),[f,h]=T.useState([]),[m,v]=T.useState(!1),[x,y]=T.useState(null),[p,g]=T.useState(0),[w,b]=T.useState(!1),P=T.useRef(null),M=T.useRef(null),j=T.useRef(null);T.useEffect(()=>{e&&(c({title:e.title||"",description:e.description||"",tags:e.tags||[],deadline:e.deadline||"",coverImage:e.coverImage||null,assignee:e.assignee||"",state:e.state||"new",priority:e.priority||"medium"}),h(e.timesheets||[]))},[e]),T.useEffect(()=>{const q=W=>{j.current&&!j.current.contains(W.target)&&b(!1)};return document.addEventListener("mousedown",q),()=>document.removeEventListener("mousedown",q)},[]),T.useEffect(()=>(m?P.current=setInterval(()=>{g(q=>q+1)},1e3):P.current&&clearInterval(P.current),()=>{P.current&&clearInterval(P.current)}),[m]);const O=()=>{y(new Date),v(!0),g(0)},R=()=>{if(x){const q=new Date,W=Math.floor((q-x)/1e3),k={id:Date.now(),employee:o.assignee||"Current User",loginTime:x.toLocaleString("en-US",{hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!0}),logoutTime:q.toLocaleString("en-US",{hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!0}),timeLogged:W,date:q.toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}),fullLoginDateTime:x.toLocaleString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!0}),fullLogoutDateTime:q.toLocaleString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!0})};h([...f,k]),v(!1),y(null),g(0)}},I=q=>{const W=Math.floor(q/3600),k=Math.floor(q%3600/60),K=q%60;return`${W}h ${k}m ${K}s`},D=q=>{const W=Math.floor(q/3600),k=Math.floor(q%3600/60);return`${W}h ${k}m`},z=()=>{const q=f.reduce((W,k)=>W+k.timeLogged,0);return D(q)},ne=q=>{const W=q.target.files[0];if(W){const k=new FileReader;k.onloadend=()=>{c({...o,coverImage:k.result})},k.readAsDataURL(W)}},Ne=()=>{c({...o,coverImage:null}),M.current&&(M.current.value="")},ue=()=>{const q={...e,...o,timesheets:f,lastModified:new Date().toISOString(),lastModifiedBy:o.assignee||"Current User"};a(q)},je=q=>{c({...o,assignee:q.name}),b(!1)};return r?s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:s.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-4xl max-h-[90vh] overflow-hidden flex flex-col",children:[s.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200 bg-gray-50",children:[s.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[s.jsx("span",{children:(t==null?void 0:t.project)||(t==null?void 0:t.title)||"Project"}),s.jsx("span",{children:">"}),s.jsx("span",{className:"font-medium text-gray-900",children:"Edit Task"})]}),s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("button",{onClick:n,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",children:"Discard"}),s.jsx("button",{onClick:ue,className:"px-4 py-2 text-sm font-medium text-white rounded-lg hover:opacity-90",style:{backgroundColor:"#714b67"},children:"Save"}),s.jsx("button",{onClick:n,className:"text-gray-400 hover:text-gray-600 transition-colors",children:s.jsx(ze,{className:"w-5 h-5"})})]})]}),s.jsxs("div",{className:"flex-1 overflow-y-auto p-6",children:[s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Task Title"}),s.jsx("input",{type:"text",value:o.title,onChange:q=>c({...o,title:q.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500",placeholder:"Enter task title"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Assignee"}),s.jsxs("div",{className:"relative",ref:j,children:[s.jsxs("button",{type:"button",onClick:()=>b(!w),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 bg-white text-left flex items-center justify-between",children:[s.jsx("span",{className:"text-gray-900",children:o.assignee||"Select assignee"}),s.jsx(Wn,{className:"w-4 h-4 text-gray-400"})]}),w&&s.jsx("div",{className:"absolute z-10 w-full mt-1 bg-white border border-gray-300 rounded-lg shadow-lg max-h-60 overflow-auto",children:gb.map(q=>s.jsxs("button",{type:"button",onClick:()=>je(q),className:"w-full px-4 py-2 text-left hover:bg-gray-50 flex items-center gap-3 transition-colors",children:[s.jsx("div",{className:"w-8 h-8 bg-gray-600 rounded-full flex items-center justify-center flex-shrink-0",children:s.jsx("span",{className:"text-xs font-semibold text-white",children:q.initials})}),s.jsxs("div",{className:"flex-1",children:[s.jsx("p",{className:"text-sm font-medium text-gray-900",children:q.name}),s.jsx("p",{className:"text-xs text-gray-500",children:q.email})]}),o.assignee===q.name&&s.jsx("svg",{className:"w-5 h-5 text-purple-600",fill:"currentColor",viewBox:"0 0 20 20",children:s.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})]},q.id))})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Status"}),s.jsxs("select",{value:o.state,onChange:q=>c({...o,state:q.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500",children:[s.jsx("option",{value:"new",children:"New"}),s.jsx("option",{value:"in_progress",children:"In Progress"}),s.jsx("option",{value:"blocked",children:"Blocked"}),s.jsx("option",{value:"done",children:"Done"})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Priority"}),s.jsxs("select",{value:o.priority,onChange:q=>c({...o,priority:q.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500",children:[s.jsx("option",{value:"low",children:"Low"}),s.jsx("option",{value:"medium",children:"Medium"}),s.jsx("option",{value:"high",children:"High"}),s.jsx("option",{value:"urgent",children:"Urgent"})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Deadline"}),s.jsx("input",{type:"datetime-local",value:o.deadline,min:new Date().toISOString().slice(0,16),onChange:q=>c({...o,deadline:q.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Cover Image"}),o.coverImage?s.jsxs("div",{className:"relative",children:[s.jsx("img",{src:o.coverImage,alt:"Cover",className:"w-full h-48 object-cover rounded-lg"}),s.jsx("button",{onClick:Ne,className:"absolute top-2 right-2 p-2 bg-red-500 text-white rounded-lg hover:bg-red-600",children:s.jsx(I0,{className:"w-4 h-4"})})]}):s.jsxs("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-8 text-center",children:[s.jsx(D0,{className:"w-8 h-8 text-gray-400 mx-auto mb-2"}),s.jsx("p",{className:"text-sm text-gray-600 mb-2",children:"Upload cover image"}),s.jsx("input",{ref:M,type:"file",accept:"image/*",onChange:ne,className:"hidden",id:"image-upload"}),s.jsx("label",{htmlFor:"image-upload",className:"px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 cursor-pointer inline-block",children:"Choose File"})]})]})]}),s.jsxs("div",{className:"mt-8 border-t border-gray-200",children:[s.jsxs("div",{className:"flex gap-4 border-b border-gray-200",children:[s.jsx("button",{onClick:()=>l("description"),className:`px-4 py-3 text-sm font-medium border-b-2 transition-colors ${i==="description"?"border-purple-600 text-purple-600":"border-transparent text-gray-600 hover:text-gray-900"}`,children:"Description"}),s.jsx("button",{onClick:()=>l("timesheets"),className:`px-4 py-3 text-sm font-medium border-b-2 transition-colors ${i==="timesheets"?"border-purple-600 text-purple-600":"border-transparent text-gray-600 hover:text-gray-900"}`,children:"Timesheets"}),s.jsx("button",{onClick:()=>l("taskinfo"),className:`px-4 py-3 text-sm font-medium border-b-2 transition-colors ${i==="taskinfo"?"border-purple-600 text-purple-600":"border-transparent text-gray-600 hover:text-gray-900"}`,children:"Task Info"})]}),s.jsxs("div",{className:"py-6",children:[i==="description"&&s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Task Description"}),s.jsx("textarea",{value:o.description,onChange:q=>c({...o,description:q.target.value}),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 min-h-[200px]",placeholder:"Enter task description..."})]}),i==="timesheets"&&s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx("h3",{className:"text-sm font-semibold text-gray-900",children:"Time Tracking"}),m&&s.jsxs("span",{className:"text-sm text-green-600 font-medium",children:["Running: ",I(p)]})]}),s.jsx("div",{className:"flex gap-2",children:m?s.jsx("button",{onClick:R,className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 text-sm font-medium",children:"Stop Tracking"}):s.jsx("button",{onClick:O,className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 text-sm font-medium",children:"Start Tracking"})})]}),s.jsx("div",{className:"mb-4 p-4 bg-gray-50 rounded-lg",children:s.jsxs("p",{className:"text-sm text-gray-600",children:["Total Time Logged: ",s.jsx("span",{className:"font-semibold text-gray-900",children:z()})]})}),s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"w-full border border-gray-200 rounded-lg",children:[s.jsx("thead",{className:"bg-gray-50",children:s.jsxs("tr",{children:[s.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-700 uppercase tracking-wider",children:"Employee"}),s.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-700 uppercase tracking-wider",children:"Login Time"}),s.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-700 uppercase tracking-wider",children:"Logout Time"}),s.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-700 uppercase tracking-wider",children:"Time Logged"}),s.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-700 uppercase tracking-wider",children:"Date"})]})}),s.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:f.length>0?f.map((q,W)=>s.jsxs("tr",{className:"hover:bg-gray-50",children:[s.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:q.employee}),s.jsx("td",{className:"px-4 py-3 text-sm text-gray-600",children:q.fullLoginDateTime||q.loginTime}),s.jsx("td",{className:"px-4 py-3 text-sm text-gray-600",children:q.fullLogoutDateTime||q.logoutTime}),s.jsx("td",{className:"px-4 py-3 text-sm text-gray-900 font-medium",children:D(q.timeLogged)}),s.jsx("td",{className:"px-4 py-3 text-sm text-gray-600",children:q.date})]},q.id||W)):s.jsx("tr",{children:s.jsx("td",{colSpan:"5",className:"px-4 py-8 text-center text-sm text-gray-500",children:"No time logged yet. Start tracking to begin."})})})]})})]}),i==="taskinfo"&&s.jsxs("div",{className:"space-y-4",children:[s.jsx("h3",{className:"text-sm font-semibold text-gray-900",children:"Task Information"}),s.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 space-y-3",children:[s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-sm text-gray-600",children:"Created:"}),s.jsx("span",{className:"text-sm text-gray-900 font-medium",children:new Date((e==null?void 0:e.created)||Date.now()).toLocaleString()})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-sm text-gray-600",children:"Last Modified:"}),s.jsx("span",{className:"text-sm text-gray-900 font-medium",children:e!=null&&e.lastModified?new Date(e.lastModified).toLocaleString():"Never"})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-sm text-gray-600",children:"Last Modified By:"}),s.jsx("span",{className:"text-sm text-gray-900 font-medium",children:(e==null?void 0:e.lastModifiedBy)||"N/A"})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-sm text-gray-600",children:"Status:"}),s.jsx("span",{className:"text-sm text-gray-900 font-medium",children:(e==null?void 0:e.status)||"In Progress"})]})]}),s.jsxs("div",{className:"mt-6",children:[s.jsx("h4",{className:"text-sm font-semibold text-gray-900 mb-3",children:"Change History"}),s.jsx("div",{className:"space-y-2",children:e!=null&&e.changeHistory&&e.changeHistory.length>0?e.changeHistory.map((q,W)=>s.jsxs("div",{className:"p-3 bg-gray-50 rounded border border-gray-200",children:[s.jsx("p",{className:"text-sm text-gray-900",children:q.description}),s.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[new Date(q.timestamp).toLocaleString()," by ",q.user]})]},W)):s.jsx("p",{className:"text-sm text-gray-500",children:"No change history available"})})]})]})]})]})]})]})}):null}function vb(){const[e,t]=T.useState(!1),[r,n]=T.useState("kanban"),[a,i]=T.useState(null),[l,o]=T.useState(!1),[c,d]=T.useState(null),[u,f]=T.useState(!1),[h,m]=T.useState(null),[v,x]=T.useState([]),[y,p]=T.useState({new:[],inProgress:[],done:[]}),[g,w]=T.useState(!0),[b,P]=T.useState(null),M=Gr(),j=((M==null?void 0:M.role)||"").toLowerCase()==="employee";T.useEffect(()=>{O()},[]);const O=async()=>{try{w(!0);const W=await yr.getAll();if(!W.success)throw new Error("Failed to load projects");const k=W.data;x(k);const K=k.map(L=>za.getAll(L.id)),te=await Promise.all(K),E={new:[],inProgress:[],done:[]},B={new:new Map,inProgress:new Map,done:new Map};k.forEach((L,U)=>{const ee=te[U],he=ee.success?ee.data:[],xe={new:[],inProgress:[],done:[]};he.forEach(G=>{const J={id:G.id,title:G.title,description:G.description,deadline:G.due_date,tags:G.labels||[],assignee:"User",created:G.created_at,state:G.state,priority:G.priority,timesheets:[],changeHistory:[]};G.state==="new"?xe.new.push(J):G.state==="in_progress"||G.state==="blocked"?xe.inProgress.push(J):G.state==="done"&&xe.done.push(J)}),Object.keys(xe).forEach(G=>{if(xe[G].length>0){const J=[...new Set(xe[G].flatMap(_e=>_e.tags||[]))],ve=xe[G].map(_e=>_e.deadline).filter(_e=>_e).map(_e=>new Date(_e)),Se=ve.length>0?new Date(Math.min(...ve)):null,se=ve.length>0?new Date(Math.max(...ve)):null,pe=Se&&se?`${Se.toLocaleDateString()}  ${se.toLocaleDateString()}`:"",Ae={id:`${L.id}-${G}`,title:L.name,description:L.description,project:L.name,badges:J,dueDate:pe,tasks:xe[G].length,assignedUsers:[{name:"User",initials:"U"}],taskList:xe[G],projectId:L.id,projectData:L};E[G].push(Ae)}})}),p(E),w(!1)}catch(W){console.error("Error loading data:",W),P(W.message),w(!1)}},R=W=>{d(W),o(!0)},I=()=>{t(!1),i(null)},D=()=>{o(!1),d(null)},z=W=>{const k={id:Date.now(),title:"New Task",description:"",deadline:"",tags:[],assignee:"",created:new Date().toISOString(),timesheets:[],changeHistory:[{description:"Task created",timestamp:new Date().toISOString(),user:"Current User"}]};m(k),d(W),f(!0)},ne=(W,k)=>{m(W),d(k),f(!0)},Ne=async W=>{var k;try{const K=(c==null?void 0:c.projectId)||(c==null?void 0:c.id)||((k=v[0])==null?void 0:k.id);if(!K){alert("No project selected");return}if(!W.title||W.title.trim().length===0){alert("Task title is required");return}const te={title:W.title.trim(),description:W.description||"",state:W.state||"new",priority:W.priority||"medium",due_date:W.deadline||null,labels:W.tags||[]},E=String(W.id),B=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i.test(E);console.log("Saving task:",{taskId:W.id,taskIdStr:E,isUUID:B,projectId:K,taskData:te});let L;B?(console.log("Updating existing task:",W.id),L=await za.update(K,W.id,te)):(console.log("Creating new task"),L=await za.create(K,te)),L.success?(console.log("Task saved successfully:",L.data),await O(),f(!1),m(null)):alert("Failed to save task: "+L.message)}catch(K){console.error("Error saving task:",K),alert("Error saving task: "+K.message)}},ue=()=>{f(!1),m(null)},je=async(W,k)=>{if(confirm("Are you sure you want to delete this task?"))try{const K=await za.delete(k,W);K.success?await O():alert("Failed to delete task: "+K.message)}catch(K){console.error("Error deleting task:",K),alert("Error deleting task: "+K.message)}},q=()=>{const W={id:Date.now(),title:"",description:"",deadline:"",tags:[],assignee:"",created:new Date().toISOString(),timesheets:[],changeHistory:[{description:"Task created",timestamp:new Date().toISOString(),user:"Current User"}]};m(W),d({project:"New Task",title:"New Task"}),f(!0)};return s.jsxs("div",{className:"h-full bg-gray-50",children:[s.jsx(mb,{isOpen:e,onClose:I,task:a}),s.jsx(pb,{project:c,isOpen:l,onClose:D,onAddTask:j?void 0:z,onEditTask:j?void 0:ne,onDeleteTask:j?void 0:je}),s.jsx(yb,{task:h,project:c,isOpen:u,onClose:ue,onSave:Ne}),s.jsx("header",{className:"bg-white border-b border-gray-200 px-8 py-6",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("h1",{className:"text-3xl font-semibold text-gray-900",children:"Tasks View"}),s.jsx("div",{className:"flex items-center gap-3",children:!j&&s.jsxs("button",{onClick:q,className:"flex items-center gap-2 px-5 py-2.5 text-sm font-medium text-white rounded-lg hover:opacity-90 transition-opacity",style:{backgroundColor:"#714b67"},children:[s.jsx(lr,{className:"w-4 h-4"}),"New"]})})]})}),s.jsx("div",{className:"p-8",children:g?s.jsx("div",{className:"flex items-center justify-center h-64",children:s.jsx("p",{className:"text-gray-500",children:"Loading tasks..."})}):b?s.jsx("div",{className:"flex items-center justify-center h-64",children:s.jsxs("p",{className:"text-red-500",children:["Error: ",b]})}):s.jsxs("div",{className:"flex gap-6 overflow-x-auto pb-4",children:[s.jsx(jc,{title:"New",count:y.new.length,tasks:y.new,onTaskClick:R}),s.jsx(jc,{title:"In Progress",count:y.inProgress.length,tasks:y.inProgress,onTaskClick:R}),s.jsx(jc,{title:"Completed",count:y.done.length,tasks:y.done,isCompleted:!0,onTaskClick:R})]})})]})}function wb({notification:e,getInitials:t,getAvatarColor:r}){const[n,a]=T.useState(!1),[i,l]=T.useState("");return s.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-5 hover:shadow-md transition-shadow",children:s.jsxs("div",{className:"flex items-start gap-4",children:[!e.isRead&&s.jsx("div",{className:"w-2 h-2 rounded-full mt-2 flex-shrink-0",style:{backgroundColor:"#714b67"}}),e.isRead&&s.jsx("div",{className:"w-2 flex-shrink-0"}),s.jsx("div",{className:`w-10 h-10 ${r(e.user.name)} rounded-full flex items-center justify-center flex-shrink-0`,children:s.jsx("span",{className:"text-sm font-semibold text-white",children:t(e.user.name)})}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsxs("p",{className:"text-sm text-gray-700 mb-2",children:[s.jsx("span",{className:"font-semibold text-gray-900",children:e.user.name})," ",e.message," ",s.jsx("span",{className:"font-semibold text-gray-900",children:e.project})]}),e.quotedComment&&s.jsx("div",{className:"mb-3 pl-3 border-l-2 border-gray-300 bg-gray-50 rounded-r py-2",children:s.jsx("p",{className:"text-sm text-gray-600",children:e.quotedComment})}),s.jsxs("div",{className:"mb-2",children:[e.action==="reply"&&s.jsx(s.Fragment,{children:n?s.jsxs("div",{className:"space-y-2",children:[s.jsx("textarea",{value:i,onChange:o=>l(o.target.value),placeholder:"Type your reply...",className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-400 focus:border-transparent resize-none",rows:"3"}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("button",{onClick:()=>{a(!1),l("")},className:"px-3 py-1.5 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:"Cancel"}),s.jsxs("button",{onClick:()=>{a(!1),l("")},className:"flex items-center gap-1.5 px-3 py-1.5 text-sm font-medium text-white rounded-lg hover:opacity-90 transition-opacity",style:{backgroundColor:"#714b67"},children:[s.jsx(fp,{className:"w-3.5 h-3.5"}),"Send"]})]})]}):s.jsxs("button",{onClick:()=>a(!0),className:"flex items-center gap-1.5 px-3 py-1.5 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:[s.jsx(mw,{className:"w-3.5 h-3.5"}),"Reply"]})}),e.action==="accept-decline"&&s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsxs("button",{className:"flex items-center gap-1.5 px-3 py-1.5 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:[s.jsx(ze,{className:"w-3.5 h-3.5"}),"Decline"]}),s.jsxs("button",{className:"flex items-center gap-1.5 px-3 py-1.5 text-sm font-medium text-white rounded-lg hover:opacity-90 transition-opacity",style:{backgroundColor:"#714b67"},children:[s.jsx(ow,{className:"w-3.5 h-3.5"}),"Accept"]})]})]}),s.jsxs("p",{className:"text-xs text-gray-500",children:[e.time," | ",e.team]})]}),s.jsx("button",{className:"text-gray-400 hover:text-gray-600 transition-colors flex-shrink-0",children:s.jsx(ns,{className:"w-4 h-4"})})]})})}const Bf={all:[{id:1,isRead:!1,user:{name:"Frank Edward",avatar:"FE"},type:"mention",message:"mentioned you in a comment in",project:"Design Team Reports",quotedComment:"@brianf have you update this design so we can use it on next meeting?",action:"reply",time:"3 hours ago",team:"Design Team"},{id:2,isRead:!1,user:{name:"Elsa Wright",avatar:"EW"},type:"access",message:"Asking for edit access in",project:"Monthly Team Progress",action:"accept-decline",time:"Yesterday",team:"Marketing Team"},{id:3,isRead:!0,user:{name:"James Wong",avatar:"JW"},type:"mention",message:"mentioned you in a comment in",project:"Monthly Team Meeting",quotedComment:"@brianf let's we plan all this event by now",action:"reply",time:"Aug 24",team:"Design Team"}],tasks:[],archived:[]};function bb(){const[e,t]=T.useState("all"),r=Bf.all.filter(i=>!i.isRead).length,n=i=>i.split(" ").map(l=>l[0]).join("").toUpperCase().slice(0,2),a=i=>{const l=["bg-gray-400","bg-gray-500","bg-gray-600","bg-gray-700","bg-gray-800"],o=i.split("").reduce((c,d)=>c+d.charCodeAt(0),0);return l[o%l.length]};return s.jsx("div",{className:"h-full bg-gray-50",children:s.jsxs("div",{className:"w-full bg-white min-h-full",children:[s.jsxs("div",{className:"border-b border-gray-200 px-8 py-6",children:[s.jsxs("div",{className:"flex items-center justify-between mb-6",children:[s.jsx("h1",{className:"text-2xl font-semibold text-gray-900",children:"Notifications"}),s.jsx("button",{className:"text-gray-400 hover:text-gray-600 transition-colors",children:s.jsx(ze,{className:"w-5 h-5"})})]}),s.jsxs("div",{className:"flex items-center gap-8 border-b border-gray-200",children:[s.jsxs("button",{onClick:()=>t("all"),className:`flex items-center gap-2 pb-4 px-1 relative ${e==="all"?"text-gray-900":"text-gray-600 hover:text-gray-900"} transition-colors`,children:[s.jsx(cp,{className:"w-4 h-4"}),s.jsx("span",{className:"text-sm font-medium",children:"All"}),r>0&&s.jsx("span",{className:"ml-1 px-1.5 py-0.5 text-xs font-semibold text-white rounded-full",style:{backgroundColor:"#714b67"},children:r}),e==="all"&&s.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-0.5",style:{backgroundColor:"#714b67"}})]}),s.jsxs("button",{onClick:()=>t("tasks"),className:`flex items-center gap-2 pb-4 px-1 relative ${e==="tasks"?"text-gray-900":"text-gray-600 hover:text-gray-900"} transition-colors`,children:[s.jsx(cw,{className:"w-4 h-4"}),s.jsx("span",{className:"text-sm font-medium",children:"Tasks"}),e==="tasks"&&s.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-0.5",style:{backgroundColor:"#714b67"}})]}),s.jsxs("button",{onClick:()=>t("archived"),className:`flex items-center gap-2 pb-4 px-1 relative ${e==="archived"?"text-gray-900":"text-gray-600 hover:text-gray-900"} transition-colors`,children:[s.jsx(sw,{className:"w-4 h-4"}),s.jsx("span",{className:"text-sm font-medium",children:"Archived"}),e==="archived"&&s.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-0.5",style:{backgroundColor:"#714b67"}})]})]}),s.jsxs("div",{className:"flex items-center justify-between mt-4",children:[s.jsx("button",{className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white rounded-lg hover:bg-gray-50 transition-colors",style:{border:"1.5px solid #714b67"},children:"Mark All as Read"}),s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("button",{className:"text-gray-400 hover:text-gray-600 transition-colors",children:s.jsx(qn,{className:"w-5 h-5"})}),s.jsx("button",{className:"text-gray-400 hover:text-gray-600 transition-colors",children:s.jsx(hp,{className:"w-5 h-5"})})]})]})]}),s.jsx("div",{className:"p-8",children:s.jsx("div",{className:"space-y-4",children:Bf[e].map(i=>s.jsx(wb,{notification:i,getInitials:n,getAvatarColor:a},i.id))})})]})})}function Nb(){return s.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[s.jsx("div",{className:"flex items-center justify-between mb-4",children:s.jsx("h3",{className:"text-sm font-semibold text-gray-900",children:"Completed Task"})}),s.jsx("div",{className:"mb-4",children:s.jsx("p",{className:"text-3xl font-bold text-gray-900",children:"21 Task"})}),s.jsx("button",{className:"w-full px-4 py-2 text-sm font-medium text-gray-700 bg-white rounded-lg hover:bg-gray-50 transition-colors",style:{border:"1.5px solid #714b67"},children:"View All"})]})}const Uf=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],zf=[45,75,35,60,51,40,55,65,50,70,45,60];function jb(){const[e,t]=T.useState(null),r=Math.max(...zf);return s.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsx("h3",{className:"text-sm font-semibold text-gray-900",children:"Active Projects"}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsxs("button",{className:"flex items-center gap-1 px-3 py-1.5 text-xs font-medium text-gray-700 bg-white rounded-lg hover:bg-gray-50",style:{border:"1.5px solid #714b67"},children:["January, 2023 - December, 2023",s.jsx(Wn,{className:"w-3 h-3"})]}),s.jsxs("button",{className:"flex items-center gap-1 px-3 py-1.5 text-xs font-medium text-gray-700 bg-white rounded-lg hover:bg-gray-50",style:{border:"1.5px solid #714b67"},children:["Month",s.jsx(Wn,{className:"w-3 h-3"})]})]})]}),s.jsxs("div",{className:"mb-4",children:[s.jsxs("div",{className:"flex items-baseline gap-2 mb-1",children:[s.jsx("p",{className:"text-3xl font-bold text-gray-900",children:"68 Projects"}),s.jsxs("div",{className:"flex items-center gap-1 text-green-600",children:[s.jsx(Li,{className:"w-4 h-4"}),s.jsx("span",{className:"text-sm font-semibold",children:"12%"})]})]}),s.jsx("p",{className:"text-sm text-gray-500",children:"This Month"})]}),s.jsxs("div",{className:"relative",children:[s.jsxs("div",{className:"absolute left-0 top-0 bottom-12 flex flex-col justify-between text-xs text-gray-500",style:{width:"30px"},children:[s.jsx("span",{children:"100"}),s.jsx("span",{children:"50"}),s.jsx("span",{children:"25"}),s.jsx("span",{children:"0"})]}),s.jsxs("div",{className:"ml-8",children:[s.jsx("div",{className:"flex items-end justify-between h-48 gap-1 relative",children:zf.map((n,a)=>{const i=n/r*100,l=e===a;return s.jsxs("div",{className:"flex-1 flex flex-col items-center group cursor-pointer relative h-full",onMouseEnter:()=>t(a),onMouseLeave:()=>t(null),children:[l&&s.jsxs("div",{className:"absolute bottom-full mb-2 px-3 py-2 bg-gray-900 text-white text-xs rounded-lg shadow-lg z-20 whitespace-nowrap",style:{left:"50%",transform:"translateX(-50%)",marginBottom:"8px"},children:[s.jsxs("div",{className:"flex items-center gap-1 mb-1",children:[s.jsx(ji,{className:"w-3 h-3"}),s.jsxs("span",{children:[Uf[a]," 2023"]})]}),s.jsxs("div",{children:["Active Projects ",n]}),s.jsx("div",{className:"absolute top-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-l-4 border-r-4 border-t-4 border-transparent border-t-gray-900"})]}),l&&s.jsx("div",{className:"absolute bottom-0 w-px border-l border-dashed border-gray-400 z-10",style:{left:"50%",transform:"translateX(-50%)",height:"100%",top:0}}),s.jsx("div",{className:"w-full h-full flex items-end",children:s.jsx("div",{className:"w-full rounded-t transition-all duration-200 relative z-0",style:{height:`${i}%`,backgroundColor:l?"#714b67":"#1f2937",minHeight:"8px"}})})]},a)})}),s.jsx("div",{className:"flex justify-between mt-2 text-xs text-gray-500",children:Uf.map((n,a)=>s.jsx("span",{className:"flex-1 text-center",children:n},a))})]})]})]})}const Sb=[{name:"Product Hunt",logo:"P",value:5,change:"up",color:"bg-orange-500"},{name:"Google",logo:"G",value:2,change:"up",color:"bg-blue-500"},{name:"Wordpress",logo:"W",value:1,change:"up",color:"bg-blue-600"},{name:"Tripadvisor",logo:"T",value:3,change:"down",color:"bg-green-500"},{name:"Slack",logo:"S",value:2,change:"down",color:"bg-purple-500"},{name:"Zendesk",logo:"Z",value:3,change:"down",color:"bg-gray-900"}];function _b(){return s.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[s.jsx("h3",{className:"text-sm font-semibold text-gray-900 mb-4",children:"Top Companies"}),s.jsx("div",{className:"space-y-3",children:Sb.map((e,t)=>s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsxs("span",{className:"text-sm font-medium text-gray-500",children:[t+1,"."]}),s.jsx("div",{className:`w-8 h-8 ${e.color} rounded flex items-center justify-center`,children:s.jsx("span",{className:"text-white font-bold text-sm",children:e.logo})}),s.jsx("span",{className:"text-sm font-medium text-gray-900",children:e.name})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"text-sm font-semibold text-gray-900",children:e.value}),e.change==="up"?s.jsx(Li,{className:"w-4 h-4 text-green-600"}):s.jsx(ww,{className:"w-4 h-4 text-red-600"})]})]},t))})]})}const jp=[{name:"Agency",value:57},{name:"Development",value:38},{name:"Marketing",value:25},{name:"Communication",value:38},{name:"Web Development",value:13},{name:"Travel Agency",value:11}],Eb=Math.max(...jp.map(e=>e.value));function Tb(){return s.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsx("h3",{className:"text-sm font-semibold text-gray-900",children:"Active Companies"}),s.jsxs("button",{className:"flex items-center gap-1 px-3 py-1.5 text-xs font-medium text-gray-700 bg-white rounded-lg hover:bg-gray-50",style:{border:"1.5px solid #714b67"},children:["Year",s.jsx(Wn,{className:"w-3 h-3"})]})]}),s.jsxs("div",{className:"mb-4",children:[s.jsxs("div",{className:"flex items-baseline gap-2 mb-1",children:[s.jsx("p",{className:"text-3xl font-bold text-gray-900",children:"341 Companies"}),s.jsxs("div",{className:"flex items-center gap-1 text-green-600",children:[s.jsx(Li,{className:"w-4 h-4"}),s.jsx("span",{className:"text-sm font-semibold",children:"12%"})]})]}),s.jsx("p",{className:"text-sm text-gray-500",children:"This Years"})]}),s.jsx("div",{className:"space-y-3",children:jp.map((e,t)=>{const r=e.value/Eb*100;return s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center justify-between mb-1",children:[s.jsx("span",{className:"text-sm text-gray-700",children:e.name}),s.jsx("span",{className:"text-sm font-semibold text-gray-900",children:e.value})]}),s.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:s.jsx("div",{className:"bg-gray-800 h-2 rounded-full transition-all duration-300",style:{width:`${r}%`}})})]},t)})})]})}const kb=[{day:"Sun",target:100,completed:75},{day:"Mon",target:100,completed:85},{day:"Tue",target:100,completed:60},{day:"Wed",target:100,completed:90},{day:"Thu",target:100,completed:70},{day:"Fri",target:100,completed:80},{day:"Sat",target:100,completed:65}];function Cb(){return s.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[s.jsx("h3",{className:"text-sm font-semibold text-gray-900 mb-6",children:"Completed Project Target This Week"}),s.jsx("div",{className:"flex items-end justify-between gap-2 h-32",children:kb.map((t,r)=>{const n=t.target/100*120,a=t.completed/100*120;return s.jsxs("div",{className:"flex-1 flex flex-col items-center",children:[s.jsxs("div",{className:"relative w-full flex flex-col items-center justify-end",style:{height:"120px"},children:[s.jsx("div",{className:"w-full bg-gray-200 rounded-t",style:{height:`${n}px`}}),s.jsx("div",{className:"absolute w-full bg-gray-900 rounded-t bottom-0",style:{height:`${a}px`}})]}),s.jsx("span",{className:"text-xs text-gray-500 mt-2",children:t.day})]},r)})})]})}function Ab(){const[e,t]=T.useState("analytics");return s.jsx("div",{className:"h-full bg-gray-50",children:s.jsxs("div",{className:"w-full bg-white min-h-full",children:[s.jsxs("div",{className:"border-b border-gray-200 px-8 py-6",children:[s.jsx("div",{className:"flex items-center justify-between mb-6",children:s.jsx("h1",{className:"text-2xl font-semibold text-gray-900",children:"Analytics"})}),s.jsxs("div",{className:"flex items-center gap-6 border-b border-gray-200",children:[s.jsxs("button",{onClick:()=>t("analytics"),className:`pb-4 px-1 relative ${e==="analytics"?"text-gray-900 font-medium":"text-gray-600 hover:text-gray-900"} transition-colors`,children:[s.jsx("span",{className:"text-sm",children:"Analytics"}),e==="analytics"&&s.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-0.5",style:{backgroundColor:"#714b67"}})]}),s.jsxs("button",{onClick:()=>t("sales"),className:`flex items-center gap-2 pb-4 px-1 relative ${e==="sales"?"text-gray-900 font-medium":"text-gray-600 hover:text-gray-900"} transition-colors`,children:[s.jsx(Cu,{className:"w-4 h-4"}),s.jsx("span",{className:"text-sm",children:"Sales"}),e==="sales"&&s.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-0.5",style:{backgroundColor:"#714b67"}})]}),s.jsxs("button",{onClick:()=>t("activity"),className:`flex items-center gap-2 pb-4 px-1 relative ${e==="activity"?"text-gray-900 font-medium":"text-gray-600 hover:text-gray-900"} transition-colors`,children:[s.jsx($t,{className:"w-4 h-4"}),s.jsx("span",{className:"text-sm",children:"Activity"}),e==="activity"&&s.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-0.5",style:{backgroundColor:"#714b67"}})]})]})]}),s.jsx("div",{className:"p-8",children:s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-12 gap-6",children:[s.jsx("div",{className:"lg:col-span-9",children:s.jsx(jb,{})}),s.jsxs("div",{className:"lg:col-span-3 space-y-6",children:[s.jsx(Nb,{}),s.jsx(_b,{})]}),s.jsxs("div",{className:"lg:col-span-12 grid grid-cols-1 md:grid-cols-2 gap-6",children:[s.jsx(Tb,{}),s.jsx(Cb,{})]})]})})]})})}const $f=()=>{const e=Jn(),[t,r]=T.useState({stats:{activeProjects:0,delayedTasks:0,hoursLogged:0,revenueEarned:0},projects:[],filteredProjects:[]}),[n,a]=T.useState({status:"all",search:""}),[i,l]=T.useState(!0),[o,c]=T.useState(null);T.useEffect(()=>{d()},[]),T.useEffect(()=>{u()},[n,t.projects]);const d=async()=>{try{l(!0),c(null);const[b,P]=await Promise.all([Mf.getStats(),Mf.getProjects()]);if(b.success&&P.success)r(M=>({...M,stats:b.data,projects:P.data,filteredProjects:P.data}));else throw new Error("Failed to load dashboard data")}catch(b){console.error("Dashboard data fetch error:",b),c(b.message)}finally{l(!1)}},u=()=>{let b=[...t.projects];if(n.status!=="all"&&(b=b.filter(P=>P.status===n.status)),n.search.trim()){const P=n.search.toLowerCase();b=b.filter(M=>{var j,O;return M.name.toLowerCase().includes(P)||((j=M.description)==null?void 0:j.toLowerCase().includes(P))||((O=M.manager)==null?void 0:O.name.toLowerCase().includes(P))})}r(P=>({...P,filteredProjects:b}))},f=b=>{a(P=>({...P,status:b}))},h=b=>{a(P=>({...P,search:b.target.value}))},m=b=>{e("/app/projects")},v=[{id:"active-projects",label:"Active Projects",value:t.stats.activeProjects,icon:Of,description:"Currently in progress"},{id:"delayed-tasks",label:"Delayed Tasks",value:t.stats.delayedTasks,icon:Qs,description:"Past due date"},{id:"hours-logged",label:"Hours Logged",value:t.stats.hoursLogged.toFixed(1),icon:$t,description:"Total time tracked"},{id:"revenue-earned",label:"Revenue Earned",value:`${t.stats.revenueEarned.toLocaleString()}`,icon:Li,description:"Approved expenses"}],x=[{id:"all",label:"All Projects"},{id:"planned",label:"Planned"},{id:"in_progress",label:"In Progress"},{id:"completed",label:"Completed"},{id:"on_hold",label:"On Hold"}],y=b=>b==="all"?t.projects.length:t.projects.filter(P=>P.status===b).length,p=b=>{const P={planned:{bg:"bg-purple-50",text:"text-[#714b67]",border:"border-purple-200"},in_progress:{bg:"bg-purple-100",text:"text-[#5a3a52]",border:"border-purple-300"},completed:{bg:"bg-gray-100",text:"text-gray-700",border:"border-gray-300"},on_hold:{bg:"bg-gray-50",text:"text-gray-600",border:"border-gray-200"}};return P[b]||P.planned},g=b=>b>=75?"bg-[#714b67]":b>=50?"bg-[#8a5a7f]":b>=25?"bg-purple-300":"bg-purple-200",w=b=>b?new Date(b).toLocaleDateString("en-GB",{day:"2-digit",month:"short"}):"N/A";return i?s.jsx("div",{className:"h-full bg-gray-50 flex items-center justify-center",children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-[#714b67] mx-auto mb-4"}),s.jsx("p",{className:"text-gray-600",children:"Loading dashboard..."})]})}):o?s.jsx("div",{className:"h-full bg-gray-50 flex items-center justify-center",children:s.jsxs("div",{className:"text-center",children:[s.jsx(Qs,{className:"w-12 h-12 text-[#714b67] mx-auto mb-4"}),s.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Error Loading Dashboard"}),s.jsx("p",{className:"text-gray-600 mb-4",children:o}),s.jsx("button",{onClick:d,className:"px-4 py-2 bg-[#714b67] text-white rounded-lg hover:bg-[#5a3a52] transition-colors",children:"Retry"})]})}):s.jsx("div",{className:"h-full bg-gray-50 overflow-auto",children:s.jsxs("div",{className:"w-full bg-white min-h-full",children:[s.jsx("div",{className:"border-b border-gray-200 px-8 py-6 bg-gradient-to-r from-white to-gray-50",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("h1",{className:"text-2xl font-semibold text-gray-900",children:"Dashboard"}),s.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Welcome back! Here's what's happening with your projects today."})]}),s.jsx("button",{onClick:d,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:"Refresh"})]})}),s.jsxs("div",{className:"p-8 space-y-8",children:[s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:v.map(b=>{const P=b.icon;return s.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6 hover:shadow-lg transition-all duration-200",children:[s.jsx("div",{className:"flex items-center justify-between mb-4",children:s.jsx("div",{className:"bg-purple-50 p-3 rounded-lg",children:s.jsx(P,{className:"w-6 h-6 text-[#714b67]"})})}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-600 mb-1",children:b.label}),s.jsx("p",{className:"text-3xl font-bold text-gray-900 mb-2",children:b.value}),s.jsx("p",{className:"text-xs text-gray-500",children:b.description})]})]},b.id)})}),s.jsx("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:s.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4",children:[s.jsxs("div",{className:"flex items-center gap-3 flex-wrap",children:[s.jsxs("div",{className:"flex items-center gap-2 text-gray-700",children:[s.jsx(qn,{className:"w-5 h-5"}),s.jsx("span",{className:"text-sm font-medium",children:"Filter:"})]}),x.map(b=>s.jsxs("button",{onClick:()=>f(b.id),className:`px-4 py-2 rounded-lg text-sm font-medium transition-all duration-200 ${n.status===b.id?"bg-[#714b67] text-white shadow-md":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:[b.label," ",s.jsxs("span",{className:"ml-1 opacity-75",children:["(",y(b.id),")"]})]},b.id))]}),s.jsxs("div",{className:"relative",children:[s.jsx(pn,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),s.jsx("input",{type:"text",placeholder:"Search projects, managers...",value:n.search,onChange:h,className:"pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#714b67] focus:border-transparent w-full lg:w-80 transition-all"})]})]})}),t.filteredProjects.length===0?s.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-12 text-center",children:[s.jsx(Of,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),s.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No projects found"}),s.jsx("p",{className:"text-gray-600 mb-6",children:n.search?"Try adjusting your search or filter criteria":"Get started by creating your first project"}),s.jsx("button",{onClick:()=>e("/app/projects"),className:"px-6 py-3 bg-[#714b67] text-white rounded-lg hover:bg-[#5a3a52] transition-colors",children:"Go to Projects"})]}):s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:t.filteredProjects.map(b=>{var M,j;const P=p(b.status);return s.jsxs("div",{onClick:()=>m(b.id),className:"bg-white border border-gray-200 rounded-lg p-6 hover:shadow-xl hover:-translate-y-1 transition-all duration-200 cursor-pointer group",children:[s.jsxs("div",{className:"mb-4",children:[s.jsxs("div",{className:"flex items-start justify-between mb-2",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 line-clamp-1 group-hover:text-[#714b67] transition-colors",children:b.name}),s.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium border ${P.bg} ${P.text} ${P.border}`,children:b.statusLabel})]}),b.description&&s.jsx("p",{className:"text-sm text-gray-600 line-clamp-2 mt-2",children:b.description})]}),s.jsxs("div",{className:"mb-4",children:[s.jsxs("div",{className:"flex justify-between items-center mb-2",children:[s.jsx("span",{className:"text-xs font-medium text-gray-700",children:"Progress"}),s.jsxs("span",{className:"text-xs font-semibold text-gray-900",children:[b.progress,"%"]})]}),s.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2 overflow-hidden",children:s.jsx("div",{className:`h-full transition-all duration-500 ${g(b.progress)}`,style:{width:`${b.progress}%`}})})]}),s.jsxs("div",{className:"grid grid-cols-3 gap-3 mb-4 py-3 border-t border-b border-gray-100",children:[s.jsxs("div",{className:"text-center",children:[s.jsx(Qe,{className:"w-4 h-4 text-[#714b67] mx-auto mb-1"}),s.jsx("p",{className:"text-xs text-gray-600 mb-0.5",children:"Tasks"}),s.jsxs("p",{className:"text-sm font-semibold text-gray-900",children:[b.tasks.completed,"/",b.tasks.total]})]}),s.jsxs("div",{className:"text-center",children:[s.jsx(Qs,{className:"w-4 h-4 text-[#714b67] mx-auto mb-1"}),s.jsx("p",{className:"text-xs text-gray-600 mb-0.5",children:"Delayed"}),s.jsx("p",{className:"text-sm font-semibold text-gray-900",children:b.tasks.delayed})]}),s.jsxs("div",{className:"text-center",children:[s.jsx(ji,{className:"w-4 h-4 text-[#714b67] mx-auto mb-1"}),s.jsx("p",{className:"text-xs text-gray-600 mb-0.5",children:"Due"}),s.jsx("p",{className:"text-sm font-semibold text-gray-900",children:w(b.due)})]})]}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:"w-8 h-8 bg-gray-200 rounded-full flex items-center justify-center",children:s.jsx(Au,{className:"w-4 h-4 text-gray-600"})}),s.jsx("span",{className:"text-xs text-gray-600 font-medium",children:((M=b.manager)==null?void 0:M.name)||"Unassigned"})]}),((j=b.budget)==null?void 0:j.amount)&&s.jsxs("span",{className:"text-xs font-semibold text-gray-900",children:[b.budget.currency," ",b.budget.amount.toLocaleString()]})]})]},b.id)})})]})]})})};function Ou({title:e,children:t,className:r=""}){return s.jsxs("div",{className:`auth-box ${r} p-6 rounded-2xl bg-white border border-gray-200 shadow-sm`,children:[e&&s.jsx("h2",{className:"auth-title text-2xl font-semibold mb-6 text-gray-900",children:e}),t]})}function Hs({label:e,type:t="text",name:r,placeholder:n="",...a}){return s.jsxs("label",{className:"block mb-4 text-sm text-gray-700",children:[s.jsx("div",{className:"mb-2 text-gray-600",children:e}),s.jsx("input",{className:"auth-input w-full rounded-md border border-gray-300 px-4 py-2 bg-white text-gray-900 placeholder-gray-400",type:t,name:r,placeholder:n,...a})]})}function Ru({variant:e="login"}){return s.jsxs("header",{className:"w-full py-4 px-6 flex items-center justify-between border-b border-gray-100 bg-white",children:[s.jsx("div",{className:"flex items-center",children:s.jsx("img",{src:Np,alt:"OneFlow Logo",className:"h-20 w-auto"})}),s.jsx("div",{children:e==="login"?s.jsx(eo,{to:"/signup",className:"px-4 py-2 rounded-md bg-purple-600 text-white hover:bg-purple-700",children:"Sign Up"}):s.jsx(eo,{to:"/login",className:"px-4 py-2 rounded-md bg-purple-600 text-white hover:bg-purple-700",children:"Login"})})]})}function Fb(){const e=Jn(),[t,r]=T.useState({workEmail:"",password:""}),[n,a]=T.useState(!1),[i,l]=T.useState(""),o=d=>{r({...t,[d.target.name]:d.target.value}),i&&l("")},c=async d=>{d.preventDefault(),l(""),a(!0);try{const u=await be(we.login,{method:"POST",body:JSON.stringify(t)});u.success?(eb(u.data.user),e("/app")):l(u.message||"Login failed. Please try again.")}catch(u){console.error("Login error:",u),l("Unable to connect to server. Please try again later.")}finally{a(!1)}};return s.jsxs("div",{className:"min-h-screen bg-white",children:[s.jsx(Ru,{variant:"login"}),s.jsx("div",{className:"flex items-center justify-center p-6",children:s.jsx("div",{className:"max-w-md w-full",children:s.jsx(Ou,{title:"Login into account",children:s.jsxs("form",{className:"space-y-2",onSubmit:c,children:[i&&s.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-md text-sm",children:i}),s.jsx(Hs,{label:"Work Email",name:"workEmail",type:"email",placeholder:"you@company.com",value:t.workEmail,onChange:o,required:!0}),s.jsx(Hs,{label:"Password",name:"password",type:"password",placeholder:"",value:t.password,onChange:o,required:!0}),s.jsx("div",{className:"text-sm text-purple-600 mt-2",children:"Forget password?"}),s.jsx("div",{className:"pt-4",children:s.jsx("button",{type:"submit",className:"auth-btn w-full text-white font-medium py-2 rounded-md disabled:opacity-50 disabled:cursor-not-allowed",disabled:n,children:n?"Logging in...":"Login"})})]})})})})]})}function Pb(){const e=Jn(),[t,r]=T.useState({firstName:"",lastName:"",workEmail:"",password:"",role:"user"}),[n,a]=T.useState(!1),[i,l]=T.useState(!1),[o,c]=T.useState(""),[d,u]=T.useState(!1),f=m=>{r({...t,[m.target.name]:m.target.value}),o&&c("")},h=async m=>{if(m.preventDefault(),c(""),!n){c("Please agree to the Terms of Service and Privacy Policy");return}if(t.password.length<8){c("Password must be at least 8 characters long");return}l(!0);try{const v=await be(we.register,{method:"POST",body:JSON.stringify(t)});v.success?(u(!0),setTimeout(()=>{e("/login")},2e3)):c(v.message||"Registration failed. Please try again.")}catch(v){console.error("Registration error:",v),c("Unable to connect to server. Please try again later.")}finally{l(!1)}};return d?s.jsxs("div",{className:"min-h-screen bg-white",children:[s.jsx(Ru,{variant:"signup"}),s.jsx("div",{className:"flex items-center justify-center p-6",children:s.jsx("div",{className:"max-w-3xl w-full",children:s.jsx(Ou,{title:"Account Created Successfully! ",children:s.jsxs("div",{className:"text-center py-6",children:[s.jsx("div",{className:"bg-green-50 border border-green-200 text-green-700 px-4 py-3 rounded-md text-sm mb-4",children:"Your account has been created successfully!"}),s.jsx("p",{className:"text-gray-600 mb-4",children:"Redirecting you to login page..."}),s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-purple-600 mx-auto"})]})})})})]}):s.jsxs("div",{className:"min-h-screen bg-white",children:[s.jsx(Ru,{variant:"signup"}),s.jsx("div",{className:"flex items-center justify-center p-6",children:s.jsx("div",{className:"max-w-3xl w-full",children:s.jsx(Ou,{title:"Create an account",children:s.jsxs("form",{className:"space-y-2",onSubmit:h,children:[o&&s.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-md text-sm",children:o}),s.jsx(Hs,{label:"First name",name:"firstName",placeholder:"John",value:t.firstName,onChange:f,required:!0}),s.jsx(Hs,{label:"Last name",name:"lastName",placeholder:"Doe",value:t.lastName,onChange:f,required:!0}),s.jsx(Hs,{label:"Work Email",name:"workEmail",type:"email",placeholder:"you@company.com",value:t.workEmail,onChange:f,required:!0}),s.jsx(Hs,{label:"Password",name:"password",type:"password",placeholder:"",value:t.password,onChange:f,required:!0}),s.jsxs("label",{className:"flex items-center text-sm text-gray-600 mt-2",children:[s.jsx("input",{type:"checkbox",className:"mr-2",checked:n,onChange:m=>a(m.target.checked)}),s.jsx("span",{children:"I agree to the Terms of Service and Privacy Policy."})]}),s.jsx("div",{className:"pt-4",children:s.jsx("button",{type:"submit",className:"auth-btn w-full text-white font-medium py-2 rounded-md disabled:opacity-50 disabled:cursor-not-allowed",disabled:i,children:i?"Creating account...":"Create an account"})})]})})})})]})}function Ob(){const e=Jn();return s.jsx("div",{className:"min-h-screen flex items-center justify-center bg-white p-8",children:s.jsxs("div",{className:"max-w-4xl text-center",children:[s.jsx("h1",{className:"text-5xl md:text-6xl font-bold leading-tight mb-6",children:"From Planning to Payout Seamlessly"}),s.jsx("p",{className:"text-lg text-gray-600 mb-8",children:"Track pipelines, close more deals, and nurture long-term growth."}),s.jsxs("div",{className:"flex items-center justify-center gap-4",children:[s.jsx("button",{onClick:()=>e("/signup"),className:"auth-btn px-6 py-3 text-lg shadow-md",children:"Start For Free"}),s.jsx("button",{onClick:()=>e("/login"),className:"border border-gray-300 px-6 py-3 rounded-md text-gray-700 hover:bg-gray-50",children:"Login"})]})]})})}const Wf={draft:"bg-gray-100 text-gray-700",submitted:"bg-yellow-100 text-yellow-700",approved:"bg-green-100 text-green-700",rejected:"bg-red-100 text-red-700",reimbursed:"bg-blue-100 text-blue-700",paid:"bg-purple-100 text-purple-700"},Rb={draft:wt,submitted:$t,approved:Qe,rejected:Nr,reimbursed:Qe,paid:Qe};function Ib({expenses:e,selectedIds:t,onSelect:r,onSelectAll:n,onRowClick:a}){const i=e.length>0&&t.length===e.length,l=t.length>0&&t.length<e.length,o=(u,f="INR")=>new Intl.NumberFormat("en-IN",{style:"currency",currency:f,minimumFractionDigits:0,maximumFractionDigits:0}).format(u),c=u=>u?new Date(u).toLocaleDateString("en-IN",{day:"numeric",month:"short",year:"numeric"}):"-",d=u=>{const f=Rb[u]||wt;return s.jsxs("span",{className:`inline-flex items-center gap-1.5 px-2.5 py-1 rounded-full text-xs font-medium ${Wf[u]||Wf.draft}`,children:[s.jsx(f,{className:"w-3 h-3"}),u.charAt(0).toUpperCase()+u.slice(1)]})};return e.length===0?s.jsx("div",{className:"text-center py-12",children:s.jsx("p",{className:"text-gray-500",children:"No expenses found"})}):s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"w-full border-collapse",children:[s.jsx("thead",{children:s.jsxs("tr",{className:"border-b border-gray-200",children:[s.jsx("th",{className:"px-4 py-3 text-left",children:s.jsx("input",{type:"checkbox",checked:i,ref:u=>{u&&(u.indeterminate=l)},onChange:u=>n(u.target.checked),className:"w-4 h-4 text-purple-600 rounded focus:ring-purple-500"})}),s.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Date"}),s.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Employee"}),s.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Project"}),s.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Category"}),s.jsx("th",{className:"px-4 py-3 text-right text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Amount"}),s.jsx("th",{className:"px-4 py-3 text-center text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Billable"}),s.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Status"}),s.jsx("th",{className:"px-4 py-3 text-center text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Receipt"}),s.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Invoice"}),s.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Notes"}),s.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Updated"})]})}),s.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:e.map(u=>s.jsxs("tr",{onClick:()=>a(u),className:"hover:bg-gray-50 cursor-pointer transition-colors",children:[s.jsx("td",{className:"px-4 py-3",onClick:f=>f.stopPropagation(),children:s.jsx("input",{type:"checkbox",checked:t.includes(u.id),onChange:f=>{f.stopPropagation(),r(u.id,f.target.checked)},className:"w-4 h-4 text-purple-600 rounded focus:ring-purple-500"})}),s.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:c(u.spentOn)}),s.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:s.jsxs("div",{children:[s.jsx("div",{className:"font-medium",children:u.employeeName||"Unknown"}),u.employeeEmail&&s.jsx("div",{className:"text-xs text-gray-500",children:u.employeeEmail})]})}),s.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:u.projectName||"-"}),s.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:u.category}),s.jsx("td",{className:"px-4 py-3 text-sm text-right font-medium text-gray-900",children:o(u.amount,u.currency)}),s.jsx("td",{className:"px-4 py-3 text-center",children:u.isBillable?s.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-700",children:"Yes"}):s.jsx("span",{className:"text-gray-400",children:"-"})}),s.jsx("td",{className:"px-4 py-3",children:d(u.status)}),s.jsx("td",{className:"px-4 py-3 text-center",children:u.receiptFileId?s.jsx(dp,{className:"w-4 h-4 text-gray-600 mx-auto"}):s.jsx("span",{className:"text-gray-300",children:"-"})}),s.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:u.invoiceNumber?s.jsx("span",{className:"text-blue-600 hover:underline",children:u.invoiceNumber}):s.jsx("span",{className:"text-gray-400",children:"-"})}),s.jsx("td",{className:"px-4 py-3 text-sm text-gray-500 max-w-xs truncate",children:u.note||"-"}),s.jsx("td",{className:"px-4 py-3 text-sm text-gray-500",children:c(u.updatedAt)})]},u.id))})]})})}function Db({filters:e,projects:t,employees:r,categories:n,onFilterChange:a,onSavedViewChange:i}){const[l,o]=T.useState(!1),c=Gr(),d=((c==null?void 0:c.role)||"").toLowerCase()==="employee",u=[{id:"my-team",label:"My Team",filters:{status:["submitted","draft"]}},{id:"billable-only",label:"Billable Only",filters:{is_billable:"true"}},{id:"missing-receipts",label:"Missing Receipts",filters:{missing_receipt:"true"}}],f=[{key:"missing_receipt",label:"Missing Receipt",value:"true"},{key:"over_policy",label:"Over Policy",value:"true"},{key:"is_billable",label:"Billable",value:"true"},{key:"this_week",label:"This Week",value:h()},{key:"this_month",label:"This Month",value:m()}];function h(){const p=new Date,g=new Date(p);return g.setDate(p.getDate()-p.getDay()),{date_from:g.toISOString().split("T")[0],date_to:p.toISOString().split("T")[0]}}function m(){const p=new Date;return{date_from:new Date(p.getFullYear(),p.getMonth(),1).toISOString().split("T")[0],date_to:p.toISOString().split("T")[0]}}const v=p=>{p.value==="true"?a({[p.key]:p.value}):typeof p.value=="object"&&a(p.value)},x=p=>{a({[p]:void 0})},y=Object.keys(e).filter(p=>{const g=e[p];return!(g===void 0||g===""||g===null||Array.isArray(g)&&g.length===0)}).length;return s.jsxs("div",{className:"relative",children:[s.jsxs("button",{onClick:()=>o(!l),className:"flex items-center gap-2 px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",children:[s.jsx(qn,{className:"w-4 h-4"}),s.jsx("span",{children:"Filters"}),y>0&&s.jsx("span",{className:"px-2 py-0.5 text-xs font-semibold text-white rounded-full",style:{backgroundColor:"#714b67"},children:y}),s.jsx(Wn,{className:`w-4 h-4 transition-transform ${l?"rotate-180":""}`})]}),l&&s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"fixed inset-0 z-10",onClick:()=>o(!1)}),s.jsxs("div",{className:"absolute right-0 mt-2 w-80 bg-white border border-gray-200 rounded-lg shadow-xl z-20",children:[s.jsxs("div",{className:"p-4 border-b border-gray-200",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsx("h3",{className:"text-sm font-semibold text-gray-900",children:"Filters"}),s.jsx("button",{onClick:()=>o(!1),className:"text-gray-400 hover:text-gray-600",children:s.jsx(ze,{className:"w-4 h-4"})})]}),s.jsxs("div",{className:"mb-4",children:[s.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2",children:"Saved Views"}),s.jsxs("select",{onChange:p=>{if(p.target.value){const g=u.find(w=>w.id===p.target.value);g&&i(g.filters)}p.target.value=""},className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500",children:[s.jsx("option",{value:"",children:"Select a view..."}),u.map(p=>s.jsx("option",{value:p.id,children:p.label},p.id))]})]}),s.jsxs("div",{className:"mb-4",children:[s.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2",children:"Quick Filters"}),s.jsx("div",{className:"flex flex-wrap gap-2",children:f.map(p=>s.jsx("button",{onClick:()=>v(p),className:"px-3 py-1 text-xs font-medium text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200",children:p.label},p.key))})]})]}),s.jsxs("div",{className:"p-4 space-y-4 max-h-96 overflow-y-auto",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Project"}),s.jsxs("select",{value:e.project_id||"",onChange:p=>a({project_id:p.target.value||void 0}),className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500",children:[s.jsx("option",{value:"",children:"All Projects"}),t.map(p=>s.jsx("option",{value:p.id,children:p.name},p.id))]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Status"}),s.jsxs("select",{value:Array.isArray(e.status)?e.status[0]||"":e.status||"",onChange:p=>{const g=p.target.value;a({status:g?[g]:void 0})},className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500",children:[s.jsx("option",{value:"",children:"All Statuses"}),s.jsx("option",{value:"draft",children:"Draft"}),s.jsx("option",{value:"submitted",children:"Submitted"}),s.jsx("option",{value:"approved",children:"Approved"}),s.jsx("option",{value:"rejected",children:"Rejected"}),s.jsx("option",{value:"reimbursed",children:"Reimbursed"}),s.jsx("option",{value:"paid",children:"Paid"})]})]}),!d&&s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Employee"}),s.jsxs("select",{value:e.user_id||"",onChange:p=>a({user_id:p.target.value||void 0}),className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500",children:[s.jsx("option",{value:"",children:"All Employees"}),r.map(p=>s.jsx("option",{value:p.id,children:p.name},p.id))]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Category"}),s.jsxs("select",{value:e.category||"",onChange:p=>a({category:p.target.value||void 0}),className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500",children:[s.jsx("option",{value:"",children:"All Categories"}),n.map(p=>s.jsx("option",{value:p,children:p},p))]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Billable"}),s.jsxs("select",{value:e.is_billable||"",onChange:p=>a({is_billable:p.target.value||void 0}),className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500",children:[s.jsx("option",{value:"",children:"All"}),s.jsx("option",{value:"true",children:"Billable"}),s.jsx("option",{value:"false",children:"Not Billable"})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Date From"}),s.jsx("input",{type:"date",value:e.date_from||"",onChange:p=>a({date_from:p.target.value||void 0}),className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Date To"}),s.jsx("input",{type:"date",value:e.date_to||"",onChange:p=>a({date_to:p.target.value||void 0}),className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Amount Min"}),s.jsx("input",{type:"number",value:e.amount_min||"",onChange:p=>a({amount_min:p.target.value||void 0}),placeholder:"0",className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Amount Max"}),s.jsx("input",{type:"number",value:e.amount_max||"",onChange:p=>a({amount_max:p.target.value||void 0}),placeholder:"100000",className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500"})]})]}),y>0&&s.jsxs("div",{className:"p-4 border-t border-gray-200",children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsx("span",{className:"text-xs font-medium text-gray-700",children:"Active Filters"}),s.jsx("button",{onClick:()=>a({}),className:"text-xs hover:underline",style:{color:"#714b67"},children:"Clear All"})]}),s.jsx("div",{className:"flex flex-wrap gap-2",children:Object.keys(e).map(p=>{const g=e[p];if(g===void 0||g===""||g===null||Array.isArray(g)&&g.length===0)return null;let w=g;Array.isArray(g)&&(w=g.join(", "));const b=p.replace(/_/g," ").replace(/\b\w/g,P=>P.toUpperCase());return s.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 text-xs bg-gray-100 text-gray-700 rounded",children:[s.jsxs("span",{children:[b,": ",w]}),s.jsx("button",{onClick:P=>{P.stopPropagation(),x(p)},className:"text-gray-500 hover:text-gray-700 ml-1",type:"button",children:s.jsx(ze,{className:"w-3 h-3"})})]},p)})})]})]})]})]})}function Lb({selectedCount:e,onBulkApprove:t,onBulkReject:r,onBulkAddToInvoice:n,onExportCSV:a}){const[i,l]=T.useState(!1),[o,c]=T.useState("");if(e===0)return null;const d=()=>{o.trim()&&(r(o),c(""),l(!1))};return s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"bg-purple-50 border border-purple-200 rounded-lg p-4 mb-4",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("div",{className:"flex items-center gap-3",children:s.jsxs("span",{className:"text-sm font-medium text-purple-900",children:[e," expense",e!==1?"s":""," selected"]})}),s.jsxs("div",{className:"flex items-center gap-2",children:[t&&s.jsxs("button",{onClick:t,className:"flex items-center gap-2 px-4 py-2 text-sm font-medium text-white bg-green-600 rounded-lg hover:bg-green-700",children:[s.jsx(Qe,{className:"w-4 h-4"}),"Approve"]}),r&&s.jsxs("button",{onClick:()=>l(!0),className:"flex items-center gap-2 px-4 py-2 text-sm font-medium text-white bg-red-600 rounded-lg hover:bg-red-700",children:[s.jsx(Nr,{className:"w-4 h-4"}),"Reject"]}),n&&s.jsxs("button",{onClick:n,className:"flex items-center gap-2 px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-lg hover:bg-blue-700",children:[s.jsx(wt,{className:"w-4 h-4"}),"Add to Invoice"]}),s.jsxs("button",{onClick:a,className:"flex items-center gap-2 px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",children:[s.jsx(da,{className:"w-4 h-4"}),"Export CSV"]})]})]})}),i&&s.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black bg-opacity-50",children:s.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full p-6",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Reject Expenses"}),s.jsxs("p",{className:"text-sm text-gray-600 mb-4",children:["Please provide a reason for rejecting ",e," expense",e!==1?"s":"","."]}),s.jsx("textarea",{value:o,onChange:u=>c(u.target.value),placeholder:"Enter rejection reason...",rows:4,className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-red-500 mb-4"}),s.jsxs("div",{className:"flex items-center justify-end gap-3",children:[s.jsx("button",{onClick:()=>{l(!1),c("")},className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",children:"Cancel"}),s.jsx("button",{onClick:d,disabled:!o.trim(),className:"px-4 py-2 text-sm font-medium text-white bg-red-600 rounded-lg hover:bg-red-700 disabled:opacity-50 disabled:cursor-not-allowed",children:"Reject"})]})]})})]})}const Hf={draft:"bg-gray-100 text-gray-700",submitted:"bg-yellow-100 text-yellow-700",approved:"bg-green-100 text-green-700",rejected:"bg-red-100 text-red-700",reimbursed:"bg-blue-100 text-blue-700",paid:"bg-purple-100 text-purple-700"};function Mb({expense:e,onClose:t,onUpdate:r,onApprove:n,onReject:a,onAddToInvoice:i}){var je;const[l,o]=T.useState(e),[c,d]=T.useState(!1),[u,f]=T.useState(!1),[h,m]=T.useState(""),[v,x]=T.useState(null);T.useEffect(()=>{x(Gr()),e!=null&&e.id&&!e.activityLog?y():o(e)},[e]);const y=async()=>{d(!0);try{const q=await pr.getById(e.id);q.success&&o(q.data)}catch(q){console.error("Error loading expense details:",q)}finally{d(!1)}},p=(q,W="INR")=>new Intl.NumberFormat("en-IN",{style:"currency",currency:W,minimumFractionDigits:0,maximumFractionDigits:0}).format(q),g=q=>q?new Date(q).toLocaleDateString("en-IN",{day:"numeric",month:"short",year:"numeric"}):"-",w=q=>q?new Date(q).toLocaleString("en-IN",{day:"numeric",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"}):"-",b=q=>{const W=q==="submitted"?$t:q==="approved"?Qe:q==="rejected"?Nr:wt;return s.jsxs("span",{className:`inline-flex items-center gap-1.5 px-3 py-1.5 rounded-full text-sm font-medium ${Hf[q]||Hf.draft}`,children:[s.jsx(W,{className:"w-4 h-4"}),q.charAt(0).toUpperCase()+q.slice(1)]})},M=((v==null?void 0:v.role)||"").toLowerCase()==="employee",j=!M&&(l==null?void 0:l.status)==="submitted"&&(l==null?void 0:l.projectId)&&(l==null?void 0:l.userId)!==(v==null?void 0:v.id)&&(!((l==null?void 0:l.amount)>500)||(l==null?void 0:l.receiptFileId)),O=!M&&((l==null?void 0:l.status)==="submitted"||(l==null?void 0:l.status)==="approved"),R=!M&&(l==null?void 0:l.status)==="approved"&&(l==null?void 0:l.isBillable)&&!(l!=null&&l.invoiceLineId),I=(l==null?void 0:l.status)==="draft"||(l==null?void 0:l.status)==="rejected",D=async()=>{try{const q=await pr.approve(l.id);q.success?(n(l.id),r(),t()):alert(q.message||"Failed to approve expense")}catch(q){console.error("Error approving expense:",q),alert(q.message||"Failed to approve expense")}},z=async()=>{if(h.trim())try{const q=await pr.reject(l.id,h);q.success?(a(l.id),r(),f(!1),m(""),t()):alert(q.message||"Failed to reject expense")}catch(q){console.error("Error rejecting expense:",q),alert(q.message||"Failed to reject expense")}},ne=()=>{i([l])},Ne=l!=null&&l.receiptUrl?l.receiptUrl.startsWith("http")?l.receiptUrl:`http://localhost:5000${l.receiptUrl}`:null,ue=(je=l==null?void 0:l.receiptMimeType)==null?void 0:je.startsWith("image/");return s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"fixed inset-0 z-40 bg-black bg-opacity-30",onClick:t}),s.jsx("div",{className:"fixed right-0 top-0 h-full w-full max-w-2xl bg-white shadow-xl z-50 overflow-y-auto",children:c?s.jsx("div",{className:"flex items-center justify-center h-full",children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"inline-block animate-spin rounded-full h-12 w-12 border-b-2 border-gray-900 mb-4"}),s.jsx("p",{className:"text-gray-600",children:"Loading expense details..."})]})}):s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"sticky top-0 bg-white border-b border-gray-200 px-6 py-4 flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[b(l==null?void 0:l.status),s.jsxs("div",{children:[s.jsx("div",{className:"text-2xl font-semibold text-gray-900",children:p((l==null?void 0:l.amount)||0,l==null?void 0:l.currency)}),s.jsx("div",{className:"text-sm text-gray-500",children:l==null?void 0:l.currency})]})]}),s.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-600",children:s.jsx(ze,{className:"w-5 h-5"})})]}),s.jsxs("div",{className:"p-6 space-y-6",children:[s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"Project"}),s.jsx("p",{className:"text-sm font-medium text-gray-900",children:(l==null?void 0:l.projectName)||"-"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"Category"}),s.jsx("p",{className:"text-sm font-medium text-gray-900",children:(l==null?void 0:l.category)||"-"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"Employee"}),s.jsx("p",{className:"text-sm font-medium text-gray-900",children:(l==null?void 0:l.employeeName)||"-"}),(l==null?void 0:l.employeeEmail)&&s.jsx("p",{className:"text-xs text-gray-500",children:l.employeeEmail})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"Expense Date"}),s.jsx("p",{className:"text-sm font-medium text-gray-900",children:g(l==null?void 0:l.spentOn)})]}),(l==null?void 0:l.merchant)&&s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"Merchant/Vendor"}),s.jsx("p",{className:"text-sm font-medium text-gray-900",children:l.merchant})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"Payment Method"}),s.jsx("p",{className:"text-sm font-medium text-gray-900",children:l!=null&&l.paymentMethod?l.paymentMethod.charAt(0).toUpperCase()+l.paymentMethod.slice(1).replace("_"," "):"-"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"Tax"}),s.jsx("p",{className:"text-sm font-medium text-gray-900",children:p((l==null?void 0:l.taxAmount)||0,l==null?void 0:l.currency)})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"Billable"}),s.jsx("p",{className:"text-sm font-medium text-gray-900",children:l!=null&&l.isBillable?s.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-700",children:"Yes"}):s.jsx("span",{className:"text-gray-400",children:"No"})})]})]}),(l==null?void 0:l.note)&&s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"Description/Notes"}),s.jsx("p",{className:"text-sm text-gray-900 whitespace-pre-wrap",children:l.note})]}),(l==null?void 0:l.amount)>500&&!(l!=null&&l.receiptFileId)&&s.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-3",children:s.jsxs("div",{className:"flex items-start gap-2",children:[s.jsx(Qs,{className:"w-5 h-5 text-yellow-600 flex-shrink-0 mt-0.5"}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-yellow-800",children:"Receipt Required"}),s.jsx("p",{className:"text-xs text-yellow-700 mt-1",children:"Expenses over 500 require a receipt for approval."})]})]})}),(l==null?void 0:l.duplicates)&&l.duplicates.length>0&&s.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3",children:s.jsxs("div",{className:"flex items-start gap-2",children:[s.jsx(Qs,{className:"w-5 h-5 text-blue-600 flex-shrink-0 mt-0.5"}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-blue-800",children:"Possible Duplicate"}),s.jsxs("p",{className:"text-xs text-blue-700 mt-1",children:["Found ",l.duplicates.length," similar expense(s) from the same employee on the same date with the same amount."]})]})]})}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-medium text-gray-500 mb-2",children:"Receipt"}),l!=null&&l.receiptFileId?s.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[ue&&Ne?s.jsx("img",{src:Ne,alt:"Receipt",className:"max-w-full rounded-lg mb-2"}):s.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[s.jsx(wt,{className:"w-5 h-5"}),s.jsx("span",{children:l.receiptFilename||"Receipt file"})]}),Ne&&s.jsxs("a",{href:Ne,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-2 mt-2 text-sm text-purple-600 hover:text-purple-700",children:[s.jsx(da,{className:"w-4 h-4"}),"Download Receipt"]})]}):s.jsx("p",{className:"text-sm text-gray-400",children:"No receipt attached"})]}),(l==null?void 0:l.invoiceNumber)&&s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"Linked Invoice"}),s.jsx("a",{href:`/app/invoices/${l.invoiceId}`,className:"text-sm text-blue-600 hover:text-blue-700 hover:underline",children:l.invoiceNumber})]}),s.jsxs("div",{className:"flex flex-wrap gap-2 pt-4 border-t border-gray-200",children:[j&&s.jsxs("button",{onClick:D,className:"flex items-center gap-2 px-4 py-2 text-sm font-medium text-white bg-green-600 rounded-lg hover:bg-green-700",children:[s.jsx(Qe,{className:"w-4 h-4"}),"Approve"]}),O&&s.jsxs("button",{onClick:()=>f(!0),className:"flex items-center gap-2 px-4 py-2 text-sm font-medium text-white bg-red-600 rounded-lg hover:bg-red-700",children:[s.jsx(Nr,{className:"w-4 h-4"}),"Reject"]}),R&&s.jsxs("button",{onClick:ne,className:"flex items-center gap-2 px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-lg hover:bg-blue-700",children:[s.jsx(wt,{className:"w-4 h-4"}),"Add to Invoice"]}),!(l!=null&&l.projectId)&&s.jsxs("button",{onClick:()=>{},className:"flex items-center gap-2 px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",children:[s.jsx(fw,{className:"w-4 h-4"}),"Link to Project"]}),I&&s.jsxs("button",{onClick:()=>{},className:"flex items-center gap-2 px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",children:[s.jsx(gw,{className:"w-4 h-4"}),"Edit"]})]}),(l==null?void 0:l.activityLog)&&l.activityLog.length>0&&s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-medium text-gray-500 mb-2",children:"Activity Log"}),s.jsx("div",{className:"space-y-3",children:l.activityLog.map((q,W)=>s.jsxs("div",{className:"flex items-start gap-3 pb-3 border-b border-gray-100 last:border-0",children:[s.jsx("div",{className:"flex-shrink-0 w-2 h-2 rounded-full bg-purple-600 mt-2"}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsxs("p",{className:"text-sm text-gray-900",children:[s.jsx("span",{className:"font-medium",children:q.actorName||"System"})," ",q.operation==="I"&&"created",q.operation==="U"&&"updated",q.operation==="D"&&"deleted"," this expense"]}),s.jsx("p",{className:"text-xs text-gray-500 mt-1",children:w(q.timestamp)})]})]},W))})]})]})]})}),u&&s.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black bg-opacity-50",children:s.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full p-6",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Reject Expense"}),s.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Please provide a reason for rejecting this expense."}),s.jsx("textarea",{value:h,onChange:q=>m(q.target.value),placeholder:"Enter rejection reason...",rows:4,className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-red-500 mb-4"}),s.jsxs("div",{className:"flex items-center justify-end gap-3",children:[s.jsx("button",{onClick:()=>{f(!1),m("")},className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",children:"Cancel"}),s.jsx("button",{onClick:z,disabled:!h.trim(),className:"px-4 py-2 text-sm font-medium text-white bg-red-600 rounded-lg hover:bg-red-700 disabled:opacity-50 disabled:cursor-not-allowed",children:"Reject"})]})]})})]})}const Bb=["cash","bank_transfer","card","upi","other"],Ub=["Travel","Meals","Accommodation","Transport","Office Supplies","Software","Hardware","Training","Marketing","Other"];function zb({expense:e,projects:t,users:r,onClose:n,onSave:a}){const[i,l]=T.useState({user_id:(e==null?void 0:e.userId)||"",project_id:(e==null?void 0:e.projectId)||"",category:(e==null?void 0:e.category)||"",amount:(e==null?void 0:e.amount)||"",tax_amount:(e==null?void 0:e.taxAmount)||0,currency:(e==null?void 0:e.currency)||"INR",is_billable:(e==null?void 0:e.isBillable)||!1,spent_on:(e==null?void 0:e.spentOn)||new Date().toISOString().split("T")[0],merchant:(e==null?void 0:e.merchant)||"",payment_method:(e==null?void 0:e.paymentMethod)||"other",note:(e==null?void 0:e.note)||""}),[o,c]=T.useState(null),[d,u]=T.useState((e==null?void 0:e.receiptUrl)||null),[f,h]=T.useState(!1),[m,v]=T.useState(!1),[x,y]=T.useState({});T.useEffect(()=>{e!=null&&e.receiptUrl&&u(e.receiptUrl)},[e]);const p=b=>{const{name:P,value:M,type:j,checked:O}=b.target;l(R=>({...R,[P]:j==="checkbox"?O:M})),x[P]&&y(R=>{const I={...R};return delete I[P],I})},g=async b=>{const P=b.target.files[0];if(!P)return;if(!["image/jpeg","image/jpg","image/png","application/pdf"].includes(P.type)){y(j=>({...j,receipt:"Only PDF, PNG, and JPG files are allowed"}));return}if(P.size>10*1024*1024){y(j=>({...j,receipt:"File size must be less than 10MB"}));return}if(c(P),y(j=>{const O={...j};return delete O.receipt,O}),P.type.startsWith("image/")){const j=new FileReader;j.onload=O=>u(O.target.result),j.readAsDataURL(P)}else u(null)},w=async(b,P="draft")=>{var j;b.preventDefault();const M={};if(i.user_id||(M.user_id="Employee is required"),i.category||(M.category="Category is required"),(!i.amount||parseFloat(i.amount)<=0)&&(M.amount="Valid amount is required"),i.spent_on||(M.spent_on="Expense date is required"),parseFloat(i.amount)>500&&!o&&!(e!=null&&e.receiptFileId)&&(M.receipt="Receipt required for expenses over 500"),Object.keys(M).length>0){y(M);return}v(!0);try{let O=e==null?void 0:e.receiptFileId;if(o){h(!0);try{const D=await pr.uploadReceipt(o);if(D.success&&((j=D.data)!=null&&j.fileId))O=D.data.fileId,console.log("Receipt uploaded, fileId:",O);else throw new Error(D.message||"Failed to upload receipt")}catch(D){throw console.error("Receipt upload error:",D),new Error(D.message||"Failed to upload receipt")}finally{h(!1)}}const R={...i,amount:parseFloat(i.amount),tax_amount:parseFloat(i.tax_amount||0),receipt_file_id:O,status:P};let I;e?I=await pr.update(e.id,R):I=await pr.create(R),I.success?(a(I.data),n()):y({submit:I.message||"Failed to save expense"})}catch(O){console.error("Error saving expense:",O),y({submit:O.message||"Failed to save expense"})}finally{v(!1),h(!1)}};return s.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black bg-opacity-50",children:s.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[s.jsxs("div",{className:"sticky top-0 bg-white border-b border-gray-200 px-6 py-4 flex items-center justify-between",children:[s.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:e?"Edit Expense":"New Expense"}),s.jsx("button",{onClick:n,className:"text-gray-400 hover:text-gray-600",children:s.jsx(ze,{className:"w-5 h-5"})})]}),s.jsxs("form",{onSubmit:b=>w(b,"draft"),className:"p-6 space-y-4",children:[x.submit&&s.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-3 text-sm text-red-800",children:x.submit}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Project ",s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsxs("select",{name:"project_id",value:i.project_id,onChange:p,className:`w-full px-3 py-2 text-sm border rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 ${x.project_id?"border-red-300":"border-gray-300"}`,children:[s.jsx("option",{value:"",children:"Select project..."}),t.map(b=>s.jsx("option",{value:b.id,children:b.name},b.id))]})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Employee ",s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsxs("select",{name:"user_id",value:i.user_id,onChange:p,className:`w-full px-3 py-2 text-sm border rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 ${x.user_id?"border-red-300":"border-gray-300"}`,children:[s.jsx("option",{value:"",children:"Select employee..."}),r&&r.map(b=>s.jsx("option",{value:b.id,children:b.full_name},b.id))]}),x.user_id&&s.jsx("p",{className:"mt-1 text-xs text-red-600",children:x.user_id})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Category ",s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsxs("select",{name:"category",value:i.category,onChange:p,className:`w-full px-3 py-2 text-sm border rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 ${x.category?"border-red-300":"border-gray-300"}`,children:[s.jsx("option",{value:"",children:"Select category..."}),Ub.map(b=>s.jsx("option",{value:b,children:b},b))]}),x.category&&s.jsx("p",{className:"mt-1 text-xs text-red-600",children:x.category})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Amount ",s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsx("input",{type:"number",name:"amount",value:i.amount,onChange:p,step:"0.01",min:"0",className:`w-full px-3 py-2 text-sm border rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 ${x.amount?"border-red-300":"border-gray-300"}`}),x.amount&&s.jsx("p",{className:"mt-1 text-xs text-red-600",children:x.amount})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tax Amount"}),s.jsx("input",{type:"number",name:"tax_amount",value:i.tax_amount,onChange:p,step:"0.01",min:"0",className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Currency"}),s.jsxs("select",{name:"currency",value:i.currency,onChange:p,className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500",children:[s.jsx("option",{value:"INR",children:"INR ()"}),s.jsx("option",{value:"USD",children:"USD ($)"}),s.jsx("option",{value:"EUR",children:"EUR ()"})]})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Expense Date ",s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsx("input",{type:"date",name:"spent_on",value:i.spent_on,onChange:p,className:`w-full px-3 py-2 text-sm border rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 ${x.spent_on?"border-red-300":"border-gray-300"}`}),x.spent_on&&s.jsx("p",{className:"mt-1 text-xs text-red-600",children:x.spent_on})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Merchant/Vendor"}),s.jsx("input",{type:"text",name:"merchant",value:i.merchant,onChange:p,className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Payment Method"}),s.jsx("select",{name:"payment_method",value:i.payment_method,onChange:p,className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500",children:Bb.map(b=>s.jsx("option",{value:b,children:b.charAt(0).toUpperCase()+b.slice(1).replace("_"," ")},b))})]})]}),s.jsxs("div",{className:"flex items-center",children:[s.jsx("input",{type:"checkbox",name:"is_billable",id:"is_billable",checked:i.is_billable,onChange:p,className:"w-4 h-4 text-purple-600 rounded focus:ring-purple-500"}),s.jsx("label",{htmlFor:"is_billable",className:"ml-2 text-sm font-medium text-gray-700",children:"Billable to customer"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description/Notes"}),s.jsx("textarea",{name:"note",value:i.note,onChange:p,rows:3,className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500"})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Receipt ",parseFloat(i.amount)>500&&s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsxs("label",{className:"flex items-center gap-2 px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 cursor-pointer",children:[s.jsx(D0,{className:"w-4 h-4"}),"Upload Receipt",s.jsx("input",{type:"file",accept:".pdf,.png,.jpg,.jpeg",onChange:g,className:"hidden"})]}),o&&s.jsx("span",{className:"text-sm text-gray-600",children:o.name}),(e==null?void 0:e.receiptFilename)&&!o&&s.jsxs("span",{className:"text-sm text-gray-600 flex items-center gap-1",children:[s.jsx(wt,{className:"w-4 h-4"}),e.receiptFilename]})]}),x.receipt&&s.jsx("p",{className:"mt-1 text-xs text-red-600",children:x.receipt}),d&&d.startsWith("data:image")&&s.jsx("div",{className:"mt-2",children:s.jsx("img",{src:d,alt:"Receipt preview",className:"max-w-xs rounded-lg border border-gray-300"})})]}),s.jsxs("div",{className:"flex items-center justify-end gap-3 pt-4 border-t border-gray-200",children:[s.jsx("button",{type:"button",onClick:n,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",children:"Cancel"}),!e&&s.jsx("button",{type:"button",onClick:b=>w(b,"draft"),disabled:m||f,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 disabled:opacity-50",children:m||f?"Saving...":"Save as Draft"}),s.jsx("button",{type:"submit",onClick:b=>w(b,"submitted"),disabled:m||f,className:"px-4 py-2 text-sm font-medium text-white rounded-lg hover:opacity-90 disabled:opacity-50",style:{backgroundColor:"#714b67"},children:m||f?"Submitting...":e?"Update":"Submit"})]})]})]})})}function $b({expenses:e,onClose:t,onSave:r}){var p;const[n,a]=T.useState("new"),[i,l]=T.useState(""),[o,c]=T.useState(""),[d,u]=T.useState(!1),[f,h]=T.useState({});T.useEffect(()=>{e.length>0&&e[0].projectId&&c("")},[e]);const m=async g=>{if(g.preventDefault(),h({}),n==="existing"&&!i){h({invoice:"Please select an invoice"});return}u(!0);try{const w=[];for(const P of e){const M={invoice_id:n==="existing"?i:null,customer_id:o},j=await pr.addToInvoice(P.id,M);w.push({expenseId:P.id,success:j.success,data:j.data})}w.every(P=>P.success)?(r(w),t()):h({submit:"Some expenses could not be added to invoice"})}catch(w){console.error("Error adding to invoice:",w),h({submit:w.message||"Failed to add expenses to invoice"})}finally{u(!1)}},v=(g,w="INR")=>new Intl.NumberFormat("en-IN",{style:"currency",currency:w,minimumFractionDigits:0,maximumFractionDigits:0}).format(g),x=e.reduce((g,w)=>g+w.amount+(w.taxAmount||0),0),y=((p=e[0])==null?void 0:p.currency)||"INR";return s.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black bg-opacity-50",children:s.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[s.jsxs("div",{className:"sticky top-0 bg-white border-b border-gray-200 px-6 py-4 flex items-center justify-between",children:[s.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Add to Invoice"}),s.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-600",children:s.jsx(ze,{className:"w-5 h-5"})})]}),s.jsxs("form",{onSubmit:m,className:"p-6 space-y-4",children:[f.submit&&s.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-3 text-sm text-red-800",children:f.submit}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Invoice"}),s.jsxs("div",{className:"flex gap-4",children:[s.jsxs("label",{className:"flex items-center",children:[s.jsx("input",{type:"radio",name:"invoiceMode",value:"new",checked:n==="new",onChange:g=>a(g.target.value),className:"w-4 h-4 text-purple-600 focus:ring-purple-500"}),s.jsx("span",{className:"ml-2 text-sm text-gray-700",children:"Create New Invoice"})]}),s.jsxs("label",{className:"flex items-center",children:[s.jsx("input",{type:"radio",name:"invoiceMode",value:"existing",checked:n==="existing",onChange:g=>a(g.target.value),className:"w-4 h-4 text-purple-600 focus:ring-purple-500"}),s.jsx("span",{className:"ml-2 text-sm text-gray-700",children:"Add to Existing Invoice"})]})]})]}),n==="existing"&&s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Select Invoice ",s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsxs("select",{value:i,onChange:g=>l(g.target.value),className:`w-full px-3 py-2 text-sm border rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 ${f.invoice?"border-red-300":"border-gray-300"}`,children:[s.jsx("option",{value:"",children:"Select invoice..."}),s.jsx("option",{value:"placeholder",children:"Invoice #INV-001 (Draft)"})]}),f.invoice&&s.jsx("p",{className:"mt-1 text-xs text-red-600",children:f.invoice})]}),n==="new"&&s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Customer"}),s.jsx("input",{type:"text",value:o||"Customer from project",disabled:!0,className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg bg-gray-50 text-gray-600"}),s.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Customer will be prefilled from project"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Expense Lines"}),s.jsx("div",{className:"border border-gray-200 rounded-lg overflow-hidden",children:s.jsxs("table",{className:"w-full",children:[s.jsx("thead",{className:"bg-gray-50",children:s.jsxs("tr",{children:[s.jsx("th",{className:"px-4 py-2 text-left text-xs font-semibold text-gray-600",children:"Description"}),s.jsx("th",{className:"px-4 py-2 text-right text-xs font-semibold text-gray-600",children:"Amount"}),s.jsx("th",{className:"px-4 py-2 text-right text-xs font-semibold text-gray-600",children:"Tax"}),s.jsx("th",{className:"px-4 py-2 text-right text-xs font-semibold text-gray-600",children:"Total"})]})}),s.jsx("tbody",{className:"divide-y divide-gray-200",children:e.map(g=>{const w=`Expense  ${g.category}  ${g.employeeName||"Employee"}  ${g.spentOn}`,b=g.amount+(g.taxAmount||0);return s.jsxs("tr",{children:[s.jsx("td",{className:"px-4 py-2 text-sm text-gray-900",children:w}),s.jsx("td",{className:"px-4 py-2 text-sm text-right text-gray-900",children:v(g.amount,g.currency)}),s.jsx("td",{className:"px-4 py-2 text-sm text-right text-gray-900",children:v(g.taxAmount||0,g.currency)}),s.jsx("td",{className:"px-4 py-2 text-sm text-right font-medium text-gray-900",children:v(b,g.currency)})]},g.id)})}),s.jsx("tfoot",{className:"bg-gray-50",children:s.jsxs("tr",{children:[s.jsx("td",{colSpan:3,className:"px-4 py-2 text-sm font-semibold text-gray-900 text-right",children:"Total:"}),s.jsx("td",{className:"px-4 py-2 text-sm font-semibold text-gray-900 text-right",children:v(x,y)})]})})]})})]}),e.length>1&&s.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3 text-sm text-blue-800",children:[s.jsx("p",{className:"font-medium mb-1",children:"Note:"}),s.jsx("p",{children:"All expenses must be from the same project and customer. Selected expenses will be added as separate invoice lines."})]}),s.jsxs("div",{className:"flex items-center justify-end gap-3 pt-4 border-t border-gray-200",children:[s.jsx("button",{type:"button",onClick:t,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",children:"Cancel"}),s.jsxs("button",{type:"submit",disabled:d,className:"flex items-center gap-2 px-4 py-2 text-sm font-medium text-white rounded-lg hover:opacity-90 disabled:opacity-50",style:{backgroundColor:"#714b67"},children:[n==="new"&&s.jsx(lr,{className:"w-4 h-4"}),d?"Adding...":n==="new"?"Create Invoice":"Add to Invoice"]})]})]})]})})}function Wb(){const[e,t]=T.useState([]),[r,n]=T.useState([]),[a,i]=T.useState([]),[l,o]=T.useState({pendingApprovals:0,pendingAmount:0,pendingBillableAmount:0,missingReceipts:0}),[c,d]=T.useState({date_from:Ne(),date_to:new Date().toISOString().split("T")[0]}),[u,f]=T.useState(""),[h,m]=T.useState([]),[v,x]=T.useState(null),[y,p]=T.useState(!1),[g,w]=T.useState(!1),[b,P]=T.useState(null),[M,j]=T.useState(!1),[O,R]=T.useState(!0),[I,D]=T.useState(null),z=Gr(),ne=((z==null?void 0:z.role)||"").toLowerCase()==="employee";function Ne(){const se=new Date;return se.setDate(se.getDate()-90),se.toISOString().split("T")[0]}T.useEffect(()=>{ue()},[c]);const ue=async()=>{try{R(!0),D(null);const se=await yr.getAll();se.success&&n(se.data);const pe=await tb.getAll();pe.success&&i(pe.data.users);const Ae=await pr.getAll(c);Ae.success?t(Ae.data):D(Ae.message||"Failed to load expenses");const _e=await pr.getStats(c);_e.success&&o(_e.data)}catch(se){console.error("Error loading data:",se),D("Unable to connect to server. Please try again.")}finally{R(!1)}},je=se=>{Object.keys(se).length===0?d({date_from:Ne(),date_to:new Date().toISOString().split("T")[0]}):d(pe=>{const Ae={...pe};return Object.keys(se).forEach(_e=>{const de=se[_e];de===void 0||de===""||de===null||Array.isArray(de)&&de.length===0?delete Ae[_e]:Ae[_e]=de}),Ae}),m([])},q=se=>{d(se),m([])},W=(se,pe)=>{m(pe?Ae=>[...Ae,se]:Ae=>Ae.filter(_e=>_e!==se))},k=se=>{m(se?e.map(pe=>pe.id):[])},K=se=>{x(se),p(!0)},te=async()=>{try{(await pr.bulkApprove(h)).success&&(m([]),ue())}catch(se){console.error("Error bulk approving:",se)}},E=async se=>{try{(await pr.bulkReject(h,se)).success&&(m([]),ue())}catch(pe){console.error("Error bulk rejecting:",pe)}},B=()=>{const se=e.filter(pe=>h.includes(pe.id));se.length>0&&(x(se[0]),j(!0))},L=()=>{const se=e.filter(at=>h.includes(at.id)),pe=["Date","Employee","Project","Category","Amount","Billable","Status","Invoice"],Ae=se.map(at=>[at.spentOn||"",at.employeeName||"",at.projectName||"",at.category||"",at.amount||0,at.isBillable?"Yes":"No",at.status||"",at.invoiceNumber||""]),_e=[pe.join(","),...Ae.map(at=>at.map(yn=>`"${yn}"`).join(","))].join(`
`),de=new Blob([_e],{type:"text/csv"}),xt=window.URL.createObjectURL(de),Zt=document.createElement("a");Zt.href=xt,Zt.download=`expenses-${new Date().toISOString().split("T")[0]}.csv`,Zt.click(),window.URL.revokeObjectURL(xt)},U=se=>{m(pe=>pe.filter(Ae=>Ae!==se)),ue()},ee=se=>{m(pe=>pe.filter(Ae=>Ae!==se)),ue()},he=()=>{ue(),w(!1),P(null)},xe=()=>{ue(),j(!1),m([])},G=se=>new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR",minimumFractionDigits:0,maximumFractionDigits:0}).format(se),J=e.filter(se=>{var Ae,_e,de,xt;if(!u.trim())return!0;const pe=u.toLowerCase();return((Ae=se.employeeName)==null?void 0:Ae.toLowerCase().includes(pe))||((_e=se.projectName)==null?void 0:_e.toLowerCase().includes(pe))||((de=se.category)==null?void 0:de.toLowerCase().includes(pe))||((xt=se.note)==null?void 0:xt.toLowerCase().includes(pe))}),ve=[...new Set(e.map(se=>se.category).filter(Boolean))],Se=e.reduce((se,pe)=>(pe.userId&&!se.find(Ae=>Ae.id===pe.userId)&&se.push({id:pe.userId,name:pe.employeeName||"Unknown"}),se),[]);return s.jsxs("div",{className:"h-full bg-gray-50",children:[s.jsxs("header",{className:"bg-white border-b border-gray-200 px-8 py-6",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsxs("div",{className:"flex items-center gap-6 flex-1",children:[s.jsx("h1",{className:"text-2xl font-semibold text-gray-900",children:"Expenses"}),s.jsxs("div",{className:"relative flex-1 max-w-md",children:[s.jsx(pn,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),s.jsx("input",{value:u,onChange:se=>f(se.target.value),type:"text",placeholder:"Search expenses...",className:"w-full pl-10 pr-4 py-2.5 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-400 focus:border-transparent text-sm",disabled:O})]})]}),s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(Db,{filters:c,projects:r,employees:ne?[]:Se,categories:ve,onFilterChange:je,onSavedViewChange:q}),s.jsxs("button",{onClick:()=>{P(null),w(!0)},className:"px-4 py-2 text-sm font-medium text-white rounded-lg hover:opacity-90 transition-opacity disabled:opacity-50",style:{backgroundColor:"#714b67"},disabled:O,children:[s.jsx(lr,{className:"inline w-4 h-4 mr-2"})," New Expense"]})]})]}),s.jsxs("div",{className:"grid grid-cols-4 gap-4 mb-4",children:[s.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4 hover:shadow-md transition-shadow cursor-pointer",children:[s.jsx("div",{className:"text-sm text-gray-600 mb-1",children:"Pending Approvals"}),s.jsx("div",{className:"text-2xl font-semibold",style:{color:"#714b67"},children:l.pendingApprovals})]}),s.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4 hover:shadow-md transition-shadow cursor-pointer",children:[s.jsx("div",{className:"text-sm text-gray-600 mb-1",children:" Pending"}),s.jsx("div",{className:"text-2xl font-semibold text-gray-900",children:G(l.pendingAmount)})]}),s.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4 hover:shadow-md transition-shadow cursor-pointer",children:[s.jsx("div",{className:"text-sm text-gray-600 mb-1",children:" Pending (Billable)"}),s.jsx("div",{className:"text-2xl font-semibold text-gray-900",children:G(l.pendingBillableAmount)})]}),s.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4 hover:shadow-md transition-shadow cursor-pointer",children:[s.jsx("div",{className:"text-sm text-gray-600 mb-1",children:"Missing Receipts"}),s.jsx("div",{className:"text-2xl font-semibold text-gray-900",children:l.missingReceipts})]})]}),s.jsxs("div",{className:"flex items-center gap-2 mb-4 flex-wrap",children:[s.jsx("button",{onClick:()=>je({status:["submitted","draft"]}),className:`px-3 py-1.5 text-sm font-medium rounded-lg transition-colors ${JSON.stringify(c.status)===JSON.stringify(["submitted","draft"])?"text-white":"bg-white text-gray-700 border border-gray-300 hover:bg-gray-50"}`,style:JSON.stringify(c.status)===JSON.stringify(["submitted","draft"])?{backgroundColor:"#714b67"}:{},children:"Pending"}),s.jsx("button",{onClick:()=>je({status:["approved"]}),className:`px-3 py-1.5 text-sm font-medium rounded-lg transition-colors ${JSON.stringify(c.status)===JSON.stringify(["approved"])?"text-white":"bg-white text-gray-700 border border-gray-300 hover:bg-gray-50"}`,style:JSON.stringify(c.status)===JSON.stringify(["approved"])?{backgroundColor:"#714b67"}:{},children:"Approved"}),s.jsx("button",{onClick:()=>je({status:["rejected"]}),className:`px-3 py-1.5 text-sm font-medium rounded-lg transition-colors ${JSON.stringify(c.status)===JSON.stringify(["rejected"])?"text-white":"bg-white text-gray-700 border border-gray-300 hover:bg-gray-50"}`,style:JSON.stringify(c.status)===JSON.stringify(["rejected"])?{backgroundColor:"#714b67"}:{},children:"Rejected"}),s.jsx("button",{onClick:()=>{const{status:se,...pe}=c;je(pe)},className:`px-3 py-1.5 text-sm font-medium rounded-lg transition-colors ${c.status?"bg-white text-gray-700 border border-gray-300 hover:bg-gray-50":"text-white"}`,style:c.status?{}:{backgroundColor:"#714b67"},children:"All"})]})]}),s.jsxs("div",{className:"p-6",children:[O&&s.jsx("div",{className:"flex items-center justify-center h-64",children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"inline-block animate-spin rounded-full h-12 w-12 border-b-2 border-gray-900 mb-4"}),s.jsx("p",{className:"text-gray-600",children:"Loading expenses..."})]})}),I&&!O&&s.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 mb-4",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("svg",{className:"w-5 h-5 text-red-600",fill:"currentColor",viewBox:"0 0 20 20",children:s.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})}),s.jsx("span",{className:"text-red-800 font-medium",children:I})]}),s.jsx("button",{onClick:ue,className:"text-red-600 hover:text-red-800 font-medium text-sm",children:"Retry"})]})}),!O&&!I&&!ne&&s.jsx(Lb,{selectedCount:h.length,onBulkApprove:te,onBulkReject:E,onBulkAddToInvoice:B,onExportCSV:L}),!O&&!I&&s.jsx(s.Fragment,{children:J.length===0?s.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-12 text-center",children:[s.jsx(Ro,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),s.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No expenses found"}),s.jsx("p",{className:"text-sm text-gray-500 mb-4",children:c.status?`No expenses with status: ${Array.isArray(c.status)?c.status.join(", "):c.status}`:"Try adjusting your filters or create a new expense."}),s.jsxs("div",{className:"flex items-center justify-center gap-3",children:[s.jsx("button",{onClick:()=>d({date_from:Ne(),date_to:new Date().toISOString().split("T")[0]}),className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",children:"Clear Filters"}),s.jsx("button",{onClick:()=>{P(null),w(!0)},className:"px-4 py-2 text-sm font-medium text-white rounded-lg hover:opacity-90",style:{backgroundColor:"#714b67"},children:"New Expense"})]})]}):s.jsx("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:s.jsx(Ib,{expenses:J,selectedIds:h,onSelect:W,onSelectAll:k,onRowClick:K})})})]}),y&&v&&s.jsx(Mb,{expense:v,onClose:()=>{p(!1),x(null)},onUpdate:async()=>{if(await ue(),v!=null&&v.id)try{const se=await pr.getById(v.id);se.success&&x(se.data)}catch(se){console.error("Error refreshing expense:",se)}},onApprove:U,onReject:ee,onAddToInvoice:se=>{x(se[0]),j(!0),p(!1)}}),g&&s.jsx(zb,{expense:b,projects:r,users:a,onClose:()=>{w(!1),P(null)},onSave:he}),M&&v&&s.jsx($b,{expenses:h.length>1?e.filter(se=>h.includes(se.id)):[v],onClose:()=>{j(!1),x(null)},onSave:xe})]})}/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var to={};to.version="0.18.5";var Sp=1252,Hb=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],_p=function(e){Hb.indexOf(e)!=-1&&(Sp=e)};function Vb(){_p(1252)}var Si=function(e){_p(e)};function Gb(){Si(1200),Vb()}var cl=function(t){return String.fromCharCode(t)},Vf=function(t){return String.fromCharCode(t)},ro,An="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function _i(e){for(var t="",r=0,n=0,a=0,i=0,l=0,o=0,c=0,d=0;d<e.length;)r=e.charCodeAt(d++),i=r>>2,n=e.charCodeAt(d++),l=(r&3)<<4|n>>4,a=e.charCodeAt(d++),o=(n&15)<<2|a>>6,c=a&63,isNaN(n)?o=c=64:isNaN(a)&&(c=64),t+=An.charAt(i)+An.charAt(l)+An.charAt(o)+An.charAt(c);return t}function fn(e){var t="",r=0,n=0,a=0,i=0,l=0,o=0,c=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var d=0;d<e.length;)i=An.indexOf(e.charAt(d++)),l=An.indexOf(e.charAt(d++)),r=i<<2|l>>4,t+=String.fromCharCode(r),o=An.indexOf(e.charAt(d++)),n=(l&15)<<4|o>>2,o!==64&&(t+=String.fromCharCode(n)),c=An.indexOf(e.charAt(d++)),a=(o&3)<<6|c,c!==64&&(t+=String.fromCharCode(a));return t}var Re=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),gn=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}}();function ps(e){return Re?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function Gf(e){return Re?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var Ar=function(t){return Re?gn(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function Io(e){if(typeof ArrayBuffer>"u")return Ar(e);for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),n=0;n!=e.length;++n)r[n]=e.charCodeAt(n)&255;return t}function Mi(e){if(Array.isArray(e))return e.map(function(n){return String.fromCharCode(n)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function Xb(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}var St=Re?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:gn(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var n=new Uint8Array(r),a=0;for(t=0,r=0;t<e.length;r+=a,++t)if(a=e[t].length,e[t]instanceof Uint8Array)n.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";n.set(new Uint8Array(e[t]),r)}return n}return[].concat.apply([],e.map(function(i){return Array.isArray(i)?i:[].slice.call(i)}))};function Kb(e){for(var t=[],r=0,n=e.length+250,a=ps(e.length+255),i=0;i<e.length;++i){var l=e.charCodeAt(i);if(l<128)a[r++]=l;else if(l<2048)a[r++]=192|l>>6&31,a[r++]=128|l&63;else if(l>=55296&&l<57344){l=(l&1023)+64;var o=e.charCodeAt(++i)&1023;a[r++]=240|l>>8&7,a[r++]=128|l>>2&63,a[r++]=128|o>>6&15|(l&3)<<4,a[r++]=128|o&63}else a[r++]=224|l>>12&15,a[r++]=128|l>>6&63,a[r++]=128|l&63;r>n&&(t.push(a.slice(0,r)),r=0,a=ps(65535),n=65530)}return t.push(a.slice(0,r)),St(t)}var Qa=/\u0000/g,ul=/[\u0001-\u0006]/g;function ea(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function Fr(e,t){var r=""+e;return r.length>=t?r:rt("0",t-r.length)+r}function M0(e,t){var r=""+e;return r.length>=t?r:rt(" ",t-r.length)+r}function no(e,t){var r=""+e;return r.length>=t?r:r+rt(" ",t-r.length)}function Yb(e,t){var r=""+Math.round(e);return r.length>=t?r:rt("0",t-r.length)+r}function Jb(e,t){var r=""+e;return r.length>=t?r:rt("0",t-r.length)+r}var Xf=Math.pow(2,32);function ks(e,t){if(e>Xf||e<-Xf)return Yb(e,t);var r=Math.round(e);return Jb(r,t)}function so(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var Kf=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Sc=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function qb(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',e}var nt={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},Yf={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},Qb={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function ao(e,t,r){for(var n=e<0?-1:1,a=e*n,i=0,l=1,o=0,c=1,d=0,u=0,f=Math.floor(a);d<t&&(f=Math.floor(a),o=f*l+i,u=f*d+c,!(a-f<5e-8));)a=1/(a-f),i=l,l=o,c=d,d=u;if(u>t&&(d>t?(u=c,o=i):(u=d,o=l)),!r)return[0,n*o,u];var h=Math.floor(n*o/u);return[h,n*o-h*u,u]}function dl(e,t,r){if(e>2958465||e<0)return null;var n=e|0,a=Math.floor(86400*(e-n)),i=0,l=[],o={D:n,T:a,u:86400*(e-n)-a,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),t&&t.date1904&&(n+=1462),o.u>.9999&&(o.u=0,++a==86400&&(o.T=a=0,++n,++o.D)),n===60)l=r?[1317,10,29]:[1900,2,29],i=3;else if(n===0)l=r?[1317,8,29]:[1900,1,0],i=6;else{n>60&&--n;var c=new Date(1900,0,1);c.setDate(c.getDate()+n-1),l=[c.getFullYear(),c.getMonth()+1,c.getDate()],i=c.getDay(),n<60&&(i=(i+6)%7),r&&(i=aN(c,l))}return o.y=l[0],o.m=l[1],o.d=l[2],o.S=a%60,a=Math.floor(a/60),o.M=a%60,a=Math.floor(a/60),o.H=a,o.q=i,o}var Ep=new Date(1899,11,31,0,0,0),Zb=Ep.getTime(),eN=new Date(1900,2,1,0,0,0);function Tp(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=eN&&(r+=24*60*60*1e3),(r-(Zb+(e.getTimezoneOffset()-Ep.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function B0(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function tN(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function rN(e){var t=e<0?12:11,r=B0(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function nN(e){var t=B0(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function sN(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=rN(e):t===10?r=e.toFixed(10).substr(0,12):r=nN(e),B0(tN(r.toUpperCase()))}function Iu(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):sN(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return Hn(14,Tp(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function aN(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function iN(e,t,r,n){var a="",i=0,l=0,o=r.y,c,d=0;switch(e){case 98:o=r.y+543;case 121:switch(t.length){case 1:case 2:c=o%100,d=2;break;default:c=o%1e4,d=4;break}break;case 109:switch(t.length){case 1:case 2:c=r.m,d=t.length;break;case 3:return Sc[r.m-1][1];case 5:return Sc[r.m-1][0];default:return Sc[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:c=r.d,d=t.length;break;case 3:return Kf[r.q][0];default:return Kf[r.q][1]}break;case 104:switch(t.length){case 1:case 2:c=1+(r.H+11)%12,d=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:c=r.H,d=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:c=r.M,d=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?Fr(r.S,t.length):(n>=2?l=n===3?1e3:100:l=n===1?10:1,i=Math.round(l*(r.S+r.u)),i>=60*l&&(i=0),t==="s"?i===0?"0":""+i/l:(a=Fr(i,2+n),t==="ss"?a.substr(0,2):"."+a.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":c=r.D*24+r.H;break;case"[m]":case"[mm]":c=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":c=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}d=t.length===3?1:2;break;case 101:c=o,d=1;break}var u=d>0?Fr(c,d):"";return u}function Fn(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,n=e.substr(0,r);r!=e.length;r+=t)n+=(n.length>0?",":"")+e.substr(r,t);return n}var kp=/%/g;function lN(e,t,r){var n=t.replace(kp,""),a=t.length-n.length;return sn(e,n,r*Math.pow(10,2*a))+rt("%",a)}function oN(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return sn(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function Cp(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+Cp(e,-t);var a=e.indexOf(".");a===-1&&(a=e.indexOf("E"));var i=Math.floor(Math.log(t)*Math.LOG10E)%a;if(i<0&&(i+=a),r=(t/Math.pow(10,i)).toPrecision(n+1+(a+i)%a),r.indexOf("e")===-1){var l=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(l-r.length+i):r+="E+"+(l-i);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,a)+"."+r.substr(2+a),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,c,d,u){return c+d+u.substr(0,(a+i)%a)+"."+u.substr(i)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var Ap=/# (\?+)( ?)\/( ?)(\d+)/;function cN(e,t,r){var n=parseInt(e[4],10),a=Math.round(t*n),i=Math.floor(a/n),l=a-i*n,o=n;return r+(i===0?"":""+i)+" "+(l===0?rt(" ",e[1].length+1+e[4].length):M0(l,e[1].length)+e[2]+"/"+e[3]+Fr(o,e[4].length))}function uN(e,t,r){return r+(t===0?"":""+t)+rt(" ",e[1].length+2+e[4].length)}var Fp=/^#*0*\.([0#]+)/,Pp=/\).*[0#]/,Op=/\(###\) ###\\?-####/;function Mt(e){for(var t="",r,n=0;n!=e.length;++n)switch(r=e.charCodeAt(n)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function Jf(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function qf(e,t){var r=e-Math.floor(e),n=Math.pow(10,t);return t<(""+Math.round(r*n)).length?0:Math.round(r*n)}function dN(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function fN(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function fr(e,t,r){if(e.charCodeAt(0)===40&&!t.match(Pp)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?fr("n",n,r):"("+fr("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return oN(e,t,r);if(t.indexOf("%")!==-1)return lN(e,t,r);if(t.indexOf("E")!==-1)return Cp(t,r);if(t.charCodeAt(0)===36)return"$"+fr(e,t.substr(t.charAt(1)==" "?2:1),r);var a,i,l,o,c=Math.abs(r),d=r<0?"-":"";if(t.match(/^00+$/))return d+ks(c,t.length);if(t.match(/^[#?]+$/))return a=ks(r,0),a==="0"&&(a=""),a.length>t.length?a:Mt(t.substr(0,t.length-a.length))+a;if(i=t.match(Ap))return cN(i,c,d);if(t.match(/^#+0+$/))return d+ks(c,t.length-t.indexOf("0"));if(i=t.match(Fp))return a=Jf(r,i[1].length).replace(/^([^\.]+)$/,"$1."+Mt(i[1])).replace(/\.$/,"."+Mt(i[1])).replace(/\.(\d*)$/,function(v,x){return"."+x+rt("0",Mt(i[1]).length-x.length)}),t.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),i=t.match(/^(0*)\.(#*)$/))return d+Jf(c,i[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=t.match(/^#{1,3},##0(\.?)$/))return d+Fn(ks(c,0));if(i=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+fr(e,t,-r):Fn(""+(Math.floor(r)+dN(r,i[1].length)))+"."+Fr(qf(r,i[1].length),i[1].length);if(i=t.match(/^#,#*,#0/))return fr(e,t.replace(/^#,#*,/,""),r);if(i=t.match(/^([0#]+)(\\?-([0#]+))+$/))return a=ea(fr(e,t.replace(/[\\-]/g,""),r)),l=0,ea(ea(t.replace(/\\/g,"")).replace(/[0#]/g,function(v){return l<a.length?a.charAt(l++):v==="0"?"0":""}));if(t.match(Op))return a=fr(e,"##########",r),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var u="";if(i=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(i[4].length,7),o=ao(c,Math.pow(10,l)-1,!1),a=""+d,u=sn("n",i[1],o[1]),u.charAt(u.length-1)==" "&&(u=u.substr(0,u.length-1)+"0"),a+=u+i[2]+"/"+i[3],u=no(o[2],l),u.length<i[4].length&&(u=Mt(i[4].substr(i[4].length-u.length))+u),a+=u,a;if(i=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(Math.max(i[1].length,i[4].length),7),o=ao(c,Math.pow(10,l)-1,!0),d+(o[0]||(o[1]?"":"0"))+" "+(o[1]?M0(o[1],l)+i[2]+"/"+i[3]+no(o[2],l):rt(" ",2*l+1+i[2].length+i[3].length));if(i=t.match(/^[#0?]+$/))return a=ks(r,0),t.length<=a.length?a:Mt(t.substr(0,t.length-a.length))+a;if(i=t.match(/^([#0?]+)\.([#0]+)$/)){a=""+r.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),l=a.indexOf(".");var f=t.indexOf(".")-l,h=t.length-a.length-f;return Mt(t.substr(0,f)+a+t.substr(t.length-h))}if(i=t.match(/^00,000\.([#0]*0)$/))return l=qf(r,i[1].length),r<0?"-"+fr(e,t,-r):Fn(fN(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(v){return"00,"+(v.length<3?Fr(0,3-v.length):"")+v})+"."+Fr(l,i[1].length);switch(t){case"###,##0.00":return fr(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var m=Fn(ks(c,0));return m!=="0"?d+m:"";case"###,###.00":return fr(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return fr(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function hN(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return sn(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function xN(e,t,r){var n=t.replace(kp,""),a=t.length-n.length;return sn(e,n,r*Math.pow(10,2*a))+rt("%",a)}function Rp(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+Rp(e,-t);var a=e.indexOf(".");a===-1&&(a=e.indexOf("E"));var i=Math.floor(Math.log(t)*Math.LOG10E)%a;if(i<0&&(i+=a),r=(t/Math.pow(10,i)).toPrecision(n+1+(a+i)%a),!r.match(/[Ee]/)){var l=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(l-r.length+i):r+="E+"+(l-i),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,c,d,u){return c+d+u.substr(0,(a+i)%a)+"."+u.substr(i)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function Mr(e,t,r){if(e.charCodeAt(0)===40&&!t.match(Pp)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Mr("n",n,r):"("+Mr("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return hN(e,t,r);if(t.indexOf("%")!==-1)return xN(e,t,r);if(t.indexOf("E")!==-1)return Rp(t,r);if(t.charCodeAt(0)===36)return"$"+Mr(e,t.substr(t.charAt(1)==" "?2:1),r);var a,i,l,o,c=Math.abs(r),d=r<0?"-":"";if(t.match(/^00+$/))return d+Fr(c,t.length);if(t.match(/^[#?]+$/))return a=""+r,r===0&&(a=""),a.length>t.length?a:Mt(t.substr(0,t.length-a.length))+a;if(i=t.match(Ap))return uN(i,c,d);if(t.match(/^#+0+$/))return d+Fr(c,t.length-t.indexOf("0"));if(i=t.match(Fp))return a=(""+r).replace(/^([^\.]+)$/,"$1."+Mt(i[1])).replace(/\.$/,"."+Mt(i[1])),a=a.replace(/\.(\d*)$/,function(v,x){return"."+x+rt("0",Mt(i[1]).length-x.length)}),t.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),i=t.match(/^(0*)\.(#*)$/))return d+(""+c).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=t.match(/^#{1,3},##0(\.?)$/))return d+Fn(""+c);if(i=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Mr(e,t,-r):Fn(""+r)+"."+rt("0",i[1].length);if(i=t.match(/^#,#*,#0/))return Mr(e,t.replace(/^#,#*,/,""),r);if(i=t.match(/^([0#]+)(\\?-([0#]+))+$/))return a=ea(Mr(e,t.replace(/[\\-]/g,""),r)),l=0,ea(ea(t.replace(/\\/g,"")).replace(/[0#]/g,function(v){return l<a.length?a.charAt(l++):v==="0"?"0":""}));if(t.match(Op))return a=Mr(e,"##########",r),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var u="";if(i=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(i[4].length,7),o=ao(c,Math.pow(10,l)-1,!1),a=""+d,u=sn("n",i[1],o[1]),u.charAt(u.length-1)==" "&&(u=u.substr(0,u.length-1)+"0"),a+=u+i[2]+"/"+i[3],u=no(o[2],l),u.length<i[4].length&&(u=Mt(i[4].substr(i[4].length-u.length))+u),a+=u,a;if(i=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(Math.max(i[1].length,i[4].length),7),o=ao(c,Math.pow(10,l)-1,!0),d+(o[0]||(o[1]?"":"0"))+" "+(o[1]?M0(o[1],l)+i[2]+"/"+i[3]+no(o[2],l):rt(" ",2*l+1+i[2].length+i[3].length));if(i=t.match(/^[#0?]+$/))return a=""+r,t.length<=a.length?a:Mt(t.substr(0,t.length-a.length))+a;if(i=t.match(/^([#0]+)\.([#0]+)$/)){a=""+r.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),l=a.indexOf(".");var f=t.indexOf(".")-l,h=t.length-a.length-f;return Mt(t.substr(0,f)+a+t.substr(t.length-h))}if(i=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+Mr(e,t,-r):Fn(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(v){return"00,"+(v.length<3?Fr(0,3-v.length):"")+v})+"."+Fr(0,i[1].length);switch(t){case"###,###":case"##,###":case"#,###":var m=Fn(""+c);return m!=="0"?d+m:"";default:if(t.match(/\.[0#?]*$/))return Mr(e,t.slice(0,t.lastIndexOf(".")),r)+Mt(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function sn(e,t,r){return(r|0)===r?Mr(e,t,r):fr(e,t,r)}function mN(e){for(var t=[],r=!1,n=0,a=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:t[t.length]=e.substr(a,n-a),a=n+1}if(t[t.length]=e.substr(a),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var Ip=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Dp(e){for(var t=0,r="",n="";t<e.length;)switch(r=e.charAt(t)){case"G":so(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="/")return!0;++t;break;case"[":for(n=r;e.charAt(t++)!=="]"&&t<e.length;)n+=e.charAt(t);if(n.match(Ip))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function pN(e,t,r,n){for(var a=[],i="",l=0,o="",c="t",d,u,f,h="H";l<e.length;)switch(o=e.charAt(l)){case"G":if(!so(e,l))throw new Error("unrecognized character "+o+" in "+e);a[a.length]={t:"G",v:"General"},l+=7;break;case'"':for(i="";(f=e.charCodeAt(++l))!==34&&l<e.length;)i+=String.fromCharCode(f);a[a.length]={t:"t",v:i},++l;break;case"\\":var m=e.charAt(++l),v=m==="("||m===")"?m:"t";a[a.length]={t:v,v:m},++l;break;case"_":a[a.length]={t:"t",v:" "},l+=2;break;case"@":a[a.length]={t:"T",v:t},++l;break;case"B":case"b":if(e.charAt(l+1)==="1"||e.charAt(l+1)==="2"){if(d==null&&(d=dl(t,r,e.charAt(l+1)==="2"),d==null))return"";a[a.length]={t:"X",v:e.substr(l,2)},c=o,l+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||d==null&&(d=dl(t,r),d==null))return"";for(i=o;++l<e.length&&e.charAt(l).toLowerCase()===o;)i+=o;o==="m"&&c.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=h),a[a.length]={t:o,v:i},c=o;break;case"A":case"a":case"":var x={t:o,v:o};if(d==null&&(d=dl(t,r)),e.substr(l,3).toUpperCase()==="A/P"?(d!=null&&(x.v=d.H>=12?"P":"A"),x.t="T",h="h",l+=3):e.substr(l,5).toUpperCase()==="AM/PM"?(d!=null&&(x.v=d.H>=12?"PM":"AM"),x.t="T",l+=5,h="h"):e.substr(l,5).toUpperCase()==="/"?(d!=null&&(x.v=d.H>=12?"":""),x.t="T",l+=5,h="h"):(x.t="t",++l),d==null&&x.t==="T")return"";a[a.length]=x,c=o;break;case"[":for(i=o;e.charAt(l++)!=="]"&&l<e.length;)i+=e.charAt(l);if(i.slice(-1)!=="]")throw'unterminated "[" block: |'+i+"|";if(i.match(Ip)){if(d==null&&(d=dl(t,r),d==null))return"";a[a.length]={t:"Z",v:i.toLowerCase()},c=i.charAt(1)}else i.indexOf("$")>-1&&(i=(i.match(/\$([^-\[\]]*)/)||[])[1]||"$",Dp(e)||(a[a.length]={t:"t",v:i}));break;case".":if(d!=null){for(i=o;++l<e.length&&(o=e.charAt(l))==="0";)i+=o;a[a.length]={t:"s",v:i};break}case"0":case"#":for(i=o;++l<e.length&&"0#?.,E+-%".indexOf(o=e.charAt(l))>-1;)i+=o;a[a.length]={t:"n",v:i};break;case"?":for(i=o;e.charAt(++l)===o;)i+=o;a[a.length]={t:o,v:i},c=o;break;case"*":++l,(e.charAt(l)==" "||e.charAt(l)=="*")&&++l;break;case"(":case")":a[a.length]={t:n===1?"t":o,v:o},++l;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(i=o;l<e.length&&"0123456789".indexOf(e.charAt(++l))>-1;)i+=e.charAt(l);a[a.length]={t:"D",v:i};break;case" ":a[a.length]={t:o,v:o},++l;break;case"$":a[a.length]={t:"t",v:"$"},++l;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+e);a[a.length]={t:"t",v:o},++l;break}var y=0,p=0,g;for(l=a.length-1,c="t";l>=0;--l)switch(a[l].t){case"h":case"H":a[l].t=h,c="h",y<1&&(y=1);break;case"s":(g=a[l].v.match(/\.0+$/))&&(p=Math.max(p,g[0].length-1)),y<3&&(y=3);case"d":case"y":case"M":case"e":c=a[l].t;break;case"m":c==="s"&&(a[l].t="M",y<2&&(y=2));break;case"X":break;case"Z":y<1&&a[l].v.match(/[Hh]/)&&(y=1),y<2&&a[l].v.match(/[Mm]/)&&(y=2),y<3&&a[l].v.match(/[Ss]/)&&(y=3)}switch(y){case 0:break;case 1:d.u>=.5&&(d.u=0,++d.S),d.S>=60&&(d.S=0,++d.M),d.M>=60&&(d.M=0,++d.H);break;case 2:d.u>=.5&&(d.u=0,++d.S),d.S>=60&&(d.S=0,++d.M);break}var w="",b;for(l=0;l<a.length;++l)switch(a[l].t){case"t":case"T":case" ":case"D":break;case"X":a[l].v="",a[l].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":a[l].v=iN(a[l].t.charCodeAt(0),a[l].v,d,p),a[l].t="t";break;case"n":case"?":for(b=l+1;a[b]!=null&&((o=a[b].t)==="?"||o==="D"||(o===" "||o==="t")&&a[b+1]!=null&&(a[b+1].t==="?"||a[b+1].t==="t"&&a[b+1].v==="/")||a[l].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(a[b].v==="/"||a[b].v===" "&&a[b+1]!=null&&a[b+1].t=="?"));)a[l].v+=a[b].v,a[b]={v:"",t:";"},++b;w+=a[l].v,l=b-1;break;case"G":a[l].t="t",a[l].v=Iu(t,r);break}var P="",M,j;if(w.length>0){w.charCodeAt(0)==40?(M=t<0&&w.charCodeAt(0)===45?-t:t,j=sn("n",w,M)):(M=t<0&&n>1?-t:t,j=sn("n",w,M),M<0&&a[0]&&a[0].t=="t"&&(j=j.substr(1),a[0].v="-"+a[0].v)),b=j.length-1;var O=a.length;for(l=0;l<a.length;++l)if(a[l]!=null&&a[l].t!="t"&&a[l].v.indexOf(".")>-1){O=l;break}var R=a.length;if(O===a.length&&j.indexOf("E")===-1){for(l=a.length-1;l>=0;--l)a[l]==null||"n?".indexOf(a[l].t)===-1||(b>=a[l].v.length-1?(b-=a[l].v.length,a[l].v=j.substr(b+1,a[l].v.length)):b<0?a[l].v="":(a[l].v=j.substr(0,b+1),b=-1),a[l].t="t",R=l);b>=0&&R<a.length&&(a[R].v=j.substr(0,b+1)+a[R].v)}else if(O!==a.length&&j.indexOf("E")===-1){for(b=j.indexOf(".")-1,l=O;l>=0;--l)if(!(a[l]==null||"n?".indexOf(a[l].t)===-1)){for(u=a[l].v.indexOf(".")>-1&&l===O?a[l].v.indexOf(".")-1:a[l].v.length-1,P=a[l].v.substr(u+1);u>=0;--u)b>=0&&(a[l].v.charAt(u)==="0"||a[l].v.charAt(u)==="#")&&(P=j.charAt(b--)+P);a[l].v=P,a[l].t="t",R=l}for(b>=0&&R<a.length&&(a[R].v=j.substr(0,b+1)+a[R].v),b=j.indexOf(".")+1,l=O;l<a.length;++l)if(!(a[l]==null||"n?(".indexOf(a[l].t)===-1&&l!==O)){for(u=a[l].v.indexOf(".")>-1&&l===O?a[l].v.indexOf(".")+1:0,P=a[l].v.substr(0,u);u<a[l].v.length;++u)b<j.length&&(P+=j.charAt(b++));a[l].v=P,a[l].t="t",R=l}}}for(l=0;l<a.length;++l)a[l]!=null&&"n?".indexOf(a[l].t)>-1&&(M=n>1&&t<0&&l>0&&a[l-1].v==="-"?-t:t,a[l].v=sn(a[l].t,a[l].v,M),a[l].t="t");var I="";for(l=0;l!==a.length;++l)a[l]!=null&&(I+=a[l].v);return I}var Qf=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function Zf(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function gN(e,t){var r=mN(e),n=r.length,a=r[n-1].indexOf("@");if(n<4&&a>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||a>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=a>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=a>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=a>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var i=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,i];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var l=r[0].match(Qf),o=r[1].match(Qf);return Zf(t,l)?[n,r[0]]:Zf(t,o)?[n,r[1]]:[n,r[l!=null&&o!=null?2:1]]}return[n,i]}function Hn(e,t,r){r==null&&(r={});var n="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?n=r.dateNF:n=e;break;case"number":e==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:nt)[e],n==null&&(n=r.table&&r.table[Yf[e]]||nt[Yf[e]]),n==null&&(n=Qb[e]||"General");break}if(so(n,0))return Iu(t,r);t instanceof Date&&(t=Tp(t,r.date1904));var a=gN(n,t);if(so(a[1]))return Iu(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return pN(a[1],t,r,a[0])}function Lp(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(nt[r]==null){t<0&&(t=r);continue}if(nt[r]==e){t=r;break}}t<0&&(t=391)}return nt[t]=e,t}function Do(e){for(var t=0;t!=392;++t)e[t]!==void 0&&Lp(e[t],t)}function Lo(){nt=qb()}var Mp=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function yN(e){var t=typeof e=="number"?nt[e]:e;return t=t.replace(Mp,"(\\d+)"),new RegExp("^"+t+"$")}function vN(e,t,r){var n=-1,a=-1,i=-1,l=-1,o=-1,c=-1;(t.match(Mp)||[]).forEach(function(f,h){var m=parseInt(r[h+1],10);switch(f.toLowerCase().charAt(0)){case"y":n=m;break;case"d":i=m;break;case"h":l=m;break;case"s":c=m;break;case"m":l>=0?o=m:a=m;break}}),c>=0&&o==-1&&a>=0&&(o=a,a=-1);var d=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(a>=1?a:1)).slice(-2)+"-"+("00"+(i>=1?i:1)).slice(-2);d.length==7&&(d="0"+d),d.length==8&&(d="20"+d);var u=("00"+(l>=0?l:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2);return l==-1&&o==-1&&c==-1?d:n==-1&&a==-1&&i==-1?u:d+"T"+u}var wN=function(){var e={};e.version="1.2.0";function t(){for(var j=0,O=new Array(256),R=0;R!=256;++R)j=R,j=j&1?-306674912^j>>>1:j>>>1,j=j&1?-306674912^j>>>1:j>>>1,j=j&1?-306674912^j>>>1:j>>>1,j=j&1?-306674912^j>>>1:j>>>1,j=j&1?-306674912^j>>>1:j>>>1,j=j&1?-306674912^j>>>1:j>>>1,j=j&1?-306674912^j>>>1:j>>>1,j=j&1?-306674912^j>>>1:j>>>1,O[R]=j;return typeof Int32Array<"u"?new Int32Array(O):O}var r=t();function n(j){var O=0,R=0,I=0,D=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(I=0;I!=256;++I)D[I]=j[I];for(I=0;I!=256;++I)for(R=j[I],O=256+I;O<4096;O+=256)R=D[O]=R>>>8^j[R&255];var z=[];for(I=1;I!=16;++I)z[I-1]=typeof Int32Array<"u"?D.subarray(I*256,I*256+256):D.slice(I*256,I*256+256);return z}var a=n(r),i=a[0],l=a[1],o=a[2],c=a[3],d=a[4],u=a[5],f=a[6],h=a[7],m=a[8],v=a[9],x=a[10],y=a[11],p=a[12],g=a[13],w=a[14];function b(j,O){for(var R=O^-1,I=0,D=j.length;I<D;)R=R>>>8^r[(R^j.charCodeAt(I++))&255];return~R}function P(j,O){for(var R=O^-1,I=j.length-15,D=0;D<I;)R=w[j[D++]^R&255]^g[j[D++]^R>>8&255]^p[j[D++]^R>>16&255]^y[j[D++]^R>>>24]^x[j[D++]]^v[j[D++]]^m[j[D++]]^h[j[D++]]^f[j[D++]]^u[j[D++]]^d[j[D++]]^c[j[D++]]^o[j[D++]]^l[j[D++]]^i[j[D++]]^r[j[D++]];for(I+=15;D<I;)R=R>>>8^r[(R^j[D++])&255];return~R}function M(j,O){for(var R=O^-1,I=0,D=j.length,z=0,ne=0;I<D;)z=j.charCodeAt(I++),z<128?R=R>>>8^r[(R^z)&255]:z<2048?(R=R>>>8^r[(R^(192|z>>6&31))&255],R=R>>>8^r[(R^(128|z&63))&255]):z>=55296&&z<57344?(z=(z&1023)+64,ne=j.charCodeAt(I++)&1023,R=R>>>8^r[(R^(240|z>>8&7))&255],R=R>>>8^r[(R^(128|z>>2&63))&255],R=R>>>8^r[(R^(128|ne>>6&15|(z&3)<<4))&255],R=R>>>8^r[(R^(128|ne&63))&255]):(R=R>>>8^r[(R^(224|z>>12&15))&255],R=R>>>8^r[(R^(128|z>>6&63))&255],R=R>>>8^r[(R^(128|z&63))&255]);return~R}return e.table=r,e.bstr=b,e.buf=P,e.str=M,e}(),Ue=function(){var t={};t.version="1.2.1";function r(N,C){for(var S=N.split("/"),_=C.split("/"),A=0,F=0,V=Math.min(S.length,_.length);A<V;++A){if(F=S[A].length-_[A].length)return F;if(S[A]!=_[A])return S[A]<_[A]?-1:1}return S.length-_.length}function n(N){if(N.charAt(N.length-1)=="/")return N.slice(0,-1).indexOf("/")===-1?N:n(N.slice(0,-1));var C=N.lastIndexOf("/");return C===-1?N:N.slice(0,C+1)}function a(N){if(N.charAt(N.length-1)=="/")return a(N.slice(0,-1));var C=N.lastIndexOf("/");return C===-1?N:N.slice(C+1)}function i(N,C){typeof C=="string"&&(C=new Date(C));var S=C.getHours();S=S<<6|C.getMinutes(),S=S<<5|C.getSeconds()>>>1,N.write_shift(2,S);var _=C.getFullYear()-1980;_=_<<4|C.getMonth()+1,_=_<<5|C.getDate(),N.write_shift(2,_)}function l(N){var C=N.read_shift(2)&65535,S=N.read_shift(2)&65535,_=new Date,A=S&31;S>>>=5;var F=S&15;S>>>=4,_.setMilliseconds(0),_.setFullYear(S+1980),_.setMonth(F-1),_.setDate(A);var V=C&31;C>>>=5;var Z=C&63;return C>>>=6,_.setHours(C),_.setMinutes(Z),_.setSeconds(V<<1),_}function o(N){rr(N,0);for(var C={},S=0;N.l<=N.length-4;){var _=N.read_shift(2),A=N.read_shift(2),F=N.l+A,V={};switch(_){case 21589:S=N.read_shift(1),S&1&&(V.mtime=N.read_shift(4)),A>5&&(S&2&&(V.atime=N.read_shift(4)),S&4&&(V.ctime=N.read_shift(4))),V.mtime&&(V.mt=new Date(V.mtime*1e3));break}N.l=F,C[_]=V}return C}var c;function d(){return c||(c={})}function u(N,C){if(N[0]==80&&N[1]==75)return xd(N,C);if((N[0]|32)==109&&(N[1]|32)==105)return x1(N,C);if(N.length<512)throw new Error("CFB file size "+N.length+" < 512");var S=3,_=512,A=0,F=0,V=0,Z=0,H=0,X=[],Y=N.slice(0,512);rr(Y,0);var ae=f(Y);switch(S=ae[0],S){case 3:_=512;break;case 4:_=4096;break;case 0:if(ae[1]==0)return xd(N,C);default:throw new Error("Major Version: Expected 3 or 4 saw "+S)}_!==512&&(Y=N.slice(0,_),rr(Y,28));var fe=N.slice(0,_);h(Y,S);var ge=Y.read_shift(4,"i");if(S===3&&ge!==0)throw new Error("# Directory Sectors: Expected 0 saw "+ge);Y.l+=4,V=Y.read_shift(4,"i"),Y.l+=4,Y.chk("00100000","Mini Stream Cutoff Size: "),Z=Y.read_shift(4,"i"),A=Y.read_shift(4,"i"),H=Y.read_shift(4,"i"),F=Y.read_shift(4,"i");for(var le=-1,me=0;me<109&&(le=Y.read_shift(4,"i"),!(le<0));++me)X[me]=le;var Te=m(N,_);y(H,F,Te,_,X);var Ye=g(Te,V,X,_);Ye[V].name="!Directory",A>0&&Z!==ne&&(Ye[Z].name="!MiniFAT"),Ye[X[0]].name="!FAT",Ye.fat_addrs=X,Ye.ssz=_;var Je={},At=[],ja=[],Sa=[];w(V,Ye,Te,At,A,Je,ja,Z),v(ja,Sa,At),At.shift();var _a={FileIndex:ja,FullPaths:Sa};return C&&C.raw&&(_a.raw={header:fe,sectors:Te}),_a}function f(N){if(N[N.l]==80&&N[N.l+1]==75)return[0,0];N.chk(Ne,"Header Signature: "),N.l+=16;var C=N.read_shift(2,"u");return[N.read_shift(2,"u"),C]}function h(N,C){var S=9;switch(N.l+=2,S=N.read_shift(2)){case 9:if(C!=3)throw new Error("Sector Shift: Expected 9 saw "+S);break;case 12:if(C!=4)throw new Error("Sector Shift: Expected 12 saw "+S);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+S)}N.chk("0600","Mini Sector Shift: "),N.chk("000000000000","Reserved: ")}function m(N,C){for(var S=Math.ceil(N.length/C)-1,_=[],A=1;A<S;++A)_[A-1]=N.slice(A*C,(A+1)*C);return _[S-1]=N.slice(S*C),_}function v(N,C,S){for(var _=0,A=0,F=0,V=0,Z=0,H=S.length,X=[],Y=[];_<H;++_)X[_]=Y[_]=_,C[_]=S[_];for(;Z<Y.length;++Z)_=Y[Z],A=N[_].L,F=N[_].R,V=N[_].C,X[_]===_&&(A!==-1&&X[A]!==A&&(X[_]=X[A]),F!==-1&&X[F]!==F&&(X[_]=X[F])),V!==-1&&(X[V]=_),A!==-1&&_!=X[_]&&(X[A]=X[_],Y.lastIndexOf(A)<Z&&Y.push(A)),F!==-1&&_!=X[_]&&(X[F]=X[_],Y.lastIndexOf(F)<Z&&Y.push(F));for(_=1;_<H;++_)X[_]===_&&(F!==-1&&X[F]!==F?X[_]=X[F]:A!==-1&&X[A]!==A&&(X[_]=X[A]));for(_=1;_<H;++_)if(N[_].type!==0){if(Z=_,Z!=X[Z])do Z=X[Z],C[_]=C[Z]+"/"+C[_];while(Z!==0&&X[Z]!==-1&&Z!=X[Z]);X[_]=-1}for(C[0]+="/",_=1;_<H;++_)N[_].type!==2&&(C[_]+="/")}function x(N,C,S){for(var _=N.start,A=N.size,F=[],V=_;S&&A>0&&V>=0;)F.push(C.slice(V*z,V*z+z)),A-=z,V=ss(S,V*4);return F.length===0?Q(0):St(F).slice(0,N.size)}function y(N,C,S,_,A){var F=ne;if(N===ne){if(C!==0)throw new Error("DIFAT chain shorter than expected")}else if(N!==-1){var V=S[N],Z=(_>>>2)-1;if(!V)return;for(var H=0;H<Z&&(F=ss(V,H*4))!==ne;++H)A.push(F);y(ss(V,_-4),C-1,S,_,A)}}function p(N,C,S,_,A){var F=[],V=[];A||(A=[]);var Z=_-1,H=0,X=0;for(H=C;H>=0;){A[H]=!0,F[F.length]=H,V.push(N[H]);var Y=S[Math.floor(H*4/_)];if(X=H*4&Z,_<4+X)throw new Error("FAT boundary crossed: "+H+" 4 "+_);if(!N[Y])break;H=ss(N[Y],X)}return{nodes:F,data:lh([V])}}function g(N,C,S,_){var A=N.length,F=[],V=[],Z=[],H=[],X=_-1,Y=0,ae=0,fe=0,ge=0;for(Y=0;Y<A;++Y)if(Z=[],fe=Y+C,fe>=A&&(fe-=A),!V[fe]){H=[];var le=[];for(ae=fe;ae>=0;){le[ae]=!0,V[ae]=!0,Z[Z.length]=ae,H.push(N[ae]);var me=S[Math.floor(ae*4/_)];if(ge=ae*4&X,_<4+ge)throw new Error("FAT boundary crossed: "+ae+" 4 "+_);if(!N[me]||(ae=ss(N[me],ge),le[ae]))break}F[fe]={nodes:Z,data:lh([H])}}return F}function w(N,C,S,_,A,F,V,Z){for(var H=0,X=_.length?2:0,Y=C[N].data,ae=0,fe=0,ge;ae<Y.length;ae+=128){var le=Y.slice(ae,ae+128);rr(le,64),fe=le.read_shift(2),ge=H0(le,0,fe-X),_.push(ge);var me={name:ge,type:le.read_shift(1),color:le.read_shift(1),L:le.read_shift(4,"i"),R:le.read_shift(4,"i"),C:le.read_shift(4,"i"),clsid:le.read_shift(16),state:le.read_shift(4,"i"),start:0,size:0},Te=le.read_shift(2)+le.read_shift(2)+le.read_shift(2)+le.read_shift(2);Te!==0&&(me.ct=b(le,le.l-8));var Ye=le.read_shift(2)+le.read_shift(2)+le.read_shift(2)+le.read_shift(2);Ye!==0&&(me.mt=b(le,le.l-8)),me.start=le.read_shift(4,"i"),me.size=le.read_shift(4,"i"),me.size<0&&me.start<0&&(me.size=me.type=0,me.start=ne,me.name=""),me.type===5?(H=me.start,A>0&&H!==ne&&(C[H].name="!StreamData")):me.size>=4096?(me.storage="fat",C[me.start]===void 0&&(C[me.start]=p(S,me.start,C.fat_addrs,C.ssz)),C[me.start].name=me.name,me.content=C[me.start].data.slice(0,me.size)):(me.storage="minifat",me.size<0?me.size=0:H!==ne&&me.start!==ne&&C[H]&&(me.content=x(me,C[H].data,(C[Z]||{}).data))),me.content&&rr(me.content,0),F[ge]=me,V.push(me)}}function b(N,C){return new Date((sr(N,C+4)/1e7*Math.pow(2,32)+sr(N,C)/1e7-11644473600)*1e3)}function P(N,C){return d(),u(c.readFileSync(N),C)}function M(N,C){var S=C&&C.type;switch(S||Re&&Buffer.isBuffer(N)&&(S="buffer"),S||"base64"){case"file":return P(N,C);case"base64":return u(Ar(fn(N)),C);case"binary":return u(Ar(N),C)}return u(N,C)}function j(N,C){var S=C||{},_=S.root||"Root Entry";if(N.FullPaths||(N.FullPaths=[]),N.FileIndex||(N.FileIndex=[]),N.FullPaths.length!==N.FileIndex.length)throw new Error("inconsistent CFB structure");N.FullPaths.length===0&&(N.FullPaths[0]=_+"/",N.FileIndex[0]={name:_,type:5}),S.CLSID&&(N.FileIndex[0].clsid=S.CLSID),O(N)}function O(N){var C="Sh33tJ5";if(!Ue.find(N,"/"+C)){var S=Q(4);S[0]=55,S[1]=S[3]=50,S[2]=54,N.FileIndex.push({name:C,type:2,content:S,size:4,L:69,R:69,C:69}),N.FullPaths.push(N.FullPaths[0]+C),R(N)}}function R(N,C){j(N);for(var S=!1,_=!1,A=N.FullPaths.length-1;A>=0;--A){var F=N.FileIndex[A];switch(F.type){case 0:_?S=!0:(N.FileIndex.pop(),N.FullPaths.pop());break;case 1:case 2:case 5:_=!0,isNaN(F.R*F.L*F.C)&&(S=!0),F.R>-1&&F.L>-1&&F.R==F.L&&(S=!0);break;default:S=!0;break}}if(!(!S&&!C)){var V=new Date(1987,1,19),Z=0,H=Object.create?Object.create(null):{},X=[];for(A=0;A<N.FullPaths.length;++A)H[N.FullPaths[A]]=!0,N.FileIndex[A].type!==0&&X.push([N.FullPaths[A],N.FileIndex[A]]);for(A=0;A<X.length;++A){var Y=n(X[A][0]);_=H[Y],_||(X.push([Y,{name:a(Y).replace("/",""),type:1,clsid:je,ct:V,mt:V,content:null}]),H[Y]=!0)}for(X.sort(function(ge,le){return r(ge[0],le[0])}),N.FullPaths=[],N.FileIndex=[],A=0;A<X.length;++A)N.FullPaths[A]=X[A][0],N.FileIndex[A]=X[A][1];for(A=0;A<X.length;++A){var ae=N.FileIndex[A],fe=N.FullPaths[A];if(ae.name=a(fe).replace("/",""),ae.L=ae.R=ae.C=-(ae.color=1),ae.size=ae.content?ae.content.length:0,ae.start=0,ae.clsid=ae.clsid||je,A===0)ae.C=X.length>1?1:-1,ae.size=0,ae.type=5;else if(fe.slice(-1)=="/"){for(Z=A+1;Z<X.length&&n(N.FullPaths[Z])!=fe;++Z);for(ae.C=Z>=X.length?-1:Z,Z=A+1;Z<X.length&&n(N.FullPaths[Z])!=n(fe);++Z);ae.R=Z>=X.length?-1:Z,ae.type=1}else n(N.FullPaths[A+1]||"")==n(fe)&&(ae.R=A+1),ae.type=2}}}function I(N,C){var S=C||{};if(S.fileType=="mad")return m1(N,S);switch(R(N),S.fileType){case"zip":return o1(N,S)}var _=function(ge){for(var le=0,me=0,Te=0;Te<ge.FileIndex.length;++Te){var Ye=ge.FileIndex[Te];if(Ye.content){var Je=Ye.content.length;Je>0&&(Je<4096?le+=Je+63>>6:me+=Je+511>>9)}}for(var At=ge.FullPaths.length+3>>2,ja=le+7>>3,Sa=le+127>>7,_a=ja+me+At+Sa,es=_a+127>>7,Xo=es<=109?0:Math.ceil((es-109)/127);_a+es+Xo+127>>7>es;)Xo=++es<=109?0:Math.ceil((es-109)/127);var Xr=[1,Xo,es,Sa,At,me,le,0];return ge.FileIndex[0].size=le<<6,Xr[7]=(ge.FileIndex[0].start=Xr[0]+Xr[1]+Xr[2]+Xr[3]+Xr[4]+Xr[5])+(Xr[6]+7>>3),Xr}(N),A=Q(_[7]<<9),F=0,V=0;{for(F=0;F<8;++F)A.write_shift(1,ue[F]);for(F=0;F<8;++F)A.write_shift(2,0);for(A.write_shift(2,62),A.write_shift(2,3),A.write_shift(2,65534),A.write_shift(2,9),A.write_shift(2,6),F=0;F<3;++F)A.write_shift(2,0);for(A.write_shift(4,0),A.write_shift(4,_[2]),A.write_shift(4,_[0]+_[1]+_[2]+_[3]-1),A.write_shift(4,0),A.write_shift(4,4096),A.write_shift(4,_[3]?_[0]+_[1]+_[2]-1:ne),A.write_shift(4,_[3]),A.write_shift(-4,_[1]?_[0]-1:ne),A.write_shift(4,_[1]),F=0;F<109;++F)A.write_shift(-4,F<_[2]?_[1]+F:-1)}if(_[1])for(V=0;V<_[1];++V){for(;F<236+V*127;++F)A.write_shift(-4,F<_[2]?_[1]+F:-1);A.write_shift(-4,V===_[1]-1?ne:V+1)}var Z=function(ge){for(V+=ge;F<V-1;++F)A.write_shift(-4,F+1);ge&&(++F,A.write_shift(-4,ne))};for(V=F=0,V+=_[1];F<V;++F)A.write_shift(-4,q.DIFSECT);for(V+=_[2];F<V;++F)A.write_shift(-4,q.FATSECT);Z(_[3]),Z(_[4]);for(var H=0,X=0,Y=N.FileIndex[0];H<N.FileIndex.length;++H)Y=N.FileIndex[H],Y.content&&(X=Y.content.length,!(X<4096)&&(Y.start=V,Z(X+511>>9)));for(Z(_[6]+7>>3);A.l&511;)A.write_shift(-4,q.ENDOFCHAIN);for(V=F=0,H=0;H<N.FileIndex.length;++H)Y=N.FileIndex[H],Y.content&&(X=Y.content.length,!(!X||X>=4096)&&(Y.start=V,Z(X+63>>6)));for(;A.l&511;)A.write_shift(-4,q.ENDOFCHAIN);for(F=0;F<_[4]<<2;++F){var ae=N.FullPaths[F];if(!ae||ae.length===0){for(H=0;H<17;++H)A.write_shift(4,0);for(H=0;H<3;++H)A.write_shift(4,-1);for(H=0;H<12;++H)A.write_shift(4,0);continue}Y=N.FileIndex[F],F===0&&(Y.start=Y.size?Y.start-1:ne);var fe=F===0&&S.root||Y.name;if(X=2*(fe.length+1),A.write_shift(64,fe,"utf16le"),A.write_shift(2,X),A.write_shift(1,Y.type),A.write_shift(1,Y.color),A.write_shift(-4,Y.L),A.write_shift(-4,Y.R),A.write_shift(-4,Y.C),Y.clsid)A.write_shift(16,Y.clsid,"hex");else for(H=0;H<4;++H)A.write_shift(4,0);A.write_shift(4,Y.state||0),A.write_shift(4,0),A.write_shift(4,0),A.write_shift(4,0),A.write_shift(4,0),A.write_shift(4,Y.start),A.write_shift(4,Y.size),A.write_shift(4,0)}for(F=1;F<N.FileIndex.length;++F)if(Y=N.FileIndex[F],Y.size>=4096)if(A.l=Y.start+1<<9,Re&&Buffer.isBuffer(Y.content))Y.content.copy(A,A.l,0,Y.size),A.l+=Y.size+511&-512;else{for(H=0;H<Y.size;++H)A.write_shift(1,Y.content[H]);for(;H&511;++H)A.write_shift(1,0)}for(F=1;F<N.FileIndex.length;++F)if(Y=N.FileIndex[F],Y.size>0&&Y.size<4096)if(Re&&Buffer.isBuffer(Y.content))Y.content.copy(A,A.l,0,Y.size),A.l+=Y.size+63&-64;else{for(H=0;H<Y.size;++H)A.write_shift(1,Y.content[H]);for(;H&63;++H)A.write_shift(1,0)}if(Re)A.l=A.length;else for(;A.l<A.length;)A.write_shift(1,0);return A}function D(N,C){var S=N.FullPaths.map(function(H){return H.toUpperCase()}),_=S.map(function(H){var X=H.split("/");return X[X.length-(H.slice(-1)=="/"?2:1)]}),A=!1;C.charCodeAt(0)===47?(A=!0,C=S[0].slice(0,-1)+C):A=C.indexOf("/")!==-1;var F=C.toUpperCase(),V=A===!0?S.indexOf(F):_.indexOf(F);if(V!==-1)return N.FileIndex[V];var Z=!F.match(ul);for(F=F.replace(Qa,""),Z&&(F=F.replace(ul,"!")),V=0;V<S.length;++V)if((Z?S[V].replace(ul,"!"):S[V]).replace(Qa,"")==F||(Z?_[V].replace(ul,"!"):_[V]).replace(Qa,"")==F)return N.FileIndex[V];return null}var z=64,ne=-2,Ne="d0cf11e0a1b11ae1",ue=[208,207,17,224,161,177,26,225],je="00000000000000000000000000000000",q={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:ne,FREESECT:-1,HEADER_SIGNATURE:Ne,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:je,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function W(N,C,S){d();var _=I(N,S);c.writeFileSync(C,_)}function k(N){for(var C=new Array(N.length),S=0;S<N.length;++S)C[S]=String.fromCharCode(N[S]);return C.join("")}function K(N,C){var S=I(N,C);switch(C&&C.type||"buffer"){case"file":return d(),c.writeFileSync(C.filename,S),S;case"binary":return typeof S=="string"?S:k(S);case"base64":return _i(typeof S=="string"?S:k(S));case"buffer":if(Re)return Buffer.isBuffer(S)?S:gn(S);case"array":return typeof S=="string"?Ar(S):S}return S}var te;function E(N){try{var C=N.InflateRaw,S=new C;if(S._processChunk(new Uint8Array([3,0]),S._finishFlushFlag),S.bytesRead)te=N;else throw new Error("zlib does not expose bytesRead")}catch(_){console.error("cannot use native zlib: "+(_.message||_))}}function B(N,C){if(!te)return fd(N,C);var S=te.InflateRaw,_=new S,A=_._processChunk(N.slice(N.l),_._finishFlushFlag);return N.l+=_.bytesRead,A}function L(N){return te?te.deflateRawSync(N):id(N)}var U=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],ee=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],he=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function xe(N){var C=(N<<1|N<<11)&139536|(N<<5|N<<15)&558144;return(C>>16|C>>8|C)&255}for(var G=typeof Uint8Array<"u",J=G?new Uint8Array(256):[],ve=0;ve<256;++ve)J[ve]=xe(ve);function Se(N,C){var S=J[N&255];return C<=8?S>>>8-C:(S=S<<8|J[N>>8&255],C<=16?S>>>16-C:(S=S<<8|J[N>>16&255],S>>>24-C))}function se(N,C){var S=C&7,_=C>>>3;return(N[_]|(S<=6?0:N[_+1]<<8))>>>S&3}function pe(N,C){var S=C&7,_=C>>>3;return(N[_]|(S<=5?0:N[_+1]<<8))>>>S&7}function Ae(N,C){var S=C&7,_=C>>>3;return(N[_]|(S<=4?0:N[_+1]<<8))>>>S&15}function _e(N,C){var S=C&7,_=C>>>3;return(N[_]|(S<=3?0:N[_+1]<<8))>>>S&31}function de(N,C){var S=C&7,_=C>>>3;return(N[_]|(S<=1?0:N[_+1]<<8))>>>S&127}function xt(N,C,S){var _=C&7,A=C>>>3,F=(1<<S)-1,V=N[A]>>>_;return S<8-_||(V|=N[A+1]<<8-_,S<16-_)||(V|=N[A+2]<<16-_,S<24-_)||(V|=N[A+3]<<24-_),V&F}function Zt(N,C,S){var _=C&7,A=C>>>3;return _<=5?N[A]|=(S&7)<<_:(N[A]|=S<<_&255,N[A+1]=(S&7)>>8-_),C+3}function at(N,C,S){var _=C&7,A=C>>>3;return S=(S&1)<<_,N[A]|=S,C+1}function yn(N,C,S){var _=C&7,A=C>>>3;return S<<=_,N[A]|=S&255,S>>>=8,N[A+1]=S,C+8}function ad(N,C,S){var _=C&7,A=C>>>3;return S<<=_,N[A]|=S&255,S>>>=8,N[A+1]=S&255,N[A+2]=S>>>8,C+16}function Wo(N,C){var S=N.length,_=2*S>C?2*S:C+5,A=0;if(S>=C)return N;if(Re){var F=Gf(_);if(N.copy)N.copy(F);else for(;A<N.length;++A)F[A]=N[A];return F}else if(G){var V=new Uint8Array(_);if(V.set)V.set(N);else for(;A<S;++A)V[A]=N[A];return V}return N.length=_,N}function Dr(N){for(var C=new Array(N),S=0;S<N;++S)C[S]=0;return C}function Hi(N,C,S){var _=1,A=0,F=0,V=0,Z=0,H=N.length,X=G?new Uint16Array(32):Dr(32);for(F=0;F<32;++F)X[F]=0;for(F=H;F<S;++F)N[F]=0;H=N.length;var Y=G?new Uint16Array(H):Dr(H);for(F=0;F<H;++F)X[A=N[F]]++,_<A&&(_=A),Y[F]=0;for(X[0]=0,F=1;F<=_;++F)X[F+16]=Z=Z+X[F-1]<<1;for(F=0;F<H;++F)Z=N[F],Z!=0&&(Y[F]=X[Z+16]++);var ae=0;for(F=0;F<H;++F)if(ae=N[F],ae!=0)for(Z=Se(Y[F],_)>>_-ae,V=(1<<_+4-ae)-1;V>=0;--V)C[Z|V<<ae]=ae&15|F<<4;return _}var Ho=G?new Uint16Array(512):Dr(512),Vo=G?new Uint16Array(32):Dr(32);if(!G){for(var Zn=0;Zn<512;++Zn)Ho[Zn]=0;for(Zn=0;Zn<32;++Zn)Vo[Zn]=0}(function(){for(var N=[],C=0;C<32;C++)N.push(5);Hi(N,Vo,32);var S=[];for(C=0;C<=143;C++)S.push(8);for(;C<=255;C++)S.push(9);for(;C<=279;C++)S.push(7);for(;C<=287;C++)S.push(8);Hi(S,Ho,288)})();var s1=function(){for(var C=G?new Uint8Array(32768):[],S=0,_=0;S<he.length-1;++S)for(;_<he[S+1];++_)C[_]=S;for(;_<32768;++_)C[_]=29;var A=G?new Uint8Array(259):[];for(S=0,_=0;S<ee.length-1;++S)for(;_<ee[S+1];++_)A[_]=S;function F(Z,H){for(var X=0;X<Z.length;){var Y=Math.min(65535,Z.length-X),ae=X+Y==Z.length;for(H.write_shift(1,+ae),H.write_shift(2,Y),H.write_shift(2,~Y&65535);Y-- >0;)H[H.l++]=Z[X++]}return H.l}function V(Z,H){for(var X=0,Y=0,ae=G?new Uint16Array(32768):[];Y<Z.length;){var fe=Math.min(65535,Z.length-Y);if(fe<10){for(X=Zt(H,X,+(Y+fe==Z.length)),X&7&&(X+=8-(X&7)),H.l=X/8|0,H.write_shift(2,fe),H.write_shift(2,~fe&65535);fe-- >0;)H[H.l++]=Z[Y++];X=H.l*8;continue}X=Zt(H,X,+(Y+fe==Z.length)+2);for(var ge=0;fe-- >0;){var le=Z[Y];ge=(ge<<5^le)&32767;var me=-1,Te=0;if((me=ae[ge])&&(me|=Y&-32768,me>Y&&(me-=32768),me<Y))for(;Z[me+Te]==Z[Y+Te]&&Te<250;)++Te;if(Te>2){le=A[Te],le<=22?X=yn(H,X,J[le+1]>>1)-1:(yn(H,X,3),X+=5,yn(H,X,J[le-23]>>5),X+=3);var Ye=le<8?0:le-4>>2;Ye>0&&(ad(H,X,Te-ee[le]),X+=Ye),le=C[Y-me],X=yn(H,X,J[le]>>3),X-=3;var Je=le<4?0:le-2>>1;Je>0&&(ad(H,X,Y-me-he[le]),X+=Je);for(var At=0;At<Te;++At)ae[ge]=Y&32767,ge=(ge<<5^Z[Y])&32767,++Y;fe-=Te-1}else le<=143?le=le+48:X=at(H,X,1),X=yn(H,X,J[le]),ae[ge]=Y&32767,++Y}X=yn(H,X,0)-1}return H.l=(X+7)/8|0,H.l}return function(H,X){return H.length<8?F(H,X):V(H,X)}}();function id(N){var C=Q(50+Math.floor(N.length*1.1)),S=s1(N,C);return C.slice(0,S)}var ld=G?new Uint16Array(32768):Dr(32768),od=G?new Uint16Array(32768):Dr(32768),cd=G?new Uint16Array(128):Dr(128),ud=1,dd=1;function a1(N,C){var S=_e(N,C)+257;C+=5;var _=_e(N,C)+1;C+=5;var A=Ae(N,C)+4;C+=4;for(var F=0,V=G?new Uint8Array(19):Dr(19),Z=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],H=1,X=G?new Uint8Array(8):Dr(8),Y=G?new Uint8Array(8):Dr(8),ae=V.length,fe=0;fe<A;++fe)V[U[fe]]=F=pe(N,C),H<F&&(H=F),X[F]++,C+=3;var ge=0;for(X[0]=0,fe=1;fe<=H;++fe)Y[fe]=ge=ge+X[fe-1]<<1;for(fe=0;fe<ae;++fe)(ge=V[fe])!=0&&(Z[fe]=Y[ge]++);var le=0;for(fe=0;fe<ae;++fe)if(le=V[fe],le!=0){ge=J[Z[fe]]>>8-le;for(var me=(1<<7-le)-1;me>=0;--me)cd[ge|me<<le]=le&7|fe<<3}var Te=[];for(H=1;Te.length<S+_;)switch(ge=cd[de(N,C)],C+=ge&7,ge>>>=3){case 16:for(F=3+se(N,C),C+=2,ge=Te[Te.length-1];F-- >0;)Te.push(ge);break;case 17:for(F=3+pe(N,C),C+=3;F-- >0;)Te.push(0);break;case 18:for(F=11+de(N,C),C+=7;F-- >0;)Te.push(0);break;default:Te.push(ge),H<ge&&(H=ge);break}var Ye=Te.slice(0,S),Je=Te.slice(S);for(fe=S;fe<286;++fe)Ye[fe]=0;for(fe=_;fe<30;++fe)Je[fe]=0;return ud=Hi(Ye,ld,286),dd=Hi(Je,od,30),C}function i1(N,C){if(N[0]==3&&!(N[1]&3))return[ps(C),2];for(var S=0,_=0,A=Gf(C||1<<18),F=0,V=A.length>>>0,Z=0,H=0;!(_&1);){if(_=pe(N,S),S+=3,_>>>1)_>>1==1?(Z=9,H=5):(S=a1(N,S),Z=ud,H=dd);else{S&7&&(S+=8-(S&7));var X=N[S>>>3]|N[(S>>>3)+1]<<8;if(S+=32,X>0)for(!C&&V<F+X&&(A=Wo(A,F+X),V=A.length);X-- >0;)A[F++]=N[S>>>3],S+=8;continue}for(;;){!C&&V<F+32767&&(A=Wo(A,F+32767),V=A.length);var Y=xt(N,S,Z),ae=_>>>1==1?Ho[Y]:ld[Y];if(S+=ae&15,ae>>>=4,!(ae>>>8&255))A[F++]=ae;else{if(ae==256)break;ae-=257;var fe=ae<8?0:ae-4>>2;fe>5&&(fe=0);var ge=F+ee[ae];fe>0&&(ge+=xt(N,S,fe),S+=fe),Y=xt(N,S,H),ae=_>>>1==1?Vo[Y]:od[Y],S+=ae&15,ae>>>=4;var le=ae<4?0:ae-2>>1,me=he[ae];for(le>0&&(me+=xt(N,S,le),S+=le),!C&&V<ge&&(A=Wo(A,ge+100),V=A.length);F<ge;)A[F]=A[F-me],++F}}}return C?[A,S+7>>>3]:[A.slice(0,F),S+7>>>3]}function fd(N,C){var S=N.slice(N.l||0),_=i1(S,C);return N.l+=_[1],_[0]}function hd(N,C){if(N)typeof console<"u"&&console.error(C);else throw new Error(C)}function xd(N,C){var S=N;rr(S,0);var _=[],A=[],F={FileIndex:_,FullPaths:A};j(F,{root:C.root});for(var V=S.length-4;(S[V]!=80||S[V+1]!=75||S[V+2]!=5||S[V+3]!=6)&&V>=0;)--V;S.l=V+4,S.l+=4;var Z=S.read_shift(2);S.l+=6;var H=S.read_shift(4);for(S.l=H,V=0;V<Z;++V){S.l+=20;var X=S.read_shift(4),Y=S.read_shift(4),ae=S.read_shift(2),fe=S.read_shift(2),ge=S.read_shift(2);S.l+=8;var le=S.read_shift(4),me=o(S.slice(S.l+ae,S.l+ae+fe));S.l+=ae+fe+ge;var Te=S.l;S.l=le+4,l1(S,X,Y,F,me),S.l=Te}return F}function l1(N,C,S,_,A){N.l+=2;var F=N.read_shift(2),V=N.read_shift(2),Z=l(N);if(F&8257)throw new Error("Unsupported ZIP encryption");for(var H=N.read_shift(4),X=N.read_shift(4),Y=N.read_shift(4),ae=N.read_shift(2),fe=N.read_shift(2),ge="",le=0;le<ae;++le)ge+=String.fromCharCode(N[N.l++]);if(fe){var me=o(N.slice(N.l,N.l+fe));(me[21589]||{}).mt&&(Z=me[21589].mt),((A||{})[21589]||{}).mt&&(Z=A[21589].mt)}N.l+=fe;var Te=N.slice(N.l,N.l+X);switch(V){case 8:Te=B(N,Y);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+V)}var Ye=!1;F&8&&(H=N.read_shift(4),H==134695760&&(H=N.read_shift(4),Ye=!0),X=N.read_shift(4),Y=N.read_shift(4)),X!=C&&hd(Ye,"Bad compressed size: "+C+" != "+X),Y!=S&&hd(Ye,"Bad uncompressed size: "+S+" != "+Y),Go(_,ge,Te,{unsafe:!0,mt:Z})}function o1(N,C){var S=C||{},_=[],A=[],F=Q(1),V=S.compression?8:0,Z=0,H=0,X=0,Y=0,ae=0,fe=N.FullPaths[0],ge=fe,le=N.FileIndex[0],me=[],Te=0;for(H=1;H<N.FullPaths.length;++H)if(ge=N.FullPaths[H].slice(fe.length),le=N.FileIndex[H],!(!le.size||!le.content||ge=="Sh33tJ5")){var Ye=Y,Je=Q(ge.length);for(X=0;X<ge.length;++X)Je.write_shift(1,ge.charCodeAt(X)&127);Je=Je.slice(0,Je.l),me[ae]=wN.buf(le.content,0);var At=le.content;V==8&&(At=L(At)),F=Q(30),F.write_shift(4,67324752),F.write_shift(2,20),F.write_shift(2,Z),F.write_shift(2,V),le.mt?i(F,le.mt):F.write_shift(4,0),F.write_shift(-4,me[ae]),F.write_shift(4,At.length),F.write_shift(4,le.content.length),F.write_shift(2,Je.length),F.write_shift(2,0),Y+=F.length,_.push(F),Y+=Je.length,_.push(Je),Y+=At.length,_.push(At),F=Q(46),F.write_shift(4,33639248),F.write_shift(2,0),F.write_shift(2,20),F.write_shift(2,Z),F.write_shift(2,V),F.write_shift(4,0),F.write_shift(-4,me[ae]),F.write_shift(4,At.length),F.write_shift(4,le.content.length),F.write_shift(2,Je.length),F.write_shift(2,0),F.write_shift(2,0),F.write_shift(2,0),F.write_shift(2,0),F.write_shift(4,0),F.write_shift(4,Ye),Te+=F.l,A.push(F),Te+=Je.length,A.push(Je),++ae}return F=Q(22),F.write_shift(4,101010256),F.write_shift(2,0),F.write_shift(2,0),F.write_shift(2,ae),F.write_shift(2,ae),F.write_shift(4,Te),F.write_shift(4,Y),F.write_shift(2,0),St([St(_),St(A),F])}var Vi={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function c1(N,C){if(N.ctype)return N.ctype;var S=N.name||"",_=S.match(/\.([^\.]+)$/);return _&&Vi[_[1]]||C&&(_=(S=C).match(/[\.\\]([^\.\\])+$/),_&&Vi[_[1]])?Vi[_[1]]:"application/octet-stream"}function u1(N){for(var C=_i(N),S=[],_=0;_<C.length;_+=76)S.push(C.slice(_,_+76));return S.join(`\r
`)+`\r
`}function d1(N){var C=N.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(X){var Y=X.charCodeAt(0).toString(16).toUpperCase();return"="+(Y.length==1?"0"+Y:Y)});C=C.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),C.charAt(0)==`
`&&(C="=0D"+C.slice(1)),C=C.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var S=[],_=C.split(`\r
`),A=0;A<_.length;++A){var F=_[A];if(F.length==0){S.push("");continue}for(var V=0;V<F.length;){var Z=76,H=F.slice(V,V+Z);H.charAt(Z-1)=="="?Z--:H.charAt(Z-2)=="="?Z-=2:H.charAt(Z-3)=="="&&(Z-=3),H=F.slice(V,V+Z),V+=Z,V<F.length&&(H+="="),S.push(H)}}return S.join(`\r
`)}function f1(N){for(var C=[],S=0;S<N.length;++S){for(var _=N[S];S<=N.length&&_.charAt(_.length-1)=="=";)_=_.slice(0,_.length-1)+N[++S];C.push(_)}for(var A=0;A<C.length;++A)C[A]=C[A].replace(/[=][0-9A-Fa-f]{2}/g,function(F){return String.fromCharCode(parseInt(F.slice(1),16))});return Ar(C.join(`\r
`))}function h1(N,C,S){for(var _="",A="",F="",V,Z=0;Z<10;++Z){var H=C[Z];if(!H||H.match(/^\s*$/))break;var X=H.match(/^(.*?):\s*([^\s].*)$/);if(X)switch(X[1].toLowerCase()){case"content-location":_=X[2].trim();break;case"content-type":F=X[2].trim();break;case"content-transfer-encoding":A=X[2].trim();break}}switch(++Z,A.toLowerCase()){case"base64":V=Ar(fn(C.slice(Z).join("")));break;case"quoted-printable":V=f1(C.slice(Z));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+A)}var Y=Go(N,_.slice(S.length),V,{unsafe:!0});F&&(Y.ctype=F)}function x1(N,C){if(k(N.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var S=C&&C.root||"",_=(Re&&Buffer.isBuffer(N)?N.toString("binary"):k(N)).split(`\r
`),A=0,F="";for(A=0;A<_.length;++A)if(F=_[A],!!/^Content-Location:/i.test(F)&&(F=F.slice(F.indexOf("file")),S||(S=F.slice(0,F.lastIndexOf("/")+1)),F.slice(0,S.length)!=S))for(;S.length>0&&(S=S.slice(0,S.length-1),S=S.slice(0,S.lastIndexOf("/")+1),F.slice(0,S.length)!=S););var V=(_[1]||"").match(/boundary="(.*?)"/);if(!V)throw new Error("MAD cannot find boundary");var Z="--"+(V[1]||""),H=[],X=[],Y={FileIndex:H,FullPaths:X};j(Y);var ae,fe=0;for(A=0;A<_.length;++A){var ge=_[A];ge!==Z&&ge!==Z+"--"||(fe++&&h1(Y,_.slice(ae,A),S),ae=A)}return Y}function m1(N,C){var S=C||{},_=S.boundary||"SheetJS";_="------="+_;for(var A=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+_.slice(2)+'"',"","",""],F=N.FullPaths[0],V=F,Z=N.FileIndex[0],H=1;H<N.FullPaths.length;++H)if(V=N.FullPaths[H].slice(F.length),Z=N.FileIndex[H],!(!Z.size||!Z.content||V=="Sh33tJ5")){V=V.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Te){return"_x"+Te.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Te){return"_u"+Te.charCodeAt(0).toString(16)+"_"});for(var X=Z.content,Y=Re&&Buffer.isBuffer(X)?X.toString("binary"):k(X),ae=0,fe=Math.min(1024,Y.length),ge=0,le=0;le<=fe;++le)(ge=Y.charCodeAt(le))>=32&&ge<128&&++ae;var me=ae>=fe*4/5;A.push(_),A.push("Content-Location: "+(S.root||"file:///C:/SheetJS/")+V),A.push("Content-Transfer-Encoding: "+(me?"quoted-printable":"base64")),A.push("Content-Type: "+c1(Z,V)),A.push(""),A.push(me?d1(Y):u1(Y))}return A.push(_+`--\r
`),A.join(`\r
`)}function p1(N){var C={};return j(C,N),C}function Go(N,C,S,_){var A=_&&_.unsafe;A||j(N);var F=!A&&Ue.find(N,C);if(!F){var V=N.FullPaths[0];C.slice(0,V.length)==V?V=C:(V.slice(-1)!="/"&&(V+="/"),V=(V+C).replace("//","/")),F={name:a(C),type:2},N.FileIndex.push(F),N.FullPaths.push(V),A||Ue.utils.cfb_gc(N)}return F.content=S,F.size=S?S.length:0,_&&(_.CLSID&&(F.clsid=_.CLSID),_.mt&&(F.mt=_.mt),_.ct&&(F.ct=_.ct)),F}function g1(N,C){j(N);var S=Ue.find(N,C);if(S){for(var _=0;_<N.FileIndex.length;++_)if(N.FileIndex[_]==S)return N.FileIndex.splice(_,1),N.FullPaths.splice(_,1),!0}return!1}function y1(N,C,S){j(N);var _=Ue.find(N,C);if(_){for(var A=0;A<N.FileIndex.length;++A)if(N.FileIndex[A]==_)return N.FileIndex[A].name=a(S),N.FullPaths[A]=S,!0}return!1}function v1(N){R(N,!0)}return t.find=D,t.read=M,t.parse=u,t.write=K,t.writeFile=W,t.utils={cfb_new:p1,cfb_add:Go,cfb_del:g1,cfb_mov:y1,cfb_gc:v1,ReadShift:ei,CheckField:rg,prep_blob:rr,bconcat:St,use_zlib:E,_deflateRaw:id,_inflateRaw:fd,consts:q},t}();function bN(e){return typeof e=="string"?Io(e):Array.isArray(e)?Xb(e):e}function Bi(e,t,r){if(typeof Deno<"u"){if(r&&typeof t=="string")switch(r){case"utf8":t=new TextEncoder(r).encode(t);break;case"binary":t=Io(t);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(e,t)}var n=r=="utf8"?Ti(t):t;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,e);if(typeof Blob<"u"){var a=new Blob([bN(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(a,e);if(typeof saveAs<"u")return saveAs(a,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var i=URL.createObjectURL(a);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),chrome.downloads.download({url:i,filename:e,saveAs:!0});var l=document.createElement("a");if(l.download!=null)return l.download=e,l.href=i,document.body.appendChild(l),l.click(),document.body.removeChild(l),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),i}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var o=File(e);return o.open("w"),o.encoding="binary",Array.isArray(t)&&(t=Mi(t)),o.write(t),o.close(),t}catch(c){if(!c.message||!c.message.match(/onstruct/))throw c}throw new Error("cannot save file "+e)}function Ct(e){for(var t=Object.keys(e),r=[],n=0;n<t.length;++n)Object.prototype.hasOwnProperty.call(e,t[n])&&r.push(t[n]);return r}function eh(e,t){for(var r=[],n=Ct(e),a=0;a!==n.length;++a)r[e[n[a]][t]]==null&&(r[e[n[a]][t]]=n[a]);return r}function U0(e){for(var t=[],r=Ct(e),n=0;n!==r.length;++n)t[e[r[n]]]=r[n];return t}function Mo(e){for(var t=[],r=Ct(e),n=0;n!==r.length;++n)t[e[r[n]]]=parseInt(r[n],10);return t}function NN(e){for(var t=[],r=Ct(e),n=0;n!==r.length;++n)t[e[r[n]]]==null&&(t[e[r[n]]]=[]),t[e[r[n]]].push(r[n]);return t}var io=new Date(1899,11,30,0,0,0);function qt(e,t){var r=e.getTime(),n=io.getTime()+(e.getTimezoneOffset()-io.getTimezoneOffset())*6e4;return(r-n)/(24*60*60*1e3)}var Bp=new Date,jN=io.getTime()+(Bp.getTimezoneOffset()-io.getTimezoneOffset())*6e4,th=Bp.getTimezoneOffset();function Up(e){var t=new Date;return t.setTime(e*24*60*60*1e3+jN),t.getTimezoneOffset()!==th&&t.setTime(t.getTime()+(t.getTimezoneOffset()-th)*6e4),t}var rh=new Date("2017-02-19T19:06:09.000Z"),zp=isNaN(rh.getFullYear())?new Date("2/19/17"):rh,SN=zp.getFullYear()==2017;function zt(e,t){var r=new Date(e);if(SN)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(zp.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return e.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var a=e.match(/\d+/g)||["2017","2","19","0","0","0"],i=new Date(+a[0],+a[1]-1,+a[2],+a[3]||0,+a[4]||0,+a[5]||0);return e.indexOf("Z")>-1&&(i=new Date(i.getTime()-i.getTimezoneOffset()*60*1e3)),i}function Bo(e,t){if(Re&&Buffer.isBuffer(e))return e.toString("binary");if(typeof TextDecoder<"u")try{var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(i){return r[i]||i})}catch{}for(var n=[],a=0;a!=e.length;++a)n.push(String.fromCharCode(e[a]));return n.join("")}function Qt(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=Qt(e[r]));return t}function rt(e,t){for(var r="";r.length<t;)r+=e;return r}function an(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(n))||(n=n.replace(/[(](.*)[)]/,function(a,i){return r=-r,i}),!isNaN(t=Number(n)))?t/r:t}var _N=["january","february","march","april","may","june","july","august","september","october","november","december"];function Ei(e){var t=new Date(e),r=new Date(NaN),n=t.getYear(),a=t.getMonth(),i=t.getDate();if(isNaN(i))return r;var l=e.toLowerCase();if(l.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(l=l.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),l.length>3&&_N.indexOf(l)==-1)return r}else if(l.match(/[a-z]/))return r;return n<0||n>8099?r:(a>0||i>1)&&n!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}function Ce(e,t,r){if(e.FullPaths){if(typeof r=="string"){var n;return Re?n=gn(r):n=Kb(r),Ue.utils.cfb_add(e,t,n)}Ue.utils.cfb_add(e,t,r)}else e.file(t,r)}function z0(){return Ue.utils.cfb_new()}var ut=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,EN={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},$0=U0(EN),W0=/[&<>'"]/g,TN=/[\u0000-\u0008\u000b-\u001f]/g;function Le(e){var t=e+"";return t.replace(W0,function(r){return $0[r]}).replace(TN,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function nh(e){return Le(e).replace(/ /g,"_x0020_")}var $p=/[\u0000-\u001f]/g;function kN(e){var t=e+"";return t.replace(W0,function(r){return $0[r]}).replace(/\n/g,"<br/>").replace($p,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function CN(e){var t=e+"";return t.replace(W0,function(r){return $0[r]}).replace($p,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}function AN(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function FN(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function _c(e){for(var t="",r=0,n=0,a=0,i=0,l=0,o=0;r<e.length;){if(n=e.charCodeAt(r++),n<128){t+=String.fromCharCode(n);continue}if(a=e.charCodeAt(r++),n>191&&n<224){l=(n&31)<<6,l|=a&63,t+=String.fromCharCode(l);continue}if(i=e.charCodeAt(r++),n<240){t+=String.fromCharCode((n&15)<<12|(a&63)<<6|i&63);continue}l=e.charCodeAt(r++),o=((n&7)<<18|(a&63)<<12|(i&63)<<6|l&63)-65536,t+=String.fromCharCode(55296+(o>>>10&1023)),t+=String.fromCharCode(56320+(o&1023))}return t}function sh(e){var t=ps(2*e.length),r,n,a=1,i=0,l=0,o;for(n=0;n<e.length;n+=a)a=1,(o=e.charCodeAt(n))<128?r=o:o<224?(r=(o&31)*64+(e.charCodeAt(n+1)&63),a=2):o<240?(r=(o&15)*4096+(e.charCodeAt(n+1)&63)*64+(e.charCodeAt(n+2)&63),a=3):(a=4,r=(o&7)*262144+(e.charCodeAt(n+1)&63)*4096+(e.charCodeAt(n+2)&63)*64+(e.charCodeAt(n+3)&63),r-=65536,l=55296+(r>>>10&1023),r=56320+(r&1023)),l!==0&&(t[i++]=l&255,t[i++]=l>>>8,l=0),t[i++]=r%256,t[i++]=r>>>8;return t.slice(0,i).toString("ucs2")}function ah(e){return gn(e,"binary").toString("utf8")}var fl="foo bar baz",Za=Re&&(ah(fl)==_c(fl)&&ah||sh(fl)==_c(fl)&&sh)||_c,Ti=Re?function(e){return gn(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,n=0,a=0;r<e.length;)switch(n=e.charCodeAt(r++),!0){case n<128:t.push(String.fromCharCode(n));break;case n<2048:t.push(String.fromCharCode(192+(n>>6))),t.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,a=e.charCodeAt(r++)-56320+(n<<10),t.push(String.fromCharCode(240+(a>>18&7))),t.push(String.fromCharCode(144+(a>>12&63))),t.push(String.fromCharCode(128+(a>>6&63))),t.push(String.fromCharCode(128+(a&63)));break;default:t.push(String.fromCharCode(224+(n>>12))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)))}return t.join("")},PN=function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),a=0;a<e.length;++a)n=n.replace(e[a][0],e[a][1]);return n}}(),Wp=/(^\s|\s$|\n)/;function _t(e,t){return"<"+e+(t.match(Wp)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function ki(e){return Ct(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function oe(e,t,r){return"<"+e+(r!=null?ki(r):"")+(t!=null?(t.match(Wp)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function Du(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(r){if(t)throw r}return""}function ON(e,t){switch(typeof e){case"string":var r=oe("vt:lpwstr",Le(e));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return oe((e|0)==e?"vt:i4":"vt:r8",Le(String(e)));case"boolean":return oe("vt:bool",e?"true":"false")}if(e instanceof Date)return oe("vt:filetime",Du(e));throw new Error("Unable to serialize "+e)}var pt={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},va=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],nr={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function RN(e,t){for(var r=1-2*(e[t+7]>>>7),n=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),a=e[t+6]&15,i=5;i>=0;--i)a=a*256+e[t+i];return n==2047?a==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,a+=Math.pow(2,52)),r*Math.pow(2,n-52)*a)}function IN(e,t,r){var n=(t<0||1/t==-1/0?1:0)<<7,a=0,i=0,l=n?-t:t;isFinite(l)?l==0?a=i=0:(a=Math.floor(Math.log(l)/Math.LN2),i=l*Math.pow(2,52-a),a<=-1023&&(!isFinite(i)||i<Math.pow(2,52))?a=-1022:(i-=Math.pow(2,52),a+=1023)):(a=2047,i=isNaN(t)?26985:0);for(var o=0;o<=5;++o,i/=256)e[r+o]=i&255;e[r+6]=(a&15)<<4|i&15,e[r+7]=a>>4|n}var ih=function(e){for(var t=[],r=10240,n=0;n<e[0].length;++n)if(e[0][n])for(var a=0,i=e[0][n].length;a<i;a+=r)t.push.apply(t,e[0][n].slice(a,a+r));return t},lh=Re?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:gn(t)})):ih(e)}:ih,oh=function(e,t,r){for(var n=[],a=t;a<r;a+=2)n.push(String.fromCharCode($a(e,a)));return n.join("").replace(Qa,"")},H0=Re?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(Qa,""):oh(e,t,r)}:oh,ch=function(e,t,r){for(var n=[],a=t;a<t+r;++a)n.push(("0"+e[a].toString(16)).slice(-2));return n.join("")},Hp=Re?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):ch(e,t,r)}:ch,uh=function(e,t,r){for(var n=[],a=t;a<r;a++)n.push(String.fromCharCode(Fs(e,a)));return n.join("")},Ui=Re?function(t,r,n){return Buffer.isBuffer(t)?t.toString("utf8",r,n):uh(t,r,n)}:uh,Vp=function(e,t){var r=sr(e,t);return r>0?Ui(e,t+4,t+4+r-1):""},Gp=Vp,Xp=function(e,t){var r=sr(e,t);return r>0?Ui(e,t+4,t+4+r-1):""},Kp=Xp,Yp=function(e,t){var r=2*sr(e,t);return r>0?Ui(e,t+4,t+4+r-1):""},Jp=Yp,qp=function(t,r){var n=sr(t,r);return n>0?H0(t,r+4,r+4+n):""},Qp=qp,Zp=function(e,t){var r=sr(e,t);return r>0?Ui(e,t+4,t+4+r):""},eg=Zp,tg=function(e,t){return RN(e,t)},lo=tg,V0=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};Re&&(Gp=function(t,r){if(!Buffer.isBuffer(t))return Vp(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},Kp=function(t,r){if(!Buffer.isBuffer(t))return Xp(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},Jp=function(t,r){if(!Buffer.isBuffer(t))return Yp(t,r);var n=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n-1)},Qp=function(t,r){if(!Buffer.isBuffer(t))return qp(t,r);var n=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n)},eg=function(t,r){if(!Buffer.isBuffer(t))return Zp(t,r);var n=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+n)},lo=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):tg(t,r)},V0=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var Fs=function(e,t){return e[t]},$a=function(e,t){return e[t+1]*256+e[t]},DN=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},sr=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},ss=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},LN=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function ei(e,t){var r="",n,a,i=[],l,o,c,d;switch(t){case"dbcs":if(d=this.l,Re&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(c=0;c<e;++c)r+=String.fromCharCode($a(this,d)),d+=2;e*=2;break;case"utf8":r=Ui(this,this.l,this.l+e);break;case"utf16le":e*=2,r=H0(this,this.l,this.l+e);break;case"wstr":return ei.call(this,e,"dbcs");case"lpstr-ansi":r=Gp(this,this.l),e=4+sr(this,this.l);break;case"lpstr-cp":r=Kp(this,this.l),e=4+sr(this,this.l);break;case"lpwstr":r=Jp(this,this.l),e=4+2*sr(this,this.l);break;case"lpp4":e=4+sr(this,this.l),r=Qp(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+sr(this,this.l),r=eg(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(l=Fs(this,this.l+e++))!==0;)i.push(cl(l));r=i.join("");break;case"_wstr":for(e=0,r="";(l=$a(this,this.l+e))!==0;)i.push(cl(l)),e+=2;e+=2,r=i.join("");break;case"dbcs-cont":for(r="",d=this.l,c=0;c<e;++c){if(this.lens&&this.lens.indexOf(d)!==-1)return l=Fs(this,d),this.l=d+1,o=ei.call(this,e-c,l?"dbcs-cont":"sbcs-cont"),i.join("")+o;i.push(cl($a(this,d))),d+=2}r=i.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",d=this.l,c=0;c!=e;++c){if(this.lens&&this.lens.indexOf(d)!==-1)return l=Fs(this,d),this.l=d+1,o=ei.call(this,e-c,l?"dbcs-cont":"sbcs-cont"),i.join("")+o;i.push(cl(Fs(this,d))),d+=1}r=i.join("");break;default:switch(e){case 1:return n=Fs(this,this.l),this.l++,n;case 2:return n=(t==="i"?DN:$a)(this,this.l),this.l+=2,n;case 4:case-4:return t==="i"||!(this[this.l+3]&128)?(n=(e>0?ss:LN)(this,this.l),this.l+=4,n):(a=sr(this,this.l),this.l+=4,a);case 8:case-8:if(t==="f")return e==8?a=lo(this,this.l):a=lo([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,a;e=8;case 16:r=Hp(this,this.l,e);break}}return this.l+=e,r}var MN=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},BN=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},UN=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function zN(e,t,r){var n=0,a=0;if(r==="dbcs"){for(a=0;a!=t.length;++a)UN(this,t.charCodeAt(a),this.l+2*a);n=2*t.length}else if(r==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),a=0;a!=t.length;++a)this[this.l+a]=t.charCodeAt(a)&255;n=t.length}else if(r==="hex"){for(;a<e;++a)this[this.l++]=parseInt(t.slice(2*a,2*a+2),16)||0;return this}else if(r==="utf16le"){var i=Math.min(this.l+e,this.length);for(a=0;a<Math.min(t.length,e);++a){var l=t.charCodeAt(a);this[this.l++]=l&255,this[this.l++]=l>>8}for(;this.l<i;)this[this.l++]=0;return this}else switch(e){case 1:n=1,this[this.l]=t&255;break;case 2:n=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:n=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:n=4,MN(this,t,this.l);break;case 8:if(n=8,r==="f"){IN(this,t,this.l);break}case 16:break;case-4:n=4,BN(this,t,this.l);break}return this.l+=n,this}function rg(e,t){var r=Hp(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function rr(e,t){e.l=t,e.read_shift=ei,e.chk=rg,e.write_shift=zN}function Vr(e,t){e.l+=t}function Q(e){var t=ps(e);return rr(t,0),t}function Jt(){var e=[],t=Re?256:2048,r=function(d){var u=Q(d);return rr(u,0),u},n=r(t),a=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&e.push(n),n=null)},i=function(d){return n&&d<n.length-n.l?n:(a(),n=r(Math.max(d+1,t)))},l=function(){return a(),St(e)},o=function(d){a(),n=d,n.l==null&&(n.l=n.length),i(t)};return{next:i,push:o,end:l,_bufs:e}}function re(e,t,r,n){var a=+t,i;if(!isNaN(a)){n||(n=RE[a].p||(r||[]).length||0),i=1+(a>=128?1:0)+1,n>=128&&++i,n>=16384&&++i,n>=2097152&&++i;var l=e.next(i);a<=127?l.write_shift(1,a):(l.write_shift(1,(a&127)+128),l.write_shift(1,a>>7));for(var o=0;o!=4;++o)if(n>=128)l.write_shift(1,(n&127)+128),n>>=7;else{l.write_shift(1,n);break}n>0&&V0(r)&&e.push(r)}}function ti(e,t,r){var n=Qt(e);if(t.s?(n.cRel&&(n.c+=t.s.c),n.rRel&&(n.r+=t.s.r)):(n.cRel&&(n.c+=t.c),n.rRel&&(n.r+=t.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function dh(e,t,r){var n=Qt(e);return n.s=ti(n.s,t.s,r),n.e=ti(n.e,t.s,r),n}function ri(e,t){if(e.cRel&&e.c<0)for(e=Qt(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=Qt(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=Be(e);return!e.cRel&&e.cRel!=null&&(r=HN(r)),!e.rRel&&e.rRel!=null&&(r=$N(r)),r}function Ec(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+Rt(e.s.c)+":"+(e.e.cRel?"":"$")+Rt(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+Tt(e.s.r)+":"+(e.e.rRel?"":"$")+Tt(e.e.r):ri(e.s,t.biff)+":"+ri(e.e,t.biff)}function G0(e){return parseInt(WN(e),10)-1}function Tt(e){return""+(e+1)}function $N(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function WN(e){return e.replace(/\$(\d+)$/,"$1")}function X0(e){for(var t=VN(e),r=0,n=0;n!==t.length;++n)r=26*r+t.charCodeAt(n)-64;return r-1}function Rt(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function HN(e){return e.replace(/^([A-Z])/,"$$$1")}function VN(e){return e.replace(/^\$([A-Z])/,"$1")}function GN(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function gt(e){for(var t=0,r=0,n=0;n<e.length;++n){var a=e.charCodeAt(n);a>=48&&a<=57?t=10*t+(a-48):a>=65&&a<=90&&(r=26*r+(a-64))}return{c:r-1,r:t-1}}function Be(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function cr(e){var t=e.indexOf(":");return t==-1?{s:gt(e),e:gt(e)}:{s:gt(e.slice(0,t)),e:gt(e.slice(t+1))}}function ct(e,t){return typeof t>"u"||typeof t=="number"?ct(e.s,e.e):(typeof e!="string"&&(e=Be(e)),typeof t!="string"&&(t=Be(t)),e==t?e:e+":"+t)}function Xe(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,a=0,i=e.length;for(r=0;n<i&&!((a=e.charCodeAt(n)-64)<1||a>26);++n)r=26*r+a;for(t.s.c=--r,r=0;n<i&&!((a=e.charCodeAt(n)-48)<0||a>9);++n)r=10*r+a;if(t.s.r=--r,n===i||a!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++n,r=0;n!=i&&!((a=e.charCodeAt(n)-64)<1||a>26);++n)r=26*r+a;for(t.e.c=--r,r=0;n!=i&&!((a=e.charCodeAt(n)-48)<0||a>9);++n)r=10*r+a;return t.e.r=--r,t}function fh(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=Hn(e.z,r?qt(t):t)}catch{}try{return e.w=Hn((e.XF||{}).numFmtId||(r?14:0),r?qt(t):t)}catch{return""+t}}function hn(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?zi[e.v]||e.v:t==null?fh(e,e.v):fh(e,t))}function Ns(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",n={};return n[r]=e,{SheetNames:[r],Sheets:n}}function ng(e,t,r){var n=r||{},a=e?Array.isArray(e):n.dense,i=e||(a?[]:{}),l=0,o=0;if(i&&n.origin!=null){if(typeof n.origin=="number")l=n.origin;else{var c=typeof n.origin=="string"?gt(n.origin):n.origin;l=c.r,o=c.c}i["!ref"]||(i["!ref"]="A1:A1")}var d={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(i["!ref"]){var u=Xe(i["!ref"]);d.s.c=u.s.c,d.s.r=u.s.r,d.e.c=Math.max(d.e.c,u.e.c),d.e.r=Math.max(d.e.r,u.e.r),l==-1&&(d.e.r=l=u.e.r+1)}for(var f=0;f!=t.length;++f)if(t[f]){if(!Array.isArray(t[f]))throw new Error("aoa_to_sheet expects an array of arrays");for(var h=0;h!=t[f].length;++h)if(!(typeof t[f][h]>"u")){var m={v:t[f][h]},v=l+f,x=o+h;if(d.s.r>v&&(d.s.r=v),d.s.c>x&&(d.s.c=x),d.e.r<v&&(d.e.r=v),d.e.c<x&&(d.e.c=x),t[f][h]&&typeof t[f][h]=="object"&&!Array.isArray(t[f][h])&&!(t[f][h]instanceof Date))m=t[f][h];else if(Array.isArray(m.v)&&(m.f=t[f][h][1],m.v=m.v[0]),m.v===null)if(m.f)m.t="n";else if(n.nullError)m.t="e",m.v=0;else if(n.sheetStubs)m.t="z";else continue;else typeof m.v=="number"?m.t="n":typeof m.v=="boolean"?m.t="b":m.v instanceof Date?(m.z=n.dateNF||nt[14],n.cellDates?(m.t="d",m.w=Hn(m.z,qt(m.v))):(m.t="n",m.v=qt(m.v),m.w=Hn(m.z,m.v))):m.t="s";if(a)i[v]||(i[v]=[]),i[v][x]&&i[v][x].z&&(m.z=i[v][x].z),i[v][x]=m;else{var y=Be({c:x,r:v});i[y]&&i[y].z&&(m.z=i[y].z),i[y]=m}}}return d.s.c<1e7&&(i["!ref"]=ct(d)),i}function wa(e,t){return ng(null,e,t)}function XN(e){return e.read_shift(4,"i")}function Rr(e,t){return t||(t=Q(4)),t.write_shift(4,e),t}function It(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function yt(e,t){var r=!1;return t==null&&(r=!0,t=Q(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}function KN(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function YN(e,t){return t||(t=Q(4)),t.write_shift(2,0),t.write_shift(2,0),t}function K0(e,t){var r=e.l,n=e.read_shift(1),a=It(e),i=[],l={t:a,h:a};if(n&1){for(var o=e.read_shift(4),c=0;c!=o;++c)i.push(KN(e));l.r=i}else l.r=[{ich:0,ifnt:0}];return e.l=r+t,l}function JN(e,t){var r=!1;return t==null&&(r=!0,t=Q(15+4*e.t.length)),t.write_shift(1,0),yt(e.t,t),r?t.slice(0,t.l):t}var qN=K0;function QN(e,t){var r=!1;return t==null&&(r=!0,t=Q(23+4*e.t.length)),t.write_shift(1,1),yt(e.t,t),t.write_shift(4,1),YN({},t),r?t.slice(0,t.l):t}function jr(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function js(e,t){return t==null&&(t=Q(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function Ss(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function _s(e,t){return t==null&&(t=Q(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}var ZN=It,sg=yt;function Y0(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}function oo(e,t){var r=!1;return t==null&&(r=!0,t=Q(127)),t.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}var ej=It,Lu=Y0,J0=oo;function ag(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,n=t[0]&2;e.l+=4;var a=n===0?lo([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):ss(t,0)>>2;return r?a/100:a}function ig(e,t){t==null&&(t=Q(4));var r=0,n=0,a=e*100;if(e==(e|0)&&e>=-536870912&&e<1<<29?n=1:a==(a|0)&&a>=-536870912&&a<1<<29&&(n=1,r=1),n)t.write_shift(-4,((r?a:e)<<2)+(r+2));else throw new Error("unsupported RkNumber "+e)}function lg(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}function tj(e,t){return t||(t=Q(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t}var Es=lg,ba=tj;function Na(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function gs(e,t){return(t||Q(8)).write_shift(8,e,"f")}function rj(e){var t={},r=e.read_shift(1),n=r>>>1,a=e.read_shift(1),i=e.read_shift(2,"i"),l=e.read_shift(1),o=e.read_shift(1),c=e.read_shift(1);switch(e.l++,n){case 0:t.auto=1;break;case 1:t.index=a;var d=dj[a];d&&(t.rgb=jh(d));break;case 2:t.rgb=jh([l,o,c]);break;case 3:t.theme=a;break}return i!=0&&(t.tint=i>0?i/32767:i/32768),t}function co(e,t){if(t||(t=Q(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;e.index!=null?(t.write_shift(1,2),t.write_shift(1,e.index)):e.theme!=null?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var r=e.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),t.write_shift(2,r),!e.rgb||e.theme!=null)t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);else{var n=e.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),t.write_shift(1,parseInt(n.slice(0,2),16)),t.write_shift(1,parseInt(n.slice(2,4),16)),t.write_shift(1,parseInt(n.slice(4,6),16)),t.write_shift(1,255)}return t}function nj(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function sj(e,t){t||(t=Q(2));var r=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return t.write_shift(1,r),t.write_shift(1,0),t}var og=2,er=3,hl=11,uo=19,xl=64,aj=65,ij=71,lj=4108,oj=4126,jt=80,hh={1:{n:"CodePage",t:og},2:{n:"Category",t:jt},3:{n:"PresentationFormat",t:jt},4:{n:"ByteCount",t:er},5:{n:"LineCount",t:er},6:{n:"ParagraphCount",t:er},7:{n:"SlideCount",t:er},8:{n:"NoteCount",t:er},9:{n:"HiddenCount",t:er},10:{n:"MultimediaClipCount",t:er},11:{n:"ScaleCrop",t:hl},12:{n:"HeadingPairs",t:lj},13:{n:"TitlesOfParts",t:oj},14:{n:"Manager",t:jt},15:{n:"Company",t:jt},16:{n:"LinksUpToDate",t:hl},17:{n:"CharacterCount",t:er},19:{n:"SharedDoc",t:hl},22:{n:"HyperlinksChanged",t:hl},23:{n:"AppVersion",t:er,p:"version"},24:{n:"DigSig",t:aj},26:{n:"ContentType",t:jt},27:{n:"ContentStatus",t:jt},28:{n:"Language",t:jt},29:{n:"Version",t:jt},255:{},2147483648:{n:"Locale",t:uo},2147483651:{n:"Behavior",t:uo},1919054434:{}},xh={1:{n:"CodePage",t:og},2:{n:"Title",t:jt},3:{n:"Subject",t:jt},4:{n:"Author",t:jt},5:{n:"Keywords",t:jt},6:{n:"Comments",t:jt},7:{n:"Template",t:jt},8:{n:"LastAuthor",t:jt},9:{n:"RevNumber",t:jt},10:{n:"EditTime",t:xl},11:{n:"LastPrinted",t:xl},12:{n:"CreatedDate",t:xl},13:{n:"ModifiedDate",t:xl},14:{n:"PageCount",t:er},15:{n:"WordCount",t:er},16:{n:"CharCount",t:er},17:{n:"Thumbnail",t:ij},18:{n:"Application",t:jt},19:{n:"DocSecurity",t:er},255:{},2147483648:{n:"Locale",t:uo},2147483651:{n:"Behavior",t:uo},1919054434:{}};function cj(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var uj=cj([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),dj=Qt(uj),zi={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},fj={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},ml={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function cg(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function ug(e,t){var r=NN(fj),n=[],a;n[n.length]=ut,n[n.length]=oe("Types",null,{xmlns:pt.CT,"xmlns:xsd":pt.xsd,"xmlns:xsi":pt.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(c){return oe("Default",null,{Extension:c[0],ContentType:c[1]})}));var i=function(c){e[c]&&e[c].length>0&&(a=e[c][0],n[n.length]=oe("Override",null,{PartName:(a[0]=="/"?"":"/")+a,ContentType:ml[c][t.bookType]||ml[c].xlsx}))},l=function(c){(e[c]||[]).forEach(function(d){n[n.length]=oe("Override",null,{PartName:(d[0]=="/"?"":"/")+d,ContentType:ml[c][t.bookType]||ml[c].xlsx})})},o=function(c){(e[c]||[]).forEach(function(d){n[n.length]=oe("Override",null,{PartName:(d[0]=="/"?"":"/")+d,ContentType:r[c][0]})})};return i("workbooks"),l("sheets"),l("charts"),o("themes"),["strs","styles"].forEach(i),["coreprops","extprops","custprops"].forEach(o),o("vba"),o("comments"),o("threadedcomments"),o("drawings"),l("metadata"),o("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var Oe={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function dg(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function ta(e){var t=[ut,oe("Relationships",null,{xmlns:pt.RELS})];return Ct(e["!id"]).forEach(function(r){t[t.length]=oe("Relationship",null,e["!id"][r])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function De(e,t,r,n,a,i){if(a||(a={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,a.Id="rId"+t,a.Type=n,a.Target=r,[Oe.HLINK,Oe.XPATH,Oe.XMISS].indexOf(a.Type)>-1&&(a.TargetMode="External"),e["!id"][a.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][a.Id]=a,e[("/"+a.Target).replace("//","/")]=a,t}function hj(e){var t=[ut];t.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),t.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<e.length;++r)t.push('  <manifest:file-entry manifest:full-path="'+e[r][0]+'" manifest:media-type="'+e[r][1]+`"/>
`);return t.push("</manifest:manifest>"),t.join("")}function mh(e,t,r){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+t+`"/>
`,`  </rdf:Description>
`].join("")}function xj(e,t){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+`"/>
`,`  </rdf:Description>
`].join("")}function mj(e){var t=[ut];t.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=e.length;++r)t.push(mh(e[r][0],e[r][1])),t.push(xj("",e[r][0]));return t.push(mh("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}function fg(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+to.version+"</meta:generator></office:meta></office:document-meta>"}var us=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]];function Tc(e,t,r,n,a){a[e]!=null||t==null||t===""||(a[e]=t,t=Le(t),n[n.length]=r?oe(e,t,r):_t(e,t))}function hg(e,t){var r=t||{},n=[ut,oe("cp:coreProperties",null,{"xmlns:cp":pt.CORE_PROPS,"xmlns:dc":pt.dc,"xmlns:dcterms":pt.dcterms,"xmlns:dcmitype":pt.dcmitype,"xmlns:xsi":pt.xsi})],a={};if(!e&&!r.Props)return n.join("");e&&(e.CreatedDate!=null&&Tc("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:Du(e.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,a),e.ModifiedDate!=null&&Tc("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:Du(e.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,a));for(var i=0;i!=us.length;++i){var l=us[i],o=r.Props&&r.Props[l[1]]!=null?r.Props[l[1]]:e?e[l[1]]:null;o===!0?o="1":o===!1?o="0":typeof o=="number"&&(o=String(o)),o!=null&&Tc(l[0],o,null,n,a)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var ra=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],xg=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function mg(e){var t=[],r=oe;return e||(e={}),e.Application="SheetJS",t[t.length]=ut,t[t.length]=oe("Properties",null,{xmlns:pt.EXT_PROPS,"xmlns:vt":pt.vt}),ra.forEach(function(n){if(e[n[1]]!==void 0){var a;switch(n[2]){case"string":a=Le(String(e[n[1]]));break;case"bool":a=e[n[1]]?"true":"false";break}a!==void 0&&(t[t.length]=r(n[0],a))}}),t[t.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=r("TitlesOfParts",r("vt:vector",e.SheetNames.map(function(n){return"<vt:lpstr>"+Le(n)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}function pg(e){var t=[ut,oe("Properties",null,{xmlns:pt.CUST_PROPS,"xmlns:vt":pt.vt})];if(!e)return t.join("");var r=1;return Ct(e).forEach(function(a){++r,t[t.length]=oe("property",ON(e[a]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:Le(a)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var ph={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"};function pj(e,t){var r=[];return Ct(ph).map(function(n){for(var a=0;a<us.length;++a)if(us[a][1]==n)return us[a];for(a=0;a<ra.length;++a)if(ra[a][1]==n)return ra[a];throw n}).forEach(function(n){if(e[n[1]]!=null){var a=t&&t.Props&&t.Props[n[1]]!=null?t.Props[n[1]]:e[n[1]];switch(n[2]){case"date":a=new Date(a).toISOString().replace(/\.\d*Z/,"Z");break}typeof a=="number"?a=String(a):a===!0||a===!1?a=a?"1":"0":a instanceof Date&&(a=new Date(a).toISOString().replace(/\.\d*Z/,"")),r.push(_t(ph[n[1]]||n[1],a))}}),oe("DocumentProperties",r.join(""),{xmlns:nr.o})}function gj(e,t){var r=["Worksheets","SheetNames"],n="CustomDocumentProperties",a=[];return e&&Ct(e).forEach(function(i){if(Object.prototype.hasOwnProperty.call(e,i)){for(var l=0;l<us.length;++l)if(i==us[l][1])return;for(l=0;l<ra.length;++l)if(i==ra[l][1])return;for(l=0;l<r.length;++l)if(i==r[l])return;var o=e[i],c="string";typeof o=="number"?(c="float",o=String(o)):o===!0||o===!1?(c="boolean",o=o?"1":"0"):o=String(o),a.push(oe(nh(i),o,{"dt:dt":c}))}}),t&&Ct(t).forEach(function(i){if(Object.prototype.hasOwnProperty.call(t,i)&&!(e&&Object.prototype.hasOwnProperty.call(e,i))){var l=t[i],o="string";typeof l=="number"?(o="float",l=String(l)):l===!0||l===!1?(o="boolean",l=l?"1":"0"):l instanceof Date?(o="dateTime.tz",l=l.toISOString()):l=String(l),a.push(oe(nh(i),l,{"dt:dt":o}))}}),"<"+n+' xmlns="'+nr.o+'">'+a.join("")+"</"+n+">"}function yj(e){var t=typeof e=="string"?new Date(Date.parse(e)):e,r=t.getTime()/1e3+11644473600,n=r%Math.pow(2,32),a=(r-n)/Math.pow(2,32);n*=1e7,a*=1e7;var i=n/Math.pow(2,32)|0;i>0&&(n=n%Math.pow(2,32),a+=i);var l=Q(8);return l.write_shift(4,n),l.write_shift(4,a),l}function gh(e,t){var r=Q(4),n=Q(4);switch(r.write_shift(4,e==80?31:e),e){case 3:n.write_shift(-4,t);break;case 5:n=Q(8),n.write_shift(8,t,"f");break;case 11:n.write_shift(4,t?1:0);break;case 64:n=yj(t);break;case 31:case 80:for(n=Q(4+2*(t.length+1)+(t.length%2?0:2)),n.write_shift(4,t.length+1),n.write_shift(0,t,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return St([r,n])}var gg=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function vj(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function yh(e,t,r){var n=Q(8),a=[],i=[],l=8,o=0,c=Q(8),d=Q(8);if(c.write_shift(4,2),c.write_shift(4,1200),d.write_shift(4,1),i.push(c),a.push(d),l+=8+c.length,!t){d=Q(8),d.write_shift(4,0),a.unshift(d);var u=[Q(4)];for(u[0].write_shift(4,e.length),o=0;o<e.length;++o){var f=e[o][0];for(c=Q(8+2*(f.length+1)+(f.length%2?0:2)),c.write_shift(4,o+2),c.write_shift(4,f.length+1),c.write_shift(0,f,"dbcs");c.l!=c.length;)c.write_shift(1,0);u.push(c)}c=St(u),i.unshift(c),l+=8+c.length}for(o=0;o<e.length;++o)if(!(t&&!t[e[o][0]])&&!(gg.indexOf(e[o][0])>-1||xg.indexOf(e[o][0])>-1)&&e[o][1]!=null){var h=e[o][1],m=0;if(t){m=+t[e[o][0]];var v=r[m];if(v.p=="version"&&typeof h=="string"){var x=h.split(".");h=(+x[0]<<16)+(+x[1]||0)}c=gh(v.t,h)}else{var y=vj(h);y==-1&&(y=31,h=String(h)),c=gh(y,h)}i.push(c),d=Q(8),d.write_shift(4,t?m:2+o),a.push(d),l+=8+c.length}var p=8*(i.length+1);for(o=0;o<i.length;++o)a[o].write_shift(4,p),p+=i[o].length;return n.write_shift(4,l),n.write_shift(4,i.length),St([n].concat(a).concat(i))}function vh(e,t,r,n,a,i){var l=Q(a?68:48),o=[l];l.write_shift(2,65534),l.write_shift(2,0),l.write_shift(4,842412599),l.write_shift(16,Ue.utils.consts.HEADER_CLSID,"hex"),l.write_shift(4,a?2:1),l.write_shift(16,t,"hex"),l.write_shift(4,a?68:48);var c=yh(e,r,n);if(o.push(c),a){var d=yh(a,null,null);l.write_shift(16,i,"hex"),l.write_shift(4,68+c.length),o.push(d)}return St(o)}function wj(e,t){t||(t=Q(e));for(var r=0;r<e;++r)t.write_shift(1,0);return t}function bj(e,t){return e.read_shift(t)===1}function Bt(e,t){return t||(t=Q(2)),t.write_shift(2,+!!e),t}function yg(e){return e.read_shift(2,"u")}function hr(e,t){return t||(t=Q(2)),t.write_shift(2,e),t}function vg(e,t,r){return r||(r=Q(2)),r.write_shift(1,t=="e"?+e:+!!e),r.write_shift(1,t=="e"?1:0),r}function wg(e,t,r){var n=e.read_shift(r&&r.biff>=12?2:1),a="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var i=e.read_shift(1);i&&(a="dbcs-cont")}else r.biff==12&&(a="wstr");r.biff>=2&&r.biff<=5&&(a="cpstr");var l=n?e.read_shift(n,a):"";return l}function Nj(e){var t=e.t||"",r=Q(3);r.write_shift(2,t.length),r.write_shift(1,1);var n=Q(2*t.length);n.write_shift(2*t.length,t,"utf16le");var a=[r,n];return St(a)}function jj(e,t,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var a=e.read_shift(1);return a===0?n=e.read_shift(t,"sbcs-cont"):n=e.read_shift(t,"dbcs-cont"),n}function Sj(e,t,r){var n=e.read_shift(r&&r.biff==2?1:2);return n===0?(e.l++,""):jj(e,n,r)}function _j(e,t,r){if(r.biff>5)return Sj(e,t,r);var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function bg(e,t,r){return r||(r=Q(3+2*e.length)),r.write_shift(2,e.length),r.write_shift(1,1),r.write_shift(31,e,"utf16le"),r}function wh(e,t){t||(t=Q(6+e.length*2)),t.write_shift(4,1+e.length);for(var r=0;r<e.length;++r)t.write_shift(2,e.charCodeAt(r));return t.write_shift(2,0),t}function Ej(e){var t=Q(512),r=0,n=e.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var a=n.indexOf("#"),i=a>-1?31:23;switch(n.charAt(0)){case"#":i=28;break;case".":i&=-3;break}t.write_shift(4,2),t.write_shift(4,i);var l=[8,6815827,6619237,4849780,83];for(r=0;r<l.length;++r)t.write_shift(4,l[r]);if(i==28)n=n.slice(1),wh(n,t);else if(i&2){for(l="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<l.length;++r)t.write_shift(1,parseInt(l[r],16));var o=a>-1?n.slice(0,a):n;for(t.write_shift(4,2*(o.length+1)),r=0;r<o.length;++r)t.write_shift(2,o.charCodeAt(r));t.write_shift(2,0),i&8&&wh(a>-1?n.slice(a+1):"",t)}else{for(l="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<l.length;++r)t.write_shift(1,parseInt(l[r],16));for(var c=0;n.slice(c*3,c*3+3)=="../"||n.slice(c*3,c*3+3)=="..\\";)++c;for(t.write_shift(2,c),t.write_shift(4,n.length-3*c+1),r=0;r<n.length-3*c;++r)t.write_shift(1,n.charCodeAt(r+3*c)&255);for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),r=0;r<6;++r)t.write_shift(4,0)}return t.slice(0,t.l)}function ys(e,t,r,n){return n||(n=Q(6)),n.write_shift(2,e),n.write_shift(2,t),n.write_shift(2,r||0),n}function Tj(e,t,r){var n=r.biff>8?4:2,a=e.read_shift(n),i=e.read_shift(n,"i"),l=e.read_shift(n,"i");return[a,i,l]}function kj(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),a=e.read_shift(2);return{s:{c:n,r:t},e:{c:a,r}}}function Ng(e,t){return t||(t=Q(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function q0(e,t,r){var n=1536,a=16;switch(r.bookType){case"biff8":break;case"biff5":n=1280,a=8;break;case"biff4":n=4,a=6;break;case"biff3":n=3,a=6;break;case"biff2":n=2,a=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var i=Q(a);return i.write_shift(2,n),i.write_shift(2,t),a>4&&i.write_shift(2,29282),a>6&&i.write_shift(2,1997),a>8&&(i.write_shift(2,49161),i.write_shift(2,1),i.write_shift(2,1798),i.write_shift(2,0)),i}function Cj(e,t){var r=!t||t.biff==8,n=Q(r?112:54);for(n.write_shift(t.biff==8?2:1,7),r&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(r?0:536870912));n.l<n.length;)n.write_shift(1,r?0:32);return n}function Aj(e,t){var r=!t||t.biff>=8?2:1,n=Q(8+r*e.name.length);n.write_shift(4,e.pos),n.write_shift(1,e.hs||0),n.write_shift(1,e.dt),n.write_shift(1,e.name.length),t.biff>=8&&n.write_shift(1,1),n.write_shift(r*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var a=n.slice(0,n.l);return a.l=n.l,a}function Fj(e,t){var r=Q(8);r.write_shift(4,e.Count),r.write_shift(4,e.Unique);for(var n=[],a=0;a<e.length;++a)n[a]=Nj(e[a]);var i=St([r].concat(n));return i.parts=[r.length].concat(n.map(function(l){return l.length})),i}function Pj(){var e=Q(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function Oj(e){var t=Q(18),r=1718;return e&&e.RTL&&(r|=64),t.write_shift(2,r),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}function Rj(e,t){var r=e.name||"Arial",n=t&&t.biff==5,a=n?15+r.length:16+2*r.length,i=Q(a);return i.write_shift(2,e.sz*20),i.write_shift(4,0),i.write_shift(2,400),i.write_shift(4,0),i.write_shift(2,0),i.write_shift(1,r.length),n||i.write_shift(1,1),i.write_shift((n?1:2)*r.length,r,n?"sbcs":"utf16le"),i}function Ij(e,t,r,n){var a=Q(10);return ys(e,t,n,a),a.write_shift(4,r),a}function Dj(e,t,r,n,a){var i=!a||a.biff==8,l=Q(8+ +i+(1+i)*r.length);return ys(e,t,n,l),l.write_shift(2,r.length),i&&l.write_shift(1,1),l.write_shift((1+i)*r.length,r,i?"utf16le":"sbcs"),l}function Lj(e,t,r,n){var a=r&&r.biff==5;n||(n=Q(a?3+t.length:5+2*t.length)),n.write_shift(2,e),n.write_shift(a?1:2,t.length),a||n.write_shift(1,1),n.write_shift((a?1:2)*t.length,t,a?"sbcs":"utf16le");var i=n.length>n.l?n.slice(0,n.l):n;return i.l==null&&(i.l=i.length),i}function Mj(e,t){var r=t.biff==8||!t.biff?4:2,n=Q(2*r+6);return n.write_shift(r,e.s.r),n.write_shift(r,e.e.r+1),n.write_shift(2,e.s.c),n.write_shift(2,e.e.c+1),n.write_shift(2,0),n}function bh(e,t,r,n){var a=r&&r.biff==5;n||(n=Q(a?16:20)),n.write_shift(2,0),e.style?(n.write_shift(2,e.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,e.numFmtId||0),n.write_shift(2,t<<4));var i=0;return e.numFmtId>0&&a&&(i|=1024),n.write_shift(4,i),n.write_shift(4,0),a||n.write_shift(4,0),n.write_shift(2,0),n}function Bj(e){var t=Q(8);return t.write_shift(4,0),t.write_shift(2,0),t.write_shift(2,0),t}function Uj(e,t,r,n,a,i){var l=Q(8);return ys(e,t,n,l),vg(r,i,l),l}function zj(e,t,r,n){var a=Q(14);return ys(e,t,n,a),gs(r,a),a}function $j(e,t,r){if(r.biff<8)return Wj(e,t,r);for(var n=[],a=e.l+t,i=e.read_shift(r.biff>8?4:2);i--!==0;)n.push(Tj(e,r.biff>8?12:6,r));if(e.l!=a)throw new Error("Bad ExternSheet: "+e.l+" != "+a);return n}function Wj(e,t,r){e[e.l+1]==3&&e[e.l]++;var n=wg(e,t,r);return n.charCodeAt(0)==3?n.slice(1):n}function Hj(e){var t=Q(2+e.length*8);t.write_shift(2,e.length);for(var r=0;r<e.length;++r)Ng(e[r],t);return t}function Vj(e){var t=Q(24),r=gt(e[0]);t.write_shift(2,r.r),t.write_shift(2,r.r),t.write_shift(2,r.c),t.write_shift(2,r.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),a=0;a<16;++a)t.write_shift(1,parseInt(n[a],16));return St([t,Ej(e[1])])}function Gj(e){var t=e[1].Tooltip,r=Q(10+2*(t.length+1));r.write_shift(2,2048);var n=gt(e[0]);r.write_shift(2,n.r),r.write_shift(2,n.r),r.write_shift(2,n.c),r.write_shift(2,n.c);for(var a=0;a<t.length;++a)r.write_shift(2,t.charCodeAt(a));return r.write_shift(2,0),r}function Xj(e){return e||(e=Q(4)),e.write_shift(2,1),e.write_shift(2,1),e}function Kj(e,t,r){if(!r.cellStyles)return Vr(e,t);var n=r&&r.biff>=12?4:2,a=e.read_shift(n),i=e.read_shift(n),l=e.read_shift(n),o=e.read_shift(n),c=e.read_shift(2);n==2&&(e.l+=2);var d={s:a,e:i,w:l,ixfe:o,flags:c};return(r.biff>=5||!r.biff)&&(d.level=c>>8&7),d}function Yj(e,t){var r=Q(12);r.write_shift(2,t),r.write_shift(2,t),r.write_shift(2,e.width*256),r.write_shift(2,0);var n=0;return e.hidden&&(n|=1),r.write_shift(1,n),n=e.level||0,r.write_shift(1,n),r.write_shift(2,0),r}function Jj(e){for(var t=Q(2*e),r=0;r<e;++r)t.write_shift(2,r+1);return t}function qj(e,t,r){var n=Q(15);return Wi(n,e,t),n.write_shift(8,r,"f"),n}function Qj(e,t,r){var n=Q(9);return Wi(n,e,t),n.write_shift(2,r),n}var Zj=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=U0({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(o,c){var d=[],u=ps(1);switch(c.type){case"base64":u=Ar(fn(o));break;case"binary":u=Ar(o);break;case"buffer":case"array":u=o;break}rr(u,0);var f=u.read_shift(1),h=!!(f&136),m=!1,v=!1;switch(f){case 2:break;case 3:break;case 48:m=!0,h=!0;break;case 49:m=!0,h=!0;break;case 131:break;case 139:break;case 140:v=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+f.toString(16))}var x=0,y=521;f==2&&(x=u.read_shift(2)),u.l+=3,f!=2&&(x=u.read_shift(4)),x>1048576&&(x=1e6),f!=2&&(y=u.read_shift(2));var p=u.read_shift(2),g=c.codepage||1252;f!=2&&(u.l+=16,u.read_shift(1),u[u.l]!==0&&(g=e[u[u.l]]),u.l+=1,u.l+=2),v&&(u.l+=36);for(var w=[],b={},P=Math.min(u.length,f==2?521:y-10-(m?264:0)),M=v?32:11;u.l<P&&u[u.l]!=13;)switch(b={},b.name=ro.utils.decode(g,u.slice(u.l,u.l+M)).replace(/[\u0000\r\n].*$/g,""),u.l+=M,b.type=String.fromCharCode(u.read_shift(1)),f!=2&&!v&&(b.offset=u.read_shift(4)),b.len=u.read_shift(1),f==2&&(b.offset=u.read_shift(2)),b.dec=u.read_shift(1),b.name.length&&w.push(b),f!=2&&(u.l+=v?13:14),b.type){case"B":(!m||b.len!=8)&&c.WTF&&console.log("Skipping "+b.name+":"+b.type);break;case"G":case"P":c.WTF&&console.log("Skipping "+b.name+":"+b.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+b.type)}if(u[u.l]!==13&&(u.l=y-1),u.read_shift(1)!==13)throw new Error("DBF Terminator not found "+u.l+" "+u[u.l]);u.l=y;var j=0,O=0;for(d[0]=[],O=0;O!=w.length;++O)d[0][O]=w[O].name;for(;x-- >0;){if(u[u.l]===42){u.l+=p;continue}for(++u.l,d[++j]=[],O=0,O=0;O!=w.length;++O){var R=u.slice(u.l,u.l+w[O].len);u.l+=w[O].len,rr(R,0);var I=ro.utils.decode(g,R);switch(w[O].type){case"C":I.trim().length&&(d[j][O]=I.replace(/\s+$/,""));break;case"D":I.length===8?d[j][O]=new Date(+I.slice(0,4),+I.slice(4,6)-1,+I.slice(6,8)):d[j][O]=I;break;case"F":d[j][O]=parseFloat(I.trim());break;case"+":case"I":d[j][O]=v?R.read_shift(-4,"i")^2147483648:R.read_shift(4,"i");break;case"L":switch(I.trim().toUpperCase()){case"Y":case"T":d[j][O]=!0;break;case"N":case"F":d[j][O]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+I+"|")}break;case"M":if(!h)throw new Error("DBF Unexpected MEMO for type "+f.toString(16));d[j][O]="##MEMO##"+(v?parseInt(I.trim(),10):R.read_shift(4));break;case"N":I=I.replace(/\u0000/g,"").trim(),I&&I!="."&&(d[j][O]=+I||0);break;case"@":d[j][O]=new Date(R.read_shift(-8,"f")-621356832e5);break;case"T":d[j][O]=new Date((R.read_shift(4)-2440588)*864e5+R.read_shift(4));break;case"Y":d[j][O]=R.read_shift(4,"i")/1e4+R.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":d[j][O]=-R.read_shift(-8,"f");break;case"B":if(m&&w[O].len==8){d[j][O]=R.read_shift(8,"f");break}case"G":case"P":R.l+=w[O].len;break;case"0":if(w[O].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+w[O].type)}}}if(f!=2&&u.l<u.length&&u[u.l++]!=26)throw new Error("DBF EOF Marker missing "+(u.l-1)+" of "+u.length+" "+u[u.l-1].toString(16));return c&&c.sheetRows&&(d=d.slice(0,c.sheetRows)),c.DBF=w,d}function n(o,c){var d=c||{};d.dateNF||(d.dateNF="yyyymmdd");var u=wa(r(o,d),d);return u["!cols"]=d.DBF.map(function(f){return{wch:f.len,DBF:f}}),delete d.DBF,u}function a(o,c){try{return Ns(n(o,c),c)}catch(d){if(c&&c.WTF)throw d}return{SheetNames:[],Sheets:{}}}var i={B:8,C:250,L:1,D:8,"?":0,"":0};function l(o,c){var d=c||{};if(+d.codepage>=0&&Si(+d.codepage),d.type=="string")throw new Error("Cannot write DBF to JS string");var u=Jt(),f=po(o,{header:1,raw:!0,cellDates:!0}),h=f[0],m=f.slice(1),v=o["!cols"]||[],x=0,y=0,p=0,g=1;for(x=0;x<h.length;++x){if(((v[x]||{}).DBF||{}).name){h[x]=v[x].DBF.name,++p;continue}if(h[x]!=null){if(++p,typeof h[x]=="number"&&(h[x]=h[x].toString(10)),typeof h[x]!="string")throw new Error("DBF Invalid column name "+h[x]+" |"+typeof h[x]+"|");if(h.indexOf(h[x])!==x){for(y=0;y<1024;++y)if(h.indexOf(h[x]+"_"+y)==-1){h[x]+="_"+y;break}}}}var w=Xe(o["!ref"]),b=[],P=[],M=[];for(x=0;x<=w.e.c-w.s.c;++x){var j="",O="",R=0,I=[];for(y=0;y<m.length;++y)m[y][x]!=null&&I.push(m[y][x]);if(I.length==0||h[x]==null){b[x]="?";continue}for(y=0;y<I.length;++y){switch(typeof I[y]){case"number":O="B";break;case"string":O="C";break;case"boolean":O="L";break;case"object":O=I[y]instanceof Date?"D":"C";break;default:O="C"}R=Math.max(R,String(I[y]).length),j=j&&j!=O?"C":O}R>250&&(R=250),O=((v[x]||{}).DBF||{}).type,O=="C"&&v[x].DBF.len>R&&(R=v[x].DBF.len),j=="B"&&O=="N"&&(j="N",M[x]=v[x].DBF.dec,R=v[x].DBF.len),P[x]=j=="C"||O=="N"?R:i[j]||0,g+=P[x],b[x]=j}var D=u.next(32);for(D.write_shift(4,318902576),D.write_shift(4,m.length),D.write_shift(2,296+32*p),D.write_shift(2,g),x=0;x<4;++x)D.write_shift(4,0);for(D.write_shift(4,0|(+t[Sp]||3)<<8),x=0,y=0;x<h.length;++x)if(h[x]!=null){var z=u.next(32),ne=(h[x].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);z.write_shift(1,ne,"sbcs"),z.write_shift(1,b[x]=="?"?"C":b[x],"sbcs"),z.write_shift(4,y),z.write_shift(1,P[x]||i[b[x]]||0),z.write_shift(1,M[x]||0),z.write_shift(1,2),z.write_shift(4,0),z.write_shift(1,0),z.write_shift(4,0),z.write_shift(4,0),y+=P[x]||i[b[x]]||0}var Ne=u.next(264);for(Ne.write_shift(4,13),x=0;x<65;++x)Ne.write_shift(4,0);for(x=0;x<m.length;++x){var ue=u.next(g);for(ue.write_shift(1,0),y=0;y<h.length;++y)if(h[y]!=null)switch(b[y]){case"L":ue.write_shift(1,m[x][y]==null?63:m[x][y]?84:70);break;case"B":ue.write_shift(8,m[x][y]||0,"f");break;case"N":var je="0";for(typeof m[x][y]=="number"&&(je=m[x][y].toFixed(M[y]||0)),p=0;p<P[y]-je.length;++p)ue.write_shift(1,32);ue.write_shift(1,je,"sbcs");break;case"D":m[x][y]?(ue.write_shift(4,("0000"+m[x][y].getFullYear()).slice(-4),"sbcs"),ue.write_shift(2,("00"+(m[x][y].getMonth()+1)).slice(-2),"sbcs"),ue.write_shift(2,("00"+m[x][y].getDate()).slice(-2),"sbcs")):ue.write_shift(8,"00000000","sbcs");break;case"C":var q=String(m[x][y]!=null?m[x][y]:"").slice(0,P[y]);for(ue.write_shift(1,q,"sbcs"),p=0;p<P[y]-q.length;++p)ue.write_shift(1,32);break}}return u.next(1).write_shift(1,26),u.end()}return{to_workbook:a,to_sheet:n,from_sheet:l}}(),e4=function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+Ct(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(h,m){var v=e[m];return typeof v=="number"?Vf(v):v},n=function(h,m,v){var x=m.charCodeAt(0)-32<<4|v.charCodeAt(0)-48;return x==59?h:Vf(x)};e["|"]=254;function a(h,m){switch(m.type){case"base64":return i(fn(h),m);case"binary":return i(h,m);case"buffer":return i(Re&&Buffer.isBuffer(h)?h.toString("binary"):Mi(h),m);case"array":return i(Bo(h),m)}throw new Error("Unrecognized type "+m.type)}function i(h,m){var v=h.split(/[\n\r]+/),x=-1,y=-1,p=0,g=0,w=[],b=[],P=null,M={},j=[],O=[],R=[],I=0,D;for(+m.codepage>=0&&Si(+m.codepage);p!==v.length;++p){I=0;var z=v[p].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(t,r),ne=z.replace(/;;/g,"\0").split(";").map(function(U){return U.replace(/\u0000/g,";")}),Ne=ne[0],ue;if(z.length>0)switch(Ne){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":ne[1].charAt(0)=="P"&&b.push(z.slice(3).replace(/;;/g,";"));break;case"C":var je=!1,q=!1,W=!1,k=!1,K=-1,te=-1;for(g=1;g<ne.length;++g)switch(ne[g].charAt(0)){case"A":break;case"X":y=parseInt(ne[g].slice(1))-1,q=!0;break;case"Y":for(x=parseInt(ne[g].slice(1))-1,q||(y=0),D=w.length;D<=x;++D)w[D]=[];break;case"K":ue=ne[g].slice(1),ue.charAt(0)==='"'?ue=ue.slice(1,ue.length-1):ue==="TRUE"?ue=!0:ue==="FALSE"?ue=!1:isNaN(an(ue))?isNaN(Ei(ue).getDate())||(ue=zt(ue)):(ue=an(ue),P!==null&&Dp(P)&&(ue=Up(ue))),je=!0;break;case"E":k=!0;var E=Q4(ne[g].slice(1),{r:x,c:y});w[x][y]=[w[x][y],E];break;case"S":W=!0,w[x][y]=[w[x][y],"S5S"];break;case"G":break;case"R":K=parseInt(ne[g].slice(1))-1;break;case"C":te=parseInt(ne[g].slice(1))-1;break;default:if(m&&m.WTF)throw new Error("SYLK bad record "+z)}if(je&&(w[x][y]&&w[x][y].length==2?w[x][y][0]=ue:w[x][y]=ue,P=null),W){if(k)throw new Error("SYLK shared formula cannot have own formula");var B=K>-1&&w[K][te];if(!B||!B[1])throw new Error("SYLK shared formula cannot find base");w[x][y][1]=Z4(B[1],{r:x-K,c:y-te})}break;case"F":var L=0;for(g=1;g<ne.length;++g)switch(ne[g].charAt(0)){case"X":y=parseInt(ne[g].slice(1))-1,++L;break;case"Y":for(x=parseInt(ne[g].slice(1))-1,D=w.length;D<=x;++D)w[D]=[];break;case"M":I=parseInt(ne[g].slice(1))/20;break;case"F":break;case"G":break;case"P":P=b[parseInt(ne[g].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(R=ne[g].slice(1).split(" "),D=parseInt(R[0],10);D<=parseInt(R[1],10);++D)I=parseInt(R[2],10),O[D-1]=I===0?{hidden:!0}:{wch:I},Q0(O[D-1]);break;case"C":y=parseInt(ne[g].slice(1))-1,O[y]||(O[y]={});break;case"R":x=parseInt(ne[g].slice(1))-1,j[x]||(j[x]={}),I>0?(j[x].hpt=I,j[x].hpx=Tg(I)):I===0&&(j[x].hidden=!0);break;default:if(m&&m.WTF)throw new Error("SYLK bad record "+z)}L<1&&(P=null);break;default:if(m&&m.WTF)throw new Error("SYLK bad record "+z)}}return j.length>0&&(M["!rows"]=j),O.length>0&&(M["!cols"]=O),m&&m.sheetRows&&(w=w.slice(0,m.sheetRows)),[w,M]}function l(h,m){var v=a(h,m),x=v[0],y=v[1],p=wa(x,m);return Ct(y).forEach(function(g){p[g]=y[g]}),p}function o(h,m){return Ns(l(h,m),m)}function c(h,m,v,x){var y="C;Y"+(v+1)+";X"+(x+1)+";K";switch(h.t){case"n":y+=h.v||0,h.f&&!h.F&&(y+=";E"+ed(h.f,{r:v,c:x}));break;case"b":y+=h.v?"TRUE":"FALSE";break;case"e":y+=h.w||h.v;break;case"d":y+='"'+(h.w||h.v)+'"';break;case"s":y+='"'+h.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return y}function d(h,m){m.forEach(function(v,x){var y="F;W"+(x+1)+" "+(x+1)+" ";v.hidden?y+="0":(typeof v.width=="number"&&!v.wpx&&(v.wpx=fo(v.width)),typeof v.wpx=="number"&&!v.wch&&(v.wch=ho(v.wpx)),typeof v.wch=="number"&&(y+=Math.round(v.wch))),y.charAt(y.length-1)!=" "&&h.push(y)})}function u(h,m){m.forEach(function(v,x){var y="F;";v.hidden?y+="M0;":v.hpt?y+="M"+20*v.hpt+";":v.hpx&&(y+="M"+20*xo(v.hpx)+";"),y.length>2&&h.push(y+"R"+(x+1))})}function f(h,m){var v=["ID;PWXL;N;E"],x=[],y=Xe(h["!ref"]),p,g=Array.isArray(h),w=`\r
`;v.push("P;PGeneral"),v.push("F;P0;DG0G8;M255"),h["!cols"]&&d(v,h["!cols"]),h["!rows"]&&u(v,h["!rows"]),v.push("B;Y"+(y.e.r-y.s.r+1)+";X"+(y.e.c-y.s.c+1)+";D"+[y.s.c,y.s.r,y.e.c,y.e.r].join(" "));for(var b=y.s.r;b<=y.e.r;++b)for(var P=y.s.c;P<=y.e.c;++P){var M=Be({r:b,c:P});p=g?(h[b]||[])[P]:h[M],!(!p||p.v==null&&(!p.f||p.F))&&x.push(c(p,h,b,P))}return v.join(w)+w+x.join(w)+w+"E"+w}return{to_workbook:o,to_sheet:l,from_sheet:f}}(),t4=function(){function e(i,l){switch(l.type){case"base64":return t(fn(i),l);case"binary":return t(i,l);case"buffer":return t(Re&&Buffer.isBuffer(i)?i.toString("binary"):Mi(i),l);case"array":return t(Bo(i),l)}throw new Error("Unrecognized type "+l.type)}function t(i,l){for(var o=i.split(`
`),c=-1,d=-1,u=0,f=[];u!==o.length;++u){if(o[u].trim()==="BOT"){f[++c]=[],d=0;continue}if(!(c<0)){var h=o[u].trim().split(","),m=h[0],v=h[1];++u;for(var x=o[u]||"";(x.match(/["]/g)||[]).length&1&&u<o.length-1;)x+=`
`+o[++u];switch(x=x.trim(),+m){case-1:if(x==="BOT"){f[++c]=[],d=0;continue}else if(x!=="EOD")throw new Error("Unrecognized DIF special command "+x);break;case 0:x==="TRUE"?f[c][d]=!0:x==="FALSE"?f[c][d]=!1:isNaN(an(v))?isNaN(Ei(v).getDate())?f[c][d]=v:f[c][d]=zt(v):f[c][d]=an(v),++d;break;case 1:x=x.slice(1,x.length-1),x=x.replace(/""/g,'"'),x&&x.match(/^=".*"$/)&&(x=x.slice(2,-1)),f[c][d++]=x!==""?x:null;break}if(x==="EOD")break}}return l&&l.sheetRows&&(f=f.slice(0,l.sheetRows)),f}function r(i,l){return wa(e(i,l),l)}function n(i,l){return Ns(r(i,l),l)}var a=function(){var i=function(c,d,u,f,h){c.push(d),c.push(u+","+f),c.push('"'+h.replace(/"/g,'""')+'"')},l=function(c,d,u,f){c.push(d+","+u),c.push(d==1?'"'+f.replace(/"/g,'""')+'"':f)};return function(c){var d=[],u=Xe(c["!ref"]),f,h=Array.isArray(c);i(d,"TABLE",0,1,"sheetjs"),i(d,"VECTORS",0,u.e.r-u.s.r+1,""),i(d,"TUPLES",0,u.e.c-u.s.c+1,""),i(d,"DATA",0,0,"");for(var m=u.s.r;m<=u.e.r;++m){l(d,-1,0,"BOT");for(var v=u.s.c;v<=u.e.c;++v){var x=Be({r:m,c:v});if(f=h?(c[m]||[])[v]:c[x],!f){l(d,1,0,"");continue}switch(f.t){case"n":var y=f.w;!y&&f.v!=null&&(y=f.v),y==null?f.f&&!f.F?l(d,1,0,"="+f.f):l(d,1,0,""):l(d,0,y,"V");break;case"b":l(d,0,f.v?1:0,f.v?"TRUE":"FALSE");break;case"s":l(d,1,0,isNaN(f.v)?f.v:'="'+f.v+'"');break;case"d":f.w||(f.w=Hn(f.z||nt[14],qt(zt(f.v)))),l(d,0,f.w,"V");break;default:l(d,1,0,"")}}}l(d,-1,0,"EOD");var p=`\r
`,g=d.join(p);return g}}();return{to_workbook:n,to_sheet:r,from_sheet:a}}(),jg=function(){function e(f){return f.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(f){return f.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(f,h){for(var m=f.split(`
`),v=-1,x=-1,y=0,p=[];y!==m.length;++y){var g=m[y].trim().split(":");if(g[0]==="cell"){var w=gt(g[1]);if(p.length<=w.r)for(v=p.length;v<=w.r;++v)p[v]||(p[v]=[]);switch(v=w.r,x=w.c,g[2]){case"t":p[v][x]=e(g[3]);break;case"v":p[v][x]=+g[3];break;case"vtf":var b=g[g.length-1];case"vtc":switch(g[3]){case"nl":p[v][x]=!!+g[4];break;default:p[v][x]=+g[4];break}g[2]=="vtf"&&(p[v][x]=[p[v][x],b])}}}return h&&h.sheetRows&&(p=p.slice(0,h.sheetRows)),p}function n(f,h){return wa(r(f,h),h)}function a(f,h){return Ns(n(f,h),h)}var i=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),l=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),c="--SocialCalcSpreadsheetControlSave--";function d(f){if(!f||!f["!ref"])return"";for(var h=[],m=[],v,x="",y=cr(f["!ref"]),p=Array.isArray(f),g=y.s.r;g<=y.e.r;++g)for(var w=y.s.c;w<=y.e.c;++w)if(x=Be({r:g,c:w}),v=p?(f[g]||[])[w]:f[x],!(!v||v.v==null||v.t==="z")){switch(m=["cell",x,"t"],v.t){case"s":case"str":m.push(t(v.v));break;case"n":v.f?(m[2]="vtf",m[3]="n",m[4]=v.v,m[5]=t(v.f)):(m[2]="v",m[3]=v.v);break;case"b":m[2]="vt"+(v.f?"f":"c"),m[3]="nl",m[4]=v.v?"1":"0",m[5]=t(v.f||(v.v?"TRUE":"FALSE"));break;case"d":var b=qt(zt(v.v));m[2]="vtc",m[3]="nd",m[4]=""+b,m[5]=v.w||Hn(v.z||nt[14],b);break;case"e":continue}h.push(m.join(":"))}return h.push("sheet:c:"+(y.e.c-y.s.c+1)+":r:"+(y.e.r-y.s.r+1)+":tvf:1"),h.push("valueformat:1:text-wiki"),h.join(`
`)}function u(f){return[i,l,o,l,d(f),c].join(`
`)}return{to_workbook:a,to_sheet:n,from_sheet:u}}(),r4=function(){function e(u,f,h,m,v){v.raw?f[h][m]=u:u===""||(u==="TRUE"?f[h][m]=!0:u==="FALSE"?f[h][m]=!1:isNaN(an(u))?isNaN(Ei(u).getDate())?f[h][m]=u:f[h][m]=zt(u):f[h][m]=an(u))}function t(u,f){var h=f||{},m=[];if(!u||u.length===0)return m;for(var v=u.split(/[\r\n]/),x=v.length-1;x>=0&&v[x].length===0;)--x;for(var y=10,p=0,g=0;g<=x;++g)p=v[g].indexOf(" "),p==-1?p=v[g].length:p++,y=Math.max(y,p);for(g=0;g<=x;++g){m[g]=[];var w=0;for(e(v[g].slice(0,y).trim(),m,g,w,h),w=1;w<=(v[g].length-y)/10+1;++w)e(v[g].slice(y+(w-1)*10,y+w*10).trim(),m,g,w,h)}return h.sheetRows&&(m=m.slice(0,h.sheetRows)),m}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function a(u){for(var f={},h=!1,m=0,v=0;m<u.length;++m)(v=u.charCodeAt(m))==34?h=!h:!h&&v in r&&(f[v]=(f[v]||0)+1);v=[];for(m in f)Object.prototype.hasOwnProperty.call(f,m)&&v.push([f[m],m]);if(!v.length){f=n;for(m in f)Object.prototype.hasOwnProperty.call(f,m)&&v.push([f[m],m])}return v.sort(function(x,y){return x[0]-y[0]||n[x[1]]-n[y[1]]}),r[v.pop()[1]]||44}function i(u,f){var h=f||{},m="",v=h.dense?[]:{},x={s:{c:0,r:0},e:{c:0,r:0}};u.slice(0,4)=="sep="?u.charCodeAt(5)==13&&u.charCodeAt(6)==10?(m=u.charAt(4),u=u.slice(7)):u.charCodeAt(5)==13||u.charCodeAt(5)==10?(m=u.charAt(4),u=u.slice(6)):m=a(u.slice(0,1024)):h&&h.FS?m=h.FS:m=a(u.slice(0,1024));var y=0,p=0,g=0,w=0,b=0,P=m.charCodeAt(0),M=!1,j=0,O=u.charCodeAt(0);u=u.replace(/\r\n/mg,`
`);var R=h.dateNF!=null?yN(h.dateNF):null;function I(){var D=u.slice(w,b),z={};if(D.charAt(0)=='"'&&D.charAt(D.length-1)=='"'&&(D=D.slice(1,-1).replace(/""/g,'"')),D.length===0)z.t="z";else if(h.raw)z.t="s",z.v=D;else if(D.trim().length===0)z.t="s",z.v=D;else if(D.charCodeAt(0)==61)D.charCodeAt(1)==34&&D.charCodeAt(D.length-1)==34?(z.t="s",z.v=D.slice(2,-1).replace(/""/g,'"')):eS(D)?(z.t="n",z.f=D.slice(1)):(z.t="s",z.v=D);else if(D=="TRUE")z.t="b",z.v=!0;else if(D=="FALSE")z.t="b",z.v=!1;else if(!isNaN(g=an(D)))z.t="n",h.cellText!==!1&&(z.w=D),z.v=g;else if(!isNaN(Ei(D).getDate())||R&&D.match(R)){z.z=h.dateNF||nt[14];var ne=0;R&&D.match(R)&&(D=vN(D,h.dateNF,D.match(R)||[]),ne=1),h.cellDates?(z.t="d",z.v=zt(D,ne)):(z.t="n",z.v=qt(zt(D,ne))),h.cellText!==!1&&(z.w=Hn(z.z,z.v instanceof Date?qt(z.v):z.v)),h.cellNF||delete z.z}else z.t="s",z.v=D;if(z.t=="z"||(h.dense?(v[y]||(v[y]=[]),v[y][p]=z):v[Be({c:p,r:y})]=z),w=b+1,O=u.charCodeAt(w),x.e.c<p&&(x.e.c=p),x.e.r<y&&(x.e.r=y),j==P)++p;else if(p=0,++y,h.sheetRows&&h.sheetRows<=y)return!0}e:for(;b<u.length;++b)switch(j=u.charCodeAt(b)){case 34:O===34&&(M=!M);break;case P:case 10:case 13:if(!M&&I())break e;break}return b-w>0&&I(),v["!ref"]=ct(x),v}function l(u,f){return!(f&&f.PRN)||f.FS||u.slice(0,4)=="sep="||u.indexOf("	")>=0||u.indexOf(",")>=0||u.indexOf(";")>=0?i(u,f):wa(t(u,f),f)}function o(u,f){var h="",m=f.type=="string"?[0,0,0,0]:xT(u,f);switch(f.type){case"base64":h=fn(u);break;case"binary":h=u;break;case"buffer":f.codepage==65001?h=u.toString("utf8"):f.codepage&&typeof ro<"u"||(h=Re&&Buffer.isBuffer(u)?u.toString("binary"):Mi(u));break;case"array":h=Bo(u);break;case"string":h=u;break;default:throw new Error("Unrecognized type "+f.type)}return m[0]==239&&m[1]==187&&m[2]==191?h=Za(h.slice(3)):f.type!="string"&&f.type!="buffer"&&f.codepage==65001?h=Za(h):f.type=="binary"&&typeof ro<"u",h.slice(0,19)=="socialcalc:version:"?jg.to_sheet(f.type=="string"?h:Za(h),f):l(h,f)}function c(u,f){return Ns(o(u,f),f)}function d(u){for(var f=[],h=Xe(u["!ref"]),m,v=Array.isArray(u),x=h.s.r;x<=h.e.r;++x){for(var y=[],p=h.s.c;p<=h.e.c;++p){var g=Be({r:x,c:p});if(m=v?(u[x]||[])[p]:u[g],!m||m.v==null){y.push("          ");continue}for(var w=(m.w||(hn(m),m.w)||"").slice(0,10);w.length<10;)w+=" ";y.push(w+(p===0?" ":""))}f.push(y.join(""))}return f.join(`
`)}return{to_workbook:c,to_sheet:o,from_sheet:d}}(),Nh=function(){function e(E,B,L){if(E){rr(E,E.l||0);for(var U=L.Enum||K;E.l<E.length;){var ee=E.read_shift(2),he=U[ee]||U[65535],xe=E.read_shift(2),G=E.l+xe,J=he.f&&he.f(E,xe,L);if(E.l=G,B(J,he,ee))return}}}function t(E,B){switch(B.type){case"base64":return r(Ar(fn(E)),B);case"binary":return r(Ar(E),B);case"buffer":case"array":return r(E,B)}throw"Unsupported type "+B.type}function r(E,B){if(!E)return E;var L=B||{},U=L.dense?[]:{},ee="Sheet1",he="",xe=0,G={},J=[],ve=[],Se={s:{r:0,c:0},e:{r:0,c:0}},se=L.sheetRows||0;if(E[2]==0&&(E[3]==8||E[3]==9)&&E.length>=16&&E[14]==5&&E[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(E[2]==2)L.Enum=K,e(E,function(de,xt,Zt){switch(Zt){case 0:L.vers=de,de>=4096&&(L.qpro=!0);break;case 6:Se=de;break;case 204:de&&(he=de);break;case 222:he=de;break;case 15:case 51:L.qpro||(de[1].v=de[1].v.slice(1));case 13:case 14:case 16:Zt==14&&(de[2]&112)==112&&(de[2]&15)>1&&(de[2]&15)<15&&(de[1].z=L.dateNF||nt[14],L.cellDates&&(de[1].t="d",de[1].v=Up(de[1].v))),L.qpro&&de[3]>xe&&(U["!ref"]=ct(Se),G[ee]=U,J.push(ee),U=L.dense?[]:{},Se={s:{r:0,c:0},e:{r:0,c:0}},xe=de[3],ee=he||"Sheet"+(xe+1),he="");var at=L.dense?(U[de[0].r]||[])[de[0].c]:U[Be(de[0])];if(at){at.t=de[1].t,at.v=de[1].v,de[1].z!=null&&(at.z=de[1].z),de[1].f!=null&&(at.f=de[1].f);break}L.dense?(U[de[0].r]||(U[de[0].r]=[]),U[de[0].r][de[0].c]=de[1]):U[Be(de[0])]=de[1];break}},L);else if(E[2]==26||E[2]==14)L.Enum=te,E[2]==14&&(L.qpro=!0,E.l=0),e(E,function(de,xt,Zt){switch(Zt){case 204:ee=de;break;case 22:de[1].v=de[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(de[3]>xe&&(U["!ref"]=ct(Se),G[ee]=U,J.push(ee),U=L.dense?[]:{},Se={s:{r:0,c:0},e:{r:0,c:0}},xe=de[3],ee="Sheet"+(xe+1)),se>0&&de[0].r>=se)break;L.dense?(U[de[0].r]||(U[de[0].r]=[]),U[de[0].r][de[0].c]=de[1]):U[Be(de[0])]=de[1],Se.e.c<de[0].c&&(Se.e.c=de[0].c),Se.e.r<de[0].r&&(Se.e.r=de[0].r);break;case 27:de[14e3]&&(ve[de[14e3][0]]=de[14e3][1]);break;case 1537:ve[de[0]]=de[1],de[0]==xe&&(ee=de[1]);break}},L);else throw new Error("Unrecognized LOTUS BOF "+E[2]);if(U["!ref"]=ct(Se),G[he||ee]=U,J.push(he||ee),!ve.length)return{SheetNames:J,Sheets:G};for(var pe={},Ae=[],_e=0;_e<ve.length;++_e)G[J[_e]]?(Ae.push(ve[_e]||J[_e]),pe[ve[_e]]=G[ve[_e]]||G[J[_e]]):(Ae.push(ve[_e]),pe[ve[_e]]={"!ref":"A1"});return{SheetNames:Ae,Sheets:pe}}function n(E,B){var L=B||{};if(+L.codepage>=0&&Si(+L.codepage),L.type=="string")throw new Error("Cannot write WK1 to JS string");var U=Jt(),ee=Xe(E["!ref"]),he=Array.isArray(E),xe=[];ce(U,0,i(1030)),ce(U,6,c(ee));for(var G=Math.min(ee.e.r,8191),J=ee.s.r;J<=G;++J)for(var ve=Tt(J),Se=ee.s.c;Se<=ee.e.c;++Se){J===ee.s.r&&(xe[Se]=Rt(Se));var se=xe[Se]+ve,pe=he?(E[J]||[])[Se]:E[se];if(!(!pe||pe.t=="z"))if(pe.t=="n")(pe.v|0)==pe.v&&pe.v>=-32768&&pe.v<=32767?ce(U,13,m(J,Se,pe.v)):ce(U,14,x(J,Se,pe.v));else{var Ae=hn(pe);ce(U,15,f(J,Se,Ae.slice(0,239)))}}return ce(U,1),U.end()}function a(E,B){var L=B||{};if(+L.codepage>=0&&Si(+L.codepage),L.type=="string")throw new Error("Cannot write WK3 to JS string");var U=Jt();ce(U,0,l(E));for(var ee=0,he=0;ee<E.SheetNames.length;++ee)(E.Sheets[E.SheetNames[ee]]||{})["!ref"]&&ce(U,27,k(E.SheetNames[ee],he++));var xe=0;for(ee=0;ee<E.SheetNames.length;++ee){var G=E.Sheets[E.SheetNames[ee]];if(!(!G||!G["!ref"])){for(var J=Xe(G["!ref"]),ve=Array.isArray(G),Se=[],se=Math.min(J.e.r,8191),pe=J.s.r;pe<=se;++pe)for(var Ae=Tt(pe),_e=J.s.c;_e<=J.e.c;++_e){pe===J.s.r&&(Se[_e]=Rt(_e));var de=Se[_e]+Ae,xt=ve?(G[pe]||[])[_e]:G[de];if(!(!xt||xt.t=="z"))if(xt.t=="n")ce(U,23,I(pe,_e,xe,xt.v));else{var Zt=hn(xt);ce(U,22,j(pe,_e,xe,Zt.slice(0,239)))}}++xe}}return ce(U,1),U.end()}function i(E){var B=Q(2);return B.write_shift(2,E),B}function l(E){var B=Q(26);B.write_shift(2,4096),B.write_shift(2,4),B.write_shift(4,0);for(var L=0,U=0,ee=0,he=0;he<E.SheetNames.length;++he){var xe=E.SheetNames[he],G=E.Sheets[xe];if(!(!G||!G["!ref"])){++ee;var J=cr(G["!ref"]);L<J.e.r&&(L=J.e.r),U<J.e.c&&(U=J.e.c)}}return L>8191&&(L=8191),B.write_shift(2,L),B.write_shift(1,ee),B.write_shift(1,U),B.write_shift(2,0),B.write_shift(2,0),B.write_shift(1,1),B.write_shift(1,2),B.write_shift(4,0),B.write_shift(4,0),B}function o(E,B,L){var U={s:{c:0,r:0},e:{c:0,r:0}};return B==8&&L.qpro?(U.s.c=E.read_shift(1),E.l++,U.s.r=E.read_shift(2),U.e.c=E.read_shift(1),E.l++,U.e.r=E.read_shift(2),U):(U.s.c=E.read_shift(2),U.s.r=E.read_shift(2),B==12&&L.qpro&&(E.l+=2),U.e.c=E.read_shift(2),U.e.r=E.read_shift(2),B==12&&L.qpro&&(E.l+=2),U.s.c==65535&&(U.s.c=U.e.c=U.s.r=U.e.r=0),U)}function c(E){var B=Q(8);return B.write_shift(2,E.s.c),B.write_shift(2,E.s.r),B.write_shift(2,E.e.c),B.write_shift(2,E.e.r),B}function d(E,B,L){var U=[{c:0,r:0},{t:"n",v:0},0,0];return L.qpro&&L.vers!=20768?(U[0].c=E.read_shift(1),U[3]=E.read_shift(1),U[0].r=E.read_shift(2),E.l+=2):(U[2]=E.read_shift(1),U[0].c=E.read_shift(2),U[0].r=E.read_shift(2)),U}function u(E,B,L){var U=E.l+B,ee=d(E,B,L);if(ee[1].t="s",L.vers==20768){E.l++;var he=E.read_shift(1);return ee[1].v=E.read_shift(he,"utf8"),ee}return L.qpro&&E.l++,ee[1].v=E.read_shift(U-E.l,"cstr"),ee}function f(E,B,L){var U=Q(7+L.length);U.write_shift(1,255),U.write_shift(2,B),U.write_shift(2,E),U.write_shift(1,39);for(var ee=0;ee<U.length;++ee){var he=L.charCodeAt(ee);U.write_shift(1,he>=128?95:he)}return U.write_shift(1,0),U}function h(E,B,L){var U=d(E,B,L);return U[1].v=E.read_shift(2,"i"),U}function m(E,B,L){var U=Q(7);return U.write_shift(1,255),U.write_shift(2,B),U.write_shift(2,E),U.write_shift(2,L,"i"),U}function v(E,B,L){var U=d(E,B,L);return U[1].v=E.read_shift(8,"f"),U}function x(E,B,L){var U=Q(13);return U.write_shift(1,255),U.write_shift(2,B),U.write_shift(2,E),U.write_shift(8,L,"f"),U}function y(E,B,L){var U=E.l+B,ee=d(E,B,L);if(ee[1].v=E.read_shift(8,"f"),L.qpro)E.l=U;else{var he=E.read_shift(2);b(E.slice(E.l,E.l+he),ee),E.l+=he}return ee}function p(E,B,L){var U=B&32768;return B&=-32769,B=(U?E:0)+(B>=8192?B-16384:B),(U?"":"$")+(L?Rt(B):Tt(B))}var g={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},w=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function b(E,B){rr(E,0);for(var L=[],U=0,ee="",he="",xe="",G="";E.l<E.length;){var J=E[E.l++];switch(J){case 0:L.push(E.read_shift(8,"f"));break;case 1:he=p(B[0].c,E.read_shift(2),!0),ee=p(B[0].r,E.read_shift(2),!1),L.push(he+ee);break;case 2:{var ve=p(B[0].c,E.read_shift(2),!0),Se=p(B[0].r,E.read_shift(2),!1);he=p(B[0].c,E.read_shift(2),!0),ee=p(B[0].r,E.read_shift(2),!1),L.push(ve+Se+":"+he+ee)}break;case 3:if(E.l<E.length){console.error("WK1 premature formula end");return}break;case 4:L.push("("+L.pop()+")");break;case 5:L.push(E.read_shift(2));break;case 6:{for(var se="";J=E[E.l++];)se+=String.fromCharCode(J);L.push('"'+se.replace(/"/g,'""')+'"')}break;case 8:L.push("-"+L.pop());break;case 23:L.push("+"+L.pop());break;case 22:L.push("NOT("+L.pop()+")");break;case 20:case 21:G=L.pop(),xe=L.pop(),L.push(["AND","OR"][J-20]+"("+xe+","+G+")");break;default:if(J<32&&w[J])G=L.pop(),xe=L.pop(),L.push(xe+w[J]+G);else if(g[J]){if(U=g[J][1],U==69&&(U=E[E.l++]),U>L.length){console.error("WK1 bad formula parse 0x"+J.toString(16)+":|"+L.join("|")+"|");return}var pe=L.slice(-U);L.length-=U,L.push(g[J][0]+"("+pe.join(",")+")")}else return J<=7?console.error("WK1 invalid opcode "+J.toString(16)):J<=24?console.error("WK1 unsupported op "+J.toString(16)):J<=30?console.error("WK1 invalid opcode "+J.toString(16)):J<=115?console.error("WK1 unsupported function opcode "+J.toString(16)):console.error("WK1 unrecognized opcode "+J.toString(16))}}L.length==1?B[1].f=""+L[0]:console.error("WK1 bad formula parse |"+L.join("|")+"|")}function P(E){var B=[{c:0,r:0},{t:"n",v:0},0];return B[0].r=E.read_shift(2),B[3]=E[E.l++],B[0].c=E[E.l++],B}function M(E,B){var L=P(E);return L[1].t="s",L[1].v=E.read_shift(B-4,"cstr"),L}function j(E,B,L,U){var ee=Q(6+U.length);ee.write_shift(2,E),ee.write_shift(1,L),ee.write_shift(1,B),ee.write_shift(1,39);for(var he=0;he<U.length;++he){var xe=U.charCodeAt(he);ee.write_shift(1,xe>=128?95:xe)}return ee.write_shift(1,0),ee}function O(E,B){var L=P(E);L[1].v=E.read_shift(2);var U=L[1].v>>1;if(L[1].v&1)switch(U&7){case 0:U=(U>>3)*5e3;break;case 1:U=(U>>3)*500;break;case 2:U=(U>>3)/20;break;case 3:U=(U>>3)/200;break;case 4:U=(U>>3)/2e3;break;case 5:U=(U>>3)/2e4;break;case 6:U=(U>>3)/16;break;case 7:U=(U>>3)/64;break}return L[1].v=U,L}function R(E,B){var L=P(E),U=E.read_shift(4),ee=E.read_shift(4),he=E.read_shift(2);if(he==65535)return U===0&&ee===3221225472?(L[1].t="e",L[1].v=15):U===0&&ee===3489660928?(L[1].t="e",L[1].v=42):L[1].v=0,L;var xe=he&32768;return he=(he&32767)-16446,L[1].v=(1-xe*2)*(ee*Math.pow(2,he+32)+U*Math.pow(2,he)),L}function I(E,B,L,U){var ee=Q(14);if(ee.write_shift(2,E),ee.write_shift(1,L),ee.write_shift(1,B),U==0)return ee.write_shift(4,0),ee.write_shift(4,0),ee.write_shift(2,65535),ee;var he=0,xe=0,G=0,J=0;return U<0&&(he=1,U=-U),xe=Math.log2(U)|0,U/=Math.pow(2,xe-31),J=U>>>0,J&2147483648||(U/=2,++xe,J=U>>>0),U-=J,J|=2147483648,J>>>=0,U*=Math.pow(2,32),G=U>>>0,ee.write_shift(4,G),ee.write_shift(4,J),xe+=16383+(he?32768:0),ee.write_shift(2,xe),ee}function D(E,B){var L=R(E);return E.l+=B-14,L}function z(E,B){var L=P(E),U=E.read_shift(4);return L[1].v=U>>6,L}function ne(E,B){var L=P(E),U=E.read_shift(8,"f");return L[1].v=U,L}function Ne(E,B){var L=ne(E);return E.l+=B-10,L}function ue(E,B){return E[E.l+B-1]==0?E.read_shift(B,"cstr"):""}function je(E,B){var L=E[E.l++];L>B-1&&(L=B-1);for(var U="";U.length<L;)U+=String.fromCharCode(E[E.l++]);return U}function q(E,B,L){if(!(!L.qpro||B<21)){var U=E.read_shift(1);E.l+=17,E.l+=1,E.l+=2;var ee=E.read_shift(B-21,"cstr");return[U,ee]}}function W(E,B){for(var L={},U=E.l+B;E.l<U;){var ee=E.read_shift(2);if(ee==14e3){for(L[ee]=[0,""],L[ee][0]=E.read_shift(2);E[E.l];)L[ee][1]+=String.fromCharCode(E[E.l]),E.l++;E.l++}}return L}function k(E,B){var L=Q(5+E.length);L.write_shift(2,14e3),L.write_shift(2,B);for(var U=0;U<E.length;++U){var ee=E.charCodeAt(U);L[L.l++]=ee>127?95:ee}return L[L.l++]=0,L}var K={0:{n:"BOF",f:yg},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:o},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:h},14:{n:"NUMBER",f:v},15:{n:"LABEL",f:u},16:{n:"FORMULA",f:y},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:u},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:ue},222:{n:"SHEETNAMELP",f:je},65535:{n:""}},te={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:M},23:{n:"NUMBER17",f:R},24:{n:"NUMBER18",f:O},25:{n:"FORMULA19",f:D},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:W},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:z},38:{n:"??"},39:{n:"NUMBER27",f:ne},40:{n:"FORMULA28",f:Ne},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:ue},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:q},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:a,to_workbook:t}}(),n4=/^\s|\s$|[\t\n\r]/;function Sg(e,t){if(!t.bookSST)return"";var r=[ut];r[r.length]=oe("sst",null,{xmlns:va[0],count:e.Count,uniqueCount:e.Unique});for(var n=0;n!=e.length;++n)if(e[n]!=null){var a=e[n],i="<si>";a.r?i+=a.r:(i+="<t",a.t||(a.t=""),a.t.match(n4)&&(i+=' xml:space="preserve"'),i+=">"+Le(a.t)+"</t>"),i+="</si>",r[r.length]=i}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function s4(e){return[e.read_shift(4),e.read_shift(4)]}function a4(e,t){return t||(t=Q(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t}var i4=JN;function l4(e){var t=Jt();re(t,159,a4(e));for(var r=0;r<e.length;++r)re(t,19,i4(e[r]));return re(t,160),t.end()}function o4(e){for(var t=[],r=e.split(""),n=0;n<r.length;++n)t[n]=r[n].charCodeAt(0);return t}function _g(e){var t=0,r,n=o4(e),a=n.length+1,i,l,o,c,d;for(r=ps(a),r[0]=n.length,i=1;i!=a;++i)r[i]=n[i-1];for(i=a-1;i>=0;--i)l=r[i],o=t&16384?1:0,c=t<<1&32767,d=o|c,t=d^l;return t^52811}var c4=function(){function e(a,i){switch(i.type){case"base64":return t(fn(a),i);case"binary":return t(a,i);case"buffer":return t(Re&&Buffer.isBuffer(a)?a.toString("binary"):Mi(a),i);case"array":return t(Bo(a),i)}throw new Error("Unrecognized type "+i.type)}function t(a,i){var l=i||{},o=l.dense?[]:{},c=a.match(/\\trowd.*?\\row\b/g);if(!c.length)throw new Error("RTF missing table");var d={s:{c:0,r:0},e:{c:0,r:c.length-1}};return c.forEach(function(u,f){Array.isArray(o)&&(o[f]=[]);for(var h=/\\\w+\b/g,m=0,v,x=-1;v=h.exec(u);){switch(v[0]){case"\\cell":var y=u.slice(m,h.lastIndex-v[0].length);if(y[0]==" "&&(y=y.slice(1)),++x,y.length){var p={v:y,t:"s"};Array.isArray(o)?o[f][x]=p:o[Be({r:f,c:x})]=p}break}m=h.lastIndex}x>d.e.c&&(d.e.c=x)}),o["!ref"]=ct(d),o}function r(a,i){return Ns(e(a,i),i)}function n(a){for(var i=["{\\rtf1\\ansi"],l=Xe(a["!ref"]),o,c=Array.isArray(a),d=l.s.r;d<=l.e.r;++d){i.push("\\trowd\\trautofit1");for(var u=l.s.c;u<=l.e.c;++u)i.push("\\cellx"+(u+1));for(i.push("\\pard\\intbl"),u=l.s.c;u<=l.e.c;++u){var f=Be({r:d,c:u});o=c?(a[d]||[])[u]:a[f],!(!o||o.v==null&&(!o.f||o.F))&&(i.push(" "+(o.w||(hn(o),o.w))),i.push("\\cell"))}i.push("\\pard\\intbl\\row")}return i.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:n}}();function jh(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}var u4=6,ln=u4;function fo(e){return Math.floor((e+Math.round(128/ln)/256)*ln)}function ho(e){return Math.floor((e-5)/ln*100+.5)/100}function Mu(e){return Math.round((e*ln+5)/ln*256)/256}function Q0(e){e.width?(e.wpx=fo(e.width),e.wch=ho(e.wpx),e.MDW=ln):e.wpx?(e.wch=ho(e.wpx),e.width=Mu(e.wch),e.MDW=ln):typeof e.wch=="number"&&(e.width=Mu(e.wch),e.wpx=fo(e.width),e.MDW=ln),e.customWidth&&delete e.customWidth}var d4=96,Eg=d4;function xo(e){return e*96/Eg}function Tg(e){return e*Eg/96}function f4(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var n=r[0];n<=r[1];++n)e[n]!=null&&(t[t.length]=oe("numFmt",null,{numFmtId:n,formatCode:Le(e[n])}))}),t.length===1?"":(t[t.length]="</numFmts>",t[0]=oe("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}function h4(e){var t=[];return t[t.length]=oe("cellXfs",null),e.forEach(function(r){t[t.length]=oe("xf",null,r)}),t[t.length]="</cellXfs>",t.length===2?"":(t[0]=oe("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}function kg(e,t){var r=[ut,oe("styleSheet",null,{xmlns:va[0],"xmlns:vt":pt.vt})],n;return e.SSF&&(n=f4(e.SSF))!=null&&(r[r.length]=n),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=h4(t.cellXfs))&&(r[r.length]=n),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function x4(e,t){var r=e.read_shift(2),n=It(e);return[r,n]}function m4(e,t,r){r||(r=Q(6+4*t.length)),r.write_shift(2,e),yt(t,r);var n=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),n}function p4(e,t,r){var n={};n.sz=e.read_shift(2)/20;var a=nj(e);a.fItalic&&(n.italic=1),a.fCondense&&(n.condense=1),a.fExtend&&(n.extend=1),a.fShadow&&(n.shadow=1),a.fOutline&&(n.outline=1),a.fStrikeout&&(n.strike=1);var i=e.read_shift(2);switch(i===700&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var l=e.read_shift(1);l!=0&&(n.underline=l);var o=e.read_shift(1);o>0&&(n.family=o);var c=e.read_shift(1);switch(c>0&&(n.charset=c),e.l++,n.color=rj(e),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=It(e),n}function g4(e,t){t||(t=Q(25+4*32)),t.write_shift(2,e.sz*20),sj(e,t),t.write_shift(2,e.bold?700:400);var r=0;e.vertAlign=="superscript"?r=1:e.vertAlign=="subscript"&&(r=2),t.write_shift(2,r),t.write_shift(1,e.underline||0),t.write_shift(1,e.family||0),t.write_shift(1,e.charset||0),t.write_shift(1,0),co(e.color,t);var n=0;return n=2,t.write_shift(1,n),yt(e.name,t),t.length>t.l?t.slice(0,t.l):t}var y4=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],kc,v4=Vr;function Sh(e,t){t||(t=Q(4*3+8*7+16*1)),kc||(kc=U0(y4));var r=kc[e.patternType];r==null&&(r=40),t.write_shift(4,r);var n=0;if(r!=40)for(co({auto:1},t),co({auto:1},t);n<12;++n)t.write_shift(4,0);else{for(;n<4;++n)t.write_shift(4,0);for(;n<12;++n)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function w4(e,t){var r=e.l+t,n=e.read_shift(2),a=e.read_shift(2);return e.l=r,{ixfe:n,numFmtId:a}}function Cg(e,t,r){r||(r=Q(16)),r.write_shift(2,t||0),r.write_shift(2,e.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var n=0;return r.write_shift(1,n),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function Da(e,t){return t||(t=Q(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var b4=Vr;function N4(e,t){return t||(t=Q(51)),t.write_shift(1,0),Da(null,t),Da(null,t),Da(null,t),Da(null,t),Da(null,t),t.length>t.l?t.slice(0,t.l):t}function j4(e,t){return t||(t=Q(12+4*10)),t.write_shift(4,e.xfId),t.write_shift(2,1),t.write_shift(1,0),t.write_shift(1,0),oo(e.name||"",t),t.length>t.l?t.slice(0,t.l):t}function S4(e,t,r){var n=Q(2052);return n.write_shift(4,e),oo(t,n),oo(r,n),n.length>n.l?n.slice(0,n.l):n}function _4(e,t){if(t){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)t[a]!=null&&++r}),r!=0&&(re(e,615,Rr(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)t[a]!=null&&re(e,44,m4(a,t[a]))}),re(e,616))}}function E4(e){var t=1;re(e,611,Rr(t)),re(e,43,g4({sz:12,color:{theme:1},name:"Calibri",family:2})),re(e,612)}function T4(e){var t=2;re(e,603,Rr(t)),re(e,45,Sh({patternType:"none"})),re(e,45,Sh({patternType:"gray125"})),re(e,604)}function k4(e){var t=1;re(e,613,Rr(t)),re(e,46,N4()),re(e,614)}function C4(e){var t=1;re(e,626,Rr(t)),re(e,47,Cg({numFmtId:0},65535)),re(e,627)}function A4(e,t){re(e,617,Rr(t.length)),t.forEach(function(r){re(e,47,Cg(r,0))}),re(e,618)}function F4(e){var t=1;re(e,619,Rr(t)),re(e,48,j4({xfId:0,name:"Normal"})),re(e,620)}function P4(e){var t=0;re(e,505,Rr(t)),re(e,506)}function O4(e){var t=0;re(e,508,S4(t,"TableStyleMedium9","PivotStyleMedium4")),re(e,509)}function R4(e,t){var r=Jt();return re(r,278),_4(r,e.SSF),E4(r),T4(r),k4(r),C4(r),A4(r,t.cellXfs),F4(r),P4(r),O4(r),re(r,279),r.end()}function Ag(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var r=[ut];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function I4(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:It(e)}}function D4(e){var t=Q(12+2*e.name.length);return t.write_shift(4,e.flags),t.write_shift(4,e.version),yt(e.name,t),t.slice(0,t.l)}function L4(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function M4(e){var t=Q(4+8*e.length);t.write_shift(4,e.length);for(var r=0;r<e.length;++r)t.write_shift(4,e[r][0]),t.write_shift(4,e[r][1]);return t}function B4(e,t){var r=Q(8+2*t.length);return r.write_shift(4,e),yt(t,r),r.slice(0,r.l)}function U4(e){return e.l+=4,e.read_shift(4)!=0}function z4(e,t){var r=Q(8);return r.write_shift(4,e),r.write_shift(4,1),r}function $4(){var e=Jt();return re(e,332),re(e,334,Rr(1)),re(e,335,D4({name:"XLDAPR",version:12e4,flags:3496657072})),re(e,336),re(e,339,B4(1,"XLDAPR")),re(e,52),re(e,35,Rr(514)),re(e,4096,Rr(0)),re(e,4097,hr(1)),re(e,36),re(e,53),re(e,340),re(e,337,z4(1)),re(e,51,M4([[1,0]])),re(e,338),re(e,333),e.end()}function Fg(){var e=[ut];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function W4(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=Be(r);var n=e.read_shift(1);return n&2&&(t.l="1"),n&8&&(t.a="1"),t}var Vs=1024;function Pg(e,t){for(var r=[21600,21600],n=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),a=[oe("xml",null,{"xmlns:v":nr.v,"xmlns:o":nr.o,"xmlns:x":nr.x,"xmlns:mv":nr.mv}).replace(/\/>/,">"),oe("o:shapelayout",oe("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),oe("v:shapetype",[oe("v:stroke",null,{joinstyle:"miter"}),oe("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:n})];Vs<e*1e3;)Vs+=1e3;return t.forEach(function(i){var l=gt(i[0]),o={color2:"#BEFF82",type:"gradient"};o.type=="gradient"&&(o.angle="-180");var c=o.type=="gradient"?oe("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,d=oe("v:fill",c,o),u={on:"t",obscured:"t"};++Vs,a=a.concat(["<v:shape"+ki({id:"_x0000_s"+Vs,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(i[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",d,oe("v:shadow",null,u),oe("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",_t("x:Anchor",[l.c+1,0,l.r+1,0,l.c+3,20,l.r+5,20].join(",")),_t("x:AutoFill","False"),_t("x:Row",String(l.r)),_t("x:Column",String(l.c)),i[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),a.push("</xml>"),a.join("")}function Og(e){var t=[ut,oe("comments",null,{xmlns:va[0]})],r=[];return t.push("<authors>"),e.forEach(function(n){n[1].forEach(function(a){var i=Le(a.a);r.indexOf(i)==-1&&(r.push(i),t.push("<author>"+i+"</author>")),a.T&&a.ID&&r.indexOf("tc="+a.ID)==-1&&(r.push("tc="+a.ID),t.push("<author>tc="+a.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach(function(n){var a=0,i=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?a=r.indexOf("tc="+n[1][0].ID):n[1].forEach(function(c){c.a&&(a=r.indexOf(Le(c.a))),i.push(c.t||"")}),t.push('<comment ref="'+n[0]+'" authorId="'+a+'"><text>'),i.length<=1)t.push(_t("t",Le(i[0]||"")));else{for(var l=`Comment:
    `+i[0]+`
`,o=1;o<i.length;++o)l+=`Reply:
    `+i[o]+`
`;t.push(_t("t",Le(l)))}t.push("</text></comment>")}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function H4(e,t,r){var n=[ut,oe("ThreadedComments",null,{xmlns:pt.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(a){var i="";(a[1]||[]).forEach(function(l,o){if(!l.T){delete l.ID;return}l.a&&t.indexOf(l.a)==-1&&t.push(l.a);var c={ref:a[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};o==0?i=c.id:c.parentId=i,l.ID=c.id,l.a&&(c.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(l.a)).slice(-12)+"}"),n.push(oe("threadedComment",_t("text",l.t||""),c))})}),n.push("</ThreadedComments>"),n.join("")}function V4(e){var t=[ut,oe("personList",null,{xmlns:pt.TCMNT,"xmlns:x":va[0]}).replace(/[\/]>/,">")];return e.forEach(function(r,n){t.push(oe("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:r,providerId:"None"}))}),t.push("</personList>"),t.join("")}function G4(e){var t={};t.iauthor=e.read_shift(4);var r=Es(e);return t.rfx=r.s,t.ref=Be(r.s),e.l+=16,t}function X4(e,t){return t==null&&(t=Q(36)),t.write_shift(4,e[1].iauthor),ba(e[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}var K4=It;function Y4(e){return yt(e.slice(0,54))}function J4(e){var t=Jt(),r=[];return re(t,628),re(t,630),e.forEach(function(n){n[1].forEach(function(a){r.indexOf(a.a)>-1||(r.push(a.a.slice(0,54)),re(t,632,Y4(a.a)))})}),re(t,631),re(t,633),e.forEach(function(n){n[1].forEach(function(a){a.iauthor=r.indexOf(a.a);var i={s:gt(n[0]),e:gt(n[0])};re(t,635,X4([i,a])),a.t&&a.t.length>0&&re(t,637,QN(a)),re(t,636),delete a.iauthor})}),re(t,634),re(t,629),t.end()}function q4(e,t){t.FullPaths.forEach(function(r,n){if(n!=0){var a=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");a.slice(-1)!=="/"&&Ue.utils.cfb_add(e,a,t.FileIndex[n].content)}})}var Rg=["xlsb","xlsm","xlam","biff8","xla"],Q4=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(n,a,i,l){var o=!1,c=!1;i.length==0?c=!0:i.charAt(0)=="["&&(c=!0,i=i.slice(1,-1)),l.length==0?o=!0:l.charAt(0)=="["&&(o=!0,l=l.slice(1,-1));var d=i.length>0?parseInt(i,10)|0:0,u=l.length>0?parseInt(l,10)|0:0;return o?u+=t.c:--u,c?d+=t.r:--d,a+(o?"":"$")+Rt(u)+(c?"":"$")+Tt(d)}return function(a,i){return t=i,a.replace(e,r)}}(),Z0=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,ed=function(){return function(t,r){return t.replace(Z0,function(n,a,i,l,o,c){var d=X0(l)-(i?0:r.c),u=G0(c)-(o?0:r.r),f=u==0?"":o?u+1:"["+u+"]",h=d==0?"":i?d+1:"["+d+"]";return a+"R"+f+"C"+h})}}();function Z4(e,t){return e.replace(Z0,function(r,n,a,i,l,o){return n+(a=="$"?a+i:Rt(X0(i)+t.c))+(l=="$"?l+o:Tt(G0(o)+t.r))})}function eS(e){return e.length!=1}function it(e){e.l+=1}function Vn(e,t){var r=e.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function Ig(e,t,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return Dg(e);r.biff==12&&(n=4)}var a=e.read_shift(n),i=e.read_shift(n),l=Vn(e),o=Vn(e);return{s:{r:a,c:l[0],cRel:l[1],rRel:l[2]},e:{r:i,c:o[0],cRel:o[1],rRel:o[2]}}}function Dg(e){var t=Vn(e),r=Vn(e),n=e.read_shift(1),a=e.read_shift(1);return{s:{r:t[0],c:n,cRel:t[1],rRel:t[2]},e:{r:r[0],c:a,cRel:r[1],rRel:r[2]}}}function tS(e,t,r){if(r.biff<8)return Dg(e);var n=e.read_shift(r.biff==12?4:2),a=e.read_shift(r.biff==12?4:2),i=Vn(e),l=Vn(e);return{s:{r:n,c:i[0],cRel:i[1],rRel:i[2]},e:{r:a,c:l[0],cRel:l[1],rRel:l[2]}}}function Lg(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return rS(e);var n=e.read_shift(r&&r.biff==12?4:2),a=Vn(e);return{r:n,c:a[0],cRel:a[1],rRel:a[2]}}function rS(e){var t=Vn(e),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function nS(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function sS(e,t,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return aS(e);var a=e.read_shift(n>=12?4:2),i=e.read_shift(2),l=(i&16384)>>14,o=(i&32768)>>15;if(i&=16383,o==1)for(;a>524287;)a-=1048576;if(l==1)for(;i>8191;)i=i-16384;return{r:a,c:i,cRel:l,rRel:o}}function aS(e){var t=e.read_shift(2),r=e.read_shift(1),n=(t&32768)>>15,a=(t&16384)>>14;return t&=16383,n==1&&t>=8192&&(t=t-16384),a==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:a,rRel:n}}function iS(e,t,r){var n=(e[e.l++]&96)>>5,a=Ig(e,r.biff>=2&&r.biff<=5?6:8,r);return[n,a]}function lS(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2,"i"),i=8;if(r)switch(r.biff){case 5:e.l+=12,i=6;break;case 12:i=12;break}var l=Ig(e,i,r);return[n,a,l]}function oS(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function cS(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2),i=8;if(r)switch(r.biff){case 5:e.l+=12,i=6;break;case 12:i=12;break}return e.l+=i,[n,a]}function uS(e,t,r){var n=(e[e.l++]&96)>>5,a=tS(e,t-1,r);return[n,a]}function dS(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[n]}function _h(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function fS(e,t,r){e.l+=2;for(var n=e.read_shift(r&&r.biff==2?1:2),a=[],i=0;i<=n;++i)a.push(e.read_shift(r&&r.biff==2?1:2));return a}function hS(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function xS(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function mS(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function pS(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[n]}function Mg(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function gS(e){return e.read_shift(2),Mg(e)}function yS(e){return e.read_shift(2),Mg(e)}function vS(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=Lg(e,0,r);return[n,a]}function wS(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=sS(e,0,r);return[n,a]}function bS(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var i=Lg(e,0,r);return[n,a,i]}function NS(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=e.read_shift(r&&r.biff<=3?1:2);return[N_[a],zg[a],n]}function jS(e,t,r){var n=e[e.l++],a=e.read_shift(1),i=r&&r.biff<=3?[n==88?-1:0,e.read_shift(1)]:SS(e);return[a,(i[0]===0?zg:b_)[i[1]]]}function SS(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function _S(e,t,r){e.l+=r&&r.biff==2?3:4}function ES(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var n=e.read_shift(2),a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function TS(e){return e.l++,zi[e.read_shift(1)]}function kS(e){return e.l++,e.read_shift(2)}function CS(e){return e.l++,e.read_shift(1)!==0}function AS(e){return e.l++,Na(e)}function FS(e,t,r){return e.l++,wg(e,t-1,r)}function PS(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=bj(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=zi[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=Na(e);break;case 2:r[1]=_j(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function OS(e,t,r){for(var n=e.read_shift(r.biff==12?4:2),a=[],i=0;i!=n;++i)a.push((r.biff==12?Es:kj)(e));return a}function RS(e,t,r){var n=0,a=0;r.biff==12?(n=e.read_shift(4),a=e.read_shift(4)):(a=1+e.read_shift(1),n=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--a==0&&(a=256));for(var i=0,l=[];i!=n&&(l[i]=[]);++i)for(var o=0;o!=a;++o)l[i][o]=PS(e,r.biff);return l}function IS(e,t,r){var n=e.read_shift(1)>>>5&3,a=!r||r.biff>=8?4:2,i=e.read_shift(a);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[n,0,i]}function DS(e,t,r){if(r.biff==5)return LS(e);var n=e.read_shift(1)>>>5&3,a=e.read_shift(2),i=e.read_shift(4);return[n,a,i]}function LS(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[t,r,n]}function MS(e,t,r){var n=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function BS(e,t,r){var n=e.read_shift(1)>>>5&3,a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function US(e,t,r){var n=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[n]}function zS(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2),i=4;if(r)switch(r.biff){case 5:i=15;break;case 12:i=6;break}return e.l+=i,[n,a]}var $S=Vr,WS=Vr,HS=Vr;function $i(e,t,r){return e.l+=2,[nS(e)]}function td(e){return e.l+=6,[]}var VS=$i,GS=td,XS=td,KS=$i;function Bg(e){return e.l+=2,[yg(e),e.read_shift(2)&1]}var YS=$i,JS=Bg,qS=td,QS=$i,ZS=$i,e_=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function t_(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),a=e.read_shift(2),i=e.read_shift(2),l=e_[r>>2&31];return{ixti:t,coltype:r&3,rt:l,idx:n,c:a,C:i}}function r_(e){return e.l+=2,[e.read_shift(4)]}function n_(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function s_(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function a_(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function i_(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function l_(e){return e.l+=4,[0,0]}var Eh={1:{n:"PtgExp",f:ES},2:{n:"PtgTbl",f:HS},3:{n:"PtgAdd",f:it},4:{n:"PtgSub",f:it},5:{n:"PtgMul",f:it},6:{n:"PtgDiv",f:it},7:{n:"PtgPower",f:it},8:{n:"PtgConcat",f:it},9:{n:"PtgLt",f:it},10:{n:"PtgLe",f:it},11:{n:"PtgEq",f:it},12:{n:"PtgGe",f:it},13:{n:"PtgGt",f:it},14:{n:"PtgNe",f:it},15:{n:"PtgIsect",f:it},16:{n:"PtgUnion",f:it},17:{n:"PtgRange",f:it},18:{n:"PtgUplus",f:it},19:{n:"PtgUminus",f:it},20:{n:"PtgPercent",f:it},21:{n:"PtgParen",f:it},22:{n:"PtgMissArg",f:it},23:{n:"PtgStr",f:FS},26:{n:"PtgSheet",f:n_},27:{n:"PtgEndSheet",f:s_},28:{n:"PtgErr",f:TS},29:{n:"PtgBool",f:CS},30:{n:"PtgInt",f:kS},31:{n:"PtgNum",f:AS},32:{n:"PtgArray",f:dS},33:{n:"PtgFunc",f:NS},34:{n:"PtgFuncVar",f:jS},35:{n:"PtgName",f:IS},36:{n:"PtgRef",f:vS},37:{n:"PtgArea",f:iS},38:{n:"PtgMemArea",f:MS},39:{n:"PtgMemErr",f:$S},40:{n:"PtgMemNoMem",f:WS},41:{n:"PtgMemFunc",f:BS},42:{n:"PtgRefErr",f:US},43:{n:"PtgAreaErr",f:oS},44:{n:"PtgRefN",f:wS},45:{n:"PtgAreaN",f:uS},46:{n:"PtgMemAreaN",f:a_},47:{n:"PtgMemNoMemN",f:i_},57:{n:"PtgNameX",f:DS},58:{n:"PtgRef3d",f:bS},59:{n:"PtgArea3d",f:lS},60:{n:"PtgRefErr3d",f:zS},61:{n:"PtgAreaErr3d",f:cS},255:{}},o_={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},c_={1:{n:"PtgElfLel",f:Bg},2:{n:"PtgElfRw",f:QS},3:{n:"PtgElfCol",f:VS},6:{n:"PtgElfRwV",f:ZS},7:{n:"PtgElfColV",f:KS},10:{n:"PtgElfRadical",f:YS},11:{n:"PtgElfRadicalS",f:qS},13:{n:"PtgElfColS",f:GS},15:{n:"PtgElfColSV",f:XS},16:{n:"PtgElfRadicalLel",f:JS},25:{n:"PtgList",f:t_},29:{n:"PtgSxName",f:r_},255:{}},u_={0:{n:"PtgAttrNoop",f:l_},1:{n:"PtgAttrSemi",f:pS},2:{n:"PtgAttrIf",f:xS},4:{n:"PtgAttrChoose",f:fS},8:{n:"PtgAttrGoto",f:hS},16:{n:"PtgAttrSum",f:_S},32:{n:"PtgAttrBaxcel",f:_h},33:{n:"PtgAttrBaxcel",f:_h},64:{n:"PtgAttrSpace",f:gS},65:{n:"PtgAttrSpaceSemi",f:yS},128:{n:"PtgAttrIfError",f:mS},255:{}};function d_(e,t,r,n){if(n.biff<8)return Vr(e,t);for(var a=e.l+t,i=[],l=0;l!==r.length;++l)switch(r[l][0]){case"PtgArray":r[l][1]=RS(e,0,n),i.push(r[l][1]);break;case"PtgMemArea":r[l][2]=OS(e,r[l][1],n),i.push(r[l][2]);break;case"PtgExp":n&&n.biff==12&&(r[l][1][1]=e.read_shift(4),i.push(r[l][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[l][0]}return t=a-e.l,t!==0&&i.push(Vr(e,t)),i}function f_(e,t,r){for(var n=e.l+t,a,i,l=[];n!=e.l;)t=n-e.l,i=e[e.l],a=Eh[i]||Eh[o_[i]],(i===24||i===25)&&(a=(i===24?c_:u_)[e[e.l+1]]),!a||!a.f?Vr(e,t):l.push([a.n,a.f(e,t,r)]);return l}function h_(e){for(var t=[],r=0;r<e.length;++r){for(var n=e[r],a=[],i=0;i<n.length;++i){var l=n[i];if(l)switch(l[0]){case 2:a.push('"'+l[1].replace(/"/g,'""')+'"');break;default:a.push(l[1])}else a.push("")}t.push(a.join(","))}return t.join(";")}var x_={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function m_(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function Ug(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!n)return"SH33TJSERR1";var a="";if(r.biff>8)switch(e[n[0]][0]){case 357:return a=n[1]==-1?"#REF":e.SheetNames[n[1]],n[1]==n[2]?a:a+":"+e.SheetNames[n[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[n[0]][0];case 355:default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return a=n[1]==-1?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?a:a+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map(function(i){return i.Name}).join(";;");default:return e[n[0]][0][3]?(a=n[1]==-1?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?a:a+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function Th(e,t,r){var n=Ug(e,t,r);return n=="#REF"?n:m_(n,r)}function fa(e,t,r,n,a){var i=a&&a.biff||8,l={s:{c:0,r:0}},o=[],c,d,u,f=0,h=0,m,v="";if(!e[0]||!e[0][0])return"";for(var x=-1,y="",p=0,g=e[0].length;p<g;++p){var w=e[0][p];switch(w[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(c=o.pop(),d=o.pop(),x>=0){switch(e[0][x][1][0]){case 0:y=rt(" ",e[0][x][1][1]);break;case 1:y=rt("\r",e[0][x][1][1]);break;default:if(y="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][x][1][0])}d=d+y,x=-1}o.push(d+x_[w[0]]+c);break;case"PtgIsect":c=o.pop(),d=o.pop(),o.push(d+" "+c);break;case"PtgUnion":c=o.pop(),d=o.pop(),o.push(d+","+c);break;case"PtgRange":c=o.pop(),d=o.pop(),o.push(d+":"+c);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":u=ti(w[1][1],l,a),o.push(ri(u,i));break;case"PtgRefN":u=r?ti(w[1][1],r,a):w[1][1],o.push(ri(u,i));break;case"PtgRef3d":f=w[1][1],u=ti(w[1][2],l,a),v=Th(n,f,a),o.push(v+"!"+ri(u,i));break;case"PtgFunc":case"PtgFuncVar":var b=w[1][0],P=w[1][1];b||(b=0),b&=127;var M=b==0?[]:o.slice(-b);o.length-=b,P==="User"&&(P=M.shift()),o.push(P+"("+M.join(",")+")");break;case"PtgBool":o.push(w[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(w[1]);break;case"PtgNum":o.push(String(w[1]));break;case"PtgStr":o.push('"'+w[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(w[1]);break;case"PtgAreaN":m=dh(w[1][1],r?{s:r}:l,a),o.push(Ec(m,a));break;case"PtgArea":m=dh(w[1][1],l,a),o.push(Ec(m,a));break;case"PtgArea3d":f=w[1][1],m=w[1][2],v=Th(n,f,a),o.push(v+"!"+Ec(m,a));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":h=w[1][2];var j=(n.names||[])[h-1]||(n[0]||[])[h],O=j?j.Name:"SH33TJSNAME"+String(h);O&&O.slice(0,6)=="_xlfn."&&!a.xlfn&&(O=O.slice(6)),o.push(O);break;case"PtgNameX":var R=w[1][1];h=w[1][2];var I;if(a.biff<=5)R<0&&(R=-R),n[R]&&(I=n[R][h]);else{var D="";if(((n[R]||[])[0]||[])[0]==14849||(((n[R]||[])[0]||[])[0]==1025?n[R][h]&&n[R][h].itab>0&&(D=n.SheetNames[n[R][h].itab-1]+"!"):D=n.SheetNames[h-1]+"!"),n[R]&&n[R][h])D+=n[R][h].Name;else if(n[0]&&n[0][h])D+=n[0][h].Name;else{var z=(Ug(n,R,a)||"").split(";;");z[h-1]?D=z[h-1]:D+="SH33TJSERRX"}o.push(D);break}I||(I={Name:"SH33TJSERRY"}),o.push(I.Name);break;case"PtgParen":var ne="(",Ne=")";if(x>=0){switch(y="",e[0][x][1][0]){case 2:ne=rt(" ",e[0][x][1][1])+ne;break;case 3:ne=rt("\r",e[0][x][1][1])+ne;break;case 4:Ne=rt(" ",e[0][x][1][1])+Ne;break;case 5:Ne=rt("\r",e[0][x][1][1])+Ne;break;default:if(a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][x][1][0])}x=-1}o.push(ne+o.pop()+Ne);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":u={c:w[1][1],r:w[1][0]};var ue={c:r.c,r:r.r};if(n.sharedf[Be(u)]){var je=n.sharedf[Be(u)];o.push(fa(je,l,ue,n,a))}else{var q=!1;for(c=0;c!=n.arrayf.length;++c)if(d=n.arrayf[c],!(u.c<d[0].s.c||u.c>d[0].e.c)&&!(u.r<d[0].s.r||u.r>d[0].e.r)){o.push(fa(d[1],l,ue,n,a)),q=!0;break}q||o.push(w[1])}break;case"PtgArray":o.push("{"+h_(w[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":x=p;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+w[1].idx+"[#"+w[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(w));default:throw new Error("Unrecognized Formula Token: "+String(w))}var W=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(a.biff!=3&&x>=0&&W.indexOf(e[0][p][0])==-1){w=e[0][x];var k=!0;switch(w[1][0]){case 4:k=!1;case 0:y=rt(" ",w[1][1]);break;case 5:k=!1;case 1:y=rt("\r",w[1][1]);break;default:if(y="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+w[1][0])}o.push((k?y:"")+o.pop()+(k?"":y)),x=-1}}if(o.length>1&&a.WTF)throw new Error("bad formula stack");return o[0]}function p_(e){if(e==null){var t=Q(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}else if(typeof e=="number")return gs(e);return gs(0)}function g_(e,t,r,n,a){var i=ys(t,r,a),l=p_(e.v),o=Q(6),c=33;o.write_shift(2,c),o.write_shift(4,0);for(var d=Q(e.bf.length),u=0;u<e.bf.length;++u)d[u]=e.bf[u];var f=St([i,l,o,d]);return f}function Uo(e,t,r){var n=e.read_shift(4),a=f_(e,n,r),i=e.read_shift(4),l=i>0?d_(e,i,a,r):null;return[a,l]}var y_=Uo,zo=Uo,v_=Uo,w_=Uo,b_={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},zg={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},N_={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function j_(e){var t="of:="+e.replace(Z0,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return t.replace(/;/g,"|").replace(/,/g,";")}function S_(e){return e.replace(/\./,"!")}var ni=typeof Map<"u";function rd(e,t,r){var n=0,a=e.length;if(r){if(ni?r.has(t):Object.prototype.hasOwnProperty.call(r,t)){for(var i=ni?r.get(t):r[t];n<i.length;++n)if(e[i[n]].t===t)return e.Count++,i[n]}}else for(;n<a;++n)if(e[n].t===t)return e.Count++,n;return e[a]={t},e.Count++,e.Unique++,r&&(ni?(r.has(t)||r.set(t,[]),r.get(t).push(a)):(Object.prototype.hasOwnProperty.call(r,t)||(r[t]=[]),r[t].push(a))),a}function $o(e,t){var r={min:e+1,max:e+1},n=-1;return t.MDW&&(ln=t.MDW),t.width!=null?r.customWidth=1:t.wpx!=null?n=ho(t.wpx):t.wch!=null&&(n=t.wch),n>-1?(r.width=Mu(n),r.customWidth=1):t.width!=null&&(r.width=t.width),t.hidden&&(r.hidden=!0),t.level!=null&&(r.outlineLevel=r.level=t.level),r}function $g(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function Qn(e,t,r){var n=r.revssf[t.z!=null?t.z:"General"],a=60,i=e.length;if(n==null&&r.ssf){for(;a<392;++a)if(r.ssf[a]==null){Lp(t.z,a),r.ssf[a]=t.z,r.revssf[t.z]=n=a;break}}for(a=0;a!=i;++a)if(e[a].numFmtId===n)return a;return e[i]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},i}function __(e,t,r){if(e&&e["!ref"]){var n=Xe(e["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+r+"): "+e["!ref"])}}function E_(e){if(e.length===0)return"";for(var t='<mergeCells count="'+e.length+'">',r=0;r!=e.length;++r)t+='<mergeCell ref="'+ct(e[r])+'"/>';return t+"</mergeCells>"}function T_(e,t,r,n,a){var i=!1,l={},o=null;if(n.bookType!=="xlsx"&&t.vbaraw){var c=t.SheetNames[r];try{t.Workbook&&(c=t.Workbook.Sheets[r].CodeName||c)}catch{}i=!0,l.codeName=Ti(Le(c))}if(e&&e["!outline"]){var d={summaryBelow:1,summaryRight:1};e["!outline"].above&&(d.summaryBelow=0),e["!outline"].left&&(d.summaryRight=0),o=(o||"")+oe("outlinePr",null,d)}!i&&!o||(a[a.length]=oe("sheetPr",o,l))}var k_=["objects","scenarios","selectLockedCells","selectUnlockedCells"],C_=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function A_(e){var t={sheet:1};return k_.forEach(function(r){e[r]!=null&&e[r]&&(t[r]="1")}),C_.forEach(function(r){e[r]!=null&&!e[r]&&(t[r]="0")}),e.password&&(t.password=_g(e.password).toString(16).toUpperCase()),oe("sheetProtection",null,t)}function F_(e){return $g(e),oe("pageMargins",null,e)}function P_(e,t){for(var r=["<cols>"],n,a=0;a!=t.length;++a)(n=t[a])&&(r[r.length]=oe("col",null,$o(a,n)));return r[r.length]="</cols>",r.join("")}function O_(e,t,r,n){var a=typeof e.ref=="string"?e.ref:ct(e.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var i=r.Workbook.Names,l=cr(a);l.s.r==l.e.r&&(l.e.r=cr(t["!ref"]).e.r,a=ct(l));for(var o=0;o<i.length;++o){var c=i[o];if(c.Name=="_xlnm._FilterDatabase"&&c.Sheet==n){c.Ref="'"+r.SheetNames[n]+"'!"+a;break}}return o==i.length&&i.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+a}),oe("autoFilter",null,{ref:a})}function R_(e,t,r,n){var a={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(a.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),oe("sheetViews",oe("sheetView",null,a),{})}function I_(e,t,r,n){if(e.c&&r["!comments"].push([t,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var a="",i=e.t,l=e.v;if(e.t!=="z")switch(e.t){case"b":a=e.v?"1":"0";break;case"n":a=""+e.v;break;case"e":a=zi[e.v];break;case"d":n&&n.cellDates?a=zt(e.v,-1).toISOString():(e=Qt(e),e.t="n",a=""+(e.v=qt(zt(e.v)))),typeof e.z>"u"&&(e.z=nt[14]);break;default:a=e.v;break}var o=_t("v",Le(a)),c={r:t},d=Qn(n.cellXfs,e,n);switch(d!==0&&(c.s=d),e.t){case"n":break;case"d":c.t="d";break;case"b":c.t="b";break;case"e":c.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){o=_t("v",""+rd(n.Strings,e.v,n.revStrings)),c.t="s";break}c.t="str";break}if(e.t!=i&&(e.t=i,e.v=l),typeof e.f=="string"&&e.f){var u=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;o=oe("f",Le(e.f),u)+(e.v!=null?o:"")}return e.l&&r["!links"].push([t,e.l]),e.D&&(c.cm=1),oe("c",o,c)}function D_(e,t,r,n){var a=[],i=[],l=Xe(e["!ref"]),o="",c,d="",u=[],f=0,h=0,m=e["!rows"],v=Array.isArray(e),x={r:d},y,p=-1;for(h=l.s.c;h<=l.e.c;++h)u[h]=Rt(h);for(f=l.s.r;f<=l.e.r;++f){for(i=[],d=Tt(f),h=l.s.c;h<=l.e.c;++h){c=u[h]+d;var g=v?(e[f]||[])[h]:e[c];g!==void 0&&(o=I_(g,c,e,t))!=null&&i.push(o)}(i.length>0||m&&m[f])&&(x={r:d},m&&m[f]&&(y=m[f],y.hidden&&(x.hidden=1),p=-1,y.hpx?p=xo(y.hpx):y.hpt&&(p=y.hpt),p>-1&&(x.ht=p,x.customHeight=1),y.level&&(x.outlineLevel=y.level)),a[a.length]=oe("row",i.join(""),x))}if(m)for(;f<m.length;++f)m&&m[f]&&(x={r:f+1},y=m[f],y.hidden&&(x.hidden=1),p=-1,y.hpx?p=xo(y.hpx):y.hpt&&(p=y.hpt),p>-1&&(x.ht=p,x.customHeight=1),y.level&&(x.outlineLevel=y.level),a[a.length]=oe("row","",x));return a.join("")}function Wg(e,t,r,n){var a=[ut,oe("worksheet",null,{xmlns:va[0],"xmlns:r":pt.r})],i=r.SheetNames[e],l=0,o="",c=r.Sheets[i];c==null&&(c={});var d=c["!ref"]||"A1",u=Xe(d);if(u.e.c>16383||u.e.r>1048575){if(t.WTF)throw new Error("Range "+d+" exceeds format limit A1:XFD1048576");u.e.c=Math.min(u.e.c,16383),u.e.r=Math.min(u.e.c,1048575),d=ct(u)}n||(n={}),c["!comments"]=[];var f=[];T_(c,r,e,t,a),a[a.length]=oe("dimension",null,{ref:d}),a[a.length]=R_(c,t,e,r),t.sheetFormat&&(a[a.length]=oe("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),c["!cols"]!=null&&c["!cols"].length>0&&(a[a.length]=P_(c,c["!cols"])),a[l=a.length]="<sheetData/>",c["!links"]=[],c["!ref"]!=null&&(o=D_(c,t),o.length>0&&(a[a.length]=o)),a.length>l+1&&(a[a.length]="</sheetData>",a[l]=a[l].replace("/>",">")),c["!protect"]&&(a[a.length]=A_(c["!protect"])),c["!autofilter"]!=null&&(a[a.length]=O_(c["!autofilter"],c,r,e)),c["!merges"]!=null&&c["!merges"].length>0&&(a[a.length]=E_(c["!merges"]));var h=-1,m,v=-1;return c["!links"].length>0&&(a[a.length]="<hyperlinks>",c["!links"].forEach(function(x){x[1].Target&&(m={ref:x[0]},x[1].Target.charAt(0)!="#"&&(v=De(n,-1,Le(x[1].Target).replace(/#.*$/,""),Oe.HLINK),m["r:id"]="rId"+v),(h=x[1].Target.indexOf("#"))>-1&&(m.location=Le(x[1].Target.slice(h+1))),x[1].Tooltip&&(m.tooltip=Le(x[1].Tooltip)),a[a.length]=oe("hyperlink",null,m))}),a[a.length]="</hyperlinks>"),delete c["!links"],c["!margins"]!=null&&(a[a.length]=F_(c["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&(a[a.length]=_t("ignoredErrors",oe("ignoredError",null,{numberStoredAsText:1,sqref:d}))),f.length>0&&(v=De(n,-1,"../drawings/drawing"+(e+1)+".xml",Oe.DRAW),a[a.length]=oe("drawing",null,{"r:id":"rId"+v}),c["!drawing"]=f),c["!comments"].length>0&&(v=De(n,-1,"../drawings/vmlDrawing"+(e+1)+".vml",Oe.VML),a[a.length]=oe("legacyDrawing",null,{"r:id":"rId"+v}),c["!legacy"]=v),a.length>1&&(a[a.length]="</worksheet>",a[1]=a[1].replace("/>",">")),a.join("")}function L_(e,t){var r={},n=e.l+t;r.r=e.read_shift(4),e.l+=4;var a=e.read_shift(2);e.l+=1;var i=e.read_shift(1);return e.l=n,i&7&&(r.level=i&7),i&16&&(r.hidden=!0),i&32&&(r.hpt=a/20),r}function M_(e,t,r){var n=Q(145),a=(r["!rows"]||[])[e]||{};n.write_shift(4,e),n.write_shift(4,0);var i=320;a.hpx?i=xo(a.hpx)*20:a.hpt&&(i=a.hpt*20),n.write_shift(2,i),n.write_shift(1,0);var l=0;a.level&&(l|=a.level),a.hidden&&(l|=16),(a.hpx||a.hpt)&&(l|=32),n.write_shift(1,l),n.write_shift(1,0);var o=0,c=n.l;n.l+=4;for(var d={r:e,c:0},u=0;u<16;++u)if(!(t.s.c>u+1<<10||t.e.c<u<<10)){for(var f=-1,h=-1,m=u<<10;m<u+1<<10;++m){d.c=m;var v=Array.isArray(r)?(r[d.r]||[])[d.c]:r[Be(d)];v&&(f<0&&(f=m),h=m)}f<0||(++o,n.write_shift(4,f),n.write_shift(4,h))}var x=n.l;return n.l=c,n.write_shift(4,o),n.l=x,n.length>n.l?n.slice(0,n.l):n}function B_(e,t,r,n){var a=M_(n,r,t);(a.length>17||(t["!rows"]||[])[n])&&re(e,0,a)}var U_=Es,z_=ba;function $_(){}function W_(e,t){var r={},n=e[e.l];return++e.l,r.above=!(n&64),r.left=!(n&128),e.l+=18,r.name=ZN(e),r}function H_(e,t,r){r==null&&(r=Q(84+4*e.length));var n=192;t&&(t.above&&(n&=-65),t.left&&(n&=-129)),r.write_shift(1,n);for(var a=1;a<3;++a)r.write_shift(1,0);return co({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),sg(e,r),r.slice(0,r.l)}function V_(e){var t=jr(e);return[t]}function G_(e,t,r){return r==null&&(r=Q(8)),js(t,r)}function X_(e){var t=Ss(e);return[t]}function K_(e,t,r){return r==null&&(r=Q(4)),_s(t,r)}function Y_(e){var t=jr(e),r=e.read_shift(1);return[t,r,"b"]}function J_(e,t,r){return r==null&&(r=Q(9)),js(t,r),r.write_shift(1,e.v?1:0),r}function q_(e){var t=Ss(e),r=e.read_shift(1);return[t,r,"b"]}function Q_(e,t,r){return r==null&&(r=Q(5)),_s(t,r),r.write_shift(1,e.v?1:0),r}function Z_(e){var t=jr(e),r=e.read_shift(1);return[t,r,"e"]}function e3(e,t,r){return r==null&&(r=Q(9)),js(t,r),r.write_shift(1,e.v),r}function t3(e){var t=Ss(e),r=e.read_shift(1);return[t,r,"e"]}function r3(e,t,r){return r==null&&(r=Q(8)),_s(t,r),r.write_shift(1,e.v),r.write_shift(2,0),r.write_shift(1,0),r}function n3(e){var t=jr(e),r=e.read_shift(4);return[t,r,"s"]}function s3(e,t,r){return r==null&&(r=Q(12)),js(t,r),r.write_shift(4,t.v),r}function a3(e){var t=Ss(e),r=e.read_shift(4);return[t,r,"s"]}function i3(e,t,r){return r==null&&(r=Q(8)),_s(t,r),r.write_shift(4,t.v),r}function l3(e){var t=jr(e),r=Na(e);return[t,r,"n"]}function o3(e,t,r){return r==null&&(r=Q(16)),js(t,r),gs(e.v,r),r}function c3(e){var t=Ss(e),r=Na(e);return[t,r,"n"]}function u3(e,t,r){return r==null&&(r=Q(12)),_s(t,r),gs(e.v,r),r}function d3(e){var t=jr(e),r=ag(e);return[t,r,"n"]}function f3(e,t,r){return r==null&&(r=Q(12)),js(t,r),ig(e.v,r),r}function h3(e){var t=Ss(e),r=ag(e);return[t,r,"n"]}function x3(e,t,r){return r==null&&(r=Q(8)),_s(t,r),ig(e.v,r),r}function m3(e){var t=jr(e),r=K0(e);return[t,r,"is"]}function p3(e){var t=jr(e),r=It(e);return[t,r,"str"]}function g3(e,t,r){return r==null&&(r=Q(12+4*e.v.length)),js(t,r),yt(e.v,r),r.length>r.l?r.slice(0,r.l):r}function y3(e){var t=Ss(e),r=It(e);return[t,r,"str"]}function v3(e,t,r){return r==null&&(r=Q(8+4*e.v.length)),_s(t,r),yt(e.v,r),r.length>r.l?r.slice(0,r.l):r}function w3(e,t,r){var n=e.l+t,a=jr(e);a.r=r["!row"];var i=e.read_shift(1),l=[a,i,"b"];if(r.cellFormula){e.l+=2;var o=zo(e,n-e.l,r);l[3]=fa(o,null,a,r.supbooks,r)}else e.l=n;return l}function b3(e,t,r){var n=e.l+t,a=jr(e);a.r=r["!row"];var i=e.read_shift(1),l=[a,i,"e"];if(r.cellFormula){e.l+=2;var o=zo(e,n-e.l,r);l[3]=fa(o,null,a,r.supbooks,r)}else e.l=n;return l}function N3(e,t,r){var n=e.l+t,a=jr(e);a.r=r["!row"];var i=Na(e),l=[a,i,"n"];if(r.cellFormula){e.l+=2;var o=zo(e,n-e.l,r);l[3]=fa(o,null,a,r.supbooks,r)}else e.l=n;return l}function j3(e,t,r){var n=e.l+t,a=jr(e);a.r=r["!row"];var i=It(e),l=[a,i,"str"];if(r.cellFormula){e.l+=2;var o=zo(e,n-e.l,r);l[3]=fa(o,null,a,r.supbooks,r)}else e.l=n;return l}var S3=Es,_3=ba;function E3(e,t){return t==null&&(t=Q(4)),t.write_shift(4,e),t}function T3(e,t){var r=e.l+t,n=Es(e),a=Y0(e),i=It(e),l=It(e),o=It(e);e.l=r;var c={rfx:n,relId:a,loc:i,display:o};return l&&(c.Tooltip=l),c}function k3(e,t){var r=Q(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));ba({s:gt(e[0]),e:gt(e[0])},r),J0("rId"+t,r);var n=e[1].Target.indexOf("#"),a=n==-1?"":e[1].Target.slice(n+1);return yt(a||"",r),yt(e[1].Tooltip||"",r),yt("",r),r.slice(0,r.l)}function C3(){}function A3(e,t,r){var n=e.l+t,a=lg(e),i=e.read_shift(1),l=[a];if(l[2]=i,r.cellFormula){var o=y_(e,n-e.l,r);l[1]=o}else e.l=n;return l}function F3(e,t,r){var n=e.l+t,a=Es(e),i=[a];if(r.cellFormula){var l=w_(e,n-e.l,r);i[1]=l,e.l=n}else e.l=n;return i}function P3(e,t,r){r==null&&(r=Q(18));var n=$o(e,t);r.write_shift(-4,e),r.write_shift(-4,e),r.write_shift(4,(n.width||10)*256),r.write_shift(4,0);var a=0;return t.hidden&&(a|=1),typeof n.width=="number"&&(a|=2),t.level&&(a|=t.level<<8),r.write_shift(2,a),r}var Hg=["left","right","top","bottom","header","footer"];function O3(e){var t={};return Hg.forEach(function(r){t[r]=Na(e)}),t}function R3(e,t){return t==null&&(t=Q(6*8)),$g(e),Hg.forEach(function(r){gs(e[r],t)}),t}function I3(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function D3(e,t,r){r==null&&(r=Q(30));var n=924;return(((t||{}).Views||[])[0]||{}).RTL&&(n|=32),r.write_shift(2,n),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function L3(e){var t=Q(24);return t.write_shift(4,4),t.write_shift(4,1),ba(e,t),t}function M3(e,t){return t==null&&(t=Q(16*4+2)),t.write_shift(2,e.password?_g(e.password):0),t.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?t.write_shift(4,e[r[0]]!=null&&!e[r[0]]?1:0):t.write_shift(4,e[r[0]]!=null&&e[r[0]]?0:1)}),t}function B3(){}function U3(){}function z3(e,t,r,n,a,i,l){if(t.v===void 0)return!1;var o="";switch(t.t){case"b":o=t.v?"1":"0";break;case"d":t=Qt(t),t.z=t.z||nt[14],t.v=qt(zt(t.v)),t.t="n";break;case"n":case"e":o=""+t.v;break;default:o=t.v;break}var c={r,c:n};switch(c.s=Qn(a.cellXfs,t,a),t.l&&i["!links"].push([Be(c),t.l]),t.c&&i["!comments"].push([Be(c),t.c]),t.t){case"s":case"str":return a.bookSST?(o=rd(a.Strings,t.v,a.revStrings),c.t="s",c.v=o,l?re(e,18,i3(t,c)):re(e,7,s3(t,c))):(c.t="str",l?re(e,17,v3(t,c)):re(e,6,g3(t,c))),!0;case"n":return t.v==(t.v|0)&&t.v>-1e3&&t.v<1e3?l?re(e,13,x3(t,c)):re(e,2,f3(t,c)):l?re(e,16,u3(t,c)):re(e,5,o3(t,c)),!0;case"b":return c.t="b",l?re(e,15,Q_(t,c)):re(e,4,J_(t,c)),!0;case"e":return c.t="e",l?re(e,14,r3(t,c)):re(e,3,e3(t,c)),!0}return l?re(e,12,K_(t,c)):re(e,1,G_(t,c)),!0}function $3(e,t,r,n){var a=Xe(t["!ref"]||"A1"),i,l="",o=[];re(e,145);var c=Array.isArray(t),d=a.e.r;t["!rows"]&&(d=Math.max(a.e.r,t["!rows"].length-1));for(var u=a.s.r;u<=d;++u){l=Tt(u),B_(e,t,a,u);var f=!1;if(u<=a.e.r)for(var h=a.s.c;h<=a.e.c;++h){u===a.s.r&&(o[h]=Rt(h)),i=o[h]+l;var m=c?(t[u]||[])[h]:t[i];if(!m){f=!1;continue}f=z3(e,m,u,h,n,t,f)}}re(e,146)}function W3(e,t){!t||!t["!merges"]||(re(e,177,E3(t["!merges"].length)),t["!merges"].forEach(function(r){re(e,176,_3(r))}),re(e,178))}function H3(e,t){!t||!t["!cols"]||(re(e,390),t["!cols"].forEach(function(r,n){r&&re(e,60,P3(n,r))}),re(e,391))}function V3(e,t){!t||!t["!ref"]||(re(e,648),re(e,649,L3(Xe(t["!ref"]))),re(e,650))}function G3(e,t,r){t["!links"].forEach(function(n){if(n[1].Target){var a=De(r,-1,n[1].Target.replace(/#.*$/,""),Oe.HLINK);re(e,494,k3(n,a))}}),delete t["!links"]}function X3(e,t,r,n){if(t["!comments"].length>0){var a=De(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",Oe.VML);re(e,551,J0("rId"+a)),t["!legacy"]=a}}function K3(e,t,r,n){if(t["!autofilter"]){var a=t["!autofilter"],i=typeof a.ref=="string"?a.ref:ct(a.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var l=r.Workbook.Names,o=cr(i);o.s.r==o.e.r&&(o.e.r=cr(t["!ref"]).e.r,i=ct(o));for(var c=0;c<l.length;++c){var d=l[c];if(d.Name=="_xlnm._FilterDatabase"&&d.Sheet==n){d.Ref="'"+r.SheetNames[n]+"'!"+i;break}}c==l.length&&l.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+i}),re(e,161,ba(Xe(i))),re(e,162)}}function Y3(e,t,r){re(e,133),re(e,137,D3(t,r)),re(e,138),re(e,134)}function J3(e,t){t["!protect"]&&re(e,535,M3(t["!protect"]))}function q3(e,t,r,n){var a=Jt(),i=r.SheetNames[e],l=r.Sheets[i]||{},o=i;try{r&&r.Workbook&&(o=r.Workbook.Sheets[e].CodeName||o)}catch{}var c=Xe(l["!ref"]||"A1");if(c.e.c>16383||c.e.r>1048575){if(t.WTF)throw new Error("Range "+(l["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");c.e.c=Math.min(c.e.c,16383),c.e.r=Math.min(c.e.c,1048575)}return l["!links"]=[],l["!comments"]=[],re(a,129),(r.vbaraw||l["!outline"])&&re(a,147,H_(o,l["!outline"])),re(a,148,z_(c)),Y3(a,l,r.Workbook),H3(a,l),$3(a,l,e,t),J3(a,l),K3(a,l,r,e),W3(a,l),G3(a,l,n),l["!margins"]&&re(a,476,R3(l["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&V3(a,l),X3(a,l,e,n),re(a,130),a.end()}function Q3(e,t){e.l+=10;var r=It(e);return{name:r}}var Z3=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]];function eE(e){return!e.Workbook||!e.Workbook.WBProps?"false":FN(e.Workbook.WBProps.date1904)?"true":"false"}var tE="][*?/\\".split("");function Vg(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return tE.forEach(function(n){if(e.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function rE(e,t,r){e.forEach(function(n,a){Vg(n);for(var i=0;i<a;++i)if(n==e[i])throw new Error("Duplicate Sheet Name: "+n);if(r){var l=t&&t[a]&&t[a].CodeName||n;if(l.charCodeAt(0)==95&&l.length>22)throw new Error("Bad Code Name: Worksheet"+l)}})}function nE(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t=e.Workbook&&e.Workbook.Sheets||[];rE(e.SheetNames,t,!!e.vbaraw);for(var r=0;r<e.SheetNames.length;++r)__(e.Sheets[e.SheetNames[r]],e.SheetNames[r],r)}function Gg(e){var t=[ut];t[t.length]=oe("workbook",null,{xmlns:va[0],"xmlns:r":pt.r});var r=e.Workbook&&(e.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(Z3.forEach(function(o){e.Workbook.WBProps[o[0]]!=null&&e.Workbook.WBProps[o[0]]!=o[1]&&(n[o[0]]=e.Workbook.WBProps[o[0]])}),e.Workbook.WBProps.CodeName&&(n.codeName=e.Workbook.WBProps.CodeName,delete n.CodeName)),t[t.length]=oe("workbookPr",null,n);var a=e.Workbook&&e.Workbook.Sheets||[],i=0;if(a&&a[0]&&a[0].Hidden){for(t[t.length]="<bookViews>",i=0;i!=e.SheetNames.length&&!(!a[i]||!a[i].Hidden);++i);i==e.SheetNames.length&&(i=0),t[t.length]='<workbookView firstSheet="'+i+'" activeTab="'+i+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",i=0;i!=e.SheetNames.length;++i){var l={name:Le(e.SheetNames[i].slice(0,31))};if(l.sheetId=""+(i+1),l["r:id"]="rId"+(i+1),a[i])switch(a[i].Hidden){case 1:l.state="hidden";break;case 2:l.state="veryHidden";break}t[t.length]=oe("sheet",null,l)}return t[t.length]="</sheets>",r&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(o){var c={name:o.Name};o.Comment&&(c.comment=o.Comment),o.Sheet!=null&&(c.localSheetId=""+o.Sheet),o.Hidden&&(c.hidden="1"),o.Ref&&(t[t.length]=oe("definedName",Le(o.Ref),c))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function sE(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=Lu(e),r.name=It(e),r}function aE(e,t){return t||(t=Q(127)),t.write_shift(4,e.Hidden),t.write_shift(4,e.iTabID),J0(e.strRelID,t),yt(e.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function iE(e,t){var r={},n=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var a=t>8?It(e):"";return a.length>0&&(r.CodeName=a),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function lE(e,t){t||(t=Q(72));var r=0;return e&&e.filterPrivacy&&(r|=8),t.write_shift(4,r),t.write_shift(4,0),sg(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}function oE(e,t,r){var n=e.l+t;e.l+=4,e.l+=1;var a=e.read_shift(4),i=ej(e),l=v_(e,0,r),o=Y0(e);e.l=n;var c={Name:i,Ptg:l};return a<268435455&&(c.Sheet=a),o&&(c.Comment=o),c}function cE(e,t){re(e,143);for(var r=0;r!=t.SheetNames.length;++r){var n=t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[r]&&t.Workbook.Sheets[r].Hidden||0,a={Hidden:n,iTabID:r+1,strRelID:"rId"+(r+1),name:t.SheetNames[r]};re(e,156,aE(a))}re(e,144)}function uE(e,t){t||(t=Q(127));for(var r=0;r!=4;++r)t.write_shift(4,0);return yt("SheetJS",t),yt(to.version,t),yt(to.version,t),yt("7262",t),t.length>t.l?t.slice(0,t.l):t}function dE(e,t){t||(t=Q(29)),t.write_shift(-4,0),t.write_shift(-4,460),t.write_shift(4,28800),t.write_shift(4,17600),t.write_shift(4,500),t.write_shift(4,e),t.write_shift(4,e);var r=120;return t.write_shift(1,r),t.length>t.l?t.slice(0,t.l):t}function fE(e,t){if(!(!t.Workbook||!t.Workbook.Sheets)){for(var r=t.Workbook.Sheets,n=0,a=-1,i=-1;n<r.length;++n)!r[n]||!r[n].Hidden&&a==-1?a=n:r[n].Hidden==1&&i==-1&&(i=n);i>a||(re(e,135),re(e,158,dE(a)),re(e,136))}}function hE(e,t){var r=Jt();return re(r,131),re(r,128,uE()),re(r,153,lE(e.Workbook&&e.Workbook.WBProps||null)),fE(r,e),cE(r,e),re(r,132),r.end()}function xE(e,t,r){return(t.slice(-4)===".bin"?hE:Gg)(e)}function mE(e,t,r,n,a){return(t.slice(-4)===".bin"?q3:Wg)(e,r,n,a)}function pE(e,t,r){return(t.slice(-4)===".bin"?R4:kg)(e,r)}function gE(e,t,r){return(t.slice(-4)===".bin"?l4:Sg)(e,r)}function yE(e,t,r){return(t.slice(-4)===".bin"?J4:Og)(e)}function vE(e){return(e.slice(-4)===".bin"?$4:Fg)()}function wE(e,t){var r=[];return e.Props&&r.push(pj(e.Props,t)),e.Custprops&&r.push(gj(e.Props,e.Custprops)),r.join("")}function bE(){return""}function NE(e,t){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(n,a){var i=[];i.push(oe("NumberFormat",null,{"ss:Format":Le(nt[n.numFmtId])}));var l={"ss:ID":"s"+(21+a)};r.push(oe("Style",i.join(""),l))}),oe("Styles",r.join(""))}function Xg(e){return oe("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+ed(e.Ref,{r:0,c:0})})}function jE(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,r=[],n=0;n<t.length;++n){var a=t[n];a.Sheet==null&&(a.Name.match(/^_xlfn\./)||r.push(Xg(a)))}return oe("Names",r.join(""))}function SE(e,t,r,n){if(!e||!((n||{}).Workbook||{}).Names)return"";for(var a=n.Workbook.Names,i=[],l=0;l<a.length;++l){var o=a[l];o.Sheet==r&&(o.Name.match(/^_xlfn\./)||i.push(Xg(o)))}return i.join("")}function _E(e,t,r,n){if(!e)return"";var a=[];if(e["!margins"]&&(a.push("<PageSetup>"),e["!margins"].header&&a.push(oe("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&a.push(oe("Footer",null,{"x:Margin":e["!margins"].footer})),a.push(oe("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),a.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[r])if(n.Workbook.Sheets[r].Hidden)a.push(oe("Visible",n.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var i=0;i<r&&!(n.Workbook.Sheets[i]&&!n.Workbook.Sheets[i].Hidden);++i);i==r&&a.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&a.push("<DisplayRightToLeft/>"),e["!protect"]&&(a.push(_t("ProtectContents","True")),e["!protect"].objects&&a.push(_t("ProtectObjects","True")),e["!protect"].scenarios&&a.push(_t("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?a.push(_t("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&a.push(_t("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(l){e["!protect"][l[0]]&&a.push("<"+l[1]+"/>")})),a.length==0?"":oe("WorksheetOptions",a.join(""),{xmlns:nr.x})}function EE(e){return e.map(function(t){var r=AN(t.t||""),n=oe("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return oe("Comment",n,{"ss:Author":t.a})}).join("")}function TE(e,t,r,n,a,i,l){if(!e||e.v==null&&e.f==null)return"";var o={};if(e.f&&(o["ss:Formula"]="="+Le(ed(e.f,l))),e.F&&e.F.slice(0,t.length)==t){var c=gt(e.F.slice(t.length+1));o["ss:ArrayRange"]="RC:R"+(c.r==l.r?"":"["+(c.r-l.r)+"]")+"C"+(c.c==l.c?"":"["+(c.c-l.c)+"]")}if(e.l&&e.l.Target&&(o["ss:HRef"]=Le(e.l.Target),e.l.Tooltip&&(o["x:HRefScreenTip"]=Le(e.l.Tooltip))),r["!merges"])for(var d=r["!merges"],u=0;u!=d.length;++u)d[u].s.c!=l.c||d[u].s.r!=l.r||(d[u].e.c>d[u].s.c&&(o["ss:MergeAcross"]=d[u].e.c-d[u].s.c),d[u].e.r>d[u].s.r&&(o["ss:MergeDown"]=d[u].e.r-d[u].s.r));var f="",h="";switch(e.t){case"z":if(!n.sheetStubs)return"";break;case"n":f="Number",h=String(e.v);break;case"b":f="Boolean",h=e.v?"1":"0";break;case"e":f="Error",h=zi[e.v];break;case"d":f="DateTime",h=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||nt[14]);break;case"s":f="String",h=CN(e.v||"");break}var m=Qn(n.cellXfs,e,n);o["ss:StyleID"]="s"+(21+m),o["ss:Index"]=l.c+1;var v=e.v!=null?h:"",x=e.t=="z"?"":'<Data ss:Type="'+f+'">'+v+"</Data>";return(e.c||[]).length>0&&(x+=EE(e.c)),oe("Cell",x,o)}function kE(e,t){var r='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=Tg(t.hpt)),t.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(r+=' ss:Hidden="1"')),r+">"}function CE(e,t,r,n){if(!e["!ref"])return"";var a=Xe(e["!ref"]),i=e["!merges"]||[],l=0,o=[];e["!cols"]&&e["!cols"].forEach(function(y,p){Q0(y);var g=!!y.width,w=$o(p,y),b={"ss:Index":p+1};g&&(b["ss:Width"]=fo(w.width)),y.hidden&&(b["ss:Hidden"]="1"),o.push(oe("Column",null,b))});for(var c=Array.isArray(e),d=a.s.r;d<=a.e.r;++d){for(var u=[kE(d,(e["!rows"]||[])[d])],f=a.s.c;f<=a.e.c;++f){var h=!1;for(l=0;l!=i.length;++l)if(!(i[l].s.c>f)&&!(i[l].s.r>d)&&!(i[l].e.c<f)&&!(i[l].e.r<d)){(i[l].s.c!=f||i[l].s.r!=d)&&(h=!0);break}if(!h){var m={r:d,c:f},v=Be(m),x=c?(e[d]||[])[f]:e[v];u.push(TE(x,v,e,t,r,n,m))}}u.push("</Row>"),u.length>2&&o.push(u.join(""))}return o.join("")}function AE(e,t,r){var n=[],a=r.SheetNames[e],i=r.Sheets[a],l=i?SE(i,t,e,r):"";return l.length>0&&n.push("<Names>"+l+"</Names>"),l=i?CE(i,t,e,r):"",l.length>0&&n.push("<Table>"+l+"</Table>"),n.push(_E(i,t,e,r)),n.join("")}function FE(e,t){t||(t={}),e.SSF||(e.SSF=Qt(nt)),e.SSF&&(Lo(),Do(e.SSF),t.revssf=Mo(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],Qn(t.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(wE(e,t)),r.push(bE()),r.push(""),r.push("");for(var n=0;n<e.SheetNames.length;++n)r.push(oe("Worksheet",AE(n,t,e),{"ss:Name":Le(e.SheetNames[n])}));return r[2]=NE(e,t),r[3]=jE(e),ut+oe("Workbook",r.join(""),{xmlns:nr.ss,"xmlns:o":nr.o,"xmlns:x":nr.x,"xmlns:ss":nr.ss,"xmlns:dt":nr.dt,"xmlns:html":nr.html})}var Cc={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function PE(e,t){var r=[],n=[],a=[],i=0,l,o=eh(hh,"n"),c=eh(xh,"n");if(e.Props)for(l=Ct(e.Props),i=0;i<l.length;++i)(Object.prototype.hasOwnProperty.call(o,l[i])?r:Object.prototype.hasOwnProperty.call(c,l[i])?n:a).push([l[i],e.Props[l[i]]]);if(e.Custprops)for(l=Ct(e.Custprops),i=0;i<l.length;++i)Object.prototype.hasOwnProperty.call(e.Props||{},l[i])||(Object.prototype.hasOwnProperty.call(o,l[i])?r:Object.prototype.hasOwnProperty.call(c,l[i])?n:a).push([l[i],e.Custprops[l[i]]]);var d=[];for(i=0;i<a.length;++i)gg.indexOf(a[i][0])>-1||xg.indexOf(a[i][0])>-1||a[i][1]!=null&&d.push(a[i]);n.length&&Ue.utils.cfb_add(t,"/SummaryInformation",vh(n,Cc.SI,c,xh)),(r.length||d.length)&&Ue.utils.cfb_add(t,"/DocumentSummaryInformation",vh(r,Cc.DSI,o,hh,d.length?d:null,Cc.UDI))}function OE(e,t){var r=t||{},n=Ue.utils.cfb_new({root:"R"}),a="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":a="/Workbook",r.biff=8;break;case"biff5":a="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return Ue.utils.cfb_add(n,a,Kg(e,r)),r.biff==8&&(e.Props||e.Custprops)&&PE(e,n),r.biff==8&&e.vbaraw&&q4(n,Ue.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),n}var RE={0:{f:L_},1:{f:V_},2:{f:d3},3:{f:Z_},4:{f:Y_},5:{f:l3},6:{f:p3},7:{f:n3},8:{f:j3},9:{f:N3},10:{f:w3},11:{f:b3},12:{f:X_},13:{f:h3},14:{f:t3},15:{f:q_},16:{f:c3},17:{f:y3},18:{f:a3},19:{f:K0},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:oE},40:{},42:{},43:{f:p4},44:{f:x4},45:{f:v4},46:{f:b4},47:{f:w4},48:{},49:{f:XN},50:{},51:{f:L4},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:Kj},62:{f:m3},63:{f:W4},64:{f:B3},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Vr,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:I3},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:W_},148:{f:U_,p:16},151:{f:C3},152:{},153:{f:iE},154:{},155:{},156:{f:sE},157:{},158:{},159:{T:1,f:s4},160:{T:-1},161:{T:1,f:Es},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:S3},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:I4},336:{T:-1},337:{f:U4,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Lu},357:{},358:{},359:{},360:{T:1},361:{},362:{f:$j},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:A3},427:{f:F3},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:O3},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:$_},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:T3},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Lu},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:K4},633:{T:1},634:{T:-1},635:{T:1,f:G4},636:{T:-1},637:{f:qN},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:Q3},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:U3},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}};function ce(e,t,r,n){var a=t;if(!isNaN(a)){var i=n||(r||[]).length||0,l=e.next(4);l.write_shift(2,a),l.write_shift(2,i),i>0&&V0(r)&&e.push(r)}}function IE(e,t,r,n){var a=(r||[]).length||0;if(a<=8224)return ce(e,t,r,a);var i=t;if(!isNaN(i)){for(var l=r.parts||[],o=0,c=0,d=0;d+(l[o]||8224)<=8224;)d+=l[o]||8224,o++;var u=e.next(4);for(u.write_shift(2,i),u.write_shift(2,d),e.push(r.slice(c,c+d)),c+=d;c<a;){for(u=e.next(4),u.write_shift(2,60),d=0;d+(l[o]||8224)<=8224;)d+=l[o]||8224,o++;u.write_shift(2,d),e.push(r.slice(c,c+d)),c+=d}}}function Wi(e,t,r){return e||(e=Q(7)),e.write_shift(2,t),e.write_shift(2,r),e.write_shift(2,0),e.write_shift(1,0),e}function DE(e,t,r,n){var a=Q(9);return Wi(a,e,t),vg(r,n||"b",a),a}function LE(e,t,r){var n=Q(8+2*r.length);return Wi(n,e,t),n.write_shift(1,r.length),n.write_shift(r.length,r,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function ME(e,t,r,n){if(t.v!=null)switch(t.t){case"d":case"n":var a=t.t=="d"?qt(zt(t.v)):t.v;a==(a|0)&&a>=0&&a<65536?ce(e,2,Qj(r,n,a)):ce(e,3,qj(r,n,a));return;case"b":case"e":ce(e,5,DE(r,n,t.v,t.t));return;case"s":case"str":ce(e,4,LE(r,n,(t.v||"").slice(0,255)));return}ce(e,1,Wi(null,r,n))}function BE(e,t,r,n){var a=Array.isArray(t),i=Xe(t["!ref"]||"A1"),l,o="",c=[];if(i.e.c>255||i.e.r>16383){if(n.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");i.e.c=Math.min(i.e.c,255),i.e.r=Math.min(i.e.c,16383),l=ct(i)}for(var d=i.s.r;d<=i.e.r;++d){o=Tt(d);for(var u=i.s.c;u<=i.e.c;++u){d===i.s.r&&(c[u]=Rt(u)),l=c[u]+o;var f=a?(t[d]||[])[u]:t[l];f&&ME(e,f,d,u)}}}function UE(e,t){for(var r=t||{},n=Jt(),a=0,i=0;i<e.SheetNames.length;++i)e.SheetNames[i]==r.sheet&&(a=i);if(a==0&&r.sheet&&e.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return ce(n,r.biff==4?1033:r.biff==3?521:9,q0(e,16,r)),BE(n,e.Sheets[e.SheetNames[a]],a,r),ce(n,10),n.end()}function zE(e,t,r){ce(e,49,Rj({sz:12,name:"Arial"},r))}function $E(e,t,r){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)t[a]!=null&&ce(e,1054,Lj(a,t[a],r))})}function WE(e,t){var r=Q(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),ce(e,2151,r),r=Q(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),Ng(Xe(t["!ref"]||"A1"),r),r.write_shift(4,4),ce(e,2152,r)}function HE(e,t){for(var r=0;r<16;++r)ce(e,224,bh({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(n){ce(e,224,bh(n,0,t))})}function VE(e,t){for(var r=0;r<t["!links"].length;++r){var n=t["!links"][r];ce(e,440,Vj(n)),n[1].Tooltip&&ce(e,2048,Gj(n))}delete t["!links"]}function GE(e,t){if(t){var r=0;t.forEach(function(n,a){++r<=256&&n&&ce(e,125,Yj($o(a,n),a))})}}function XE(e,t,r,n,a){var i=16+Qn(a.cellXfs,t,a);if(t.v==null&&!t.bf){ce(e,513,ys(r,n,i));return}if(t.bf)ce(e,6,g_(t,r,n,a,i));else switch(t.t){case"d":case"n":var l=t.t=="d"?qt(zt(t.v)):t.v;ce(e,515,zj(r,n,l,i));break;case"b":case"e":ce(e,517,Uj(r,n,t.v,i,a,t.t));break;case"s":case"str":if(a.bookSST){var o=rd(a.Strings,t.v,a.revStrings);ce(e,253,Ij(r,n,o,i))}else ce(e,516,Dj(r,n,(t.v||"").slice(0,255),i,a));break;default:ce(e,513,ys(r,n,i))}}function KE(e,t,r){var n=Jt(),a=r.SheetNames[e],i=r.Sheets[a]||{},l=(r||{}).Workbook||{},o=(l.Sheets||[])[e]||{},c=Array.isArray(i),d=t.biff==8,u,f="",h=[],m=Xe(i["!ref"]||"A1"),v=d?65536:16384;if(m.e.c>255||m.e.r>=v){if(t.WTF)throw new Error("Range "+(i["!ref"]||"A1")+" exceeds format limit A1:IV16384");m.e.c=Math.min(m.e.c,255),m.e.r=Math.min(m.e.c,v-1)}ce(n,2057,q0(r,16,t)),ce(n,13,hr(1)),ce(n,12,hr(100)),ce(n,15,Bt(!0)),ce(n,17,Bt(!1)),ce(n,16,gs(.001)),ce(n,95,Bt(!0)),ce(n,42,Bt(!1)),ce(n,43,Bt(!1)),ce(n,130,hr(1)),ce(n,128,Bj()),ce(n,131,Bt(!1)),ce(n,132,Bt(!1)),d&&GE(n,i["!cols"]),ce(n,512,Mj(m,t)),d&&(i["!links"]=[]);for(var x=m.s.r;x<=m.e.r;++x){f=Tt(x);for(var y=m.s.c;y<=m.e.c;++y){x===m.s.r&&(h[y]=Rt(y)),u=h[y]+f;var p=c?(i[x]||[])[y]:i[u];p&&(XE(n,p,x,y,t),d&&p.l&&i["!links"].push([u,p.l]))}}var g=o.CodeName||o.name||a;return d&&ce(n,574,Oj((l.Views||[])[0])),d&&(i["!merges"]||[]).length&&ce(n,229,Hj(i["!merges"])),d&&VE(n,i),ce(n,442,bg(g)),d&&WE(n,i),ce(n,10),n.end()}function YE(e,t,r){var n=Jt(),a=(e||{}).Workbook||{},i=a.Sheets||[],l=a.WBProps||{},o=r.biff==8,c=r.biff==5;if(ce(n,2057,q0(e,5,r)),r.bookType=="xla"&&ce(n,135),ce(n,225,o?hr(1200):null),ce(n,193,wj(2)),c&&ce(n,191),c&&ce(n,192),ce(n,226),ce(n,92,Cj("SheetJS",r)),ce(n,66,hr(o?1200:1252)),o&&ce(n,353,hr(0)),o&&ce(n,448),ce(n,317,Jj(e.SheetNames.length)),o&&e.vbaraw&&ce(n,211),o&&e.vbaraw){var d=l.CodeName||"ThisWorkbook";ce(n,442,bg(d))}ce(n,156,hr(17)),ce(n,25,Bt(!1)),ce(n,18,Bt(!1)),ce(n,19,hr(0)),o&&ce(n,431,Bt(!1)),o&&ce(n,444,hr(0)),ce(n,61,Pj()),ce(n,64,Bt(!1)),ce(n,141,hr(0)),ce(n,34,Bt(eE(e)=="true")),ce(n,14,Bt(!0)),o&&ce(n,439,Bt(!1)),ce(n,218,hr(0)),zE(n,e,r),$E(n,e.SSF,r),HE(n,r),o&&ce(n,352,Bt(!1));var u=n.end(),f=Jt();o&&ce(f,140,Xj()),o&&r.Strings&&IE(f,252,Fj(r.Strings)),ce(f,10);var h=f.end(),m=Jt(),v=0,x=0;for(x=0;x<e.SheetNames.length;++x)v+=(o?12:11)+(o?2:1)*e.SheetNames[x].length;var y=u.length+v+h.length;for(x=0;x<e.SheetNames.length;++x){var p=i[x]||{};ce(m,133,Aj({pos:y,hs:p.Hidden||0,dt:0,name:e.SheetNames[x]},r)),y+=t[x].length}var g=m.end();if(v!=g.length)throw new Error("BS8 "+v+" != "+g.length);var w=[];return u.length&&w.push(u),g.length&&w.push(g),h.length&&w.push(h),St(w)}function JE(e,t){var r=t||{},n=[];e&&!e.SSF&&(e.SSF=Qt(nt)),e&&e.SSF&&(Lo(),Do(e.SSF),r.revssf=Mo(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,nd(r),r.cellXfs=[],Qn(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var a=0;a<e.SheetNames.length;++a)n[n.length]=KE(a,r,e);return n.unshift(YE(e,n,r)),St(n)}function Kg(e,t){for(var r=0;r<=e.SheetNames.length;++r){var n=e.Sheets[e.SheetNames[r]];if(!(!n||!n["!ref"])){var a=cr(n["!ref"]);a.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var i=t||{};switch(i.biff||2){case 8:case 5:return JE(e,t);case 4:case 3:case 2:return UE(e,t)}throw new Error("invalid type "+i.bookType+" for BIFF")}function qE(e,t,r,n){for(var a=e["!merges"]||[],i=[],l=t.s.c;l<=t.e.c;++l){for(var o=0,c=0,d=0;d<a.length;++d)if(!(a[d].s.r>r||a[d].s.c>l)&&!(a[d].e.r<r||a[d].e.c<l)){if(a[d].s.r<r||a[d].s.c<l){o=-1;break}o=a[d].e.r-a[d].s.r+1,c=a[d].e.c-a[d].s.c+1;break}if(!(o<0)){var u=Be({r,c:l}),f=n.dense?(e[r]||[])[l]:e[u],h=f&&f.v!=null&&(f.h||kN(f.w||(hn(f),f.w)||""))||"",m={};o>1&&(m.rowspan=o),c>1&&(m.colspan=c),n.editable?h='<span contenteditable="true">'+h+"</span>":f&&(m["data-t"]=f&&f.t||"z",f.v!=null&&(m["data-v"]=f.v),f.z!=null&&(m["data-z"]=f.z),f.l&&(f.l.Target||"#").charAt(0)!="#"&&(h='<a href="'+f.l.Target+'">'+h+"</a>")),m.id=(n.id||"sjs")+"-"+u,i.push(oe("td",h,m))}}var v="<tr>";return v+i.join("")+"</tr>"}var QE='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',ZE="</body></html>";function eT(e,t,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function Yg(e,t){var r=t||{},n=r.header!=null?r.header:QE,a=r.footer!=null?r.footer:ZE,i=[n],l=cr(e["!ref"]);r.dense=Array.isArray(e),i.push(eT(e,l,r));for(var o=l.s.r;o<=l.e.r;++o)i.push(qE(e,l,o,r));return i.push("</table>"+a),i.join("")}function Jg(e,t,r){var n=r||{},a=0,i=0;if(n.origin!=null)if(typeof n.origin=="number")a=n.origin;else{var l=typeof n.origin=="string"?gt(n.origin):n.origin;a=l.r,i=l.c}var o=t.getElementsByTagName("tr"),c=Math.min(n.sheetRows||1e7,o.length),d={s:{r:0,c:0},e:{r:a,c:i}};if(e["!ref"]){var u=cr(e["!ref"]);d.s.r=Math.min(d.s.r,u.s.r),d.s.c=Math.min(d.s.c,u.s.c),d.e.r=Math.max(d.e.r,u.e.r),d.e.c=Math.max(d.e.c,u.e.c),a==-1&&(d.e.r=a=u.e.r+1)}var f=[],h=0,m=e["!rows"]||(e["!rows"]=[]),v=0,x=0,y=0,p=0,g=0,w=0;for(e["!cols"]||(e["!cols"]=[]);v<o.length&&x<c;++v){var b=o[v];if(kh(b)){if(n.display)continue;m[x]={hidden:!0}}var P=b.children;for(y=p=0;y<P.length;++y){var M=P[y];if(!(n.display&&kh(M))){var j=M.hasAttribute("data-v")?M.getAttribute("data-v"):M.hasAttribute("v")?M.getAttribute("v"):PN(M.innerHTML),O=M.getAttribute("data-z")||M.getAttribute("z");for(h=0;h<f.length;++h){var R=f[h];R.s.c==p+i&&R.s.r<x+a&&x+a<=R.e.r&&(p=R.e.c+1-i,h=-1)}w=+M.getAttribute("colspan")||1,((g=+M.getAttribute("rowspan")||1)>1||w>1)&&f.push({s:{r:x+a,c:p+i},e:{r:x+a+(g||1)-1,c:p+i+(w||1)-1}});var I={t:"s",v:j},D=M.getAttribute("data-t")||M.getAttribute("t")||"";j!=null&&(j.length==0?I.t=D||"z":n.raw||j.trim().length==0||D=="s"||(j==="TRUE"?I={t:"b",v:!0}:j==="FALSE"?I={t:"b",v:!1}:isNaN(an(j))?isNaN(Ei(j).getDate())||(I={t:"d",v:zt(j)},n.cellDates||(I={t:"n",v:qt(I.v)}),I.z=n.dateNF||nt[14]):I={t:"n",v:an(j)})),I.z===void 0&&O!=null&&(I.z=O);var z="",ne=M.getElementsByTagName("A");if(ne&&ne.length)for(var Ne=0;Ne<ne.length&&!(ne[Ne].hasAttribute("href")&&(z=ne[Ne].getAttribute("href"),z.charAt(0)!="#"));++Ne);z&&z.charAt(0)!="#"&&(I.l={Target:z}),n.dense?(e[x+a]||(e[x+a]=[]),e[x+a][p+i]=I):e[Be({c:p+i,r:x+a})]=I,d.e.c<p+i&&(d.e.c=p+i),p+=w}}++x}return f.length&&(e["!merges"]=(e["!merges"]||[]).concat(f)),d.e.r=Math.max(d.e.r,x-1+a),e["!ref"]=ct(d),x>=c&&(e["!fullref"]=ct((d.e.r=o.length-v+x-1+a,d))),e}function qg(e,t){var r=t||{},n=r.dense?[]:{};return Jg(n,e,t)}function tT(e,t){return Ns(qg(e,t),t)}function kh(e){var t="",r=rT(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function rT(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}var nT=function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+ki({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return ut+t}}(),Ch=function(){var e=function(i){return Le(i).replace(/  +/g,function(l){return'<text:s text:c="'+l.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,n=function(i,l,o){var c=[];c.push('      <table:table table:name="'+Le(l.SheetNames[o])+`" table:style-name="ta1">
`);var d=0,u=0,f=cr(i["!ref"]||"A1"),h=i["!merges"]||[],m=0,v=Array.isArray(i);if(i["!cols"])for(u=0;u<=f.e.c;++u)c.push("        <table:table-column"+(i["!cols"][u]?' table:style-name="co'+i["!cols"][u].ods+'"':"")+`></table:table-column>
`);var x="",y=i["!rows"]||[];for(d=0;d<f.s.r;++d)x=y[d]?' table:style-name="ro'+y[d].ods+'"':"",c.push("        <table:table-row"+x+`></table:table-row>
`);for(;d<=f.e.r;++d){for(x=y[d]?' table:style-name="ro'+y[d].ods+'"':"",c.push("        <table:table-row"+x+`>
`),u=0;u<f.s.c;++u)c.push(t);for(;u<=f.e.c;++u){var p=!1,g={},w="";for(m=0;m!=h.length;++m)if(!(h[m].s.c>u)&&!(h[m].s.r>d)&&!(h[m].e.c<u)&&!(h[m].e.r<d)){(h[m].s.c!=u||h[m].s.r!=d)&&(p=!0),g["table:number-columns-spanned"]=h[m].e.c-h[m].s.c+1,g["table:number-rows-spanned"]=h[m].e.r-h[m].s.r+1;break}if(p){c.push(r);continue}var b=Be({r:d,c:u}),P=v?(i[d]||[])[u]:i[b];if(P&&P.f&&(g["table:formula"]=Le(j_(P.f)),P.F&&P.F.slice(0,b.length)==b)){var M=cr(P.F);g["table:number-matrix-columns-spanned"]=M.e.c-M.s.c+1,g["table:number-matrix-rows-spanned"]=M.e.r-M.s.r+1}if(!P){c.push(t);continue}switch(P.t){case"b":w=P.v?"TRUE":"FALSE",g["office:value-type"]="boolean",g["office:boolean-value"]=P.v?"true":"false";break;case"n":w=P.w||String(P.v||0),g["office:value-type"]="float",g["office:value"]=P.v||0;break;case"s":case"str":w=P.v==null?"":P.v,g["office:value-type"]="string";break;case"d":w=P.w||zt(P.v).toISOString(),g["office:value-type"]="date",g["office:date-value"]=zt(P.v).toISOString(),g["table:style-name"]="ce1";break;default:c.push(t);continue}var j=e(w);if(P.l&&P.l.Target){var O=P.l.Target;O=O.charAt(0)=="#"?"#"+S_(O.slice(1)):O,O.charAt(0)!="#"&&!O.match(/^\w+:/)&&(O="../"+O),j=oe("text:a",j,{"xlink:href":O.replace(/&/g,"&amp;")})}c.push("          "+oe("table:table-cell",oe("text:p",j,{}),g)+`
`)}c.push(`        </table:table-row>
`)}return c.push(`      </table:table>
`),c.join("")},a=function(i,l){i.push(` <office:automatic-styles>
`),i.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),i.push(`   <number:month number:style="long"/>
`),i.push(`   <number:text>/</number:text>
`),i.push(`   <number:day number:style="long"/>
`),i.push(`   <number:text>/</number:text>
`),i.push(`   <number:year/>
`),i.push(`  </number:date-style>
`);var o=0;l.SheetNames.map(function(d){return l.Sheets[d]}).forEach(function(d){if(d&&d["!cols"]){for(var u=0;u<d["!cols"].length;++u)if(d["!cols"][u]){var f=d["!cols"][u];if(f.width==null&&f.wpx==null&&f.wch==null)continue;Q0(f),f.ods=o;var h=d["!cols"][u].wpx+"px";i.push('  <style:style style:name="co'+o+`" style:family="table-column">
`),i.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+h+`"/>
`),i.push(`  </style:style>
`),++o}}});var c=0;l.SheetNames.map(function(d){return l.Sheets[d]}).forEach(function(d){if(d&&d["!rows"]){for(var u=0;u<d["!rows"].length;++u)if(d["!rows"][u]){d["!rows"][u].ods=c;var f=d["!rows"][u].hpx+"px";i.push('  <style:style style:name="ro'+c+`" style:family="table-row">
`),i.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+f+`"/>
`),i.push(`  </style:style>
`),++c}}}),i.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),i.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),i.push(`  </style:style>
`),i.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),i.push(` </office:automatic-styles>
`)};return function(l,o){var c=[ut],d=ki({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),u=ki({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});o.bookType=="fods"?(c.push("<office:document"+d+u+`>
`),c.push(fg().replace(/office:document-meta/g,"office:meta"))):c.push("<office:document-content"+d+`>
`),a(c,l),c.push(`  <office:body>
`),c.push(`    <office:spreadsheet>
`);for(var f=0;f!=l.SheetNames.length;++f)c.push(n(l.Sheets[l.SheetNames[f]],l,f));return c.push(`    </office:spreadsheet>
`),c.push(`  </office:body>
`),o.bookType=="fods"?c.push("</office:document>"):c.push("</office:document-content>"),c.join("")}}();function Qg(e,t){if(t.bookType=="fods")return Ch(e,t);var r=z0(),n="",a=[],i=[];return n="mimetype",Ce(r,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",Ce(r,n,Ch(e,t)),a.push([n,"text/xml"]),i.push([n,"ContentFile"]),n="styles.xml",Ce(r,n,nT(e,t)),a.push([n,"text/xml"]),i.push([n,"StylesFile"]),n="meta.xml",Ce(r,n,ut+fg()),a.push([n,"text/xml"]),i.push([n,"MetadataFile"]),n="manifest.rdf",Ce(r,n,mj(i)),a.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",Ce(r,n,hj(a)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function mo(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function sT(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):Ar(Ti(e))}function aT(e,t){e:for(var r=0;r<=e.length-t.length;++r){for(var n=0;n<t.length;++n)if(e[r+n]!=t[n])continue e;return!0}return!1}function Gn(e){var t=e.reduce(function(a,i){return a+i.length},0),r=new Uint8Array(t),n=0;return e.forEach(function(a){r.set(a,n),n+=a.length}),r}function iT(e,t,r){var n=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,a=r/Math.pow(10,n-6176);e[t+15]|=n>>7,e[t+14]|=(n&127)<<1;for(var i=0;a>=1;++i,a/=256)e[t+i]=a&255;e[t+15]|=r>=0?0:128}function Ci(e,t){var r=t?t[0]:0,n=e[r]&127;e:if(e[r++]>=128&&(n|=(e[r]&127)<<7,e[r++]<128||(n|=(e[r]&127)<<14,e[r++]<128)||(n|=(e[r]&127)<<21,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),n}function Ie(e){var t=new Uint8Array(7);t[0]=e&127;var r=1;e:if(e>127){if(t[r-1]|=128,t[r]=e>>7&127,++r,e<=16383||(t[r-1]|=128,t[r]=e>>14&127,++r,e<=2097151)||(t[r-1]|=128,t[r]=e>>21&127,++r,e<=268435455)||(t[r-1]|=128,t[r]=e/256>>>21&127,++r,e<=34359738367)||(t[r-1]|=128,t[r]=e/65536>>>21&127,++r,e<=4398046511103))break e;t[r-1]|=128,t[r]=e/16777216>>>21&127,++r}return t.slice(0,r)}function na(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function dt(e){for(var t=[],r=[0];r[0]<e.length;){var n=r[0],a=Ci(e,r),i=a&7;a=Math.floor(a/8);var l=0,o;if(a==0)break;switch(i){case 0:{for(var c=r[0];e[r[0]++]>=128;);o=e.slice(c,r[0])}break;case 5:l=4,o=e.slice(r[0],r[0]+l),r[0]+=l;break;case 1:l=8,o=e.slice(r[0],r[0]+l),r[0]+=l;break;case 2:l=Ci(e,r),o=e.slice(r[0],r[0]+l),r[0]+=l;break;case 3:case 4:default:throw new Error("PB Type ".concat(i," for Field ").concat(a," at offset ").concat(n))}var d={data:o,type:i};t[a]==null?t[a]=[d]:t[a].push(d)}return t}function bt(e){var t=[];return e.forEach(function(r,n){r.forEach(function(a){a.data&&(t.push(Ie(n*8+a.type)),a.type==2&&t.push(Ie(a.data.length)),t.push(a.data))})}),Gn(t)}function _r(e){for(var t,r=[],n=[0];n[0]<e.length;){var a=Ci(e,n),i=dt(e.slice(n[0],n[0]+a));n[0]+=a;var l={id:na(i[1][0].data),messages:[]};i[2].forEach(function(o){var c=dt(o.data),d=na(c[3][0].data);l.messages.push({meta:c,data:e.slice(n[0],n[0]+d)}),n[0]+=d}),(t=i[3])!=null&&t[0]&&(l.merge=na(i[3][0].data)>>>0>0),r.push(l)}return r}function Cs(e){var t=[];return e.forEach(function(r){var n=[];n[1]=[{data:Ie(r.id),type:0}],n[2]=[],r.merge!=null&&(n[3]=[{data:Ie(+!!r.merge),type:0}]);var a=[];r.messages.forEach(function(l){a.push(l.data),l.meta[3]=[{type:0,data:Ie(l.data.length)}],n[2].push({data:bt(l.meta),type:2})});var i=bt(n);t.push(Ie(i.length)),t.push(i),a.forEach(function(l){return t.push(l)})}),Gn(t)}function lT(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],n=Ci(t,r),a=[];r[0]<t.length;){var i=t[r[0]]&3;if(i==0){var l=t[r[0]++]>>2;if(l<60)++l;else{var o=l-59;l=t[r[0]],o>1&&(l|=t[r[0]+1]<<8),o>2&&(l|=t[r[0]+2]<<16),o>3&&(l|=t[r[0]+3]<<24),l>>>=0,l++,r[0]+=o}a.push(t.slice(r[0],r[0]+l)),r[0]+=l;continue}else{var c=0,d=0;if(i==1?(d=(t[r[0]]>>2&7)+4,c=(t[r[0]++]&224)<<3,c|=t[r[0]++]):(d=(t[r[0]++]>>2)+1,i==2?(c=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(c=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),a=[Gn(a)],c==0)throw new Error("Invalid offset 0");if(c>a[0].length)throw new Error("Invalid offset beyond length");if(d>=c)for(a.push(a[0].slice(-c)),d-=c;d>=a[a.length-1].length;)a.push(a[a.length-1]),d-=a[a.length-1].length;a.push(a[0].slice(-c,-c+d))}}var u=Gn(a);if(u.length!=n)throw new Error("Unexpected length: ".concat(u.length," != ").concat(n));return u}function Er(e){for(var t=[],r=0;r<e.length;){var n=e[r++],a=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(lT(n,e.slice(r,r+a))),r+=a}if(r!==e.length)throw new Error("data is not a valid framed stream!");return Gn(t)}function As(e){for(var t=[],r=0;r<e.length;){var n=Math.min(e.length-r,268435455),a=new Uint8Array(4);t.push(a);var i=Ie(n),l=i.length;t.push(i),n<=60?(l++,t.push(new Uint8Array([n-1<<2]))):n<=256?(l+=2,t.push(new Uint8Array([240,n-1&255]))):n<=65536?(l+=3,t.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(l+=4,t.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(l+=5,t.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),t.push(e.slice(r,r+n)),l+=n,a[0]=0,a[1]=l&255,a[2]=l>>8&255,a[3]=l>>16&255,r+=n}return Gn(t)}function Ac(e,t){var r=new Uint8Array(32),n=mo(r),a=12,i=0;switch(r[0]=5,e.t){case"n":r[1]=2,iT(r,a,e.v),i|=1,a+=16;break;case"b":r[1]=6,n.setFloat64(a,e.v?1:0,!0),i|=2,a+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[1]=3,n.setUint32(a,t.indexOf(e.v),!0),i|=8,a+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(8,i,!0),r.slice(0,a)}function Fc(e,t){var r=new Uint8Array(32),n=mo(r),a=12,i=0;switch(r[0]=3,e.t){case"n":r[2]=2,n.setFloat64(a,e.v,!0),i|=32,a+=8;break;case"b":r[2]=6,n.setFloat64(a,e.v?1:0,!0),i|=32,a+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[2]=3,n.setUint32(a,t.indexOf(e.v),!0),i|=16,a+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(4,i,!0),r.slice(0,a)}function Nn(e){var t=dt(e);return Ci(t[1][0].data)}function oT(e,t,r){var n,a,i,l;if(!((n=e[6])!=null&&n[0])||!((a=e[7])!=null&&a[0]))throw"Mutation only works on post-BNC storages!";var o=((l=(i=e[8])==null?void 0:i[0])==null?void 0:l.data)&&na(e[8][0].data)>0||!1;if(o)throw"Math only works with normal offsets";for(var c=0,d=mo(e[7][0].data),u=0,f=[],h=mo(e[4][0].data),m=0,v=[],x=0;x<t.length;++x){if(t[x]==null){d.setUint16(x*2,65535,!0),h.setUint16(x*2,65535);continue}d.setUint16(x*2,u,!0),h.setUint16(x*2,m,!0);var y,p;switch(typeof t[x]){case"string":y=Ac({t:"s",v:t[x]},r),p=Fc({t:"s",v:t[x]},r);break;case"number":y=Ac({t:"n",v:t[x]},r),p=Fc({t:"n",v:t[x]},r);break;case"boolean":y=Ac({t:"b",v:t[x]},r),p=Fc({t:"b",v:t[x]},r);break;default:throw new Error("Unsupported value "+t[x])}f.push(y),u+=y.length,v.push(p),m+=p.length,++c}for(e[2][0].data=Ie(c);x<e[7][0].data.length/2;++x)d.setUint16(x*2,65535,!0),h.setUint16(x*2,65535,!0);return e[6][0].data=Gn(f),e[3][0].data=Gn(v),c}function cT(e,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=cr(r["!ref"]);n.s.r=n.s.c=0;var a=!1;n.e.c>9&&(a=!0,n.e.c=9),n.e.r>49&&(a=!0,n.e.r=49),a&&console.error("The Numbers writer is currently limited to ".concat(ct(n)));var i=po(r,{range:n,header:1}),l=["~Sh33tJ5~"];i.forEach(function(B){return B.forEach(function(L){typeof L=="string"&&l.push(L)})});var o={},c=[],d=Ue.read(t.numbers,{type:"base64"});d.FileIndex.map(function(B,L){return[B,d.FullPaths[L]]}).forEach(function(B){var L=B[0],U=B[1];if(L.type==2&&L.name.match(/\.iwa/)){var ee=L.content,he=Er(ee),xe=_r(he);xe.forEach(function(G){c.push(G.id),o[G.id]={deps:[],location:U,type:na(G.messages[0].meta[1][0].data)}})}}),c.sort(function(B,L){return B-L});var u=c.filter(function(B){return B>1}).map(function(B){return[B,Ie(B)]});d.FileIndex.map(function(B,L){return[B,d.FullPaths[L]]}).forEach(function(B){var L=B[0];if(B[1],!!L.name.match(/\.iwa/)){var U=_r(Er(L.content));U.forEach(function(ee){ee.messages.forEach(function(he){u.forEach(function(xe){ee.messages.some(function(G){return na(G.meta[1][0].data)!=11006&&aT(G.data,xe[1])})&&o[xe[0]].deps.push(ee.id)})})})}});for(var f=Ue.find(d,o[1].location),h=_r(Er(f.content)),m,v=0;v<h.length;++v){var x=h[v];x.id==1&&(m=x)}var y=Nn(dt(m.messages[0].data)[1][0].data);for(f=Ue.find(d,o[y].location),h=_r(Er(f.content)),v=0;v<h.length;++v)x=h[v],x.id==y&&(m=x);for(y=Nn(dt(m.messages[0].data)[2][0].data),f=Ue.find(d,o[y].location),h=_r(Er(f.content)),v=0;v<h.length;++v)x=h[v],x.id==y&&(m=x);for(y=Nn(dt(m.messages[0].data)[2][0].data),f=Ue.find(d,o[y].location),h=_r(Er(f.content)),v=0;v<h.length;++v)x=h[v],x.id==y&&(m=x);var p=dt(m.messages[0].data);{p[6][0].data=Ie(n.e.r+1),p[7][0].data=Ie(n.e.c+1);var g=Nn(p[46][0].data),w=Ue.find(d,o[g].location),b=_r(Er(w.content));{for(var P=0;P<b.length&&b[P].id!=g;++P);if(b[P].id!=g)throw"Bad ColumnRowUIDMapArchive";var M=dt(b[P].messages[0].data);M[1]=[],M[2]=[],M[3]=[];for(var j=0;j<=n.e.c;++j){var O=[];O[1]=O[2]=[{type:0,data:Ie(j+420690)}],M[1].push({type:2,data:bt(O)}),M[2].push({type:0,data:Ie(j)}),M[3].push({type:0,data:Ie(j)})}M[4]=[],M[5]=[],M[6]=[];for(var R=0;R<=n.e.r;++R)O=[],O[1]=O[2]=[{type:0,data:Ie(R+726270)}],M[4].push({type:2,data:bt(O)}),M[5].push({type:0,data:Ie(R)}),M[6].push({type:0,data:Ie(R)});b[P].messages[0].data=bt(M)}w.content=As(Cs(b)),w.size=w.content.length,delete p[46];var I=dt(p[4][0].data);{I[7][0].data=Ie(n.e.r+1);var D=dt(I[1][0].data),z=Nn(D[2][0].data);w=Ue.find(d,o[z].location),b=_r(Er(w.content));{if(b[0].id!=z)throw"Bad HeaderStorageBucket";var ne=dt(b[0].messages[0].data);for(R=0;R<i.length;++R){var Ne=dt(ne[2][0].data);Ne[1][0].data=Ie(R),Ne[4][0].data=Ie(i[R].length),ne[2][R]={type:ne[2][0].type,data:bt(Ne)}}b[0].messages[0].data=bt(ne)}w.content=As(Cs(b)),w.size=w.content.length;var ue=Nn(I[2][0].data);w=Ue.find(d,o[ue].location),b=_r(Er(w.content));{if(b[0].id!=ue)throw"Bad HeaderStorageBucket";for(ne=dt(b[0].messages[0].data),j=0;j<=n.e.c;++j)Ne=dt(ne[2][0].data),Ne[1][0].data=Ie(j),Ne[4][0].data=Ie(n.e.r+1),ne[2][j]={type:ne[2][0].type,data:bt(Ne)};b[0].messages[0].data=bt(ne)}w.content=As(Cs(b)),w.size=w.content.length;var je=Nn(I[4][0].data);(function(){for(var B=Ue.find(d,o[je].location),L=_r(Er(B.content)),U,ee=0;ee<L.length;++ee){var he=L[ee];he.id==je&&(U=he)}var xe=dt(U.messages[0].data);{xe[3]=[];var G=[];l.forEach(function(Se,se){G[1]=[{type:0,data:Ie(se)}],G[2]=[{type:0,data:Ie(1)}],G[3]=[{type:2,data:sT(Se)}],xe[3].push({type:2,data:bt(G)})})}U.messages[0].data=bt(xe);var J=Cs(L),ve=As(J);B.content=ve,B.size=B.content.length})();var q=dt(I[3][0].data);{var W=q[1][0];delete q[2];var k=dt(W.data);{var K=Nn(k[2][0].data);(function(){for(var B=Ue.find(d,o[K].location),L=_r(Er(B.content)),U,ee=0;ee<L.length;++ee){var he=L[ee];he.id==K&&(U=he)}var xe=dt(U.messages[0].data);{delete xe[6],delete q[7];var G=new Uint8Array(xe[5][0].data);xe[5]=[];for(var J=0,ve=0;ve<=n.e.r;++ve){var Se=dt(G);J+=oT(Se,i[ve],l),Se[1][0].data=Ie(ve),xe[5].push({data:bt(Se),type:2})}xe[1]=[{type:0,data:Ie(n.e.c+1)}],xe[2]=[{type:0,data:Ie(n.e.r+1)}],xe[3]=[{type:0,data:Ie(J)}],xe[4]=[{type:0,data:Ie(n.e.r+1)}]}U.messages[0].data=bt(xe);var se=Cs(L),pe=As(se);B.content=pe,B.size=B.content.length})()}W.data=bt(k)}I[3][0].data=bt(q)}p[4][0].data=bt(I)}m.messages[0].data=bt(p);var te=Cs(h),E=As(te);return f.content=E,f.size=f.content.length,d}function uT(e){return function(r){for(var n=0;n!=e.length;++n){var a=e[n];r[a[0]]===void 0&&(r[a[0]]=a[1]),a[2]==="n"&&(r[a[0]]=Number(r[a[0]]))}}}function nd(e){uT([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function dT(e,t){return t.bookType=="ods"?Qg(e,t):t.bookType=="numbers"?cT(e,t):t.bookType=="xlsb"?fT(e,t):hT(e,t)}function fT(e,t){Vs=1024,e&&!e.SSF&&(e.SSF=Qt(nt)),e&&e.SSF&&(Lo(),Do(e.SSF),t.revssf=Mo(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,ni?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r=t.bookType=="xlsb"?"bin":"xml",n=Rg.indexOf(t.bookType)>-1,a=cg();nd(t=t||{});var i=z0(),l="",o=0;if(t.cellXfs=[],Qn(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),l="docProps/core.xml",Ce(i,l,hg(e.Props,t)),a.coreprops.push(l),De(t.rels,2,l,Oe.CORE_PROPS),l="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var c=[],d=0;d<e.SheetNames.length;++d)(e.Workbook.Sheets[d]||{}).Hidden!=2&&c.push(e.SheetNames[d]);e.Props.SheetNames=c}for(e.Props.Worksheets=e.Props.SheetNames.length,Ce(i,l,mg(e.Props)),a.extprops.push(l),De(t.rels,3,l,Oe.EXT_PROPS),e.Custprops!==e.Props&&Ct(e.Custprops||{}).length>0&&(l="docProps/custom.xml",Ce(i,l,pg(e.Custprops)),a.custprops.push(l),De(t.rels,4,l,Oe.CUST_PROPS)),o=1;o<=e.SheetNames.length;++o){var u={"!id":{}},f=e.Sheets[e.SheetNames[o-1]],h=(f||{})["!type"]||"sheet";switch(h){case"chart":default:l="xl/worksheets/sheet"+o+"."+r,Ce(i,l,mE(o-1,l,t,e,u)),a.sheets.push(l),De(t.wbrels,-1,"worksheets/sheet"+o+"."+r,Oe.WS[0])}if(f){var m=f["!comments"],v=!1,x="";m&&m.length>0&&(x="xl/comments"+o+"."+r,Ce(i,x,yE(m,x)),a.comments.push(x),De(u,-1,"../comments"+o+"."+r,Oe.CMNT),v=!0),f["!legacy"]&&v&&Ce(i,"xl/drawings/vmlDrawing"+o+".vml",Pg(o,f["!comments"])),delete f["!comments"],delete f["!legacy"]}u["!id"].rId1&&Ce(i,dg(l),ta(u))}return t.Strings!=null&&t.Strings.length>0&&(l="xl/sharedStrings."+r,Ce(i,l,gE(t.Strings,l,t)),a.strs.push(l),De(t.wbrels,-1,"sharedStrings."+r,Oe.SST)),l="xl/workbook."+r,Ce(i,l,xE(e,l)),a.workbooks.push(l),De(t.rels,1,l,Oe.WB),l="xl/theme/theme1.xml",Ce(i,l,Ag(e.Themes,t)),a.themes.push(l),De(t.wbrels,-1,"theme/theme1.xml",Oe.THEME),l="xl/styles."+r,Ce(i,l,pE(e,l,t)),a.styles.push(l),De(t.wbrels,-1,"styles."+r,Oe.STY),e.vbaraw&&n&&(l="xl/vbaProject.bin",Ce(i,l,e.vbaraw),a.vba.push(l),De(t.wbrels,-1,"vbaProject.bin",Oe.VBA)),l="xl/metadata."+r,Ce(i,l,vE(l)),a.metadata.push(l),De(t.wbrels,-1,"metadata."+r,Oe.XLMETA),Ce(i,"[Content_Types].xml",ug(a,t)),Ce(i,"_rels/.rels",ta(t.rels)),Ce(i,"xl/_rels/workbook."+r+".rels",ta(t.wbrels)),delete t.revssf,delete t.ssf,i}function hT(e,t){Vs=1024,e&&!e.SSF&&(e.SSF=Qt(nt)),e&&e.SSF&&(Lo(),Do(e.SSF),t.revssf=Mo(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,ni?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r="xml",n=Rg.indexOf(t.bookType)>-1,a=cg();nd(t=t||{});var i=z0(),l="",o=0;if(t.cellXfs=[],Qn(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),l="docProps/core.xml",Ce(i,l,hg(e.Props,t)),a.coreprops.push(l),De(t.rels,2,l,Oe.CORE_PROPS),l="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var c=[],d=0;d<e.SheetNames.length;++d)(e.Workbook.Sheets[d]||{}).Hidden!=2&&c.push(e.SheetNames[d]);e.Props.SheetNames=c}e.Props.Worksheets=e.Props.SheetNames.length,Ce(i,l,mg(e.Props)),a.extprops.push(l),De(t.rels,3,l,Oe.EXT_PROPS),e.Custprops!==e.Props&&Ct(e.Custprops||{}).length>0&&(l="docProps/custom.xml",Ce(i,l,pg(e.Custprops)),a.custprops.push(l),De(t.rels,4,l,Oe.CUST_PROPS));var u=["SheetJ5"];for(t.tcid=0,o=1;o<=e.SheetNames.length;++o){var f={"!id":{}},h=e.Sheets[e.SheetNames[o-1]],m=(h||{})["!type"]||"sheet";switch(m){case"chart":default:l="xl/worksheets/sheet"+o+"."+r,Ce(i,l,Wg(o-1,t,e,f)),a.sheets.push(l),De(t.wbrels,-1,"worksheets/sheet"+o+"."+r,Oe.WS[0])}if(h){var v=h["!comments"],x=!1,y="";if(v&&v.length>0){var p=!1;v.forEach(function(g){g[1].forEach(function(w){w.T==!0&&(p=!0)})}),p&&(y="xl/threadedComments/threadedComment"+o+"."+r,Ce(i,y,H4(v,u,t)),a.threadedcomments.push(y),De(f,-1,"../threadedComments/threadedComment"+o+"."+r,Oe.TCMNT)),y="xl/comments"+o+"."+r,Ce(i,y,Og(v)),a.comments.push(y),De(f,-1,"../comments"+o+"."+r,Oe.CMNT),x=!0}h["!legacy"]&&x&&Ce(i,"xl/drawings/vmlDrawing"+o+".vml",Pg(o,h["!comments"])),delete h["!comments"],delete h["!legacy"]}f["!id"].rId1&&Ce(i,dg(l),ta(f))}return t.Strings!=null&&t.Strings.length>0&&(l="xl/sharedStrings."+r,Ce(i,l,Sg(t.Strings,t)),a.strs.push(l),De(t.wbrels,-1,"sharedStrings."+r,Oe.SST)),l="xl/workbook."+r,Ce(i,l,Gg(e)),a.workbooks.push(l),De(t.rels,1,l,Oe.WB),l="xl/theme/theme1.xml",Ce(i,l,Ag(e.Themes,t)),a.themes.push(l),De(t.wbrels,-1,"theme/theme1.xml",Oe.THEME),l="xl/styles."+r,Ce(i,l,kg(e,t)),a.styles.push(l),De(t.wbrels,-1,"styles."+r,Oe.STY),e.vbaraw&&n&&(l="xl/vbaProject.bin",Ce(i,l,e.vbaraw),a.vba.push(l),De(t.wbrels,-1,"vbaProject.bin",Oe.VBA)),l="xl/metadata."+r,Ce(i,l,Fg()),a.metadata.push(l),De(t.wbrels,-1,"metadata."+r,Oe.XLMETA),u.length>1&&(l="xl/persons/person.xml",Ce(i,l,V4(u)),a.people.push(l),De(t.wbrels,-1,"persons/person.xml",Oe.PEOPLE)),Ce(i,"[Content_Types].xml",ug(a,t)),Ce(i,"_rels/.rels",ta(t.rels)),Ce(i,"xl/_rels/workbook."+r+".rels",ta(t.wbrels)),delete t.revssf,delete t.ssf,i}function xT(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=fn(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function Zg(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return Bi(t.file,Ue.write(e,{type:Re?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return Ue.write(e,t)}function mT(e,t){var r=Qt(t||{}),n=dT(e,r);return pT(n,r)}function pT(e,t){var r={},n=Re?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(t.compression&&(r.compression="DEFLATE"),t.password)r.type=n;else switch(t.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":r.type=n;break;default:throw new Error("Unrecognized type "+t.type)}var a=e.FullPaths?Ue.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!t.compression}):e.generate(r);if(typeof Deno<"u"&&typeof a=="string"){if(t.type=="binary"||t.type=="base64")return a;a=new Uint8Array(Io(a))}return t.password&&typeof encrypt_agile<"u"?Zg(encrypt_agile(a,t.password),t):t.type==="file"?Bi(t.file,a):t.type=="string"?Za(a):a}function gT(e,t){var r=t||{},n=OE(e,r);return Zg(n,r)}function Br(e,t,r){r||(r="");var n=r+e;switch(t.type){case"base64":return _i(Ti(n));case"binary":return Ti(n);case"string":return e;case"file":return Bi(t.file,n,"utf8");case"buffer":return Re?gn(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):Br(n,{type:"binary"}).split("").map(function(a){return a.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function yT(e,t){switch(t.type){case"base64":return _i(e);case"binary":return e;case"string":return e;case"file":return Bi(t.file,e,"binary");case"buffer":return Re?gn(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function pl(e,t){switch(t.type){case"string":case"base64":case"binary":for(var r="",n=0;n<e.length;++n)r+=String.fromCharCode(e[n]);return t.type=="base64"?_i(r):t.type=="string"?Za(r):r;case"file":return Bi(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function e1(e,t){Gb(),nE(e);var r=Qt(t||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=e1(e,r);return r.type="array",Io(n)}var a=0;if(r.sheet&&(typeof r.sheet=="number"?a=r.sheet:a=e.SheetNames.indexOf(r.sheet),!e.SheetNames[a]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return Br(FE(e,r),r);case"slk":case"sylk":return Br(e4.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"htm":case"html":return Br(Yg(e.Sheets[e.SheetNames[a]],r),r);case"txt":return yT(t1(e.Sheets[e.SheetNames[a]],r),r);case"csv":return Br(sd(e.Sheets[e.SheetNames[a]],r),r,"\uFEFF");case"dif":return Br(t4.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"dbf":return pl(Zj.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"prn":return Br(r4.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"rtf":return Br(c4.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"eth":return Br(jg.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"fods":return Br(Qg(e,r),r);case"wk1":return pl(Nh.sheet_to_wk1(e.Sheets[e.SheetNames[a]],r),r);case"wk3":return pl(Nh.book_to_wk3(e,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),pl(Kg(e,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),gT(e,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return mT(e,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function vT(e){if(!e.bookType){var t={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(e.bookType=r.slice(1)),e.bookType=t[e.bookType]||e.bookType}}function wT(e,t,r){var n={};return n.type="file",n.file=t,vT(n),e1(e,n)}function bT(e,t,r,n,a,i,l,o){var c=Tt(r),d=o.defval,u=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),f=!0,h=a===1?[]:{};if(a!==1)if(Object.defineProperty)try{Object.defineProperty(h,"__rowNum__",{value:r,enumerable:!1})}catch{h.__rowNum__=r}else h.__rowNum__=r;if(!l||e[r])for(var m=t.s.c;m<=t.e.c;++m){var v=l?e[r][m]:e[n[m]+c];if(v===void 0||v.t===void 0){if(d===void 0)continue;i[m]!=null&&(h[i[m]]=d);continue}var x=v.v;switch(v.t){case"z":if(x==null)break;continue;case"e":x=x==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+v.t)}if(i[m]!=null){if(x==null)if(v.t=="e"&&x===null)h[i[m]]=null;else if(d!==void 0)h[i[m]]=d;else if(u&&x===null)h[i[m]]=null;else continue;else h[i[m]]=u&&(v.t!=="n"||v.t==="n"&&o.rawNumbers!==!1)?x:hn(v,x,o);x!=null&&(f=!1)}}return{row:h,isempty:f}}function po(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},n=0,a=1,i=[],l=0,o="",c={s:{r:0,c:0},e:{r:0,c:0}},d=t||{},u=d.range!=null?d.range:e["!ref"];switch(d.header===1?n=1:d.header==="A"?n=2:Array.isArray(d.header)?n=3:d.header==null&&(n=0),typeof u){case"string":c=Xe(u);break;case"number":c=Xe(e["!ref"]),c.s.r=u;break;default:c=u}n>0&&(a=0);var f=Tt(c.s.r),h=[],m=[],v=0,x=0,y=Array.isArray(e),p=c.s.r,g=0,w={};y&&!e[p]&&(e[p]=[]);var b=d.skipHidden&&e["!cols"]||[],P=d.skipHidden&&e["!rows"]||[];for(g=c.s.c;g<=c.e.c;++g)if(!(b[g]||{}).hidden)switch(h[g]=Rt(g),r=y?e[p][g]:e[h[g]+f],n){case 1:i[g]=g-c.s.c;break;case 2:i[g]=h[g];break;case 3:i[g]=d.header[g-c.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),o=l=hn(r,null,d),x=w[l]||0,!x)w[l]=1;else{do o=l+"_"+x++;while(w[o]);w[l]=x,w[o]=1}i[g]=o}for(p=c.s.r+a;p<=c.e.r;++p)if(!(P[p]||{}).hidden){var M=bT(e,c,p,h,n,i,y,d);(M.isempty===!1||(n===1?d.blankrows!==!1:d.blankrows))&&(m[v++]=M.row)}return m.length=v,m}var Ah=/"/g;function NT(e,t,r,n,a,i,l,o){for(var c=!0,d=[],u="",f=Tt(r),h=t.s.c;h<=t.e.c;++h)if(n[h]){var m=o.dense?(e[r]||[])[h]:e[n[h]+f];if(m==null)u="";else if(m.v!=null){c=!1,u=""+(o.rawNumbers&&m.t=="n"?m.v:hn(m,null,o));for(var v=0,x=0;v!==u.length;++v)if((x=u.charCodeAt(v))===a||x===i||x===34||o.forceQuotes){u='"'+u.replace(Ah,'""')+'"';break}u=="ID"&&(u='"ID"')}else m.f!=null&&!m.F?(c=!1,u="="+m.f,u.indexOf(",")>=0&&(u='"'+u.replace(Ah,'""')+'"')):u="";d.push(u)}return o.blankrows===!1&&c?null:d.join(l)}function sd(e,t){var r=[],n=t??{};if(e==null||e["!ref"]==null)return"";var a=Xe(e["!ref"]),i=n.FS!==void 0?n.FS:",",l=i.charCodeAt(0),o=n.RS!==void 0?n.RS:`
`,c=o.charCodeAt(0),d=new RegExp((i=="|"?"\\|":i)+"+$"),u="",f=[];n.dense=Array.isArray(e);for(var h=n.skipHidden&&e["!cols"]||[],m=n.skipHidden&&e["!rows"]||[],v=a.s.c;v<=a.e.c;++v)(h[v]||{}).hidden||(f[v]=Rt(v));for(var x=0,y=a.s.r;y<=a.e.r;++y)(m[y]||{}).hidden||(u=NT(e,a,y,f,l,c,i,n),u!=null&&(n.strip&&(u=u.replace(d,"")),(u||n.blankrows!==!1)&&r.push((x++?o:"")+u)));return delete n.dense,r.join("")}function t1(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=sd(e,t);return r}function jT(e){var t="",r,n="";if(e==null||e["!ref"]==null)return[];var a=Xe(e["!ref"]),i="",l=[],o,c=[],d=Array.isArray(e);for(o=a.s.c;o<=a.e.c;++o)l[o]=Rt(o);for(var u=a.s.r;u<=a.e.r;++u)for(i=Tt(u),o=a.s.c;o<=a.e.c;++o)if(t=l[o]+i,r=d?(e[u]||[])[o]:e[t],n="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;n=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}c[c.length]=t+"="+n}return c}function r1(e,t,r){var n=r||{},a=+!n.skipHeader,i=e||{},l=0,o=0;if(i&&n.origin!=null)if(typeof n.origin=="number")l=n.origin;else{var c=typeof n.origin=="string"?gt(n.origin):n.origin;l=c.r,o=c.c}var d,u={s:{c:0,r:0},e:{c:o,r:l+t.length-1+a}};if(i["!ref"]){var f=Xe(i["!ref"]);u.e.c=Math.max(u.e.c,f.e.c),u.e.r=Math.max(u.e.r,f.e.r),l==-1&&(l=f.e.r+1,u.e.r=l+t.length-1+a)}else l==-1&&(l=0,u.e.r=t.length-1+a);var h=n.header||[],m=0;t.forEach(function(x,y){Ct(x).forEach(function(p){(m=h.indexOf(p))==-1&&(h[m=h.length]=p);var g=x[p],w="z",b="",P=Be({c:o+m,r:l+y+a});d=Ai(i,P),g&&typeof g=="object"&&!(g instanceof Date)?i[P]=g:(typeof g=="number"?w="n":typeof g=="boolean"?w="b":typeof g=="string"?w="s":g instanceof Date?(w="d",n.cellDates||(w="n",g=qt(g)),b=n.dateNF||nt[14]):g===null&&n.nullError&&(w="e",g=0),d?(d.t=w,d.v=g,delete d.w,delete d.R,b&&(d.z=b)):i[P]=d={t:w,v:g},b&&(d.z=b))})}),u.e.c=Math.max(u.e.c,o+h.length-1);var v=Tt(l);if(a)for(m=0;m<h.length;++m)i[Rt(m+o)+v]={t:"s",v:h[m]};return i["!ref"]=ct(u),i}function ST(e,t){return r1(null,e,t)}function Ai(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var n=gt(t);return e[n.r]||(e[n.r]=[]),e[n.r][n.c]||(e[n.r][n.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?Ai(e,Be(t)):Ai(e,Be({r:t,c:r||0}))}function _T(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function ET(){return{SheetNames:[],Sheets:{}}}function TT(e,t,r,n){var a=1;if(!r)for(;a<=65535&&e.SheetNames.indexOf(r="Sheet"+a)!=-1;++a,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(r)>=0){var i=r.match(/(^.*?)(\d+)$/);a=i&&+i[2]||0;var l=i&&i[1]||r;for(++a;a<=65535&&e.SheetNames.indexOf(r=l+a)!=-1;++a);}if(Vg(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function kT(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var n=_T(e,t);switch(e.Workbook.Sheets[n]||(e.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[n].Hidden=r}function CT(e,t){return e.z=t,e}function n1(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function AT(e,t,r){return n1(e,"#"+t,r)}function FT(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function PT(e,t,r,n){for(var a=typeof t!="string"?t:Xe(t),i=typeof t=="string"?t:ct(t),l=a.s.r;l<=a.e.r;++l)for(var o=a.s.c;o<=a.e.c;++o){var c=Ai(e,l,o);c.t="n",c.F=i,delete c.v,l==a.s.r&&o==a.s.c&&(c.f=r,n&&(c.D=!0))}return e}var Pc={encode_col:Rt,encode_row:Tt,encode_cell:Be,encode_range:ct,decode_col:X0,decode_row:G0,split_cell:GN,decode_cell:gt,decode_range:cr,format_cell:hn,sheet_add_aoa:ng,sheet_add_json:r1,sheet_add_dom:Jg,aoa_to_sheet:wa,json_to_sheet:ST,table_to_sheet:qg,table_to_book:tT,sheet_to_csv:sd,sheet_to_txt:t1,sheet_to_json:po,sheet_to_html:Yg,sheet_to_formulae:jT,sheet_to_row_object_array:po,sheet_get_cell:Ai,book_new:ET,book_append_sheet:TT,book_set_sheet_visibility:kT,cell_set_number_format:CT,cell_set_hyperlink:n1,cell_set_internal_link:AT,cell_add_comment:FT,sheet_set_array_formula:PT,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const Fh={pending:"bg-yellow-100 text-yellow-700",approved:"bg-green-100 text-green-700",rejected:"bg-red-100 text-red-700"},OT={pending:$t,approved:Qe,rejected:Nr};function RT({timesheets:e,selectedIds:t,onSelect:r,onSelectAll:n,onRowClick:a}){const i=e.length>0&&t.length===e.length,l=t.length>0&&t.length<e.length,o=(f,h="INR")=>new Intl.NumberFormat("en-IN",{style:"currency",currency:h,minimumFractionDigits:0,maximumFractionDigits:0}).format(f),c=f=>f?new Date(f).toLocaleDateString("en-IN",{day:"numeric",month:"short",year:"numeric"}):"-",d=f=>{if(!f)return"0h";const h=Math.floor(f),m=Math.round((f-h)*60);return m===0?`${h}h`:`${h}h ${m}m`},u=f=>{const h=OT[f]||$t;return s.jsxs("span",{className:`inline-flex items-center gap-1.5 px-2.5 py-1 rounded-full text-xs font-medium ${Fh[f]||Fh.pending}`,children:[s.jsx(h,{className:"w-3 h-3"}),f.charAt(0).toUpperCase()+f.slice(1)]})};return e.length===0?s.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-12 text-center",children:[s.jsx($t,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),s.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No timesheets found"}),s.jsx("p",{className:"text-sm text-gray-500",children:"Try adjusting your filters or create a new timesheet entry."})]}):s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"w-full",children:[s.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:s.jsxs("tr",{children:[s.jsx("th",{className:"px-4 py-3 text-left",children:s.jsx("input",{type:"checkbox",checked:i,ref:f=>{f&&(f.indeterminate=l)},onChange:f=>n(f.target.checked),className:"w-4 h-4 text-gray-600 border-gray-300 rounded focus:ring-gray-500"})}),s.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-700 uppercase tracking-wider",children:"Date"}),s.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-700 uppercase tracking-wider",children:"Employee"}),s.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-700 uppercase tracking-wider",children:"Project"}),s.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-700 uppercase tracking-wider",children:"Hours"}),s.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-700 uppercase tracking-wider",children:"Billable"}),s.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-700 uppercase tracking-wider",children:"Cost"}),s.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-700 uppercase tracking-wider",children:"Status"})]})}),s.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:e.map(f=>s.jsxs("tr",{onClick:()=>a(f),className:"hover:bg-gray-50 cursor-pointer",children:[s.jsx("td",{className:"px-4 py-3 whitespace-nowrap",onClick:h=>h.stopPropagation(),children:s.jsx("input",{type:"checkbox",checked:t.includes(f.id),onChange:h=>r(f.id,h.target.checked),className:"w-4 h-4 text-gray-600 border-gray-300 rounded focus:ring-gray-500"})}),s.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-900",children:c(f.workedOn)}),s.jsxs("td",{className:"px-4 py-3 whitespace-nowrap",children:[s.jsx("div",{className:"text-sm font-medium text-gray-900",children:f.userName||"Unknown"}),f.userEmail&&s.jsx("div",{className:"text-xs text-gray-500 truncate max-w-[180px]",children:f.userEmail})]}),s.jsxs("td",{className:"px-4 py-3 whitespace-nowrap",children:[s.jsx("div",{className:"text-sm text-gray-900",children:f.projectName||"-"}),f.taskTitle&&s.jsx("div",{className:"text-xs text-gray-500 truncate max-w-[180px]",children:f.taskTitle})]}),s.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-900 font-medium",children:d(f.hours)}),s.jsx("td",{className:"px-4 py-3 whitespace-nowrap",children:f.isBillable?s.jsx("span",{className:"inline-flex items-center px-2.5 py-1 rounded-full text-xs font-medium bg-green-100 text-green-800",children:"Yes"}):s.jsx("span",{className:"inline-flex items-center px-2.5 py-1 rounded-full text-xs font-medium bg-gray-100 text-gray-800",children:"No"})}),s.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-900 font-medium",children:o(f.cost||0)}),s.jsx("td",{className:"px-4 py-3 whitespace-nowrap",children:u(f.status||"pending")})]},f.id))})]})})}function IT({filters:e,projects:t,employees:r,onFilterChange:n,onSavedViewChange:a}){const[i,l]=T.useState(!1),o=Gr(),c=((o==null?void 0:o.role)||"").toLowerCase()==="employee",d=[{id:"pending",label:"Pending Approval",filters:{status:"pending"}},{id:"billable-only",label:"Billable Only",filters:{is_billable:"true"}},{id:"this-week",label:"This Week",filters:f()}],u=[{key:"is_billable",label:"Billable",value:"true"},{key:"this_week",label:"This Week",value:f()},{key:"this_month",label:"This Month",value:h()}];function f(){const y=new Date,p=new Date(y);return p.setDate(y.getDate()-y.getDay()),{date_from:p.toISOString().split("T")[0],date_to:y.toISOString().split("T")[0]}}function h(){const y=new Date;return{date_from:new Date(y.getFullYear(),y.getMonth(),1).toISOString().split("T")[0],date_to:y.toISOString().split("T")[0]}}const m=y=>{y.value==="true"?n({[y.key]:y.value}):typeof y.value=="object"&&n(y.value)},v=y=>{n({[y]:void 0})},x=Object.keys(e).filter(y=>{const p=e[y];return!(p===void 0||p===""||p===null||Array.isArray(p)&&p.length===0)}).length;return s.jsxs("div",{className:"relative",children:[s.jsxs("button",{onClick:()=>l(!i),className:"flex items-center gap-2 px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",children:[s.jsx(qn,{className:"w-4 h-4"}),s.jsx("span",{children:"Filters"}),x>0&&s.jsx("span",{className:"px-2 py-0.5 text-xs font-semibold text-white rounded-full",style:{backgroundColor:"#714b67"},children:x}),s.jsx(Wn,{className:`w-4 h-4 transition-transform ${i?"rotate-180":""}`})]}),i&&s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"fixed inset-0 z-10",onClick:()=>l(!1)}),s.jsxs("div",{className:"absolute right-0 mt-2 w-80 bg-white border border-gray-200 rounded-lg shadow-xl z-20",children:[s.jsxs("div",{className:"p-4 border-b border-gray-200",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsx("h3",{className:"text-sm font-semibold text-gray-900",children:"Filters"}),s.jsx("button",{onClick:()=>l(!1),className:"text-gray-400 hover:text-gray-600",children:s.jsx(ze,{className:"w-4 h-4"})})]}),s.jsxs("div",{className:"mb-4",children:[s.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2",children:"Saved Views"}),s.jsxs("select",{onChange:y=>{if(y.target.value){const p=d.find(g=>g.id===y.target.value);p&&a(p.filters)}y.target.value=""},className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-400",children:[s.jsx("option",{value:"",children:"Select a view..."}),d.map(y=>s.jsx("option",{value:y.id,children:y.label},y.id))]})]}),s.jsxs("div",{className:"mb-4",children:[s.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2",children:"Quick Filters"}),s.jsx("div",{className:"flex flex-wrap gap-2",children:u.map(y=>s.jsx("button",{onClick:()=>m(y),className:"px-3 py-1 text-xs font-medium text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200",children:y.label},y.key))})]})]}),s.jsxs("div",{className:"p-4 space-y-4 max-h-96 overflow-y-auto",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Project"}),s.jsxs("select",{value:e.project_id||"",onChange:y=>n({project_id:y.target.value||void 0}),className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-400",children:[s.jsx("option",{value:"",children:"All Projects"}),t.map(y=>s.jsx("option",{value:y.id,children:y.name},y.id))]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Status"}),s.jsxs("select",{value:e.status||"",onChange:y=>n({status:y.target.value||void 0}),className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-400",children:[s.jsx("option",{value:"",children:"All Statuses"}),s.jsx("option",{value:"pending",children:"Pending"}),s.jsx("option",{value:"approved",children:"Approved"}),s.jsx("option",{value:"rejected",children:"Rejected"})]})]}),!c&&s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Employee"}),s.jsxs("select",{value:e.user_id||"",onChange:y=>n({user_id:y.target.value||void 0}),className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-400",children:[s.jsx("option",{value:"",children:"All Employees"}),r.map(y=>s.jsx("option",{value:y.id,children:y.name},y.id))]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Billable"}),s.jsxs("select",{value:e.is_billable||"",onChange:y=>n({is_billable:y.target.value||void 0}),className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-400",children:[s.jsx("option",{value:"",children:"All"}),s.jsx("option",{value:"true",children:"Billable"}),s.jsx("option",{value:"false",children:"Not Billable"})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Date From"}),s.jsx("input",{type:"date",value:e.date_from||"",onChange:y=>n({date_from:y.target.value||void 0}),className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-400"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Date To"}),s.jsx("input",{type:"date",value:e.date_to||"",onChange:y=>n({date_to:y.target.value||void 0}),className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-400"})]})]}),x>0&&s.jsxs("div",{className:"p-4 border-t border-gray-200",children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsx("span",{className:"text-xs font-medium text-gray-700",children:"Active Filters"}),s.jsx("button",{onClick:()=>{const y=Object.keys(e),p={};y.forEach(g=>{p[g]=void 0}),p.date_from=void 0,p.date_to=void 0,n(p)},className:"text-xs hover:underline",style:{color:"#714b67"},children:"Clear All"})]}),s.jsx("div",{className:"flex flex-wrap gap-2",children:Object.keys(e).map(y=>{const p=e[y];if(p===void 0||p===""||p===null||Array.isArray(p)&&p.length===0)return null;let g=p;Array.isArray(p)&&(g=p.join(", "));const w=y.replace(/_/g," ").replace(/\b\w/g,b=>b.toUpperCase());return s.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 text-xs bg-gray-100 text-gray-700 rounded",children:[s.jsxs("span",{children:[w,": ",g]}),s.jsx("button",{onClick:b=>{b.stopPropagation(),v(y)},className:"text-gray-500 hover:text-gray-700 ml-1",type:"button",children:s.jsx(ze,{className:"w-3 h-3"})})]},y)})})]})]})]})]})}function DT({selectedCount:e,onBulkApprove:t,onBulkReject:r,onExportCSV:n,onExportExcel:a}){const[i,l]=T.useState(!1),[o,c]=T.useState("");if(e===0)return null;const d=()=>{o.trim()&&(r(o),c(""),l(!1))};return s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-3 mb-4",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("div",{className:"flex items-center gap-3",children:s.jsxs("span",{className:"text-sm font-medium text-gray-900",children:[e," timesheet",e!==1?"s":""," selected"]})}),s.jsxs("div",{className:"flex items-center gap-2",children:[t&&s.jsxs("button",{onClick:t,className:"flex items-center gap-2 px-4 py-2 text-sm font-medium text-white bg-green-600 rounded-lg hover:bg-green-700",children:[s.jsx(Qe,{className:"w-4 h-4"}),"Approve"]}),r&&s.jsxs("button",{onClick:()=>l(!0),className:"flex items-center gap-2 px-4 py-2 text-sm font-medium text-white bg-red-600 rounded-lg hover:bg-red-700",children:[s.jsx(Nr,{className:"w-4 h-4"}),"Reject"]}),s.jsxs("button",{onClick:n,className:"flex items-center gap-2 px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",title:"Export as CSV",children:[s.jsx(da,{className:"w-4 h-4"}),"CSV"]}),a&&s.jsxs("button",{onClick:a,className:"flex items-center gap-2 px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",title:"Export as Excel",children:[s.jsx(da,{className:"w-4 h-4"}),"Excel"]})]})]})}),i&&s.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black bg-opacity-50",children:s.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full p-6",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Reject Timesheets"}),s.jsxs("p",{className:"text-sm text-gray-600 mb-4",children:["Please provide a reason for rejecting ",e," timesheet",e!==1?"s":"","."]}),s.jsx("textarea",{value:o,onChange:u=>c(u.target.value),placeholder:"Enter rejection reason...",rows:4,className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-red-500 mb-4"}),s.jsxs("div",{className:"flex items-center justify-end gap-3",children:[s.jsx("button",{onClick:()=>{l(!1),c("")},className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",children:"Cancel"}),s.jsx("button",{onClick:d,disabled:!o.trim(),className:"px-4 py-2 text-sm font-medium text-white bg-red-600 rounded-lg hover:bg-red-700 disabled:opacity-50 disabled:cursor-not-allowed",children:"Reject"})]})]})})]})}const Ph={pending:"bg-yellow-100 text-yellow-700",approved:"bg-green-100 text-green-700",rejected:"bg-red-100 text-red-700"};function LT({timesheet:e,onClose:t,onUpdate:r,onApprove:n,onReject:a}){const[i,l]=T.useState(e),[o,c]=T.useState(!1),[d,u]=T.useState(!1),[f,h]=T.useState(""),[m,v]=T.useState(null);T.useEffect(()=>{v(Gr()),e!=null&&e.id?x():l(e)},[e]);const x=async()=>{c(!0);try{const D=await $r.getById(e.id);D.success&&l(D.data)}catch(D){console.error("Error loading timesheet details:",D)}finally{c(!1)}},y=(D,z="INR")=>new Intl.NumberFormat("en-IN",{style:"currency",currency:z,minimumFractionDigits:0,maximumFractionDigits:0}).format(D),p=D=>D?new Date(D).toLocaleDateString("en-IN",{day:"numeric",month:"short",year:"numeric"}):"-",g=D=>D?new Date(D).toLocaleString("en-IN",{day:"numeric",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"}):"-",w=D=>{if(!D)return"0h";const z=Math.floor(D),ne=Math.round((D-z)*60);return ne===0?`${z}h`:`${z}h ${ne}m`},b=D=>{const z=D==="pending"?$t:D==="approved"?Qe:Nr;return s.jsxs("span",{className:`inline-flex items-center gap-1.5 px-3 py-1.5 rounded-full text-sm font-medium ${Ph[D]||Ph.pending}`,children:[s.jsx(z,{className:"w-4 h-4"}),D.charAt(0).toUpperCase()+D.slice(1)]})},M=((m==null?void 0:m.role)||"").toLowerCase()==="employee",j=!M&&(i==null?void 0:i.status)==="pending",O=!M&&((i==null?void 0:i.status)==="pending"||(i==null?void 0:i.status)==="approved");i==null||i.status;const R=async()=>{try{const D=await $r.approve(i.id);D.success?(n(i.id),r(),t()):alert(D.message||"Failed to approve timesheet")}catch(D){console.error("Error approving timesheet:",D),alert(D.message||"Failed to approve timesheet")}},I=async()=>{if(f.trim())try{const D=await $r.reject(i.id,f);D.success?(a(i.id),r(),u(!1),h(""),t()):alert(D.message||"Failed to reject timesheet")}catch(D){console.error("Error rejecting timesheet:",D),alert(D.message||"Failed to reject timesheet")}};return s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"fixed inset-0 z-40 bg-black bg-opacity-30",onClick:t}),s.jsx("div",{className:"fixed right-0 top-0 h-full w-full max-w-2xl bg-white shadow-xl z-50 overflow-y-auto",children:o?s.jsx("div",{className:"flex items-center justify-center h-full",children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"inline-block animate-spin rounded-full h-12 w-12 border-b-2 border-gray-900 mb-4"}),s.jsx("p",{className:"text-gray-600",children:"Loading timesheet details..."})]})}):s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"sticky top-0 bg-white border-b border-gray-200 px-6 py-4 flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[b(i==null?void 0:i.status),s.jsxs("div",{children:[s.jsx("div",{className:"text-2xl font-semibold text-gray-900",children:w((i==null?void 0:i.hours)||0)}),s.jsx("div",{className:"text-sm text-gray-500",children:y((i==null?void 0:i.cost)||0)})]})]}),s.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-600",children:s.jsx(ze,{className:"w-5 h-5"})})]}),s.jsxs("div",{className:"p-6 space-y-6",children:[s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"Project"}),s.jsx("p",{className:"text-sm font-medium text-gray-900",children:(i==null?void 0:i.projectName)||"-"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"Task"}),s.jsx("p",{className:"text-sm font-medium text-gray-900",children:(i==null?void 0:i.taskTitle)||"-"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"Employee"}),s.jsx("p",{className:"text-sm font-medium text-gray-900",children:(i==null?void 0:i.userName)||"-"}),(i==null?void 0:i.userEmail)&&s.jsx("p",{className:"text-xs text-gray-500",children:i.userEmail})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"Date Worked"}),s.jsx("p",{className:"text-sm font-medium text-gray-900",children:p(i==null?void 0:i.workedOn)})]}),(i==null?void 0:i.startTime)&&s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"Start Time"}),s.jsx("p",{className:"text-sm font-medium text-gray-900",children:g(i.startTime)})]}),(i==null?void 0:i.endTime)&&s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"End Time"}),s.jsx("p",{className:"text-sm font-medium text-gray-900",children:g(i.endTime)})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"Hours"}),s.jsx("p",{className:"text-sm font-medium text-gray-900",children:w((i==null?void 0:i.hours)||0)})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"Billable"}),s.jsx("p",{className:"text-sm font-medium text-gray-900",children:i!=null&&i.isBillable?"Yes":"No"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"Cost Rate"}),s.jsx("p",{className:"text-sm font-medium text-gray-900",children:i!=null&&i.costRate?y(i.costRate)+"/hr":"-"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"Total Cost"}),s.jsx("p",{className:"text-sm font-medium text-gray-900",children:y((i==null?void 0:i.cost)||0)})]})]}),(i==null?void 0:i.note)&&s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"Notes"}),s.jsx("p",{className:"text-sm text-gray-900 whitespace-pre-wrap",children:i.note})]}),(i==null?void 0:i.approvedBy)&&s.jsxs("div",{className:"border-t border-gray-200 pt-4",children:[s.jsx("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"Approved By"}),s.jsx("p",{className:"text-sm font-medium text-gray-900",children:i.approverName||"-"}),i.approvedAt&&s.jsx("p",{className:"text-xs text-gray-500 mt-1",children:g(i.approvedAt)})]}),s.jsxs("div",{className:"flex items-center gap-3 pt-4 border-t border-gray-200",children:[j&&s.jsxs("button",{onClick:R,className:"flex items-center gap-2 px-4 py-2 text-sm font-medium text-white bg-green-600 rounded-lg hover:bg-green-700",children:[s.jsx(Qe,{className:"w-4 h-4"}),"Approve"]}),O&&s.jsxs("button",{onClick:()=>u(!0),className:"flex items-center gap-2 px-4 py-2 text-sm font-medium text-white bg-red-600 rounded-lg hover:bg-red-700",children:[s.jsx(Nr,{className:"w-4 h-4"}),"Reject"]})]})]})]})}),d&&s.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black bg-opacity-50",children:s.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full p-6",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Reject Timesheet"}),s.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Please provide a reason for rejecting this timesheet."}),s.jsx("textarea",{value:f,onChange:D=>h(D.target.value),placeholder:"Enter rejection reason...",rows:4,className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-red-500 mb-4"}),s.jsxs("div",{className:"flex items-center justify-end gap-3",children:[s.jsx("button",{onClick:()=>{u(!1),h("")},className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",children:"Cancel"}),s.jsx("button",{onClick:I,disabled:!f.trim(),className:"px-4 py-2 text-sm font-medium text-white bg-red-600 rounded-lg hover:bg-red-700 disabled:opacity-50 disabled:cursor-not-allowed",children:"Reject"})]})]})})]})}function MT({timesheet:e,projects:t,employees:r,onClose:n,onSave:a}){const[i,l]=T.useState({project_id:(e==null?void 0:e.projectId)||"",task_id:(e==null?void 0:e.taskId)||"",user_id:(e==null?void 0:e.userId)||"",worked_on:(e==null?void 0:e.workedOn)||new Date().toISOString().split("T")[0],start_time:e!=null&&e.startTime?e.startTime.slice(0,16):"",end_time:e!=null&&e.endTime?e.endTime.slice(0,16):"",hours:(e==null?void 0:e.hours)||"",is_billable:(e==null?void 0:e.isBillable)!==void 0?e.isBillable:!0,note:(e==null?void 0:e.note)||""}),[o,c]=T.useState([]),[d,u]=T.useState(!1),[f,h]=T.useState({}),[m,v]=T.useState(null);T.useEffect(()=>{if(i.start_time&&i.end_time){const p=new Date(i.start_time),w=(new Date(i.end_time)-p)/(1e3*60*60);w>0&&(v(w.toFixed(2)),i.hours||l(b=>({...b,hours:w.toFixed(2)})))}},[i.start_time,i.end_time]);const x=p=>{const{name:g,value:w,type:b,checked:P}=p.target;l(M=>({...M,[g]:b==="checkbox"?P:w})),f[g]&&h(M=>{const j={...M};return delete j[g],j})},y=async p=>{p.preventDefault();const g={};if(i.project_id||(g.project_id="Project is required"),i.user_id||(g.user_id="Employee is required"),i.worked_on||(g.worked_on="Date worked is required"),(!i.hours||parseFloat(i.hours)<=0)&&(g.hours="Valid hours are required"),Object.keys(g).length>0){h(g);return}u(!0);try{const w={...i,hours:parseFloat(i.hours),start_time:i.start_time||void 0,end_time:i.end_time||void 0,task_id:i.task_id||void 0};let b;e?b=await $r.update(e.id,w):b=await $r.create(w),b.success?(a(b.data),n()):h({submit:b.message||"Failed to save timesheet"})}catch(w){console.error("Error saving timesheet:",w),h({submit:w.message||"Failed to save timesheet"})}finally{u(!1)}};return s.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black bg-opacity-50",children:s.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[s.jsxs("div",{className:"sticky top-0 bg-white border-b border-gray-200 px-6 py-4 flex items-center justify-between",children:[s.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:e?"Edit Timesheet":"New Timesheet"}),s.jsx("button",{onClick:n,className:"text-gray-400 hover:text-gray-600",children:s.jsx(ze,{className:"w-5 h-5"})})]}),s.jsxs("form",{onSubmit:y,className:"p-6 space-y-4",children:[f.submit&&s.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-3 text-sm text-red-800",children:f.submit}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Project ",s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsxs("select",{name:"project_id",value:i.project_id,onChange:x,className:`w-full px-3 py-2 text-sm border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-400 ${f.project_id?"border-red-300":"border-gray-300"}`,children:[s.jsx("option",{value:"",children:"Select project..."}),t.map(p=>s.jsx("option",{value:p.id,children:p.name},p.id))]}),f.project_id&&s.jsx("p",{className:"mt-1 text-xs text-red-600",children:f.project_id})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Employee ",s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsxs("select",{name:"user_id",value:i.user_id,onChange:x,className:`w-full px-3 py-2 text-sm border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-400 ${f.user_id?"border-red-300":"border-gray-300"}`,children:[s.jsx("option",{value:"",children:"Select employee..."}),r.map(p=>s.jsx("option",{value:p.id,children:p.name},p.id))]}),f.user_id&&s.jsx("p",{className:"mt-1 text-xs text-red-600",children:f.user_id})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Date Worked ",s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsx("input",{type:"date",name:"worked_on",value:i.worked_on,onChange:x,className:`w-full px-3 py-2 text-sm border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-400 ${f.worked_on?"border-red-300":"border-gray-300"}`}),f.worked_on&&s.jsx("p",{className:"mt-1 text-xs text-red-600",children:f.worked_on})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Hours ",s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsx("input",{type:"number",name:"hours",value:i.hours,onChange:x,step:"0.25",min:"0",max:"24",className:`w-full px-3 py-2 text-sm border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-400 ${f.hours?"border-red-300":"border-gray-300"}`}),m&&i.start_time&&i.end_time&&s.jsxs("p",{className:"mt-1 text-xs text-gray-500",children:["Calculated: ",m," hours"]}),f.hours&&s.jsx("p",{className:"mt-1 text-xs text-red-600",children:f.hours})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Start Time"}),s.jsx("input",{type:"datetime-local",name:"start_time",value:i.start_time,onChange:x,className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-400"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"End Time"}),s.jsx("input",{type:"datetime-local",name:"end_time",value:i.end_time,onChange:x,className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-400"})]})]}),s.jsxs("div",{className:"flex items-center",children:[s.jsx("input",{type:"checkbox",name:"is_billable",id:"is_billable",checked:i.is_billable,onChange:x,className:"w-4 h-4 text-gray-600 rounded focus:ring-gray-500"}),s.jsx("label",{htmlFor:"is_billable",className:"ml-2 text-sm font-medium text-gray-700",children:"Billable to customer"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description/Notes"}),s.jsx("textarea",{name:"note",value:i.note,onChange:x,rows:3,className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-400"})]}),s.jsxs("div",{className:"flex items-center justify-end gap-3 pt-4 border-t border-gray-200",children:[s.jsx("button",{type:"button",onClick:n,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",children:"Cancel"}),s.jsx("button",{type:"submit",disabled:d,className:"px-4 py-2 text-sm font-medium text-white rounded-lg hover:opacity-90 disabled:opacity-50",style:{backgroundColor:"#714b67"},children:d?"Saving...":e?"Update":"Create"})]})]})]})})}function BT(){const[e,t]=T.useState([]),[r,n]=T.useState([]),[a,i]=T.useState({totalHours:0,billableHours:0,pendingApprovals:0,totalCost:0}),[l,o]=T.useState({date_from:I(),date_to:new Date().toISOString().split("T")[0]}),[c,d]=T.useState(""),[u,f]=T.useState([]),[h,m]=T.useState(null),[v,x]=T.useState(!1),[y,p]=T.useState(!1),[g,w]=T.useState(null),[b,P]=T.useState(!0),[M,j]=T.useState(null),O=Gr(),R=((O==null?void 0:O.role)||"").toLowerCase()==="employee";function I(){const G=new Date;return G.setDate(G.getDate()-90),G.toISOString().split("T")[0]}const D=async()=>{try{P(!0),j(null);const G=await yr.getAll();G.success&&n(G.data);const J=await $r.getAll(l);J.success?t(J.data):j(J.message||"Failed to load timesheets");const ve=await $r.getStats(l);ve.success&&i(ve.data)}catch(G){console.error("Error loading data:",G),j("Unable to connect to server. Please try again.")}finally{P(!1)}};T.useEffect(()=>{D()},[l]);const z=G=>{Object.keys(G).length===0?o({date_from:I(),date_to:new Date().toISOString().split("T")[0]}):o(J=>{const ve={...J};return Object.keys(G).forEach(Se=>{const se=G[Se];se===void 0||se===""||se===null||Array.isArray(se)&&se.length===0?delete ve[Se]:ve[Se]=se}),ve}),f([])},ne=G=>{o(G),f([])},Ne=(G,J)=>{f(J?ve=>[...ve,G]:ve=>ve.filter(Se=>Se!==G))},ue=G=>{f(G?e.map(J=>J.id):[])},je=G=>{m(G),x(!0)},q=async()=>{try{(await $r.bulkApprove(u)).success&&(f([]),D())}catch(G){console.error("Error bulk approving:",G)}},W=async G=>{try{(await $r.bulkReject(u,G)).success&&(f([]),D())}catch(J){console.error("Error bulk rejecting:",J)}},k=()=>(u.length>0?e.filter(J=>u.includes(J.id)):he).map(J=>({Date:J.workedOn||"",Employee:J.userName||"",Email:J.userEmail||"",Project:J.projectName||"",Task:J.taskTitle||"",Hours:J.hours||0,Billable:J.isBillable?"Yes":"No","Bill Rate":J.billRate||"","Cost Rate":J.costRate||"",Cost:J.cost||0,Status:J.status||"pending",Note:J.note||"","Approved By":J.approverName||"","Approved At":J.approvedAt||""})),K=()=>{const G=k();if(G.length===0){alert("No data to export. Please select timesheets or adjust your filters.");return}const J=Object.keys(G[0]||{}),ve=G.map(_e=>J.map(de=>_e[de]||"")),Se=[J.join(","),...ve.map(_e=>_e.map(de=>`"${String(de).replace(/"/g,'""')}"`).join(","))].join(`
`),se=new Blob([Se],{type:"text/csv;charset=utf-8;"}),pe=window.URL.createObjectURL(se),Ae=document.createElement("a");Ae.href=pe,Ae.download=`timesheets-${new Date().toISOString().split("T")[0]}.csv`,Ae.click(),window.URL.revokeObjectURL(pe)},te=()=>{const G=k();if(G.length===0){alert("No data to export. Please select timesheets or adjust your filters.");return}const J=Pc.json_to_sheet(G),ve=Pc.book_new();Pc.book_append_sheet(ve,J,"Timesheets");const Se=15,se=Object.keys(G[0]||{}).map(()=>({wch:Se}));J["!cols"]=se,wT(ve,`timesheets-${new Date().toISOString().split("T")[0]}.xlsx`)},E=G=>{f(J=>J.filter(ve=>ve!==G)),D()},B=G=>{f(J=>J.filter(ve=>ve!==G)),D()},L=()=>{D(),p(!1),w(null)},U=G=>new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR",minimumFractionDigits:0,maximumFractionDigits:0}).format(G),ee=G=>{if(!G)return"0h";const J=Math.floor(G),ve=Math.round((G-J)*60);return ve===0?`${J}h`:`${J}h ${ve}m`},he=e.filter(G=>{var ve,Se,se,pe;if(!c.trim())return!0;const J=c.toLowerCase();return((ve=G.userName)==null?void 0:ve.toLowerCase().includes(J))||((Se=G.projectName)==null?void 0:Se.toLowerCase().includes(J))||((se=G.taskTitle)==null?void 0:se.toLowerCase().includes(J))||((pe=G.note)==null?void 0:pe.toLowerCase().includes(J))}),xe=e.reduce((G,J)=>(J.userId&&!G.find(ve=>ve.id===J.userId)&&G.push({id:J.userId,name:J.userName||"Unknown"}),G),[]);return s.jsxs("div",{className:"h-full bg-gray-50",children:[s.jsxs("header",{className:"bg-white border-b border-gray-200 px-6 py-4",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsxs("div",{className:"flex items-center gap-5 flex-1",children:[s.jsx("h1",{className:"text-2xl font-semibold text-gray-900",children:"Timesheets"}),s.jsxs("div",{className:"relative flex-1 max-w-md",children:[s.jsx(pn,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),s.jsx("input",{value:c,onChange:G=>d(G.target.value),type:"text",placeholder:"Search timesheets...",className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-400 focus:border-transparent text-sm",disabled:b})]})]}),s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsxs("button",{onClick:K,className:"flex items-center gap-2 px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",title:"Export as CSV",children:[s.jsx(da,{className:"w-4 h-4"}),s.jsx("span",{className:"hidden sm:inline",children:"CSV"})]}),s.jsxs("button",{onClick:te,className:"flex items-center gap-2 px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",title:"Export as Excel",children:[s.jsx(da,{className:"w-4 h-4"}),s.jsx("span",{className:"hidden sm:inline",children:"Excel"})]}),s.jsx(IT,{filters:l,projects:r,employees:xe,onFilterChange:z,onSavedViewChange:ne}),s.jsxs("button",{onClick:()=>{w(null),p(!0)},className:"px-4 py-2 text-sm font-medium text-white rounded-lg hover:opacity-90 transition-opacity disabled:opacity-50",style:{backgroundColor:"#714b67"},disabled:b,children:[s.jsx(lr,{className:"inline w-4 h-4 mr-2"})," New Timesheet"]})]})]}),s.jsxs("div",{className:"grid grid-cols-4 gap-3 mb-4",children:[s.jsxs("div",{className:"bg-gray-50 rounded-lg p-3",children:[s.jsx("div",{className:"text-sm text-gray-600 mb-1",children:"Total Hours"}),s.jsx("div",{className:"text-xl font-semibold",style:{color:"#714b67"},children:ee(a.totalHours)})]}),s.jsxs("div",{className:"bg-gray-50 rounded-lg p-3",children:[s.jsx("div",{className:"text-sm text-gray-600 mb-1",children:"Billable Hours"}),s.jsx("div",{className:"text-xl font-semibold text-gray-900",children:ee(a.billableHours)})]}),s.jsxs("div",{className:"bg-gray-50 rounded-lg p-3",children:[s.jsx("div",{className:"text-sm text-gray-600 mb-1",children:"Pending Approvals"}),s.jsx("div",{className:"text-xl font-semibold text-gray-900",children:a.pendingApprovals})]}),s.jsxs("div",{className:"bg-gray-50 rounded-lg p-3",children:[s.jsx("div",{className:"text-sm text-gray-600 mb-1",children:"Total Cost"}),s.jsx("div",{className:"text-xl font-semibold text-gray-900",children:U(a.totalCost)})]})]}),s.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[s.jsx("button",{onClick:()=>z({status:"pending"}),className:`px-3 py-1.5 text-sm font-medium rounded-lg transition-colors ${l.status==="pending"?"text-white":"bg-white text-gray-700 border border-gray-300 hover:bg-gray-50"}`,style:l.status==="pending"?{backgroundColor:"#714b67"}:{},children:"Pending"}),s.jsx("button",{onClick:()=>z({status:"approved"}),className:`px-3 py-1.5 text-sm font-medium rounded-lg transition-colors ${l.status==="approved"?"text-white":"bg-white text-gray-700 border border-gray-300 hover:bg-gray-50"}`,style:l.status==="approved"?{backgroundColor:"#714b67"}:{},children:"Approved"}),s.jsx("button",{onClick:()=>z({status:"rejected"}),className:`px-3 py-1.5 text-sm font-medium rounded-lg transition-colors ${l.status==="rejected"?"text-white":"bg-white text-gray-700 border border-gray-300 hover:bg-gray-50"}`,style:l.status==="rejected"?{backgroundColor:"#714b67"}:{},children:"Rejected"}),s.jsx("button",{onClick:()=>z({status:void 0}),className:`px-3 py-1.5 text-sm font-medium rounded-lg transition-colors ${l.status?"bg-white text-gray-700 border border-gray-300 hover:bg-gray-50":"text-white"}`,style:l.status?{}:{backgroundColor:"#714b67"},children:"All"})]})]}),s.jsxs("div",{className:"p-6",children:[b&&s.jsx("div",{className:"flex items-center justify-center h-64",children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"inline-block animate-spin rounded-full h-10 w-10 border-b-2 border-gray-900 mb-3"}),s.jsx("p",{className:"text-sm text-gray-600",children:"Loading timesheets..."})]})}),M&&!b&&s.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 mb-4",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("svg",{className:"w-5 h-5 text-red-600",fill:"currentColor",viewBox:"0 0 20 20",children:s.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})}),s.jsx("span",{className:"text-sm text-red-800 font-medium",children:M})]}),s.jsx("button",{onClick:D,className:"text-sm text-red-600 hover:text-red-800 font-medium",children:"Retry"})]})}),!b&&!M&&!R&&s.jsx(DT,{selectedCount:u.length,onBulkApprove:q,onBulkReject:W,onExportCSV:K,onExportExcel:te}),!b&&!M&&s.jsx(s.Fragment,{children:he.length===0?s.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-12 text-center",children:[s.jsx($t,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),s.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No timesheets found"}),s.jsx("p",{className:"text-sm text-gray-500 mb-4",children:l.status?`No timesheets with status: ${l.status}`:"Try adjusting your filters or create a new timesheet entry."}),s.jsxs("div",{className:"flex items-center justify-center gap-3",children:[s.jsx("button",{onClick:()=>{const G=Object.keys(l),J={};G.forEach(ve=>{J[ve]=void 0}),J.date_from=void 0,J.date_to=void 0,z(J)},className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",children:"Clear Filters"}),s.jsx("button",{onClick:()=>{w(null),p(!0)},className:"px-4 py-2 text-sm font-medium text-white rounded-lg hover:opacity-90",style:{backgroundColor:"#714b67"},children:"New Timesheet"})]})]}):s.jsx("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:s.jsx(RT,{timesheets:he,selectedIds:u,onSelect:Ne,onSelectAll:ue,onRowClick:je})})})]}),v&&h&&s.jsx(LT,{timesheet:h,onClose:()=>{x(!1),m(null)},onUpdate:async()=>{if(await D(),h!=null&&h.id)try{const G=await $r.getById(h.id);G.success&&m(G.data)}catch(G){console.error("Error refreshing timesheet:",G)}},onApprove:E,onReject:B}),y&&s.jsx(MT,{timesheet:g,projects:r,employees:xe,onClose:()=>{p(!1),w(null)},onSave:L})]})}const UT=[{icon:xp,label:"Sales Orders",path:"/settings/sales-orders",description:"Manage customer sales orders"},{icon:wt,label:"Purchase Orders",path:"/settings/purchase-orders",description:"Manage vendor purchase orders"},{icon:up,label:"Invoices",path:"/settings/invoices",description:"Manage customer invoices"},{icon:Ro,label:"Vendor Bills",path:"/settings/vendor-bills",description:"Manage vendor bills"}];function zT(){const e=ga(),t=r=>{const n=`/app${r}`;return e.pathname===n};return s.jsx("div",{className:"p-8",children:s.jsxs("div",{className:"max-w-6xl mx-auto",children:[s.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-8",children:"Settings"}),s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:UT.map(r=>{const n=r.icon,a=t(r.path);return s.jsxs(eo,{to:`/app${r.path}`,className:Pu("flex items-start gap-4 p-6 rounded-lg border-2 transition-all",a?"border-blue-500 bg-blue-50":"border-gray-200 bg-white hover:border-gray-300 hover:shadow-md"),children:[s.jsx("div",{className:"p-3 rounded-lg",style:{backgroundColor:"#714b67"},children:s.jsx(n,{className:"w-6 h-6 text-white"})}),s.jsxs("div",{className:"flex-1",children:[s.jsx("h3",{className:Pu("text-lg font-semibold mb-1",a?"text-blue-900":"text-gray-900"),children:r.label}),s.jsx("p",{className:"text-sm text-gray-600",children:r.description})]})]},r.path)})})]})})}const Oh={draft:"bg-gray-100 text-gray-700",confirmed:"bg-green-100 text-green-700",fulfilled:"bg-blue-100 text-blue-700",closed:"bg-purple-100 text-purple-700",cancelled:"bg-red-100 text-red-700"},$T={draft:wt,confirmed:Qe,fulfilled:$t,closed:Qe,cancelled:Nr};function WT({salesOrders:e,selectedIds:t,onSelect:r,onSelectAll:n,onRowClick:a}){const i=e.length>0&&t.length===e.length,l=t.length>0&&t.length<e.length,o=(u,f="INR")=>new Intl.NumberFormat("en-IN",{style:"currency",currency:f,minimumFractionDigits:0,maximumFractionDigits:0}).format(u),c=u=>u?new Date(u).toLocaleDateString("en-IN",{day:"numeric",month:"short",year:"numeric"}):"-",d=u=>{const f=$T[u]||wt;return s.jsxs("span",{className:`inline-flex items-center gap-1.5 px-2.5 py-1 rounded-full text-xs font-medium ${Oh[u]||Oh.draft}`,children:[s.jsx(f,{className:"w-3 h-3"}),u.charAt(0).toUpperCase()+u.slice(1)]})};return e.length===0?s.jsx("div",{className:"text-center py-12",children:s.jsx("p",{className:"text-gray-500",children:"No sales orders found"})}):s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"w-full border-collapse",children:[s.jsx("thead",{children:s.jsxs("tr",{className:"border-b border-gray-200",children:[s.jsx("th",{className:"px-4 py-3 text-left",children:s.jsx("input",{type:"checkbox",checked:i,ref:u=>{u&&(u.indeterminate=l)},onChange:u=>n(u.target.checked),className:"w-4 h-4 text-purple-600 rounded focus:ring-purple-500"})}),s.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Number"}),s.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Date"}),s.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Customer"}),s.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Project"}),s.jsx("th",{className:"px-4 py-3 text-right text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Amount"}),s.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Status"}),s.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Reference"})]})}),s.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:e.map(u=>s.jsxs("tr",{onClick:()=>a(u),className:"hover:bg-gray-50 cursor-pointer transition-colors",children:[s.jsx("td",{className:"px-4 py-3",onClick:f=>f.stopPropagation(),children:s.jsx("input",{type:"checkbox",checked:t.includes(u.id),onChange:f=>{f.stopPropagation(),r(u.id,f.target.checked)},className:"w-4 h-4 text-purple-600 rounded focus:ring-purple-500"})}),s.jsx("td",{className:"px-4 py-3 text-sm font-medium text-gray-900",children:u.number||"-"}),s.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:c(u.orderDate)}),s.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:u.customerName||"-"}),s.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:u.projectName||"-"}),s.jsx("td",{className:"px-4 py-3 text-sm text-right font-medium text-gray-900",children:o(u.grandTotal,u.currency)}),s.jsx("td",{className:"px-4 py-3",children:d(u.status)}),s.jsx("td",{className:"px-4 py-3 text-sm text-gray-500",children:u.reference||"-"})]},u.id))})]})})}function HT({filters:e,projects:t,onFilterChange:r}){const[n,a]=T.useState(!1),i=(o,c)=>{r({[o]:c})},l=()=>{r({})};return s.jsxs("div",{className:"relative",children:[s.jsxs("button",{onClick:()=>a(!n),className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 flex items-center gap-2",children:[s.jsx(qn,{className:"w-4 h-4"}),"Filters"]}),n&&s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"fixed inset-0 z-10",onClick:()=>a(!1)}),s.jsxs("div",{className:"absolute right-0 mt-2 w-80 bg-white border border-gray-200 rounded-lg shadow-lg z-20 p-4",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsx("h3",{className:"text-sm font-semibold text-gray-900",children:"Filters"}),s.jsx("button",{onClick:()=>a(!1),className:"text-gray-400 hover:text-gray-600",children:s.jsx(ze,{className:"w-4 h-4"})})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Project"}),s.jsxs("select",{value:e.project_id||"",onChange:o=>i("project_id",o.target.value||void 0),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm",children:[s.jsx("option",{value:"",children:"All Projects"}),t.map(o=>s.jsx("option",{value:o.id,children:o.name},o.id))]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Status"}),s.jsxs("select",{value:Array.isArray(e.status)?e.status[0]:e.status||"",onChange:o=>i("status",o.target.value?[o.target.value]:void 0),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm",children:[s.jsx("option",{value:"",children:"All Statuses"}),s.jsx("option",{value:"draft",children:"Draft"}),s.jsx("option",{value:"confirmed",children:"Confirmed"}),s.jsx("option",{value:"fulfilled",children:"Fulfilled"}),s.jsx("option",{value:"closed",children:"Closed"}),s.jsx("option",{value:"cancelled",children:"Cancelled"})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date From"}),s.jsx("input",{type:"date",value:e.date_from||"",onChange:o=>i("date_from",o.target.value||void 0),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date To"}),s.jsx("input",{type:"date",value:e.date_to||"",onChange:o=>i("date_to",o.target.value||void 0),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm"})]}),s.jsxs("div",{className:"flex gap-2 pt-2",children:[s.jsx("button",{onClick:l,className:"flex-1 px-3 py-2 text-sm font-medium text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200",children:"Clear"}),s.jsx("button",{onClick:()=>a(!1),className:"flex-1 px-3 py-2 text-sm font-medium text-white rounded-lg hover:opacity-90",style:{backgroundColor:"#714b67"},children:"Apply"})]})]})]})]})]})}function VT({selectedCount:e,onBulkConfirm:t,onBulkCancel:r}){return e===0?null:s.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-4 flex items-center justify-between",children:[s.jsx("div",{className:"flex items-center gap-2",children:s.jsxs("span",{className:"text-sm font-medium text-blue-900",children:[e," order",e!==1?"s":""," selected"]})}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("button",{onClick:t,className:"px-3 py-1.5 text-sm font-medium text-white rounded-lg hover:opacity-90",style:{backgroundColor:"#714b67"},children:"Confirm"}),s.jsx("button",{onClick:r,className:"px-3 py-1.5 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",children:"Cancel"})]})]})}function GT({order:e,onClose:t,onUpdate:r}){const n=(o,c="INR")=>new Intl.NumberFormat("en-IN",{style:"currency",currency:c,minimumFractionDigits:0,maximumFractionDigits:0}).format(o),a=o=>o?new Date(o).toLocaleDateString("en-IN",{day:"numeric",month:"short",year:"numeric"}):"-",i=async()=>{try{await qr.confirm(e.id),r()}catch(o){console.error("Error confirming order:",o)}},l=async()=>{try{await qr.cancel(e.id),r()}catch(o){console.error("Error cancelling order:",o)}};return s.jsxs("div",{className:"fixed inset-0 z-50 overflow-hidden",children:[s.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-50",onClick:t}),s.jsx("div",{className:"absolute right-0 top-0 bottom-0 w-full max-w-2xl bg-white shadow-xl",children:s.jsxs("div",{className:"h-full flex flex-col",children:[s.jsxs("div",{className:"px-6 py-4 border-b border-gray-200 flex items-center justify-between",children:[s.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Sales Order Details"}),s.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-600",children:s.jsx(ze,{className:"w-5 h-5"})})]}),s.jsx("div",{className:"flex-1 overflow-y-auto p-6",children:s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"text-sm font-medium text-gray-500 mb-2",children:"Order Information"}),s.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 space-y-2",children:[s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-sm text-gray-600",children:"Number:"}),s.jsx("span",{className:"text-sm font-medium text-gray-900",children:e.number||"-"})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-sm text-gray-600",children:"Date:"}),s.jsx("span",{className:"text-sm font-medium text-gray-900",children:a(e.orderDate)})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-sm text-gray-600",children:"Customer:"}),s.jsx("span",{className:"text-sm font-medium text-gray-900",children:e.customerName||"-"})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-sm text-gray-600",children:"Project:"}),s.jsx("span",{className:"text-sm font-medium text-gray-900",children:e.projectName||"-"})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-sm text-gray-600",children:"Status:"}),s.jsx("span",{className:"text-sm font-medium text-gray-900 capitalize",children:e.status||"-"})]})]})]}),e.lines&&e.lines.length>0&&s.jsxs("div",{children:[s.jsx("h3",{className:"text-sm font-medium text-gray-500 mb-2",children:"Line Items"}),s.jsx("div",{className:"border border-gray-200 rounded-lg overflow-hidden",children:s.jsxs("table",{className:"w-full",children:[s.jsx("thead",{className:"bg-gray-50",children:s.jsxs("tr",{children:[s.jsx("th",{className:"px-4 py-2 text-left text-xs font-semibold text-gray-600",children:"Description"}),s.jsx("th",{className:"px-4 py-2 text-right text-xs font-semibold text-gray-600",children:"Quantity"}),s.jsx("th",{className:"px-4 py-2 text-right text-xs font-semibold text-gray-600",children:"Price"}),s.jsx("th",{className:"px-4 py-2 text-right text-xs font-semibold text-gray-600",children:"Total"})]})}),s.jsx("tbody",{className:"divide-y divide-gray-200",children:e.lines.map(o=>s.jsxs("tr",{children:[s.jsx("td",{className:"px-4 py-2 text-sm text-gray-900",children:o.description}),s.jsx("td",{className:"px-4 py-2 text-sm text-right text-gray-900",children:o.quantity}),s.jsx("td",{className:"px-4 py-2 text-sm text-right text-gray-900",children:n(o.unitPrice,e.currency)}),s.jsx("td",{className:"px-4 py-2 text-sm text-right font-medium text-gray-900",children:n(o.lineTotal,e.currency)})]},o.id))})]})})]}),s.jsxs("div",{children:[s.jsx("h3",{className:"text-sm font-medium text-gray-500 mb-2",children:"Totals"}),s.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 space-y-2",children:[s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-sm text-gray-600",children:"Subtotal:"}),s.jsx("span",{className:"text-sm font-medium text-gray-900",children:n(e.subtotal||0,e.currency)})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-sm text-gray-600",children:"Tax:"}),s.jsx("span",{className:"text-sm font-medium text-gray-900",children:n(e.taxTotal||0,e.currency)})]}),s.jsxs("div",{className:"flex justify-between border-t border-gray-300 pt-2",children:[s.jsx("span",{className:"text-sm font-semibold text-gray-900",children:"Grand Total:"}),s.jsx("span",{className:"text-sm font-semibold text-gray-900",children:n(e.grandTotal||0,e.currency)})]})]})]})]})}),s.jsxs("div",{className:"px-6 py-4 border-t border-gray-200 flex items-center justify-end gap-3",children:[e.status==="draft"&&s.jsxs(s.Fragment,{children:[s.jsx("button",{onClick:i,className:"px-4 py-2 text-sm font-medium text-white rounded-lg hover:opacity-90",style:{backgroundColor:"#714b67"},children:"Confirm"}),s.jsx("button",{onClick:l,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",children:"Cancel Order"})]}),s.jsx("button",{onClick:t,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",children:"Close"})]})]})})]})}function XT({order:e,projects:t,onClose:r,onSave:n}){const[a,i]=T.useState({project_id:"",customer_partner_id:"",order_date:new Date().toISOString().split("T")[0],currency:"INR",lines:[{description:"",quantity:1,unit_price:0}]}),[l,o]=T.useState(!1);T.useEffect(()=>{var f;e&&i({project_id:e.projectId||"",customer_partner_id:e.customerPartnerId||"",order_date:e.orderDate||new Date().toISOString().split("T")[0],currency:e.currency||"INR",lines:((f=e.lines)==null?void 0:f.map(h=>({description:h.description,quantity:h.quantity,unit_price:h.unitPrice})))||[{description:"",quantity:1,unit_price:0}]})},[e]);const c=async f=>{f.preventDefault(),o(!0);try{e?await qr.update(e.id,a):await qr.create(a),n()}catch(h){console.error("Error saving sales order:",h),alert("Failed to save sales order")}finally{o(!1)}},d=()=>{i(f=>({...f,lines:[...f.lines,{description:"",quantity:1,unit_price:0}]}))},u=(f,h,m)=>{i(v=>({...v,lines:v.lines.map((x,y)=>y===f?{...x,[h]:m}:x)}))};return s.jsxs("div",{className:"fixed inset-0 z-50 overflow-hidden",children:[s.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-50",onClick:r}),s.jsx("div",{className:"absolute inset-0 flex items-center justify-center p-4",children:s.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-4xl max-h-[90vh] overflow-hidden flex flex-col",children:[s.jsxs("div",{className:"px-6 py-4 border-b border-gray-200 flex items-center justify-between",children:[s.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:e?"Edit Sales Order":"New Sales Order"}),s.jsx("button",{onClick:r,className:"text-gray-400 hover:text-gray-600",children:s.jsx(ze,{className:"w-5 h-5"})})]}),s.jsx("form",{onSubmit:c,className:"flex-1 overflow-y-auto p-6",children:s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Project"}),s.jsxs("select",{value:a.project_id,onChange:f=>i(h=>({...h,project_id:f.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm",children:[s.jsx("option",{value:"",children:"Select Project"}),t.map(f=>s.jsx("option",{value:f.id,children:f.name},f.id))]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Order Date"}),s.jsx("input",{type:"date",value:a.order_date,onChange:f=>i(h=>({...h,order_date:f.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm",required:!0})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Customer Partner ID"}),s.jsx("input",{type:"text",value:a.customer_partner_id,onChange:f=>i(h=>({...h,customer_partner_id:f.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm",placeholder:"Enter customer partner ID",required:!0})]}),s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Line Items"}),s.jsx("button",{type:"button",onClick:d,className:"text-sm text-blue-600 hover:text-blue-800",children:"+ Add Line"})]}),s.jsx("div",{className:"border border-gray-200 rounded-lg overflow-hidden",children:s.jsxs("table",{className:"w-full",children:[s.jsx("thead",{className:"bg-gray-50",children:s.jsxs("tr",{children:[s.jsx("th",{className:"px-4 py-2 text-left text-xs font-semibold text-gray-600",children:"Description"}),s.jsx("th",{className:"px-4 py-2 text-right text-xs font-semibold text-gray-600",children:"Quantity"}),s.jsx("th",{className:"px-4 py-2 text-right text-xs font-semibold text-gray-600",children:"Unit Price"})]})}),s.jsx("tbody",{className:"divide-y divide-gray-200",children:a.lines.map((f,h)=>s.jsxs("tr",{children:[s.jsx("td",{className:"px-4 py-2",children:s.jsx("input",{type:"text",value:f.description,onChange:m=>u(h,"description",m.target.value),className:"w-full px-2 py-1 border border-gray-300 rounded text-sm",required:!0})}),s.jsx("td",{className:"px-4 py-2",children:s.jsx("input",{type:"number",value:f.quantity,onChange:m=>u(h,"quantity",parseFloat(m.target.value)||0),className:"w-full px-2 py-1 border border-gray-300 rounded text-sm text-right",min:"0",step:"0.01",required:!0})}),s.jsx("td",{className:"px-4 py-2",children:s.jsx("input",{type:"number",value:f.unit_price,onChange:m=>u(h,"unit_price",parseFloat(m.target.value)||0),className:"w-full px-2 py-1 border border-gray-300 rounded text-sm text-right",min:"0",step:"0.01",required:!0})})]},h))})]})})]})]})}),s.jsxs("div",{className:"px-6 py-4 border-t border-gray-200 flex items-center justify-end gap-3",children:[s.jsx("button",{onClick:r,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",children:"Cancel"}),s.jsx("button",{onClick:c,disabled:l,className:"px-4 py-2 text-sm font-medium text-white rounded-lg hover:opacity-90 disabled:opacity-50",style:{backgroundColor:"#714b67"},children:l?"Saving...":"Save"})]})]})})]})}function KT(){const[e,t]=T.useState([]),[r,n]=T.useState([]),[a,i]=T.useState({totalCount:0,draftCount:0,confirmedCount:0,fulfilledCount:0,totalAmount:0,confirmedAmount:0}),[l,o]=T.useState({date_from:O(),date_to:new Date().toISOString().split("T")[0]}),[c,d]=T.useState(""),[u,f]=T.useState([]),[h,m]=T.useState(null),[v,x]=T.useState(!1),[y,p]=T.useState(!1),[g,w]=T.useState(null),[b,P]=T.useState(!0),[M,j]=T.useState(null);function O(){const k=new Date;return k.setDate(k.getDate()-90),k.toISOString().split("T")[0]}T.useEffect(()=>{R()},[l]);const R=async()=>{try{P(!0),j(null);const k=await yr.getAll();k.success&&n(k.data);const K=await qr.getAll(l);K.success?t(K.data):j(K.message||"Failed to load sales orders");const te=await qr.getStats(l);te.success&&i(te.data)}catch(k){console.error("Error loading data:",k),j("Unable to connect to server. Please try again.")}finally{P(!1)}},I=k=>{Object.keys(k).length===0?o({date_from:O(),date_to:new Date().toISOString().split("T")[0]}):o(K=>{const te={...K};return Object.keys(k).forEach(E=>{const B=k[E];B===void 0||B===""||B===null||Array.isArray(B)&&B.length===0?delete te[E]:te[E]=B}),te}),f([])},D=(k,K)=>{f(K?te=>[...te,k]:te=>te.filter(E=>E!==k))},z=k=>{f(k?e.map(K=>K.id):[])},ne=k=>{m(k),x(!0)},Ne=async()=>{try{for(const k of u)await qr.confirm(k);f([]),R()}catch(k){console.error("Error bulk confirming:",k)}},ue=async()=>{try{for(const k of u)await qr.cancel(k);f([]),R()}catch(k){console.error("Error bulk cancelling:",k)}},je=()=>{R(),p(!1),w(null)},q=k=>new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR",minimumFractionDigits:0,maximumFractionDigits:0}).format(k),W=e.filter(k=>{var te,E,B,L;if(!c.trim())return!0;const K=c.toLowerCase();return((te=k.number)==null?void 0:te.toLowerCase().includes(K))||((E=k.customerName)==null?void 0:E.toLowerCase().includes(K))||((B=k.projectName)==null?void 0:B.toLowerCase().includes(K))||((L=k.reference)==null?void 0:L.toLowerCase().includes(K))});return s.jsxs("div",{className:"h-full bg-gray-50",children:[s.jsxs("header",{className:"bg-white border-b border-gray-200 px-8 py-6",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsxs("div",{className:"flex items-center gap-6 flex-1",children:[s.jsx("h1",{className:"text-2xl font-semibold text-gray-900",children:"Sales Orders"}),s.jsxs("div",{className:"relative flex-1 max-w-md",children:[s.jsx(pn,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),s.jsx("input",{value:c,onChange:k=>d(k.target.value),type:"text",placeholder:"Search sales orders...",className:"w-full pl-10 pr-4 py-2.5 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-400 focus:border-transparent text-sm",disabled:b})]})]}),s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(HT,{filters:l,projects:r,onFilterChange:I}),s.jsxs("button",{onClick:()=>{w(null),p(!0)},className:"px-4 py-2 text-sm font-medium text-white rounded-lg hover:opacity-90 transition-opacity disabled:opacity-50",style:{backgroundColor:"#714b67"},disabled:b,children:[s.jsx(lr,{className:"inline w-4 h-4 mr-2"})," New Sales Order"]})]})]}),s.jsxs("div",{className:"grid grid-cols-4 gap-4 mb-4",children:[s.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[s.jsx("div",{className:"text-sm text-gray-600 mb-1",children:"Total Orders"}),s.jsx("div",{className:"text-2xl font-semibold",style:{color:"#714b67"},children:a.totalCount})]}),s.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[s.jsx("div",{className:"text-sm text-gray-600 mb-1",children:"Draft"}),s.jsx("div",{className:"text-2xl font-semibold text-gray-900",children:a.draftCount})]}),s.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[s.jsx("div",{className:"text-sm text-gray-600 mb-1",children:"Confirmed"}),s.jsx("div",{className:"text-2xl font-semibold text-gray-900",children:a.confirmedCount})]}),s.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[s.jsx("div",{className:"text-sm text-gray-600 mb-1",children:"Total Amount"}),s.jsx("div",{className:"text-2xl font-semibold text-gray-900",children:q(a.totalAmount)})]})]}),s.jsxs("div",{className:"flex items-center gap-2 mb-4 flex-wrap",children:[s.jsx("button",{onClick:()=>I({status:["draft"]}),className:`px-3 py-1.5 text-sm font-medium rounded-lg transition-colors ${JSON.stringify(l.status)===JSON.stringify(["draft"])?"text-white":"bg-white text-gray-700 border border-gray-300 hover:bg-gray-50"}`,style:JSON.stringify(l.status)===JSON.stringify(["draft"])?{backgroundColor:"#714b67"}:{},children:"Draft"}),s.jsx("button",{onClick:()=>I({status:["confirmed"]}),className:`px-3 py-1.5 text-sm font-medium rounded-lg transition-colors ${JSON.stringify(l.status)===JSON.stringify(["confirmed"])?"text-white":"bg-white text-gray-700 border border-gray-300 hover:bg-gray-50"}`,style:JSON.stringify(l.status)===JSON.stringify(["confirmed"])?{backgroundColor:"#714b67"}:{},children:"Confirmed"}),s.jsx("button",{onClick:()=>{const{status:k,...K}=l;I(K)},className:`px-3 py-1.5 text-sm font-medium rounded-lg transition-colors ${l.status?"bg-white text-gray-700 border border-gray-300 hover:bg-gray-50":"text-white"}`,style:l.status?{}:{backgroundColor:"#714b67"},children:"All"})]})]}),s.jsxs("div",{className:"p-6",children:[b&&s.jsx("div",{className:"flex items-center justify-center h-64",children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"inline-block animate-spin rounded-full h-12 w-12 border-b-2 border-gray-900 mb-4"}),s.jsx("p",{className:"text-gray-600",children:"Loading sales orders..."})]})}),M&&!b&&s.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 mb-4",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{className:"text-red-800 font-medium",children:M}),s.jsx("button",{onClick:R,className:"text-red-600 hover:text-red-800 font-medium text-sm",children:"Retry"})]})}),!b&&!M&&s.jsx(VT,{selectedCount:u.length,onBulkConfirm:Ne,onBulkCancel:ue}),!b&&!M&&s.jsx(s.Fragment,{children:W.length===0?s.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-12 text-center",children:[s.jsx(xp,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),s.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No sales orders found"}),s.jsx("p",{className:"text-sm text-gray-500 mb-4",children:"Try adjusting your filters or create a new sales order."}),s.jsx("button",{onClick:()=>{w(null),p(!0)},className:"px-4 py-2 text-sm font-medium text-white rounded-lg hover:opacity-90",style:{backgroundColor:"#714b67"},children:"New Sales Order"})]}):s.jsx("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:s.jsx(WT,{salesOrders:W,selectedIds:u,onSelect:D,onSelectAll:z,onRowClick:ne})})})]}),v&&h&&s.jsx(GT,{order:h,onClose:()=>{x(!1),m(null)},onUpdate:async()=>{if(await R(),h!=null&&h.id)try{const k=await qr.getById(h.id);k.success&&m(k.data)}catch(k){console.error("Error refreshing order:",k)}}}),y&&s.jsx(XT,{order:g,projects:r,onClose:()=>{p(!1),w(null)},onSave:je})]})}const Rh={draft:"bg-gray-100 text-gray-700",confirmed:"bg-green-100 text-green-700",fulfilled:"bg-blue-100 text-blue-700",closed:"bg-purple-100 text-purple-700",cancelled:"bg-red-100 text-red-700"},YT={draft:wt,confirmed:Qe,fulfilled:$t,closed:Qe,cancelled:Nr};function JT({purchaseOrders:e,selectedIds:t,onSelect:r,onSelectAll:n,onRowClick:a}){const i=e.length>0&&t.length===e.length,l=t.length>0&&t.length<e.length,o=(u,f="INR")=>new Intl.NumberFormat("en-IN",{style:"currency",currency:f,minimumFractionDigits:0,maximumFractionDigits:0}).format(u),c=u=>u?new Date(u).toLocaleDateString("en-IN",{day:"numeric",month:"short",year:"numeric"}):"-",d=u=>{const f=YT[u]||wt;return s.jsxs("span",{className:`inline-flex items-center gap-1.5 px-2.5 py-1 rounded-full text-xs font-medium ${Rh[u]||Rh.draft}`,children:[s.jsx(f,{className:"w-3 h-3"}),u.charAt(0).toUpperCase()+u.slice(1)]})};return e.length===0?s.jsx("div",{className:"text-center py-12",children:s.jsx("p",{className:"text-gray-500",children:"No purchase orders found"})}):s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"w-full border-collapse",children:[s.jsx("thead",{children:s.jsxs("tr",{className:"border-b border-gray-200",children:[s.jsx("th",{className:"px-4 py-3 text-left",children:s.jsx("input",{type:"checkbox",checked:i,ref:u=>{u&&(u.indeterminate=l)},onChange:u=>n(u.target.checked),className:"w-4 h-4 text-purple-600 rounded focus:ring-purple-500"})}),s.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Number"}),s.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Date"}),s.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Vendor"}),s.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Project"}),s.jsx("th",{className:"px-4 py-3 text-right text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Amount"}),s.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Status"}),s.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Reference"})]})}),s.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:e.map(u=>s.jsxs("tr",{onClick:()=>a(u),className:"hover:bg-gray-50 cursor-pointer transition-colors",children:[s.jsx("td",{className:"px-4 py-3",onClick:f=>f.stopPropagation(),children:s.jsx("input",{type:"checkbox",checked:t.includes(u.id),onChange:f=>{f.stopPropagation(),r(u.id,f.target.checked)},className:"w-4 h-4 text-purple-600 rounded focus:ring-purple-500"})}),s.jsx("td",{className:"px-4 py-3 text-sm font-medium text-gray-900",children:u.number||"-"}),s.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:c(u.orderDate)}),s.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:u.vendorName||"-"}),s.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:u.projectName||"-"}),s.jsx("td",{className:"px-4 py-3 text-sm text-right font-medium text-gray-900",children:o(u.grandTotal,u.currency)}),s.jsx("td",{className:"px-4 py-3",children:d(u.status)}),s.jsx("td",{className:"px-4 py-3 text-sm text-gray-500",children:u.reference||"-"})]},u.id))})]})})}function qT({filters:e,projects:t,onFilterChange:r}){const[n,a]=T.useState(!1),i=(o,c)=>{r({[o]:c})},l=()=>{r({})};return s.jsxs("div",{className:"relative",children:[s.jsxs("button",{onClick:()=>a(!n),className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 flex items-center gap-2",children:[s.jsx(qn,{className:"w-4 h-4"}),"Filters"]}),n&&s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"fixed inset-0 z-10",onClick:()=>a(!1)}),s.jsxs("div",{className:"absolute right-0 mt-2 w-80 bg-white border border-gray-200 rounded-lg shadow-lg z-20 p-4",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsx("h3",{className:"text-sm font-semibold text-gray-900",children:"Filters"}),s.jsx("button",{onClick:()=>a(!1),className:"text-gray-400 hover:text-gray-600",children:s.jsx(ze,{className:"w-4 h-4"})})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Project"}),s.jsxs("select",{value:e.project_id||"",onChange:o=>i("project_id",o.target.value||void 0),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm",children:[s.jsx("option",{value:"",children:"All Projects"}),t.map(o=>s.jsx("option",{value:o.id,children:o.name},o.id))]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Status"}),s.jsxs("select",{value:Array.isArray(e.status)?e.status[0]:e.status||"",onChange:o=>i("status",o.target.value?[o.target.value]:void 0),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm",children:[s.jsx("option",{value:"",children:"All Statuses"}),s.jsx("option",{value:"draft",children:"Draft"}),s.jsx("option",{value:"confirmed",children:"Confirmed"}),s.jsx("option",{value:"fulfilled",children:"Fulfilled"}),s.jsx("option",{value:"closed",children:"Closed"}),s.jsx("option",{value:"cancelled",children:"Cancelled"})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date From"}),s.jsx("input",{type:"date",value:e.date_from||"",onChange:o=>i("date_from",o.target.value||void 0),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date To"}),s.jsx("input",{type:"date",value:e.date_to||"",onChange:o=>i("date_to",o.target.value||void 0),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm"})]}),s.jsxs("div",{className:"flex gap-2 pt-2",children:[s.jsx("button",{onClick:l,className:"flex-1 px-3 py-2 text-sm font-medium text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200",children:"Clear"}),s.jsx("button",{onClick:()=>a(!1),className:"flex-1 px-3 py-2 text-sm font-medium text-white rounded-lg hover:opacity-90",style:{backgroundColor:"#714b67"},children:"Apply"})]})]})]})]})]})}function QT({selectedCount:e,onBulkConfirm:t,onBulkCancel:r}){return e===0?null:s.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-4 flex items-center justify-between",children:[s.jsx("div",{className:"flex items-center gap-2",children:s.jsxs("span",{className:"text-sm font-medium text-blue-900",children:[e," order",e!==1?"s":""," selected"]})}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("button",{onClick:t,className:"px-3 py-1.5 text-sm font-medium text-white rounded-lg hover:opacity-90",style:{backgroundColor:"#714b67"},children:"Confirm"}),s.jsx("button",{onClick:r,className:"px-3 py-1.5 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",children:"Cancel"})]})]})}function ZT({order:e,onClose:t,onUpdate:r}){const n=(o,c="INR")=>new Intl.NumberFormat("en-IN",{style:"currency",currency:c,minimumFractionDigits:0,maximumFractionDigits:0}).format(o),a=o=>o?new Date(o).toLocaleDateString("en-IN",{day:"numeric",month:"short",year:"numeric"}):"-",i=async()=>{try{await Qr.confirm(e.id),r()}catch(o){console.error("Error confirming order:",o)}},l=async()=>{try{await Qr.cancel(e.id),r()}catch(o){console.error("Error cancelling order:",o)}};return s.jsxs("div",{className:"fixed inset-0 z-50 overflow-hidden",children:[s.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-50",onClick:t}),s.jsx("div",{className:"absolute right-0 top-0 bottom-0 w-full max-w-2xl bg-white shadow-xl",children:s.jsxs("div",{className:"h-full flex flex-col",children:[s.jsxs("div",{className:"px-6 py-4 border-b border-gray-200 flex items-center justify-between",children:[s.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Purchase Order Details"}),s.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-600",children:s.jsx(ze,{className:"w-5 h-5"})})]}),s.jsx("div",{className:"flex-1 overflow-y-auto p-6",children:s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"text-sm font-medium text-gray-500 mb-2",children:"Order Information"}),s.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 space-y-2",children:[s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-sm text-gray-600",children:"Number:"}),s.jsx("span",{className:"text-sm font-medium text-gray-900",children:e.number||"-"})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-sm text-gray-600",children:"Date:"}),s.jsx("span",{className:"text-sm font-medium text-gray-900",children:a(e.orderDate)})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-sm text-gray-600",children:"Vendor:"}),s.jsx("span",{className:"text-sm font-medium text-gray-900",children:e.vendorName||"-"})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-sm text-gray-600",children:"Project:"}),s.jsx("span",{className:"text-sm font-medium text-gray-900",children:e.projectName||"-"})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-sm text-gray-600",children:"Status:"}),s.jsx("span",{className:"text-sm font-medium text-gray-900 capitalize",children:e.status||"-"})]})]})]}),e.lines&&e.lines.length>0&&s.jsxs("div",{children:[s.jsx("h3",{className:"text-sm font-medium text-gray-500 mb-2",children:"Line Items"}),s.jsx("div",{className:"border border-gray-200 rounded-lg overflow-hidden",children:s.jsxs("table",{className:"w-full",children:[s.jsx("thead",{className:"bg-gray-50",children:s.jsxs("tr",{children:[s.jsx("th",{className:"px-4 py-2 text-left text-xs font-semibold text-gray-600",children:"Description"}),s.jsx("th",{className:"px-4 py-2 text-right text-xs font-semibold text-gray-600",children:"Quantity"}),s.jsx("th",{className:"px-4 py-2 text-right text-xs font-semibold text-gray-600",children:"Price"}),s.jsx("th",{className:"px-4 py-2 text-right text-xs font-semibold text-gray-600",children:"Total"})]})}),s.jsx("tbody",{className:"divide-y divide-gray-200",children:e.lines.map(o=>s.jsxs("tr",{children:[s.jsx("td",{className:"px-4 py-2 text-sm text-gray-900",children:o.description}),s.jsx("td",{className:"px-4 py-2 text-sm text-right text-gray-900",children:o.quantity}),s.jsx("td",{className:"px-4 py-2 text-sm text-right text-gray-900",children:n(o.unitPrice,e.currency)}),s.jsx("td",{className:"px-4 py-2 text-sm text-right font-medium text-gray-900",children:n(o.lineTotal,e.currency)})]},o.id))})]})})]}),s.jsxs("div",{children:[s.jsx("h3",{className:"text-sm font-medium text-gray-500 mb-2",children:"Totals"}),s.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 space-y-2",children:[s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-sm text-gray-600",children:"Subtotal:"}),s.jsx("span",{className:"text-sm font-medium text-gray-900",children:n(e.subtotal||0,e.currency)})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-sm text-gray-600",children:"Tax:"}),s.jsx("span",{className:"text-sm font-medium text-gray-900",children:n(e.taxTotal||0,e.currency)})]}),s.jsxs("div",{className:"flex justify-between border-t border-gray-300 pt-2",children:[s.jsx("span",{className:"text-sm font-semibold text-gray-900",children:"Grand Total:"}),s.jsx("span",{className:"text-sm font-semibold text-gray-900",children:n(e.grandTotal||0,e.currency)})]})]})]})]})}),s.jsxs("div",{className:"px-6 py-4 border-t border-gray-200 flex items-center justify-end gap-3",children:[e.status==="draft"&&s.jsxs(s.Fragment,{children:[s.jsx("button",{onClick:i,className:"px-4 py-2 text-sm font-medium text-white rounded-lg hover:opacity-90",style:{backgroundColor:"#714b67"},children:"Confirm"}),s.jsx("button",{onClick:l,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",children:"Cancel Order"})]}),s.jsx("button",{onClick:t,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",children:"Close"})]})]})})]})}function ek({order:e,projects:t,onClose:r,onSave:n}){const[a,i]=T.useState({project_id:"",vendor_partner_id:"",order_date:new Date().toISOString().split("T")[0],currency:"INR",lines:[{description:"",quantity:1,unit_price:0}]}),[l,o]=T.useState(!1);T.useEffect(()=>{var f;e&&i({project_id:e.projectId||"",vendor_partner_id:e.vendorPartnerId||"",order_date:e.orderDate||new Date().toISOString().split("T")[0],currency:e.currency||"INR",lines:((f=e.lines)==null?void 0:f.map(h=>({description:h.description,quantity:h.quantity,unit_price:h.unitPrice})))||[{description:"",quantity:1,unit_price:0}]})},[e]);const c=async f=>{f.preventDefault(),o(!0);try{e?await Qr.update(e.id,a):await Qr.create(a),n()}catch(h){console.error("Error saving purchase order:",h),alert("Failed to save purchase order")}finally{o(!1)}},d=()=>{i(f=>({...f,lines:[...f.lines,{description:"",quantity:1,unit_price:0}]}))},u=(f,h,m)=>{i(v=>({...v,lines:v.lines.map((x,y)=>y===f?{...x,[h]:m}:x)}))};return s.jsxs("div",{className:"fixed inset-0 z-50 overflow-hidden",children:[s.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-50",onClick:r}),s.jsx("div",{className:"absolute inset-0 flex items-center justify-center p-4",children:s.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-4xl max-h-[90vh] overflow-hidden flex flex-col",children:[s.jsxs("div",{className:"px-6 py-4 border-b border-gray-200 flex items-center justify-between",children:[s.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:e?"Edit Purchase Order":"New Purchase Order"}),s.jsx("button",{onClick:r,className:"text-gray-400 hover:text-gray-600",children:s.jsx(ze,{className:"w-5 h-5"})})]}),s.jsx("form",{onSubmit:c,className:"flex-1 overflow-y-auto p-6",children:s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Project"}),s.jsxs("select",{value:a.project_id,onChange:f=>i(h=>({...h,project_id:f.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm",children:[s.jsx("option",{value:"",children:"Select Project"}),t.map(f=>s.jsx("option",{value:f.id,children:f.name},f.id))]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Order Date"}),s.jsx("input",{type:"date",value:a.order_date,onChange:f=>i(h=>({...h,order_date:f.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm",required:!0})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Vendor Partner ID"}),s.jsx("input",{type:"text",value:a.vendor_partner_id,onChange:f=>i(h=>({...h,vendor_partner_id:f.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm",placeholder:"Enter vendor partner ID",required:!0})]}),s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Line Items"}),s.jsx("button",{type:"button",onClick:d,className:"text-sm text-blue-600 hover:text-blue-800",children:"+ Add Line"})]}),s.jsx("div",{className:"border border-gray-200 rounded-lg overflow-hidden",children:s.jsxs("table",{className:"w-full",children:[s.jsx("thead",{className:"bg-gray-50",children:s.jsxs("tr",{children:[s.jsx("th",{className:"px-4 py-2 text-left text-xs font-semibold text-gray-600",children:"Description"}),s.jsx("th",{className:"px-4 py-2 text-right text-xs font-semibold text-gray-600",children:"Quantity"}),s.jsx("th",{className:"px-4 py-2 text-right text-xs font-semibold text-gray-600",children:"Unit Price"})]})}),s.jsx("tbody",{className:"divide-y divide-gray-200",children:a.lines.map((f,h)=>s.jsxs("tr",{children:[s.jsx("td",{className:"px-4 py-2",children:s.jsx("input",{type:"text",value:f.description,onChange:m=>u(h,"description",m.target.value),className:"w-full px-2 py-1 border border-gray-300 rounded text-sm",required:!0})}),s.jsx("td",{className:"px-4 py-2",children:s.jsx("input",{type:"number",value:f.quantity,onChange:m=>u(h,"quantity",parseFloat(m.target.value)||0),className:"w-full px-2 py-1 border border-gray-300 rounded text-sm text-right",min:"0",step:"0.01",required:!0})}),s.jsx("td",{className:"px-4 py-2",children:s.jsx("input",{type:"number",value:f.unit_price,onChange:m=>u(h,"unit_price",parseFloat(m.target.value)||0),className:"w-full px-2 py-1 border border-gray-300 rounded text-sm text-right",min:"0",step:"0.01",required:!0})})]},h))})]})})]})]})}),s.jsxs("div",{className:"px-6 py-4 border-t border-gray-200 flex items-center justify-end gap-3",children:[s.jsx("button",{onClick:r,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",children:"Cancel"}),s.jsx("button",{onClick:c,disabled:l,className:"px-4 py-2 text-sm font-medium text-white rounded-lg hover:opacity-90 disabled:opacity-50",style:{backgroundColor:"#714b67"},children:l?"Saving...":"Save"})]})]})})]})}function tk(){const[e,t]=T.useState([]),[r,n]=T.useState([]),[a,i]=T.useState({totalCount:0,draftCount:0,confirmedCount:0,fulfilledCount:0,totalAmount:0,confirmedAmount:0}),[l,o]=T.useState({date_from:O(),date_to:new Date().toISOString().split("T")[0]}),[c,d]=T.useState(""),[u,f]=T.useState([]),[h,m]=T.useState(null),[v,x]=T.useState(!1),[y,p]=T.useState(!1),[g,w]=T.useState(null),[b,P]=T.useState(!0),[M,j]=T.useState(null);function O(){const k=new Date;return k.setDate(k.getDate()-90),k.toISOString().split("T")[0]}T.useEffect(()=>{R()},[l]);const R=async()=>{try{P(!0),j(null);const k=await yr.getAll();k.success&&n(k.data);const K=await Qr.getAll(l);K.success?t(K.data):j(K.message||"Failed to load purchase orders");const te=await Qr.getStats(l);te.success&&i(te.data)}catch(k){console.error("Error loading data:",k),j("Unable to connect to server. Please try again.")}finally{P(!1)}},I=k=>{Object.keys(k).length===0?o({date_from:O(),date_to:new Date().toISOString().split("T")[0]}):o(K=>{const te={...K};return Object.keys(k).forEach(E=>{const B=k[E];B===void 0||B===""||B===null||Array.isArray(B)&&B.length===0?delete te[E]:te[E]=B}),te}),f([])},D=(k,K)=>{f(K?te=>[...te,k]:te=>te.filter(E=>E!==k))},z=k=>{f(k?e.map(K=>K.id):[])},ne=k=>{m(k),x(!0)},Ne=async()=>{try{for(const k of u)await Qr.confirm(k);f([]),R()}catch(k){console.error("Error bulk confirming:",k)}},ue=async()=>{try{for(const k of u)await Qr.cancel(k);f([]),R()}catch(k){console.error("Error bulk cancelling:",k)}},je=()=>{R(),p(!1),w(null)},q=k=>new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR",minimumFractionDigits:0,maximumFractionDigits:0}).format(k),W=e.filter(k=>{var te,E,B,L;if(!c.trim())return!0;const K=c.toLowerCase();return((te=k.number)==null?void 0:te.toLowerCase().includes(K))||((E=k.vendorName)==null?void 0:E.toLowerCase().includes(K))||((B=k.projectName)==null?void 0:B.toLowerCase().includes(K))||((L=k.reference)==null?void 0:L.toLowerCase().includes(K))});return s.jsxs("div",{className:"h-full bg-gray-50",children:[s.jsxs("header",{className:"bg-white border-b border-gray-200 px-8 py-6",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsxs("div",{className:"flex items-center gap-6 flex-1",children:[s.jsx("h1",{className:"text-2xl font-semibold text-gray-900",children:"Purchase Orders"}),s.jsxs("div",{className:"relative flex-1 max-w-md",children:[s.jsx(pn,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),s.jsx("input",{value:c,onChange:k=>d(k.target.value),type:"text",placeholder:"Search purchase orders...",className:"w-full pl-10 pr-4 py-2.5 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-400 focus:border-transparent text-sm",disabled:b})]})]}),s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(qT,{filters:l,projects:r,onFilterChange:I}),s.jsxs("button",{onClick:()=>{w(null),p(!0)},className:"px-4 py-2 text-sm font-medium text-white rounded-lg hover:opacity-90 transition-opacity disabled:opacity-50",style:{backgroundColor:"#714b67"},disabled:b,children:[s.jsx(lr,{className:"inline w-4 h-4 mr-2"})," New Purchase Order"]})]})]}),s.jsxs("div",{className:"grid grid-cols-4 gap-4 mb-4",children:[s.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[s.jsx("div",{className:"text-sm text-gray-600 mb-1",children:"Total Orders"}),s.jsx("div",{className:"text-2xl font-semibold",style:{color:"#714b67"},children:a.totalCount})]}),s.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[s.jsx("div",{className:"text-sm text-gray-600 mb-1",children:"Draft"}),s.jsx("div",{className:"text-2xl font-semibold text-gray-900",children:a.draftCount})]}),s.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[s.jsx("div",{className:"text-sm text-gray-600 mb-1",children:"Confirmed"}),s.jsx("div",{className:"text-2xl font-semibold text-gray-900",children:a.confirmedCount})]}),s.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[s.jsx("div",{className:"text-sm text-gray-600 mb-1",children:"Total Amount"}),s.jsx("div",{className:"text-2xl font-semibold text-gray-900",children:q(a.totalAmount)})]})]}),s.jsxs("div",{className:"flex items-center gap-2 mb-4 flex-wrap",children:[s.jsx("button",{onClick:()=>I({status:["draft"]}),className:`px-3 py-1.5 text-sm font-medium rounded-lg transition-colors ${JSON.stringify(l.status)===JSON.stringify(["draft"])?"text-white":"bg-white text-gray-700 border border-gray-300 hover:bg-gray-50"}`,style:JSON.stringify(l.status)===JSON.stringify(["draft"])?{backgroundColor:"#714b67"}:{},children:"Draft"}),s.jsx("button",{onClick:()=>I({status:["confirmed"]}),className:`px-3 py-1.5 text-sm font-medium rounded-lg transition-colors ${JSON.stringify(l.status)===JSON.stringify(["confirmed"])?"text-white":"bg-white text-gray-700 border border-gray-300 hover:bg-gray-50"}`,style:JSON.stringify(l.status)===JSON.stringify(["confirmed"])?{backgroundColor:"#714b67"}:{},children:"Confirmed"}),s.jsx("button",{onClick:()=>{const{status:k,...K}=l;I(K)},className:`px-3 py-1.5 text-sm font-medium rounded-lg transition-colors ${l.status?"bg-white text-gray-700 border border-gray-300 hover:bg-gray-50":"text-white"}`,style:l.status?{}:{backgroundColor:"#714b67"},children:"All"})]})]}),s.jsxs("div",{className:"p-6",children:[b&&s.jsx("div",{className:"flex items-center justify-center h-64",children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"inline-block animate-spin rounded-full h-12 w-12 border-b-2 border-gray-900 mb-4"}),s.jsx("p",{className:"text-gray-600",children:"Loading purchase orders..."})]})}),M&&!b&&s.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 mb-4",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{className:"text-red-800 font-medium",children:M}),s.jsx("button",{onClick:R,className:"text-red-600 hover:text-red-800 font-medium text-sm",children:"Retry"})]})}),!b&&!M&&s.jsx(QT,{selectedCount:u.length,onBulkConfirm:Ne,onBulkCancel:ue}),!b&&!M&&s.jsx(s.Fragment,{children:W.length===0?s.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-12 text-center",children:[s.jsx(wt,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),s.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No purchase orders found"}),s.jsx("p",{className:"text-sm text-gray-500 mb-4",children:"Try adjusting your filters or create a new purchase order."}),s.jsx("button",{onClick:()=>{w(null),p(!0)},className:"px-4 py-2 text-sm font-medium text-white rounded-lg hover:opacity-90",style:{backgroundColor:"#714b67"},children:"New Purchase Order"})]}):s.jsx("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:s.jsx(JT,{purchaseOrders:W,selectedIds:u,onSelect:D,onSelectAll:z,onRowClick:ne})})})]}),v&&h&&s.jsx(ZT,{order:h,onClose:()=>{x(!1),m(null)},onUpdate:async()=>{if(await R(),h!=null&&h.id)try{const k=await Qr.getById(h.id);k.success&&m(k.data)}catch(k){console.error("Error refreshing order:",k)}}}),y&&s.jsx(ek,{order:g,projects:r,onClose:()=>{p(!1),w(null)},onSave:je})]})}const Ih={draft:"bg-gray-100 text-gray-700",posted:"bg-green-100 text-green-700",fulfilled:"bg-blue-100 text-blue-700",closed:"bg-purple-100 text-purple-700",cancelled:"bg-red-100 text-red-700"},rk={draft:wt,posted:Qe,fulfilled:$t,closed:Qe,cancelled:Nr};function nk({customerInvoices:e,selectedIds:t,onSelect:r,onSelectAll:n,onRowClick:a}){const i=e.length>0&&t.length===e.length,l=t.length>0&&t.length<e.length,o=(u,f="INR")=>new Intl.NumberFormat("en-IN",{style:"currency",currency:f,minimumFractionDigits:0,maximumFractionDigits:0}).format(u),c=u=>u?new Date(u).toLocaleDateString("en-IN",{day:"numeric",month:"short",year:"numeric"}):"-",d=u=>{const f=rk[u]||wt;return s.jsxs("span",{className:`inline-flex items-center gap-1.5 px-2.5 py-1 rounded-full text-xs font-medium ${Ih[u]||Ih.draft}`,children:[s.jsx(f,{className:"w-3 h-3"}),u.charAt(0).toUpperCase()+u.slice(1)]})};return e.length===0?s.jsx("div",{className:"text-center py-12",children:s.jsx("p",{className:"text-gray-500",children:"No customer invoices found"})}):s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"w-full border-collapse",children:[s.jsx("thead",{children:s.jsxs("tr",{className:"border-b border-gray-200",children:[s.jsx("th",{className:"px-4 py-3 text-left",children:s.jsx("input",{type:"checkbox",checked:i,ref:u=>{u&&(u.indeterminate=l)},onChange:u=>n(u.target.checked),className:"w-4 h-4 text-purple-600 rounded focus:ring-purple-500"})}),s.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Number"}),s.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Date"}),s.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Customer"}),s.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Project"}),s.jsx("th",{className:"px-4 py-3 text-right text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Amount"}),s.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Status"}),s.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Reference"})]})}),s.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:e.map(u=>s.jsxs("tr",{onClick:()=>a(u),className:"hover:bg-gray-50 cursor-pointer transition-colors",children:[s.jsx("td",{className:"px-4 py-3",onClick:f=>f.stopPropagation(),children:s.jsx("input",{type:"checkbox",checked:t.includes(u.id),onChange:f=>{f.stopPropagation(),r(u.id,f.target.checked)},className:"w-4 h-4 text-purple-600 rounded focus:ring-purple-500"})}),s.jsx("td",{className:"px-4 py-3 text-sm font-medium text-gray-900",children:u.number||"-"}),s.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:c(u.invoiceDate)}),s.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:u.customerName||"-"}),s.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:u.projectName||"-"}),s.jsx("td",{className:"px-4 py-3 text-sm text-right font-medium text-gray-900",children:o(u.grandTotal,u.currency)}),s.jsx("td",{className:"px-4 py-3",children:d(u.status)}),s.jsx("td",{className:"px-4 py-3 text-sm text-gray-500",children:u.reference||"-"})]},u.id))})]})})}function sk({filters:e,projects:t,onFilterChange:r}){const[n,a]=T.useState(!1),i=(o,c)=>{r({[o]:c})},l=()=>{r({})};return s.jsxs("div",{className:"relative",children:[s.jsxs("button",{onClick:()=>a(!n),className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 flex items-center gap-2",children:[s.jsx(qn,{className:"w-4 h-4"}),"Filters"]}),n&&s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"fixed inset-0 z-10",onClick:()=>a(!1)}),s.jsxs("div",{className:"absolute right-0 mt-2 w-80 bg-white border border-gray-200 rounded-lg shadow-lg z-20 p-4",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsx("h3",{className:"text-sm font-semibold text-gray-900",children:"Filters"}),s.jsx("button",{onClick:()=>a(!1),className:"text-gray-400 hover:text-gray-600",children:s.jsx(ze,{className:"w-4 h-4"})})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Project"}),s.jsxs("select",{value:e.project_id||"",onChange:o=>i("project_id",o.target.value||void 0),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm",children:[s.jsx("option",{value:"",children:"All Projects"}),t.map(o=>s.jsx("option",{value:o.id,children:o.name},o.id))]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Status"}),s.jsxs("select",{value:Array.isArray(e.status)?e.status[0]:e.status||"",onChange:o=>i("status",o.target.value?[o.target.value]:void 0),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm",children:[s.jsx("option",{value:"",children:"All Statuses"}),s.jsx("option",{value:"draft",children:"Draft"}),s.jsx("option",{value:"posted",children:"Posted"}),s.jsx("option",{value:"fulfilled",children:"Fulfilled"}),s.jsx("option",{value:"closed",children:"Closed"}),s.jsx("option",{value:"cancelled",children:"Cancelled"})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date From"}),s.jsx("input",{type:"date",value:e.date_from||"",onChange:o=>i("date_from",o.target.value||void 0),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date To"}),s.jsx("input",{type:"date",value:e.date_to||"",onChange:o=>i("date_to",o.target.value||void 0),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm"})]}),s.jsxs("div",{className:"flex gap-2 pt-2",children:[s.jsx("button",{onClick:l,className:"flex-1 px-3 py-2 text-sm font-medium text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200",children:"Clear"}),s.jsx("button",{onClick:()=>a(!1),className:"flex-1 px-3 py-2 text-sm font-medium text-white rounded-lg hover:opacity-90",style:{backgroundColor:"#714b67"},children:"Apply"})]})]})]})]})]})}function ak({selectedCount:e,onBulkConfirm:t,onBulkCancel:r}){return e===0?null:s.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-4 flex items-center justify-between",children:[s.jsx("div",{className:"flex items-center gap-2",children:s.jsxs("span",{className:"text-sm font-medium text-blue-900",children:[e," invoice",e!==1?"s":""," selected"]})}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("button",{onClick:t,className:"px-3 py-1.5 text-sm font-medium text-white rounded-lg hover:opacity-90",style:{backgroundColor:"#714b67"},children:"Post"}),s.jsx("button",{onClick:r,className:"px-3 py-1.5 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",children:"Cancel"})]})]})}function ik({order:e,onClose:t,onUpdate:r}){const n=(o,c="INR")=>new Intl.NumberFormat("en-IN",{style:"currency",currency:c,minimumFractionDigits:0,maximumFractionDigits:0}).format(o),a=o=>o?new Date(o).toLocaleDateString("en-IN",{day:"numeric",month:"short",year:"numeric"}):"-",i=async()=>{try{await Zr.post(e.id),r()}catch(o){console.error("Error posting invoice:",o)}},l=async()=>{try{await Zr.cancel(e.id),r()}catch(o){console.error("Error cancelling order:",o)}};return s.jsxs("div",{className:"fixed inset-0 z-50 overflow-hidden",children:[s.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-50",onClick:t}),s.jsx("div",{className:"absolute right-0 top-0 bottom-0 w-full max-w-2xl bg-white shadow-xl",children:s.jsxs("div",{className:"h-full flex flex-col",children:[s.jsxs("div",{className:"px-6 py-4 border-b border-gray-200 flex items-center justify-between",children:[s.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Customer Invoice Details"}),s.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-600",children:s.jsx(ze,{className:"w-5 h-5"})})]}),s.jsx("div",{className:"flex-1 overflow-y-auto p-6",children:s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"text-sm font-medium text-gray-500 mb-2",children:"Order Information"}),s.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 space-y-2",children:[s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-sm text-gray-600",children:"Number:"}),s.jsx("span",{className:"text-sm font-medium text-gray-900",children:e.number||"-"})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-sm text-gray-600",children:"Date:"}),s.jsx("span",{className:"text-sm font-medium text-gray-900",children:a(e.invoiceDate)})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-sm text-gray-600",children:"Customer:"}),s.jsx("span",{className:"text-sm font-medium text-gray-900",children:e.customerName||"-"})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-sm text-gray-600",children:"Project:"}),s.jsx("span",{className:"text-sm font-medium text-gray-900",children:e.projectName||"-"})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-sm text-gray-600",children:"Status:"}),s.jsx("span",{className:"text-sm font-medium text-gray-900 capitalize",children:e.status||"-"})]})]})]}),e.lines&&e.lines.length>0&&s.jsxs("div",{children:[s.jsx("h3",{className:"text-sm font-medium text-gray-500 mb-2",children:"Line Items"}),s.jsx("div",{className:"border border-gray-200 rounded-lg overflow-hidden",children:s.jsxs("table",{className:"w-full",children:[s.jsx("thead",{className:"bg-gray-50",children:s.jsxs("tr",{children:[s.jsx("th",{className:"px-4 py-2 text-left text-xs font-semibold text-gray-600",children:"Description"}),s.jsx("th",{className:"px-4 py-2 text-right text-xs font-semibold text-gray-600",children:"Quantity"}),s.jsx("th",{className:"px-4 py-2 text-right text-xs font-semibold text-gray-600",children:"Price"}),s.jsx("th",{className:"px-4 py-2 text-right text-xs font-semibold text-gray-600",children:"Total"})]})}),s.jsx("tbody",{className:"divide-y divide-gray-200",children:e.lines.map(o=>s.jsxs("tr",{children:[s.jsx("td",{className:"px-4 py-2 text-sm text-gray-900",children:o.description}),s.jsx("td",{className:"px-4 py-2 text-sm text-right text-gray-900",children:o.quantity}),s.jsx("td",{className:"px-4 py-2 text-sm text-right text-gray-900",children:n(o.unitPrice,e.currency)}),s.jsx("td",{className:"px-4 py-2 text-sm text-right font-medium text-gray-900",children:n(o.lineTotal,e.currency)})]},o.id))})]})})]}),s.jsxs("div",{children:[s.jsx("h3",{className:"text-sm font-medium text-gray-500 mb-2",children:"Totals"}),s.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 space-y-2",children:[s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-sm text-gray-600",children:"Subtotal:"}),s.jsx("span",{className:"text-sm font-medium text-gray-900",children:n(e.subtotal||0,e.currency)})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-sm text-gray-600",children:"Tax:"}),s.jsx("span",{className:"text-sm font-medium text-gray-900",children:n(e.taxTotal||0,e.currency)})]}),s.jsxs("div",{className:"flex justify-between border-t border-gray-300 pt-2",children:[s.jsx("span",{className:"text-sm font-semibold text-gray-900",children:"Grand Total:"}),s.jsx("span",{className:"text-sm font-semibold text-gray-900",children:n(e.grandTotal||0,e.currency)})]})]})]})]})}),s.jsxs("div",{className:"px-6 py-4 border-t border-gray-200 flex items-center justify-end gap-3",children:[e.status==="draft"&&s.jsxs(s.Fragment,{children:[s.jsx("button",{onClick:i,className:"px-4 py-2 text-sm font-medium text-white rounded-lg hover:opacity-90",style:{backgroundColor:"#714b67"},children:"Post"}),s.jsx("button",{onClick:l,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",children:"Cancel Invoice"})]}),s.jsx("button",{onClick:t,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",children:"Close"})]})]})})]})}function lk({order:e,projects:t,onClose:r,onSave:n}){const[a,i]=T.useState({project_id:"",customer_partner_id:"",invoice_date:new Date().toISOString().split("T")[0],currency:"INR",lines:[{description:"",quantity:1,unit_price:0}]}),[l,o]=T.useState(!1);T.useEffect(()=>{var f;e&&i({project_id:e.projectId||"",customer_partner_id:e.customerPartnerId||"",invoice_date:e.invoiceDate||new Date().toISOString().split("T")[0],currency:e.currency||"INR",lines:((f=e.lines)==null?void 0:f.map(h=>({description:h.description,quantity:h.quantity,unit_price:h.unitPrice})))||[{description:"",quantity:1,unit_price:0}]})},[e]);const c=async f=>{f.preventDefault(),o(!0);try{e?await Zr.update(e.id,a):await Zr.create(a),n()}catch(h){console.error("Error saving customer invoice:",h),alert("Failed to save customer invoice")}finally{o(!1)}},d=()=>{i(f=>({...f,lines:[...f.lines,{description:"",quantity:1,unit_price:0}]}))},u=(f,h,m)=>{i(v=>({...v,lines:v.lines.map((x,y)=>y===f?{...x,[h]:m}:x)}))};return s.jsxs("div",{className:"fixed inset-0 z-50 overflow-hidden",children:[s.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-50",onClick:r}),s.jsx("div",{className:"absolute inset-0 flex items-center justify-center p-4",children:s.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-4xl max-h-[90vh] overflow-hidden flex flex-col",children:[s.jsxs("div",{className:"px-6 py-4 border-b border-gray-200 flex items-center justify-between",children:[s.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:e?"Edit Customer Invoice":"New Customer Invoice"}),s.jsx("button",{onClick:r,className:"text-gray-400 hover:text-gray-600",children:s.jsx(ze,{className:"w-5 h-5"})})]}),s.jsx("form",{onSubmit:c,className:"flex-1 overflow-y-auto p-6",children:s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Project"}),s.jsxs("select",{value:a.project_id,onChange:f=>i(h=>({...h,project_id:f.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm",children:[s.jsx("option",{value:"",children:"Select Project"}),t.map(f=>s.jsx("option",{value:f.id,children:f.name},f.id))]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Invoice Date"}),s.jsx("input",{type:"date",value:a.invoice_date,onChange:f=>i(h=>({...h,invoice_date:f.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm",required:!0})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Customer Partner ID"}),s.jsx("input",{type:"text",value:a.customer_partner_id,onChange:f=>i(h=>({...h,customer_partner_id:f.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm",placeholder:"Enter customer partner ID",required:!0})]}),s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Line Items"}),s.jsx("button",{type:"button",onClick:d,className:"text-sm text-blue-600 hover:text-blue-800",children:"+ Add Line"})]}),s.jsx("div",{className:"border border-gray-200 rounded-lg overflow-hidden",children:s.jsxs("table",{className:"w-full",children:[s.jsx("thead",{className:"bg-gray-50",children:s.jsxs("tr",{children:[s.jsx("th",{className:"px-4 py-2 text-left text-xs font-semibold text-gray-600",children:"Description"}),s.jsx("th",{className:"px-4 py-2 text-right text-xs font-semibold text-gray-600",children:"Quantity"}),s.jsx("th",{className:"px-4 py-2 text-right text-xs font-semibold text-gray-600",children:"Unit Price"})]})}),s.jsx("tbody",{className:"divide-y divide-gray-200",children:a.lines.map((f,h)=>s.jsxs("tr",{children:[s.jsx("td",{className:"px-4 py-2",children:s.jsx("input",{type:"text",value:f.description,onChange:m=>u(h,"description",m.target.value),className:"w-full px-2 py-1 border border-gray-300 rounded text-sm",required:!0})}),s.jsx("td",{className:"px-4 py-2",children:s.jsx("input",{type:"number",value:f.quantity,onChange:m=>u(h,"quantity",parseFloat(m.target.value)||0),className:"w-full px-2 py-1 border border-gray-300 rounded text-sm text-right",min:"0",step:"0.01",required:!0})}),s.jsx("td",{className:"px-4 py-2",children:s.jsx("input",{type:"number",value:f.unit_price,onChange:m=>u(h,"unit_price",parseFloat(m.target.value)||0),className:"w-full px-2 py-1 border border-gray-300 rounded text-sm text-right",min:"0",step:"0.01",required:!0})})]},h))})]})})]})]})}),s.jsxs("div",{className:"px-6 py-4 border-t border-gray-200 flex items-center justify-end gap-3",children:[s.jsx("button",{onClick:r,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",children:"Cancel"}),s.jsx("button",{onClick:c,disabled:l,className:"px-4 py-2 text-sm font-medium text-white rounded-lg hover:opacity-90 disabled:opacity-50",style:{backgroundColor:"#714b67"},children:l?"Saving...":"Save"})]})]})})]})}function ok(){const[e,t]=T.useState([]),[r,n]=T.useState([]),[a,i]=T.useState({totalCount:0,draftCount:0,postedCount:0,fulfilledCount:0,totalAmount:0,postedAmount:0}),[l,o]=T.useState({date_from:O(),date_to:new Date().toISOString().split("T")[0]}),[c,d]=T.useState(""),[u,f]=T.useState([]),[h,m]=T.useState(null),[v,x]=T.useState(!1),[y,p]=T.useState(!1),[g,w]=T.useState(null),[b,P]=T.useState(!0),[M,j]=T.useState(null);function O(){const k=new Date;return k.setDate(k.getDate()-90),k.toISOString().split("T")[0]}T.useEffect(()=>{R()},[l]);const R=async()=>{try{P(!0),j(null);const k=await yr.getAll();k.success&&n(k.data);const K=await Zr.getAll(l);K.success?t(K.data):j(K.message||"Failed to load customer invoices");const te=await Zr.getStats(l);te.success&&i(te.data)}catch(k){console.error("Error loading data:",k),j("Unable to connect to server. Please try again.")}finally{P(!1)}},I=k=>{Object.keys(k).length===0?o({date_from:O(),date_to:new Date().toISOString().split("T")[0]}):o(K=>{const te={...K};return Object.keys(k).forEach(E=>{const B=k[E];B===void 0||B===""||B===null||Array.isArray(B)&&B.length===0?delete te[E]:te[E]=B}),te}),f([])},D=(k,K)=>{f(K?te=>[...te,k]:te=>te.filter(E=>E!==k))},z=k=>{f(k?e.map(K=>K.id):[])},ne=k=>{m(k),x(!0)},Ne=async()=>{try{for(const k of u)await Zr.post(k);f([]),R()}catch(k){console.error("Error bulk posting:",k)}},ue=async()=>{try{for(const k of u)await Zr.cancel(k);f([]),R()}catch(k){console.error("Error bulk cancelling:",k)}},je=()=>{R(),p(!1),w(null)},q=k=>new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR",minimumFractionDigits:0,maximumFractionDigits:0}).format(k),W=e.filter(k=>{var te,E,B,L;if(!c.trim())return!0;const K=c.toLowerCase();return((te=k.number)==null?void 0:te.toLowerCase().includes(K))||((E=k.customerName)==null?void 0:E.toLowerCase().includes(K))||((B=k.projectName)==null?void 0:B.toLowerCase().includes(K))||((L=k.reference)==null?void 0:L.toLowerCase().includes(K))});return s.jsxs("div",{className:"h-full bg-gray-50",children:[s.jsxs("header",{className:"bg-white border-b border-gray-200 px-8 py-6",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsxs("div",{className:"flex items-center gap-6 flex-1",children:[s.jsx("h1",{className:"text-2xl font-semibold text-gray-900",children:"Customer Invoices"}),s.jsxs("div",{className:"relative flex-1 max-w-md",children:[s.jsx(pn,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),s.jsx("input",{value:c,onChange:k=>d(k.target.value),type:"text",placeholder:"Search customer invoices...",className:"w-full pl-10 pr-4 py-2.5 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-400 focus:border-transparent text-sm",disabled:b})]})]}),s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(sk,{filters:l,projects:r,onFilterChange:I}),s.jsxs("button",{onClick:()=>{w(null),p(!0)},className:"px-4 py-2 text-sm font-medium text-white rounded-lg hover:opacity-90 transition-opacity disabled:opacity-50",style:{backgroundColor:"#714b67"},disabled:b,children:[s.jsx(lr,{className:"inline w-4 h-4 mr-2"})," New Customer Invoice"]})]})]}),s.jsxs("div",{className:"grid grid-cols-4 gap-4 mb-4",children:[s.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[s.jsx("div",{className:"text-sm text-gray-600 mb-1",children:"Total Orders"}),s.jsx("div",{className:"text-2xl font-semibold",style:{color:"#714b67"},children:a.totalCount})]}),s.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[s.jsx("div",{className:"text-sm text-gray-600 mb-1",children:"Draft"}),s.jsx("div",{className:"text-2xl font-semibold text-gray-900",children:a.draftCount})]}),s.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[s.jsx("div",{className:"text-sm text-gray-600 mb-1",children:"Posted"}),s.jsx("div",{className:"text-2xl font-semibold text-gray-900",children:a.postedCount})]}),s.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[s.jsx("div",{className:"text-sm text-gray-600 mb-1",children:"Total Amount"}),s.jsx("div",{className:"text-2xl font-semibold text-gray-900",children:q(a.totalAmount)})]})]}),s.jsxs("div",{className:"flex items-center gap-2 mb-4 flex-wrap",children:[s.jsx("button",{onClick:()=>I({status:["draft"]}),className:`px-3 py-1.5 text-sm font-medium rounded-lg transition-colors ${JSON.stringify(l.status)===JSON.stringify(["draft"])?"text-white":"bg-white text-gray-700 border border-gray-300 hover:bg-gray-50"}`,style:JSON.stringify(l.status)===JSON.stringify(["draft"])?{backgroundColor:"#714b67"}:{},children:"Draft"}),s.jsx("button",{onClick:()=>I({status:["posted"]}),className:`px-3 py-1.5 text-sm font-medium rounded-lg transition-colors ${JSON.stringify(l.status)===JSON.stringify(["posted"])?"text-white":"bg-white text-gray-700 border border-gray-300 hover:bg-gray-50"}`,style:JSON.stringify(l.status)===JSON.stringify(["posted"])?{backgroundColor:"#714b67"}:{},children:"Posted"}),s.jsx("button",{onClick:()=>{const{status:k,...K}=l;I(K)},className:`px-3 py-1.5 text-sm font-medium rounded-lg transition-colors ${l.status?"bg-white text-gray-700 border border-gray-300 hover:bg-gray-50":"text-white"}`,style:l.status?{}:{backgroundColor:"#714b67"},children:"All"})]})]}),s.jsxs("div",{className:"p-6",children:[b&&s.jsx("div",{className:"flex items-center justify-center h-64",children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"inline-block animate-spin rounded-full h-12 w-12 border-b-2 border-gray-900 mb-4"}),s.jsx("p",{className:"text-gray-600",children:"Loading customer invoices..."})]})}),M&&!b&&s.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 mb-4",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{className:"text-red-800 font-medium",children:M}),s.jsx("button",{onClick:R,className:"text-red-600 hover:text-red-800 font-medium text-sm",children:"Retry"})]})}),!b&&!M&&s.jsx(ak,{selectedCount:u.length,onBulkConfirm:Ne,onBulkCancel:ue}),!b&&!M&&s.jsx(s.Fragment,{children:W.length===0?s.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-12 text-center",children:[s.jsx(up,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),s.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No customer invoices found"}),s.jsx("p",{className:"text-sm text-gray-500 mb-4",children:"Try adjusting your filters or create a new customer invoice."}),s.jsx("button",{onClick:()=>{w(null),p(!0)},className:"px-4 py-2 text-sm font-medium text-white rounded-lg hover:opacity-90",style:{backgroundColor:"#714b67"},children:"New Customer Invoice"})]}):s.jsx("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:s.jsx(nk,{customerInvoices:W,selectedIds:u,onSelect:D,onSelectAll:z,onRowClick:ne})})})]}),v&&h&&s.jsx(ik,{order:h,onClose:()=>{x(!1),m(null)},onUpdate:async()=>{if(await R(),h!=null&&h.id)try{const k=await Zr.getById(h.id);k.success&&m(k.data)}catch(k){console.error("Error refreshing order:",k)}}}),y&&s.jsx(lk,{order:g,projects:r,onClose:()=>{p(!1),w(null)},onSave:je})]})}const Dh={draft:"bg-gray-100 text-gray-700",posted:"bg-green-100 text-green-700",fulfilled:"bg-blue-100 text-blue-700",closed:"bg-purple-100 text-purple-700",cancelled:"bg-red-100 text-red-700"},ck={draft:wt,posted:Qe,fulfilled:$t,closed:Qe,cancelled:Nr};function uk({vendorBills:e,selectedIds:t,onSelect:r,onSelectAll:n,onRowClick:a}){const i=e.length>0&&t.length===e.length,l=t.length>0&&t.length<e.length,o=(u,f="INR")=>new Intl.NumberFormat("en-IN",{style:"currency",currency:f,minimumFractionDigits:0,maximumFractionDigits:0}).format(u),c=u=>u?new Date(u).toLocaleDateString("en-IN",{day:"numeric",month:"short",year:"numeric"}):"-",d=u=>{const f=ck[u]||wt;return s.jsxs("span",{className:`inline-flex items-center gap-1.5 px-2.5 py-1 rounded-full text-xs font-medium ${Dh[u]||Dh.draft}`,children:[s.jsx(f,{className:"w-3 h-3"}),u.charAt(0).toUpperCase()+u.slice(1)]})};return e.length===0?s.jsx("div",{className:"text-center py-12",children:s.jsx("p",{className:"text-gray-500",children:"No vendor bills found"})}):s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"w-full border-collapse",children:[s.jsx("thead",{children:s.jsxs("tr",{className:"border-b border-gray-200",children:[s.jsx("th",{className:"px-4 py-3 text-left",children:s.jsx("input",{type:"checkbox",checked:i,ref:u=>{u&&(u.indeterminate=l)},onChange:u=>n(u.target.checked),className:"w-4 h-4 text-purple-600 rounded focus:ring-purple-500"})}),s.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Number"}),s.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Date"}),s.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Vendor"}),s.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Project"}),s.jsx("th",{className:"px-4 py-3 text-right text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Amount"}),s.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Status"}),s.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Reference"})]})}),s.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:e.map(u=>s.jsxs("tr",{onClick:()=>a(u),className:"hover:bg-gray-50 cursor-pointer transition-colors",children:[s.jsx("td",{className:"px-4 py-3",onClick:f=>f.stopPropagation(),children:s.jsx("input",{type:"checkbox",checked:t.includes(u.id),onChange:f=>{f.stopPropagation(),r(u.id,f.target.checked)},className:"w-4 h-4 text-purple-600 rounded focus:ring-purple-500"})}),s.jsx("td",{className:"px-4 py-3 text-sm font-medium text-gray-900",children:u.number||"-"}),s.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:c(u.billDate)}),s.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:u.vendorName||"-"}),s.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:u.projectName||"-"}),s.jsx("td",{className:"px-4 py-3 text-sm text-right font-medium text-gray-900",children:o(u.grandTotal,u.currency)}),s.jsx("td",{className:"px-4 py-3",children:d(u.status)}),s.jsx("td",{className:"px-4 py-3 text-sm text-gray-500",children:u.reference||"-"})]},u.id))})]})})}function dk({filters:e,projects:t,onFilterChange:r}){const[n,a]=T.useState(!1),i=(o,c)=>{r({[o]:c})},l=()=>{r({})};return s.jsxs("div",{className:"relative",children:[s.jsxs("button",{onClick:()=>a(!n),className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 flex items-center gap-2",children:[s.jsx(qn,{className:"w-4 h-4"}),"Filters"]}),n&&s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"fixed inset-0 z-10",onClick:()=>a(!1)}),s.jsxs("div",{className:"absolute right-0 mt-2 w-80 bg-white border border-gray-200 rounded-lg shadow-lg z-20 p-4",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsx("h3",{className:"text-sm font-semibold text-gray-900",children:"Filters"}),s.jsx("button",{onClick:()=>a(!1),className:"text-gray-400 hover:text-gray-600",children:s.jsx(ze,{className:"w-4 h-4"})})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Project"}),s.jsxs("select",{value:e.project_id||"",onChange:o=>i("project_id",o.target.value||void 0),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm",children:[s.jsx("option",{value:"",children:"All Projects"}),t.map(o=>s.jsx("option",{value:o.id,children:o.name},o.id))]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Status"}),s.jsxs("select",{value:Array.isArray(e.status)?e.status[0]:e.status||"",onChange:o=>i("status",o.target.value?[o.target.value]:void 0),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm",children:[s.jsx("option",{value:"",children:"All Statuses"}),s.jsx("option",{value:"draft",children:"Draft"}),s.jsx("option",{value:"posted",children:"Posted"}),s.jsx("option",{value:"fulfilled",children:"Fulfilled"}),s.jsx("option",{value:"closed",children:"Closed"}),s.jsx("option",{value:"cancelled",children:"Cancelled"})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date From"}),s.jsx("input",{type:"date",value:e.date_from||"",onChange:o=>i("date_from",o.target.value||void 0),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date To"}),s.jsx("input",{type:"date",value:e.date_to||"",onChange:o=>i("date_to",o.target.value||void 0),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm"})]}),s.jsxs("div",{className:"flex gap-2 pt-2",children:[s.jsx("button",{onClick:l,className:"flex-1 px-3 py-2 text-sm font-medium text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200",children:"Clear"}),s.jsx("button",{onClick:()=>a(!1),className:"flex-1 px-3 py-2 text-sm font-medium text-white rounded-lg hover:opacity-90",style:{backgroundColor:"#714b67"},children:"Apply"})]})]})]})]})]})}function fk({selectedCount:e,onBulkConfirm:t,onBulkCancel:r}){return e===0?null:s.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-4 flex items-center justify-between",children:[s.jsx("div",{className:"flex items-center gap-2",children:s.jsxs("span",{className:"text-sm font-medium text-blue-900",children:[e," bill",e!==1?"s":""," selected"]})}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("button",{onClick:t,className:"px-3 py-1.5 text-sm font-medium text-white rounded-lg hover:opacity-90",style:{backgroundColor:"#714b67"},children:"Post"}),s.jsx("button",{onClick:r,className:"px-3 py-1.5 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",children:"Cancel"})]})]})}function hk({order:e,onClose:t,onUpdate:r}){const n=(o,c="INR")=>new Intl.NumberFormat("en-IN",{style:"currency",currency:c,minimumFractionDigits:0,maximumFractionDigits:0}).format(o),a=o=>o?new Date(o).toLocaleDateString("en-IN",{day:"numeric",month:"short",year:"numeric"}):"-",i=async()=>{try{await en.post(e.id),r()}catch(o){console.error("Error posting bill:",o)}},l=async()=>{try{await en.cancel(e.id),r()}catch(o){console.error("Error cancelling order:",o)}};return s.jsxs("div",{className:"fixed inset-0 z-50 overflow-hidden",children:[s.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-50",onClick:t}),s.jsx("div",{className:"absolute right-0 top-0 bottom-0 w-full max-w-2xl bg-white shadow-xl",children:s.jsxs("div",{className:"h-full flex flex-col",children:[s.jsxs("div",{className:"px-6 py-4 border-b border-gray-200 flex items-center justify-between",children:[s.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Vendor Bill Details"}),s.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-600",children:s.jsx(ze,{className:"w-5 h-5"})})]}),s.jsx("div",{className:"flex-1 overflow-y-auto p-6",children:s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"text-sm font-medium text-gray-500 mb-2",children:"Order Information"}),s.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 space-y-2",children:[s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-sm text-gray-600",children:"Number:"}),s.jsx("span",{className:"text-sm font-medium text-gray-900",children:e.number||"-"})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-sm text-gray-600",children:"Date:"}),s.jsx("span",{className:"text-sm font-medium text-gray-900",children:a(e.billDate)})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-sm text-gray-600",children:"Vendor:"}),s.jsx("span",{className:"text-sm font-medium text-gray-900",children:e.vendorName||"-"})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-sm text-gray-600",children:"Project:"}),s.jsx("span",{className:"text-sm font-medium text-gray-900",children:e.projectName||"-"})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-sm text-gray-600",children:"Status:"}),s.jsx("span",{className:"text-sm font-medium text-gray-900 capitalize",children:e.status||"-"})]})]})]}),e.lines&&e.lines.length>0&&s.jsxs("div",{children:[s.jsx("h3",{className:"text-sm font-medium text-gray-500 mb-2",children:"Line Items"}),s.jsx("div",{className:"border border-gray-200 rounded-lg overflow-hidden",children:s.jsxs("table",{className:"w-full",children:[s.jsx("thead",{className:"bg-gray-50",children:s.jsxs("tr",{children:[s.jsx("th",{className:"px-4 py-2 text-left text-xs font-semibold text-gray-600",children:"Description"}),s.jsx("th",{className:"px-4 py-2 text-right text-xs font-semibold text-gray-600",children:"Quantity"}),s.jsx("th",{className:"px-4 py-2 text-right text-xs font-semibold text-gray-600",children:"Price"}),s.jsx("th",{className:"px-4 py-2 text-right text-xs font-semibold text-gray-600",children:"Total"})]})}),s.jsx("tbody",{className:"divide-y divide-gray-200",children:e.lines.map(o=>s.jsxs("tr",{children:[s.jsx("td",{className:"px-4 py-2 text-sm text-gray-900",children:o.description}),s.jsx("td",{className:"px-4 py-2 text-sm text-right text-gray-900",children:o.quantity}),s.jsx("td",{className:"px-4 py-2 text-sm text-right text-gray-900",children:n(o.unitPrice,e.currency)}),s.jsx("td",{className:"px-4 py-2 text-sm text-right font-medium text-gray-900",children:n(o.lineTotal,e.currency)})]},o.id))})]})})]}),s.jsxs("div",{children:[s.jsx("h3",{className:"text-sm font-medium text-gray-500 mb-2",children:"Totals"}),s.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 space-y-2",children:[s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-sm text-gray-600",children:"Subtotal:"}),s.jsx("span",{className:"text-sm font-medium text-gray-900",children:n(e.subtotal||0,e.currency)})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-sm text-gray-600",children:"Tax:"}),s.jsx("span",{className:"text-sm font-medium text-gray-900",children:n(e.taxTotal||0,e.currency)})]}),s.jsxs("div",{className:"flex justify-between border-t border-gray-300 pt-2",children:[s.jsx("span",{className:"text-sm font-semibold text-gray-900",children:"Grand Total:"}),s.jsx("span",{className:"text-sm font-semibold text-gray-900",children:n(e.grandTotal||0,e.currency)})]})]})]})]})}),s.jsxs("div",{className:"px-6 py-4 border-t border-gray-200 flex items-center justify-end gap-3",children:[e.status==="draft"&&s.jsxs(s.Fragment,{children:[s.jsx("button",{onClick:i,className:"px-4 py-2 text-sm font-medium text-white rounded-lg hover:opacity-90",style:{backgroundColor:"#714b67"},children:"Post"}),s.jsx("button",{onClick:l,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",children:"Cancel Bill"})]}),s.jsx("button",{onClick:t,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",children:"Close"})]})]})})]})}function xk({order:e,projects:t,onClose:r,onSave:n}){const[a,i]=T.useState({project_id:"",vendor_partner_id:"",bill_date:new Date().toISOString().split("T")[0],currency:"INR",lines:[{description:"",quantity:1,unit_price:0}]}),[l,o]=T.useState(!1);T.useEffect(()=>{var f;e&&i({project_id:e.projectId||"",vendor_partner_id:e.vendorPartnerId||"",bill_date:e.billDate||new Date().toISOString().split("T")[0],currency:e.currency||"INR",lines:((f=e.lines)==null?void 0:f.map(h=>({description:h.description,quantity:h.quantity,unit_price:h.unitPrice})))||[{description:"",quantity:1,unit_price:0}]})},[e]);const c=async f=>{f.preventDefault(),o(!0);try{e?await en.update(e.id,a):await en.create(a),n()}catch(h){console.error("Error saving vendor bill:",h),alert("Failed to save vendor bill")}finally{o(!1)}},d=()=>{i(f=>({...f,lines:[...f.lines,{description:"",quantity:1,unit_price:0}]}))},u=(f,h,m)=>{i(v=>({...v,lines:v.lines.map((x,y)=>y===f?{...x,[h]:m}:x)}))};return s.jsxs("div",{className:"fixed inset-0 z-50 overflow-hidden",children:[s.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-50",onClick:r}),s.jsx("div",{className:"absolute inset-0 flex items-center justify-center p-4",children:s.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-4xl max-h-[90vh] overflow-hidden flex flex-col",children:[s.jsxs("div",{className:"px-6 py-4 border-b border-gray-200 flex items-center justify-between",children:[s.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:e?"Edit Vendor Bill":"New Vendor Bill"}),s.jsx("button",{onClick:r,className:"text-gray-400 hover:text-gray-600",children:s.jsx(ze,{className:"w-5 h-5"})})]}),s.jsx("form",{onSubmit:c,className:"flex-1 overflow-y-auto p-6",children:s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Project"}),s.jsxs("select",{value:a.project_id,onChange:f=>i(h=>({...h,project_id:f.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm",children:[s.jsx("option",{value:"",children:"Select Project"}),t.map(f=>s.jsx("option",{value:f.id,children:f.name},f.id))]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Bill Date"}),s.jsx("input",{type:"date",value:a.bill_date,onChange:f=>i(h=>({...h,bill_date:f.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm",required:!0})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Vendor Partner ID"}),s.jsx("input",{type:"text",value:a.vendor_partner_id,onChange:f=>i(h=>({...h,vendor_partner_id:f.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm",placeholder:"Enter vendor partner ID",required:!0})]}),s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Line Items"}),s.jsx("button",{type:"button",onClick:d,className:"text-sm text-blue-600 hover:text-blue-800",children:"+ Add Line"})]}),s.jsx("div",{className:"border border-gray-200 rounded-lg overflow-hidden",children:s.jsxs("table",{className:"w-full",children:[s.jsx("thead",{className:"bg-gray-50",children:s.jsxs("tr",{children:[s.jsx("th",{className:"px-4 py-2 text-left text-xs font-semibold text-gray-600",children:"Description"}),s.jsx("th",{className:"px-4 py-2 text-right text-xs font-semibold text-gray-600",children:"Quantity"}),s.jsx("th",{className:"px-4 py-2 text-right text-xs font-semibold text-gray-600",children:"Unit Price"})]})}),s.jsx("tbody",{className:"divide-y divide-gray-200",children:a.lines.map((f,h)=>s.jsxs("tr",{children:[s.jsx("td",{className:"px-4 py-2",children:s.jsx("input",{type:"text",value:f.description,onChange:m=>u(h,"description",m.target.value),className:"w-full px-2 py-1 border border-gray-300 rounded text-sm",required:!0})}),s.jsx("td",{className:"px-4 py-2",children:s.jsx("input",{type:"number",value:f.quantity,onChange:m=>u(h,"quantity",parseFloat(m.target.value)||0),className:"w-full px-2 py-1 border border-gray-300 rounded text-sm text-right",min:"0",step:"0.01",required:!0})}),s.jsx("td",{className:"px-4 py-2",children:s.jsx("input",{type:"number",value:f.unit_price,onChange:m=>u(h,"unit_price",parseFloat(m.target.value)||0),className:"w-full px-2 py-1 border border-gray-300 rounded text-sm text-right",min:"0",step:"0.01",required:!0})})]},h))})]})})]})]})}),s.jsxs("div",{className:"px-6 py-4 border-t border-gray-200 flex items-center justify-end gap-3",children:[s.jsx("button",{onClick:r,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",children:"Cancel"}),s.jsx("button",{onClick:c,disabled:l,className:"px-4 py-2 text-sm font-medium text-white rounded-lg hover:opacity-90 disabled:opacity-50",style:{backgroundColor:"#714b67"},children:l?"Saving...":"Save"})]})]})})]})}function mk(){const[e,t]=T.useState([]),[r,n]=T.useState([]),[a,i]=T.useState({totalCount:0,draftCount:0,postedCount:0,fulfilledCount:0,totalAmount:0,postedAmount:0}),[l,o]=T.useState({date_from:O(),date_to:new Date().toISOString().split("T")[0]}),[c,d]=T.useState(""),[u,f]=T.useState([]),[h,m]=T.useState(null),[v,x]=T.useState(!1),[y,p]=T.useState(!1),[g,w]=T.useState(null),[b,P]=T.useState(!0),[M,j]=T.useState(null);function O(){const k=new Date;return k.setDate(k.getDate()-90),k.toISOString().split("T")[0]}T.useEffect(()=>{R()},[l]);const R=async()=>{try{P(!0),j(null);const k=await yr.getAll();k.success&&n(k.data);const K=await en.getAll(l);K.success?t(K.data):j(K.message||"Failed to load vendor bills");const te=await en.getStats(l);te.success&&i(te.data)}catch(k){console.error("Error loading data:",k),j("Unable to connect to server. Please try again.")}finally{P(!1)}},I=k=>{Object.keys(k).length===0?o({date_from:O(),date_to:new Date().toISOString().split("T")[0]}):o(K=>{const te={...K};return Object.keys(k).forEach(E=>{const B=k[E];B===void 0||B===""||B===null||Array.isArray(B)&&B.length===0?delete te[E]:te[E]=B}),te}),f([])},D=(k,K)=>{f(K?te=>[...te,k]:te=>te.filter(E=>E!==k))},z=k=>{f(k?e.map(K=>K.id):[])},ne=k=>{m(k),x(!0)},Ne=async()=>{try{for(const k of u)await en.post(k);f([]),R()}catch(k){console.error("Error bulk posting:",k)}},ue=async()=>{try{for(const k of u)await en.cancel(k);f([]),R()}catch(k){console.error("Error bulk cancelling:",k)}},je=()=>{R(),p(!1),w(null)},q=k=>new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR",minimumFractionDigits:0,maximumFractionDigits:0}).format(k),W=e.filter(k=>{var te,E,B,L;if(!c.trim())return!0;const K=c.toLowerCase();return((te=k.number)==null?void 0:te.toLowerCase().includes(K))||((E=k.vendorName)==null?void 0:E.toLowerCase().includes(K))||((B=k.projectName)==null?void 0:B.toLowerCase().includes(K))||((L=k.reference)==null?void 0:L.toLowerCase().includes(K))});return s.jsxs("div",{className:"h-full bg-gray-50",children:[s.jsxs("header",{className:"bg-white border-b border-gray-200 px-8 py-6",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsxs("div",{className:"flex items-center gap-6 flex-1",children:[s.jsx("h1",{className:"text-2xl font-semibold text-gray-900",children:"Vendor Bills"}),s.jsxs("div",{className:"relative flex-1 max-w-md",children:[s.jsx(pn,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),s.jsx("input",{value:c,onChange:k=>d(k.target.value),type:"text",placeholder:"Search vendor bills...",className:"w-full pl-10 pr-4 py-2.5 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-400 focus:border-transparent text-sm",disabled:b})]})]}),s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(dk,{filters:l,projects:r,onFilterChange:I}),s.jsxs("button",{onClick:()=>{w(null),p(!0)},className:"px-4 py-2 text-sm font-medium text-white rounded-lg hover:opacity-90 transition-opacity disabled:opacity-50",style:{backgroundColor:"#714b67"},disabled:b,children:[s.jsx(lr,{className:"inline w-4 h-4 mr-2"})," New Vendor Bill"]})]})]}),s.jsxs("div",{className:"grid grid-cols-4 gap-4 mb-4",children:[s.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[s.jsx("div",{className:"text-sm text-gray-600 mb-1",children:"Total Orders"}),s.jsx("div",{className:"text-2xl font-semibold",style:{color:"#714b67"},children:a.totalCount})]}),s.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[s.jsx("div",{className:"text-sm text-gray-600 mb-1",children:"Draft"}),s.jsx("div",{className:"text-2xl font-semibold text-gray-900",children:a.draftCount})]}),s.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[s.jsx("div",{className:"text-sm text-gray-600 mb-1",children:"Posted"}),s.jsx("div",{className:"text-2xl font-semibold text-gray-900",children:a.postedCount})]}),s.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[s.jsx("div",{className:"text-sm text-gray-600 mb-1",children:"Total Amount"}),s.jsx("div",{className:"text-2xl font-semibold text-gray-900",children:q(a.totalAmount)})]})]}),s.jsxs("div",{className:"flex items-center gap-2 mb-4 flex-wrap",children:[s.jsx("button",{onClick:()=>I({status:["draft"]}),className:`px-3 py-1.5 text-sm font-medium rounded-lg transition-colors ${JSON.stringify(l.status)===JSON.stringify(["draft"])?"text-white":"bg-white text-gray-700 border border-gray-300 hover:bg-gray-50"}`,style:JSON.stringify(l.status)===JSON.stringify(["draft"])?{backgroundColor:"#714b67"}:{},children:"Draft"}),s.jsx("button",{onClick:()=>I({status:["posted"]}),className:`px-3 py-1.5 text-sm font-medium rounded-lg transition-colors ${JSON.stringify(l.status)===JSON.stringify(["posted"])?"text-white":"bg-white text-gray-700 border border-gray-300 hover:bg-gray-50"}`,style:JSON.stringify(l.status)===JSON.stringify(["posted"])?{backgroundColor:"#714b67"}:{},children:"Posted"}),s.jsx("button",{onClick:()=>{const{status:k,...K}=l;I(K)},className:`px-3 py-1.5 text-sm font-medium rounded-lg transition-colors ${l.status?"bg-white text-gray-700 border border-gray-300 hover:bg-gray-50":"text-white"}`,style:l.status?{}:{backgroundColor:"#714b67"},children:"All"})]})]}),s.jsxs("div",{className:"p-6",children:[b&&s.jsx("div",{className:"flex items-center justify-center h-64",children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"inline-block animate-spin rounded-full h-12 w-12 border-b-2 border-gray-900 mb-4"}),s.jsx("p",{className:"text-gray-600",children:"Loading vendor bills..."})]})}),M&&!b&&s.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 mb-4",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{className:"text-red-800 font-medium",children:M}),s.jsx("button",{onClick:R,className:"text-red-600 hover:text-red-800 font-medium text-sm",children:"Retry"})]})}),!b&&!M&&s.jsx(fk,{selectedCount:u.length,onBulkConfirm:Ne,onBulkCancel:ue}),!b&&!M&&s.jsx(s.Fragment,{children:W.length===0?s.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-12 text-center",children:[s.jsx(Ro,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),s.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No vendor bills found"}),s.jsx("p",{className:"text-sm text-gray-500 mb-4",children:"Try adjusting your filters or create a new vendor bill."}),s.jsx("button",{onClick:()=>{w(null),p(!0)},className:"px-4 py-2 text-sm font-medium text-white rounded-lg hover:opacity-90",style:{backgroundColor:"#714b67"},children:"New Vendor Bill"})]}):s.jsx("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:s.jsx(uk,{vendorBills:W,selectedIds:u,onSelect:D,onSelectAll:z,onRowClick:ne})})})]}),v&&h&&s.jsx(hk,{order:h,onClose:()=>{x(!1),m(null)},onUpdate:async()=>{if(await R(),h!=null&&h.id)try{const k=await en.getById(h.id);k.success&&m(k.data)}catch(k){console.error("Error refreshing order:",k)}}}),y&&s.jsx(xk,{order:g,projects:r,onClose:()=>{p(!1),w(null)},onSave:je})]})}function pk(){return s.jsx(J2,{children:s.jsxs(W2,{children:[s.jsx(Ve,{path:"/",element:s.jsx(Ob,{})}),s.jsx(Ve,{path:"/login",element:s.jsx(Fb,{})}),s.jsx(Ve,{path:"/signup",element:s.jsx(Pb,{})}),s.jsxs(Ve,{path:"/app",element:s.jsx(sb,{}),children:[s.jsx(Ve,{index:!0,element:s.jsx($f,{})}),s.jsx(Ve,{path:"dashboard",element:s.jsx($f,{})}),s.jsx(Ve,{path:"notes",element:s.jsx(ob,{})}),s.jsx(Ve,{path:"projects",element:s.jsx(fb,{})}),s.jsx(Ve,{path:"projects/:projectId",element:s.jsx(hb,{})}),s.jsx(Ve,{path:"notifications",element:s.jsx(bb,{})}),s.jsx(Ve,{path:"tasks",element:s.jsx(vb,{})}),s.jsx(Ve,{path:"expenses",element:s.jsx(Wb,{})}),s.jsx(Ve,{path:"timesheets",element:s.jsx(BT,{})}),s.jsx(Ve,{path:"emails",element:s.jsx("div",{className:"p-8",children:s.jsx("h1",{children:"Emails"})})}),s.jsx(Ve,{path:"calendars",element:s.jsx("div",{className:"p-8",children:s.jsx("h1",{children:"Calendars"})})}),s.jsx(Ve,{path:"analytics",element:s.jsx(Ab,{})}),s.jsx(Ve,{path:"contacts",element:s.jsx("div",{className:"p-8",children:s.jsx("h1",{children:"Contacts"})})}),s.jsx(Ve,{path:"companies",element:s.jsx("div",{className:"p-8",children:s.jsx("h1",{children:"Companies"})})}),s.jsx(Ve,{path:"integrations",element:s.jsx("div",{className:"p-8",children:s.jsx("h1",{children:"Integrations"})})}),s.jsx(Ve,{path:"settings",element:s.jsx(zT,{})}),s.jsx(Ve,{path:"settings/sales-orders",element:s.jsx(KT,{})}),s.jsx(Ve,{path:"settings/purchase-orders",element:s.jsx(tk,{})}),s.jsx(Ve,{path:"settings/invoices",element:s.jsx(ok,{})}),s.jsx(Ve,{path:"settings/vendor-bills",element:s.jsx(mk,{})})]})]})})}Oc.createRoot(document.getElementById("root")).render(s.jsx(Xh.StrictMode,{children:s.jsx(pk,{})}));
