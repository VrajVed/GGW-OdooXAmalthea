function p1(e,t){for(var r=0;r<t.length;r++){const n=t[r];if(typeof n!="string"&&!Array.isArray(n)){for(const s in n)if(s!=="default"&&!(s in e)){const i=Object.getOwnPropertyDescriptor(n,s);i&&Object.defineProperty(e,s,i.get?i:{enumerable:!0,get:()=>n[s]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const l of i.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&n(l)}).observe(document,{childList:!0,subtree:!0});function r(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(s){if(s.ep)return;s.ep=!0;const i=r(s);fetch(s.href,i)}})();function g1(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Oh={exports:{}},mo={},Ph={exports:{}},ke={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ki=Symbol.for("react.element"),v1=Symbol.for("react.portal"),y1=Symbol.for("react.fragment"),w1=Symbol.for("react.strict_mode"),b1=Symbol.for("react.profiler"),N1=Symbol.for("react.provider"),j1=Symbol.for("react.context"),S1=Symbol.for("react.forward_ref"),_1=Symbol.for("react.suspense"),E1=Symbol.for("react.memo"),T1=Symbol.for("react.lazy"),dd=Symbol.iterator;function C1(e){return e===null||typeof e!="object"?null:(e=dd&&e[dd]||e["@@iterator"],typeof e=="function"?e:null)}var Rh={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Ih=Object.assign,Dh={};function ua(e,t,r){this.props=e,this.context=t,this.refs=Dh,this.updater=r||Rh}ua.prototype.isReactComponent={};ua.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};ua.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function Lh(){}Lh.prototype=ua.prototype;function Iu(e,t,r){this.props=e,this.context=t,this.refs=Dh,this.updater=r||Rh}var Du=Iu.prototype=new Lh;Du.constructor=Iu;Ih(Du,ua.prototype);Du.isPureReactComponent=!0;var fd=Array.isArray,Mh=Object.prototype.hasOwnProperty,Lu={current:null},Bh={key:!0,ref:!0,__self:!0,__source:!0};function Uh(e,t,r){var n,s={},i=null,l=null;if(t!=null)for(n in t.ref!==void 0&&(l=t.ref),t.key!==void 0&&(i=""+t.key),t)Mh.call(t,n)&&!Bh.hasOwnProperty(n)&&(s[n]=t[n]);var o=arguments.length-2;if(o===1)s.children=r;else if(1<o){for(var c=Array(o),d=0;d<o;d++)c[d]=arguments[d+2];s.children=c}if(e&&e.defaultProps)for(n in o=e.defaultProps,o)s[n]===void 0&&(s[n]=o[n]);return{$$typeof:ki,type:e,key:i,ref:l,props:s,_owner:Lu.current}}function k1(e,t){return{$$typeof:ki,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function Mu(e){return typeof e=="object"&&e!==null&&e.$$typeof===ki}function A1(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(r){return t[r]})}var hd=/\/+/g;function Ko(e,t){return typeof e=="object"&&e!==null&&e.key!=null?A1(""+e.key):t.toString(36)}function ml(e,t,r,n,s){var i=typeof e;(i==="undefined"||i==="boolean")&&(e=null);var l=!1;if(e===null)l=!0;else switch(i){case"string":case"number":l=!0;break;case"object":switch(e.$$typeof){case ki:case v1:l=!0}}if(l)return l=e,s=s(l),e=n===""?"."+Ko(l,0):n,fd(s)?(r="",e!=null&&(r=e.replace(hd,"$&/")+"/"),ml(s,t,r,"",function(d){return d})):s!=null&&(Mu(s)&&(s=k1(s,r+(!s.key||l&&l.key===s.key?"":(""+s.key).replace(hd,"$&/")+"/")+e)),t.push(s)),1;if(l=0,n=n===""?".":n+":",fd(e))for(var o=0;o<e.length;o++){i=e[o];var c=n+Ko(i,o);l+=ml(i,t,r,c,s)}else if(c=C1(e),typeof c=="function")for(e=c.call(e),o=0;!(i=e.next()).done;)i=i.value,c=n+Ko(i,o++),l+=ml(i,t,r,c,s);else if(i==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return l}function Wi(e,t,r){if(e==null)return e;var n=[],s=0;return ml(e,n,"","",function(i){return t.call(r,i,s++)}),n}function F1(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(r){(e._status===0||e._status===-1)&&(e._status=1,e._result=r)},function(r){(e._status===0||e._status===-1)&&(e._status=2,e._result=r)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var zt={current:null},pl={transition:null},O1={ReactCurrentDispatcher:zt,ReactCurrentBatchConfig:pl,ReactCurrentOwner:Lu};function zh(){throw Error("act(...) is not supported in production builds of React.")}ke.Children={map:Wi,forEach:function(e,t,r){Wi(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return Wi(e,function(){t++}),t},toArray:function(e){return Wi(e,function(t){return t})||[]},only:function(e){if(!Mu(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};ke.Component=ua;ke.Fragment=y1;ke.Profiler=b1;ke.PureComponent=Iu;ke.StrictMode=w1;ke.Suspense=_1;ke.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=O1;ke.act=zh;ke.cloneElement=function(e,t,r){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var n=Ih({},e.props),s=e.key,i=e.ref,l=e._owner;if(t!=null){if(t.ref!==void 0&&(i=t.ref,l=Lu.current),t.key!==void 0&&(s=""+t.key),e.type&&e.type.defaultProps)var o=e.type.defaultProps;for(c in t)Mh.call(t,c)&&!Bh.hasOwnProperty(c)&&(n[c]=t[c]===void 0&&o!==void 0?o[c]:t[c])}var c=arguments.length-2;if(c===1)n.children=r;else if(1<c){o=Array(c);for(var d=0;d<c;d++)o[d]=arguments[d+2];n.children=o}return{$$typeof:ki,type:e.type,key:s,ref:i,props:n,_owner:l}};ke.createContext=function(e){return e={$$typeof:j1,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:N1,_context:e},e.Consumer=e};ke.createElement=Uh;ke.createFactory=function(e){var t=Uh.bind(null,e);return t.type=e,t};ke.createRef=function(){return{current:null}};ke.forwardRef=function(e){return{$$typeof:S1,render:e}};ke.isValidElement=Mu;ke.lazy=function(e){return{$$typeof:T1,_payload:{_status:-1,_result:e},_init:F1}};ke.memo=function(e,t){return{$$typeof:E1,type:e,compare:t===void 0?null:t}};ke.startTransition=function(e){var t=pl.transition;pl.transition={};try{e()}finally{pl.transition=t}};ke.unstable_act=zh;ke.useCallback=function(e,t){return zt.current.useCallback(e,t)};ke.useContext=function(e){return zt.current.useContext(e)};ke.useDebugValue=function(){};ke.useDeferredValue=function(e){return zt.current.useDeferredValue(e)};ke.useEffect=function(e,t){return zt.current.useEffect(e,t)};ke.useId=function(){return zt.current.useId()};ke.useImperativeHandle=function(e,t,r){return zt.current.useImperativeHandle(e,t,r)};ke.useInsertionEffect=function(e,t){return zt.current.useInsertionEffect(e,t)};ke.useLayoutEffect=function(e,t){return zt.current.useLayoutEffect(e,t)};ke.useMemo=function(e,t){return zt.current.useMemo(e,t)};ke.useReducer=function(e,t,r){return zt.current.useReducer(e,t,r)};ke.useRef=function(e){return zt.current.useRef(e)};ke.useState=function(e){return zt.current.useState(e)};ke.useSyncExternalStore=function(e,t,r){return zt.current.useSyncExternalStore(e,t,r)};ke.useTransition=function(){return zt.current.useTransition()};ke.version="18.3.1";Ph.exports=ke;var C=Ph.exports;const $h=g1(C),P1=p1({__proto__:null,default:$h},[C]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var R1=C,I1=Symbol.for("react.element"),D1=Symbol.for("react.fragment"),L1=Object.prototype.hasOwnProperty,M1=R1.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,B1={key:!0,ref:!0,__self:!0,__source:!0};function Wh(e,t,r){var n,s={},i=null,l=null;r!==void 0&&(i=""+r),t.key!==void 0&&(i=""+t.key),t.ref!==void 0&&(l=t.ref);for(n in t)L1.call(t,n)&&!B1.hasOwnProperty(n)&&(s[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps,t)s[n]===void 0&&(s[n]=t[n]);return{$$typeof:I1,type:e,key:i,ref:l,props:s,_owner:M1.current}}mo.Fragment=D1;mo.jsx=Wh;mo.jsxs=Wh;Oh.exports=mo;var a=Oh.exports,Oc={},Hh={exports:{}},or={},Vh={exports:{}},Gh={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(Y,F){var K=Y.length;Y.push(F);e:for(;0<K;){var te=K-1>>>1,T=Y[te];if(0<s(T,F))Y[te]=F,Y[K]=T,K=te;else break e}}function r(Y){return Y.length===0?null:Y[0]}function n(Y){if(Y.length===0)return null;var F=Y[0],K=Y.pop();if(K!==F){Y[0]=K;e:for(var te=0,T=Y.length,M=T>>>1;te<M;){var D=2*(te+1)-1,B=Y[D],q=D+1,W=Y[q];if(0>s(B,K))q<T&&0>s(W,B)?(Y[te]=W,Y[q]=K,te=q):(Y[te]=B,Y[D]=K,te=D);else if(q<T&&0>s(W,K))Y[te]=W,Y[q]=K,te=q;else break e}}return F}function s(Y,F){var K=Y.sortIndex-F.sortIndex;return K!==0?K:Y.id-F.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;e.unstable_now=function(){return i.now()}}else{var l=Date,o=l.now();e.unstable_now=function(){return l.now()-o}}var c=[],d=[],u=1,f=null,h=3,m=!1,p=!1,x=!1,v=typeof setTimeout=="function"?setTimeout:null,y=typeof clearTimeout=="function"?clearTimeout:null,g=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function w(Y){for(var F=r(d);F!==null;){if(F.callback===null)n(d);else if(F.startTime<=Y)n(d),F.sortIndex=F.expirationTime,t(c,F);else break;F=r(d)}}function b(Y){if(x=!1,w(Y),!p)if(r(c)!==null)p=!0,xe(P);else{var F=r(d);F!==null&&ee(b,F.startTime-Y)}}function P(Y,F){p=!1,x&&(x=!1,y(I),I=-1),m=!0;var K=h;try{for(w(F),f=r(c);f!==null&&(!(f.expirationTime>F)||Y&&!U());){var te=f.callback;if(typeof te=="function"){f.callback=null,h=f.priorityLevel;var T=te(f.expirationTime<=F);F=e.unstable_now(),typeof T=="function"?f.callback=T:f===r(c)&&n(c),w(F)}else n(c);f=r(c)}if(f!==null)var M=!0;else{var D=r(d);D!==null&&ee(b,D.startTime-F),M=!1}return M}finally{f=null,h=K,m=!1}}var L=!1,E=null,I=-1,S=5,R=-1;function U(){return!(e.unstable_now()-R<S)}function G(){if(E!==null){var Y=e.unstable_now();R=Y;var F=!0;try{F=E(!0,Y)}finally{F?se():(L=!1,E=null)}}else L=!1}var se;if(typeof g=="function")se=function(){g(G)};else if(typeof MessageChannel<"u"){var Ne=new MessageChannel,ae=Ne.port2;Ne.port1.onmessage=G,se=function(){ae.postMessage(null)}}else se=function(){v(G,0)};function xe(Y){E=Y,L||(L=!0,se())}function ee(Y,F){I=v(function(){Y(e.unstable_now())},F)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(Y){Y.callback=null},e.unstable_continueExecution=function(){p||m||(p=!0,xe(P))},e.unstable_forceFrameRate=function(Y){0>Y||125<Y?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):S=0<Y?Math.floor(1e3/Y):5},e.unstable_getCurrentPriorityLevel=function(){return h},e.unstable_getFirstCallbackNode=function(){return r(c)},e.unstable_next=function(Y){switch(h){case 1:case 2:case 3:var F=3;break;default:F=h}var K=h;h=F;try{return Y()}finally{h=K}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(Y,F){switch(Y){case 1:case 2:case 3:case 4:case 5:break;default:Y=3}var K=h;h=Y;try{return F()}finally{h=K}},e.unstable_scheduleCallback=function(Y,F,K){var te=e.unstable_now();switch(typeof K=="object"&&K!==null?(K=K.delay,K=typeof K=="number"&&0<K?te+K:te):K=te,Y){case 1:var T=-1;break;case 2:T=250;break;case 5:T=1073741823;break;case 4:T=1e4;break;default:T=5e3}return T=K+T,Y={id:u++,callback:F,priorityLevel:Y,startTime:K,expirationTime:T,sortIndex:-1},K>te?(Y.sortIndex=K,t(d,Y),r(c)===null&&Y===r(d)&&(x?(y(I),I=-1):x=!0,ee(b,K-te))):(Y.sortIndex=T,t(c,Y),p||m||(p=!0,xe(P))),Y},e.unstable_shouldYield=U,e.unstable_wrapCallback=function(Y){var F=h;return function(){var K=h;h=F;try{return Y.apply(this,arguments)}finally{h=K}}}})(Gh);Vh.exports=Gh;var U1=Vh.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var z1=C,ir=U1;function oe(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Xh=new Set,ni={};function ps(e,t){ta(e,t),ta(e+"Capture",t)}function ta(e,t){for(ni[e]=t,e=0;e<t.length;e++)Xh.add(t[e])}var an=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Pc=Object.prototype.hasOwnProperty,$1=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,xd={},md={};function W1(e){return Pc.call(md,e)?!0:Pc.call(xd,e)?!1:$1.test(e)?md[e]=!0:(xd[e]=!0,!1)}function H1(e,t,r,n){if(r!==null&&r.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function V1(e,t,r,n){if(t===null||typeof t>"u"||H1(e,t,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function $t(e,t,r,n,s,i,l){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=n,this.attributeNamespace=s,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=i,this.removeEmptyString=l}var Tt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){Tt[e]=new $t(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];Tt[t]=new $t(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){Tt[e]=new $t(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){Tt[e]=new $t(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){Tt[e]=new $t(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){Tt[e]=new $t(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){Tt[e]=new $t(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){Tt[e]=new $t(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){Tt[e]=new $t(e,5,!1,e.toLowerCase(),null,!1,!1)});var Bu=/[\-:]([a-z])/g;function Uu(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(Bu,Uu);Tt[t]=new $t(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(Bu,Uu);Tt[t]=new $t(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(Bu,Uu);Tt[t]=new $t(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){Tt[e]=new $t(e,1,!1,e.toLowerCase(),null,!1,!1)});Tt.xlinkHref=new $t("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){Tt[e]=new $t(e,1,!1,e.toLowerCase(),null,!0,!0)});function zu(e,t,r,n){var s=Tt.hasOwnProperty(t)?Tt[t]:null;(s!==null?s.type!==0:n||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(V1(t,r,s,n)&&(r=null),n||s===null?W1(t)&&(r===null?e.removeAttribute(t):e.setAttribute(t,""+r)):s.mustUseProperty?e[s.propertyName]=r===null?s.type===3?!1:"":r:(t=s.attributeName,n=s.attributeNamespace,r===null?e.removeAttribute(t):(s=s.type,r=s===3||s===4&&r===!0?"":""+r,n?e.setAttributeNS(n,t,r):e.setAttribute(t,r))))}var fn=z1.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Hi=Symbol.for("react.element"),As=Symbol.for("react.portal"),Fs=Symbol.for("react.fragment"),$u=Symbol.for("react.strict_mode"),Rc=Symbol.for("react.profiler"),Kh=Symbol.for("react.provider"),Yh=Symbol.for("react.context"),Wu=Symbol.for("react.forward_ref"),Ic=Symbol.for("react.suspense"),Dc=Symbol.for("react.suspense_list"),Hu=Symbol.for("react.memo"),yn=Symbol.for("react.lazy"),Jh=Symbol.for("react.offscreen"),pd=Symbol.iterator;function Sa(e){return e===null||typeof e!="object"?null:(e=pd&&e[pd]||e["@@iterator"],typeof e=="function"?e:null)}var et=Object.assign,Yo;function Ia(e){if(Yo===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);Yo=t&&t[1]||""}return`
`+Yo+e}var Jo=!1;function qo(e,t){if(!e||Jo)return"";Jo=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(d){var n=d}Reflect.construct(e,[],t)}else{try{t.call()}catch(d){n=d}e.call(t.prototype)}else{try{throw Error()}catch(d){n=d}e()}}catch(d){if(d&&n&&typeof d.stack=="string"){for(var s=d.stack.split(`
`),i=n.stack.split(`
`),l=s.length-1,o=i.length-1;1<=l&&0<=o&&s[l]!==i[o];)o--;for(;1<=l&&0<=o;l--,o--)if(s[l]!==i[o]){if(l!==1||o!==1)do if(l--,o--,0>o||s[l]!==i[o]){var c=`
`+s[l].replace(" at new "," at ");return e.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",e.displayName)),c}while(1<=l&&0<=o);break}}}finally{Jo=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?Ia(e):""}function G1(e){switch(e.tag){case 5:return Ia(e.type);case 16:return Ia("Lazy");case 13:return Ia("Suspense");case 19:return Ia("SuspenseList");case 0:case 2:case 15:return e=qo(e.type,!1),e;case 11:return e=qo(e.type.render,!1),e;case 1:return e=qo(e.type,!0),e;default:return""}}function Lc(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case Fs:return"Fragment";case As:return"Portal";case Rc:return"Profiler";case $u:return"StrictMode";case Ic:return"Suspense";case Dc:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case Yh:return(e.displayName||"Context")+".Consumer";case Kh:return(e._context.displayName||"Context")+".Provider";case Wu:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case Hu:return t=e.displayName||null,t!==null?t:Lc(e.type)||"Memo";case yn:t=e._payload,e=e._init;try{return Lc(e(t))}catch{}}return null}function X1(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Lc(t);case 8:return t===$u?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function Ln(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function qh(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function K1(e){var t=qh(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var s=r.get,i=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return s.call(this)},set:function(l){n=""+l,i.call(this,l)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(l){n=""+l},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function Vi(e){e._valueTracker||(e._valueTracker=K1(e))}function Qh(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),n="";return e&&(n=qh(e)?e.checked?"true":"false":e.value),e=n,e!==r?(t.setValue(e),!0):!1}function Tl(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function Mc(e,t){var r=t.checked;return et({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??e._wrapperState.initialChecked})}function gd(e,t){var r=t.defaultValue==null?"":t.defaultValue,n=t.checked!=null?t.checked:t.defaultChecked;r=Ln(t.value!=null?t.value:r),e._wrapperState={initialChecked:n,initialValue:r,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function Zh(e,t){t=t.checked,t!=null&&zu(e,"checked",t,!1)}function Bc(e,t){Zh(e,t);var r=Ln(t.value),n=t.type;if(r!=null)n==="number"?(r===0&&e.value===""||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if(n==="submit"||n==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?Uc(e,t.type,r):t.hasOwnProperty("defaultValue")&&Uc(e,t.type,Ln(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function vd(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!(n!=="submit"&&n!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}r=e.name,r!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,r!==""&&(e.name=r)}function Uc(e,t,r){(t!=="number"||Tl(e.ownerDocument)!==e)&&(r==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var Da=Array.isArray;function Hs(e,t,r,n){if(e=e.options,t){t={};for(var s=0;s<r.length;s++)t["$"+r[s]]=!0;for(r=0;r<e.length;r++)s=t.hasOwnProperty("$"+e[r].value),e[r].selected!==s&&(e[r].selected=s),s&&n&&(e[r].defaultSelected=!0)}else{for(r=""+Ln(r),t=null,s=0;s<e.length;s++){if(e[s].value===r){e[s].selected=!0,n&&(e[s].defaultSelected=!0);return}t!==null||e[s].disabled||(t=e[s])}t!==null&&(t.selected=!0)}}function zc(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(oe(91));return et({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function yd(e,t){var r=t.value;if(r==null){if(r=t.children,t=t.defaultValue,r!=null){if(t!=null)throw Error(oe(92));if(Da(r)){if(1<r.length)throw Error(oe(93));r=r[0]}t=r}t==null&&(t=""),r=t}e._wrapperState={initialValue:Ln(r)}}function ex(e,t){var r=Ln(t.value),n=Ln(t.defaultValue);r!=null&&(r=""+r,r!==e.value&&(e.value=r),t.defaultValue==null&&e.defaultValue!==r&&(e.defaultValue=r)),n!=null&&(e.defaultValue=""+n)}function wd(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function tx(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function $c(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?tx(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var Gi,rx=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,r,n,s){MSApp.execUnsafeLocalFunction(function(){return e(t,r,n,s)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(Gi=Gi||document.createElement("div"),Gi.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=Gi.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function si(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var za={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Y1=["Webkit","ms","Moz","O"];Object.keys(za).forEach(function(e){Y1.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),za[t]=za[e]})});function nx(e,t,r){return t==null||typeof t=="boolean"||t===""?"":r||typeof t!="number"||t===0||za.hasOwnProperty(e)&&za[e]?(""+t).trim():t+"px"}function sx(e,t){e=e.style;for(var r in t)if(t.hasOwnProperty(r)){var n=r.indexOf("--")===0,s=nx(r,t[r],n);r==="float"&&(r="cssFloat"),n?e.setProperty(r,s):e[r]=s}}var J1=et({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Wc(e,t){if(t){if(J1[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(oe(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(oe(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(oe(61))}if(t.style!=null&&typeof t.style!="object")throw Error(oe(62))}}function Hc(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Vc=null;function Vu(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var Gc=null,Vs=null,Gs=null;function bd(e){if(e=Oi(e)){if(typeof Gc!="function")throw Error(oe(280));var t=e.stateNode;t&&(t=wo(t),Gc(e.stateNode,e.type,t))}}function ax(e){Vs?Gs?Gs.push(e):Gs=[e]:Vs=e}function ix(){if(Vs){var e=Vs,t=Gs;if(Gs=Vs=null,bd(e),t)for(e=0;e<t.length;e++)bd(t[e])}}function lx(e,t){return e(t)}function ox(){}var Qo=!1;function cx(e,t,r){if(Qo)return e(t,r);Qo=!0;try{return lx(e,t,r)}finally{Qo=!1,(Vs!==null||Gs!==null)&&(ox(),ix())}}function ai(e,t){var r=e.stateNode;if(r===null)return null;var n=wo(r);if(n===null)return null;r=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(e=e.type,n=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!n;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(oe(231,t,typeof r));return r}var Xc=!1;if(an)try{var _a={};Object.defineProperty(_a,"passive",{get:function(){Xc=!0}}),window.addEventListener("test",_a,_a),window.removeEventListener("test",_a,_a)}catch{Xc=!1}function q1(e,t,r,n,s,i,l,o,c){var d=Array.prototype.slice.call(arguments,3);try{t.apply(r,d)}catch(u){this.onError(u)}}var $a=!1,Cl=null,kl=!1,Kc=null,Q1={onError:function(e){$a=!0,Cl=e}};function Z1(e,t,r,n,s,i,l,o,c){$a=!1,Cl=null,q1.apply(Q1,arguments)}function ev(e,t,r,n,s,i,l,o,c){if(Z1.apply(this,arguments),$a){if($a){var d=Cl;$a=!1,Cl=null}else throw Error(oe(198));kl||(kl=!0,Kc=d)}}function gs(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function ux(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function Nd(e){if(gs(e)!==e)throw Error(oe(188))}function tv(e){var t=e.alternate;if(!t){if(t=gs(e),t===null)throw Error(oe(188));return t!==e?null:e}for(var r=e,n=t;;){var s=r.return;if(s===null)break;var i=s.alternate;if(i===null){if(n=s.return,n!==null){r=n;continue}break}if(s.child===i.child){for(i=s.child;i;){if(i===r)return Nd(s),e;if(i===n)return Nd(s),t;i=i.sibling}throw Error(oe(188))}if(r.return!==n.return)r=s,n=i;else{for(var l=!1,o=s.child;o;){if(o===r){l=!0,r=s,n=i;break}if(o===n){l=!0,n=s,r=i;break}o=o.sibling}if(!l){for(o=i.child;o;){if(o===r){l=!0,r=i,n=s;break}if(o===n){l=!0,n=i,r=s;break}o=o.sibling}if(!l)throw Error(oe(189))}}if(r.alternate!==n)throw Error(oe(190))}if(r.tag!==3)throw Error(oe(188));return r.stateNode.current===r?e:t}function dx(e){return e=tv(e),e!==null?fx(e):null}function fx(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=fx(e);if(t!==null)return t;e=e.sibling}return null}var hx=ir.unstable_scheduleCallback,jd=ir.unstable_cancelCallback,rv=ir.unstable_shouldYield,nv=ir.unstable_requestPaint,st=ir.unstable_now,sv=ir.unstable_getCurrentPriorityLevel,Gu=ir.unstable_ImmediatePriority,xx=ir.unstable_UserBlockingPriority,Al=ir.unstable_NormalPriority,av=ir.unstable_LowPriority,mx=ir.unstable_IdlePriority,po=null,$r=null;function iv(e){if($r&&typeof $r.onCommitFiberRoot=="function")try{$r.onCommitFiberRoot(po,e,void 0,(e.current.flags&128)===128)}catch{}}var Fr=Math.clz32?Math.clz32:cv,lv=Math.log,ov=Math.LN2;function cv(e){return e>>>=0,e===0?32:31-(lv(e)/ov|0)|0}var Xi=64,Ki=4194304;function La(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function Fl(e,t){var r=e.pendingLanes;if(r===0)return 0;var n=0,s=e.suspendedLanes,i=e.pingedLanes,l=r&268435455;if(l!==0){var o=l&~s;o!==0?n=La(o):(i&=l,i!==0&&(n=La(i)))}else l=r&~s,l!==0?n=La(l):i!==0&&(n=La(i));if(n===0)return 0;if(t!==0&&t!==n&&!(t&s)&&(s=n&-n,i=t&-t,s>=i||s===16&&(i&4194240)!==0))return t;if(n&4&&(n|=r&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=n;0<t;)r=31-Fr(t),s=1<<r,n|=e[r],t&=~s;return n}function uv(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function dv(e,t){for(var r=e.suspendedLanes,n=e.pingedLanes,s=e.expirationTimes,i=e.pendingLanes;0<i;){var l=31-Fr(i),o=1<<l,c=s[l];c===-1?(!(o&r)||o&n)&&(s[l]=uv(o,t)):c<=t&&(e.expiredLanes|=o),i&=~o}}function Yc(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function px(){var e=Xi;return Xi<<=1,!(Xi&4194240)&&(Xi=64),e}function Zo(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function Ai(e,t,r){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-Fr(t),e[t]=r}function fv(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<r;){var s=31-Fr(r),i=1<<s;t[s]=0,n[s]=-1,e[s]=-1,r&=~i}}function Xu(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var n=31-Fr(r),s=1<<n;s&t|e[n]&t&&(e[n]|=t),r&=~s}}var De=0;function gx(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var vx,Ku,yx,wx,bx,Jc=!1,Yi=[],Cn=null,kn=null,An=null,ii=new Map,li=new Map,bn=[],hv="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Sd(e,t){switch(e){case"focusin":case"focusout":Cn=null;break;case"dragenter":case"dragleave":kn=null;break;case"mouseover":case"mouseout":An=null;break;case"pointerover":case"pointerout":ii.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":li.delete(t.pointerId)}}function Ea(e,t,r,n,s,i){return e===null||e.nativeEvent!==i?(e={blockedOn:t,domEventName:r,eventSystemFlags:n,nativeEvent:i,targetContainers:[s]},t!==null&&(t=Oi(t),t!==null&&Ku(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,s!==null&&t.indexOf(s)===-1&&t.push(s),e)}function xv(e,t,r,n,s){switch(t){case"focusin":return Cn=Ea(Cn,e,t,r,n,s),!0;case"dragenter":return kn=Ea(kn,e,t,r,n,s),!0;case"mouseover":return An=Ea(An,e,t,r,n,s),!0;case"pointerover":var i=s.pointerId;return ii.set(i,Ea(ii.get(i)||null,e,t,r,n,s)),!0;case"gotpointercapture":return i=s.pointerId,li.set(i,Ea(li.get(i)||null,e,t,r,n,s)),!0}return!1}function Nx(e){var t=rs(e.target);if(t!==null){var r=gs(t);if(r!==null){if(t=r.tag,t===13){if(t=ux(r),t!==null){e.blockedOn=t,bx(e.priority,function(){yx(r)});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function gl(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=qc(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(r===null){r=e.nativeEvent;var n=new r.constructor(r.type,r);Vc=n,r.target.dispatchEvent(n),Vc=null}else return t=Oi(r),t!==null&&Ku(t),e.blockedOn=r,!1;t.shift()}return!0}function _d(e,t,r){gl(e)&&r.delete(t)}function mv(){Jc=!1,Cn!==null&&gl(Cn)&&(Cn=null),kn!==null&&gl(kn)&&(kn=null),An!==null&&gl(An)&&(An=null),ii.forEach(_d),li.forEach(_d)}function Ta(e,t){e.blockedOn===t&&(e.blockedOn=null,Jc||(Jc=!0,ir.unstable_scheduleCallback(ir.unstable_NormalPriority,mv)))}function oi(e){function t(s){return Ta(s,e)}if(0<Yi.length){Ta(Yi[0],e);for(var r=1;r<Yi.length;r++){var n=Yi[r];n.blockedOn===e&&(n.blockedOn=null)}}for(Cn!==null&&Ta(Cn,e),kn!==null&&Ta(kn,e),An!==null&&Ta(An,e),ii.forEach(t),li.forEach(t),r=0;r<bn.length;r++)n=bn[r],n.blockedOn===e&&(n.blockedOn=null);for(;0<bn.length&&(r=bn[0],r.blockedOn===null);)Nx(r),r.blockedOn===null&&bn.shift()}var Xs=fn.ReactCurrentBatchConfig,Ol=!0;function pv(e,t,r,n){var s=De,i=Xs.transition;Xs.transition=null;try{De=1,Yu(e,t,r,n)}finally{De=s,Xs.transition=i}}function gv(e,t,r,n){var s=De,i=Xs.transition;Xs.transition=null;try{De=4,Yu(e,t,r,n)}finally{De=s,Xs.transition=i}}function Yu(e,t,r,n){if(Ol){var s=qc(e,t,r,n);if(s===null)cc(e,t,n,Pl,r),Sd(e,n);else if(xv(s,e,t,r,n))n.stopPropagation();else if(Sd(e,n),t&4&&-1<hv.indexOf(e)){for(;s!==null;){var i=Oi(s);if(i!==null&&vx(i),i=qc(e,t,r,n),i===null&&cc(e,t,n,Pl,r),i===s)break;s=i}s!==null&&n.stopPropagation()}else cc(e,t,n,null,r)}}var Pl=null;function qc(e,t,r,n){if(Pl=null,e=Vu(n),e=rs(e),e!==null)if(t=gs(e),t===null)e=null;else if(r=t.tag,r===13){if(e=ux(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Pl=e,null}function jx(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(sv()){case Gu:return 1;case xx:return 4;case Al:case av:return 16;case mx:return 536870912;default:return 16}default:return 16}}var jn=null,Ju=null,vl=null;function Sx(){if(vl)return vl;var e,t=Ju,r=t.length,n,s="value"in jn?jn.value:jn.textContent,i=s.length;for(e=0;e<r&&t[e]===s[e];e++);var l=r-e;for(n=1;n<=l&&t[r-n]===s[i-n];n++);return vl=s.slice(e,1<n?1-n:void 0)}function yl(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function Ji(){return!0}function Ed(){return!1}function cr(e){function t(r,n,s,i,l){this._reactName=r,this._targetInst=s,this.type=n,this.nativeEvent=i,this.target=l,this.currentTarget=null;for(var o in e)e.hasOwnProperty(o)&&(r=e[o],this[o]=r?r(i):i[o]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?Ji:Ed,this.isPropagationStopped=Ed,this}return et(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=Ji)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=Ji)},persist:function(){},isPersistent:Ji}),t}var da={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},qu=cr(da),Fi=et({},da,{view:0,detail:0}),vv=cr(Fi),ec,tc,Ca,go=et({},Fi,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Qu,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Ca&&(Ca&&e.type==="mousemove"?(ec=e.screenX-Ca.screenX,tc=e.screenY-Ca.screenY):tc=ec=0,Ca=e),ec)},movementY:function(e){return"movementY"in e?e.movementY:tc}}),Td=cr(go),yv=et({},go,{dataTransfer:0}),wv=cr(yv),bv=et({},Fi,{relatedTarget:0}),rc=cr(bv),Nv=et({},da,{animationName:0,elapsedTime:0,pseudoElement:0}),jv=cr(Nv),Sv=et({},da,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),_v=cr(Sv),Ev=et({},da,{data:0}),Cd=cr(Ev),Tv={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Cv={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},kv={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Av(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=kv[e])?!!t[e]:!1}function Qu(){return Av}var Fv=et({},Fi,{key:function(e){if(e.key){var t=Tv[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=yl(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?Cv[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Qu,charCode:function(e){return e.type==="keypress"?yl(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?yl(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),Ov=cr(Fv),Pv=et({},go,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),kd=cr(Pv),Rv=et({},Fi,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Qu}),Iv=cr(Rv),Dv=et({},da,{propertyName:0,elapsedTime:0,pseudoElement:0}),Lv=cr(Dv),Mv=et({},go,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Bv=cr(Mv),Uv=[9,13,27,32],Zu=an&&"CompositionEvent"in window,Wa=null;an&&"documentMode"in document&&(Wa=document.documentMode);var zv=an&&"TextEvent"in window&&!Wa,_x=an&&(!Zu||Wa&&8<Wa&&11>=Wa),Ad=" ",Fd=!1;function Ex(e,t){switch(e){case"keyup":return Uv.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Tx(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Os=!1;function $v(e,t){switch(e){case"compositionend":return Tx(t);case"keypress":return t.which!==32?null:(Fd=!0,Ad);case"textInput":return e=t.data,e===Ad&&Fd?null:e;default:return null}}function Wv(e,t){if(Os)return e==="compositionend"||!Zu&&Ex(e,t)?(e=Sx(),vl=Ju=jn=null,Os=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return _x&&t.locale!=="ko"?null:t.data;default:return null}}var Hv={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Od(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!Hv[e.type]:t==="textarea"}function Cx(e,t,r,n){ax(n),t=Rl(t,"onChange"),0<t.length&&(r=new qu("onChange","change",null,r,n),e.push({event:r,listeners:t}))}var Ha=null,ci=null;function Vv(e){Bx(e,0)}function vo(e){var t=Is(e);if(Qh(t))return e}function Gv(e,t){if(e==="change")return t}var kx=!1;if(an){var nc;if(an){var sc="oninput"in document;if(!sc){var Pd=document.createElement("div");Pd.setAttribute("oninput","return;"),sc=typeof Pd.oninput=="function"}nc=sc}else nc=!1;kx=nc&&(!document.documentMode||9<document.documentMode)}function Rd(){Ha&&(Ha.detachEvent("onpropertychange",Ax),ci=Ha=null)}function Ax(e){if(e.propertyName==="value"&&vo(ci)){var t=[];Cx(t,ci,e,Vu(e)),cx(Vv,t)}}function Xv(e,t,r){e==="focusin"?(Rd(),Ha=t,ci=r,Ha.attachEvent("onpropertychange",Ax)):e==="focusout"&&Rd()}function Kv(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return vo(ci)}function Yv(e,t){if(e==="click")return vo(t)}function Jv(e,t){if(e==="input"||e==="change")return vo(t)}function qv(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Rr=typeof Object.is=="function"?Object.is:qv;function ui(e,t){if(Rr(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var s=r[n];if(!Pc.call(t,s)||!Rr(e[s],t[s]))return!1}return!0}function Id(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Dd(e,t){var r=Id(e);e=0;for(var n;r;){if(r.nodeType===3){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=Id(r)}}function Fx(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?Fx(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function Ox(){for(var e=window,t=Tl();t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch{r=!1}if(r)e=t.contentWindow;else break;t=Tl(e.document)}return t}function e0(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function Qv(e){var t=Ox(),r=e.focusedElem,n=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&Fx(r.ownerDocument.documentElement,r)){if(n!==null&&e0(r)){if(t=n.start,e=n.end,e===void 0&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if(e=(t=r.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var s=r.textContent.length,i=Math.min(n.start,s);n=n.end===void 0?i:Math.min(n.end,s),!e.extend&&i>n&&(s=n,n=i,i=s),s=Dd(r,i);var l=Dd(r,n);s&&l&&(e.rangeCount!==1||e.anchorNode!==s.node||e.anchorOffset!==s.offset||e.focusNode!==l.node||e.focusOffset!==l.offset)&&(t=t.createRange(),t.setStart(s.node,s.offset),e.removeAllRanges(),i>n?(e.addRange(t),e.extend(l.node,l.offset)):(t.setEnd(l.node,l.offset),e.addRange(t)))}}for(t=[],e=r;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<t.length;r++)e=t[r],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var Zv=an&&"documentMode"in document&&11>=document.documentMode,Ps=null,Qc=null,Va=null,Zc=!1;function Ld(e,t,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;Zc||Ps==null||Ps!==Tl(n)||(n=Ps,"selectionStart"in n&&e0(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),Va&&ui(Va,n)||(Va=n,n=Rl(Qc,"onSelect"),0<n.length&&(t=new qu("onSelect","select",null,t,r),e.push({event:t,listeners:n}),t.target=Ps)))}function qi(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var Rs={animationend:qi("Animation","AnimationEnd"),animationiteration:qi("Animation","AnimationIteration"),animationstart:qi("Animation","AnimationStart"),transitionend:qi("Transition","TransitionEnd")},ac={},Px={};an&&(Px=document.createElement("div").style,"AnimationEvent"in window||(delete Rs.animationend.animation,delete Rs.animationiteration.animation,delete Rs.animationstart.animation),"TransitionEvent"in window||delete Rs.transitionend.transition);function yo(e){if(ac[e])return ac[e];if(!Rs[e])return e;var t=Rs[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in Px)return ac[e]=t[r];return e}var Rx=yo("animationend"),Ix=yo("animationiteration"),Dx=yo("animationstart"),Lx=yo("transitionend"),Mx=new Map,Md="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Wn(e,t){Mx.set(e,t),ps(t,[e])}for(var ic=0;ic<Md.length;ic++){var lc=Md[ic],ey=lc.toLowerCase(),ty=lc[0].toUpperCase()+lc.slice(1);Wn(ey,"on"+ty)}Wn(Rx,"onAnimationEnd");Wn(Ix,"onAnimationIteration");Wn(Dx,"onAnimationStart");Wn("dblclick","onDoubleClick");Wn("focusin","onFocus");Wn("focusout","onBlur");Wn(Lx,"onTransitionEnd");ta("onMouseEnter",["mouseout","mouseover"]);ta("onMouseLeave",["mouseout","mouseover"]);ta("onPointerEnter",["pointerout","pointerover"]);ta("onPointerLeave",["pointerout","pointerover"]);ps("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));ps("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));ps("onBeforeInput",["compositionend","keypress","textInput","paste"]);ps("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));ps("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));ps("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ma="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),ry=new Set("cancel close invalid load scroll toggle".split(" ").concat(Ma));function Bd(e,t,r){var n=e.type||"unknown-event";e.currentTarget=r,ev(n,t,void 0,e),e.currentTarget=null}function Bx(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var n=e[r],s=n.event;n=n.listeners;e:{var i=void 0;if(t)for(var l=n.length-1;0<=l;l--){var o=n[l],c=o.instance,d=o.currentTarget;if(o=o.listener,c!==i&&s.isPropagationStopped())break e;Bd(s,o,d),i=c}else for(l=0;l<n.length;l++){if(o=n[l],c=o.instance,d=o.currentTarget,o=o.listener,c!==i&&s.isPropagationStopped())break e;Bd(s,o,d),i=c}}}if(kl)throw e=Kc,kl=!1,Kc=null,e}function Ve(e,t){var r=t[su];r===void 0&&(r=t[su]=new Set);var n=e+"__bubble";r.has(n)||(Ux(t,e,2,!1),r.add(n))}function oc(e,t,r){var n=0;t&&(n|=4),Ux(r,e,n,t)}var Qi="_reactListening"+Math.random().toString(36).slice(2);function di(e){if(!e[Qi]){e[Qi]=!0,Xh.forEach(function(r){r!=="selectionchange"&&(ry.has(r)||oc(r,!1,e),oc(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[Qi]||(t[Qi]=!0,oc("selectionchange",!1,t))}}function Ux(e,t,r,n){switch(jx(t)){case 1:var s=pv;break;case 4:s=gv;break;default:s=Yu}r=s.bind(null,t,r,e),s=void 0,!Xc||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(s=!0),n?s!==void 0?e.addEventListener(t,r,{capture:!0,passive:s}):e.addEventListener(t,r,!0):s!==void 0?e.addEventListener(t,r,{passive:s}):e.addEventListener(t,r,!1)}function cc(e,t,r,n,s){var i=n;if(!(t&1)&&!(t&2)&&n!==null)e:for(;;){if(n===null)return;var l=n.tag;if(l===3||l===4){var o=n.stateNode.containerInfo;if(o===s||o.nodeType===8&&o.parentNode===s)break;if(l===4)for(l=n.return;l!==null;){var c=l.tag;if((c===3||c===4)&&(c=l.stateNode.containerInfo,c===s||c.nodeType===8&&c.parentNode===s))return;l=l.return}for(;o!==null;){if(l=rs(o),l===null)return;if(c=l.tag,c===5||c===6){n=i=l;continue e}o=o.parentNode}}n=n.return}cx(function(){var d=i,u=Vu(r),f=[];e:{var h=Mx.get(e);if(h!==void 0){var m=qu,p=e;switch(e){case"keypress":if(yl(r)===0)break e;case"keydown":case"keyup":m=Ov;break;case"focusin":p="focus",m=rc;break;case"focusout":p="blur",m=rc;break;case"beforeblur":case"afterblur":m=rc;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":m=Td;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":m=wv;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":m=Iv;break;case Rx:case Ix:case Dx:m=jv;break;case Lx:m=Lv;break;case"scroll":m=vv;break;case"wheel":m=Bv;break;case"copy":case"cut":case"paste":m=_v;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":m=kd}var x=(t&4)!==0,v=!x&&e==="scroll",y=x?h!==null?h+"Capture":null:h;x=[];for(var g=d,w;g!==null;){w=g;var b=w.stateNode;if(w.tag===5&&b!==null&&(w=b,y!==null&&(b=ai(g,y),b!=null&&x.push(fi(g,b,w)))),v)break;g=g.return}0<x.length&&(h=new m(h,p,null,r,u),f.push({event:h,listeners:x}))}}if(!(t&7)){e:{if(h=e==="mouseover"||e==="pointerover",m=e==="mouseout"||e==="pointerout",h&&r!==Vc&&(p=r.relatedTarget||r.fromElement)&&(rs(p)||p[ln]))break e;if((m||h)&&(h=u.window===u?u:(h=u.ownerDocument)?h.defaultView||h.parentWindow:window,m?(p=r.relatedTarget||r.toElement,m=d,p=p?rs(p):null,p!==null&&(v=gs(p),p!==v||p.tag!==5&&p.tag!==6)&&(p=null)):(m=null,p=d),m!==p)){if(x=Td,b="onMouseLeave",y="onMouseEnter",g="mouse",(e==="pointerout"||e==="pointerover")&&(x=kd,b="onPointerLeave",y="onPointerEnter",g="pointer"),v=m==null?h:Is(m),w=p==null?h:Is(p),h=new x(b,g+"leave",m,r,u),h.target=v,h.relatedTarget=w,b=null,rs(u)===d&&(x=new x(y,g+"enter",p,r,u),x.target=w,x.relatedTarget=v,b=x),v=b,m&&p)t:{for(x=m,y=p,g=0,w=x;w;w=_s(w))g++;for(w=0,b=y;b;b=_s(b))w++;for(;0<g-w;)x=_s(x),g--;for(;0<w-g;)y=_s(y),w--;for(;g--;){if(x===y||y!==null&&x===y.alternate)break t;x=_s(x),y=_s(y)}x=null}else x=null;m!==null&&Ud(f,h,m,x,!1),p!==null&&v!==null&&Ud(f,v,p,x,!0)}}e:{if(h=d?Is(d):window,m=h.nodeName&&h.nodeName.toLowerCase(),m==="select"||m==="input"&&h.type==="file")var P=Gv;else if(Od(h))if(kx)P=Jv;else{P=Kv;var L=Xv}else(m=h.nodeName)&&m.toLowerCase()==="input"&&(h.type==="checkbox"||h.type==="radio")&&(P=Yv);if(P&&(P=P(e,d))){Cx(f,P,r,u);break e}L&&L(e,h,d),e==="focusout"&&(L=h._wrapperState)&&L.controlled&&h.type==="number"&&Uc(h,"number",h.value)}switch(L=d?Is(d):window,e){case"focusin":(Od(L)||L.contentEditable==="true")&&(Ps=L,Qc=d,Va=null);break;case"focusout":Va=Qc=Ps=null;break;case"mousedown":Zc=!0;break;case"contextmenu":case"mouseup":case"dragend":Zc=!1,Ld(f,r,u);break;case"selectionchange":if(Zv)break;case"keydown":case"keyup":Ld(f,r,u)}var E;if(Zu)e:{switch(e){case"compositionstart":var I="onCompositionStart";break e;case"compositionend":I="onCompositionEnd";break e;case"compositionupdate":I="onCompositionUpdate";break e}I=void 0}else Os?Ex(e,r)&&(I="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(I="onCompositionStart");I&&(_x&&r.locale!=="ko"&&(Os||I!=="onCompositionStart"?I==="onCompositionEnd"&&Os&&(E=Sx()):(jn=u,Ju="value"in jn?jn.value:jn.textContent,Os=!0)),L=Rl(d,I),0<L.length&&(I=new Cd(I,e,null,r,u),f.push({event:I,listeners:L}),E?I.data=E:(E=Tx(r),E!==null&&(I.data=E)))),(E=zv?$v(e,r):Wv(e,r))&&(d=Rl(d,"onBeforeInput"),0<d.length&&(u=new Cd("onBeforeInput","beforeinput",null,r,u),f.push({event:u,listeners:d}),u.data=E))}Bx(f,t)})}function fi(e,t,r){return{instance:e,listener:t,currentTarget:r}}function Rl(e,t){for(var r=t+"Capture",n=[];e!==null;){var s=e,i=s.stateNode;s.tag===5&&i!==null&&(s=i,i=ai(e,r),i!=null&&n.unshift(fi(e,i,s)),i=ai(e,t),i!=null&&n.push(fi(e,i,s))),e=e.return}return n}function _s(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function Ud(e,t,r,n,s){for(var i=t._reactName,l=[];r!==null&&r!==n;){var o=r,c=o.alternate,d=o.stateNode;if(c!==null&&c===n)break;o.tag===5&&d!==null&&(o=d,s?(c=ai(r,i),c!=null&&l.unshift(fi(r,c,o))):s||(c=ai(r,i),c!=null&&l.push(fi(r,c,o)))),r=r.return}l.length!==0&&e.push({event:t,listeners:l})}var ny=/\r\n?/g,sy=/\u0000|\uFFFD/g;function zd(e){return(typeof e=="string"?e:""+e).replace(ny,`
`).replace(sy,"")}function Zi(e,t,r){if(t=zd(t),zd(e)!==t&&r)throw Error(oe(425))}function Il(){}var eu=null,tu=null;function ru(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var nu=typeof setTimeout=="function"?setTimeout:void 0,ay=typeof clearTimeout=="function"?clearTimeout:void 0,$d=typeof Promise=="function"?Promise:void 0,iy=typeof queueMicrotask=="function"?queueMicrotask:typeof $d<"u"?function(e){return $d.resolve(null).then(e).catch(ly)}:nu;function ly(e){setTimeout(function(){throw e})}function uc(e,t){var r=t,n=0;do{var s=r.nextSibling;if(e.removeChild(r),s&&s.nodeType===8)if(r=s.data,r==="/$"){if(n===0){e.removeChild(s),oi(t);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=s}while(r);oi(t)}function Fn(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function Wd(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"){if(t===0)return e;t--}else r==="/$"&&t++}e=e.previousSibling}return null}var fa=Math.random().toString(36).slice(2),Ur="__reactFiber$"+fa,hi="__reactProps$"+fa,ln="__reactContainer$"+fa,su="__reactEvents$"+fa,oy="__reactListeners$"+fa,cy="__reactHandles$"+fa;function rs(e){var t=e[Ur];if(t)return t;for(var r=e.parentNode;r;){if(t=r[ln]||r[Ur]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=Wd(e);e!==null;){if(r=e[Ur])return r;e=Wd(e)}return t}e=r,r=e.parentNode}return null}function Oi(e){return e=e[Ur]||e[ln],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function Is(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(oe(33))}function wo(e){return e[hi]||null}var au=[],Ds=-1;function Hn(e){return{current:e}}function Ge(e){0>Ds||(e.current=au[Ds],au[Ds]=null,Ds--)}function ze(e,t){Ds++,au[Ds]=e.current,e.current=t}var Mn={},It=Hn(Mn),Vt=Hn(!1),os=Mn;function ra(e,t){var r=e.type.contextTypes;if(!r)return Mn;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var s={},i;for(i in r)s[i]=t[i];return n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=s),s}function Gt(e){return e=e.childContextTypes,e!=null}function Dl(){Ge(Vt),Ge(It)}function Hd(e,t,r){if(It.current!==Mn)throw Error(oe(168));ze(It,t),ze(Vt,r)}function zx(e,t,r){var n=e.stateNode;if(t=t.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var s in n)if(!(s in t))throw Error(oe(108,X1(e)||"Unknown",s));return et({},r,n)}function Ll(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Mn,os=It.current,ze(It,e),ze(Vt,Vt.current),!0}function Vd(e,t,r){var n=e.stateNode;if(!n)throw Error(oe(169));r?(e=zx(e,t,os),n.__reactInternalMemoizedMergedChildContext=e,Ge(Vt),Ge(It),ze(It,e)):Ge(Vt),ze(Vt,r)}var Kr=null,bo=!1,dc=!1;function $x(e){Kr===null?Kr=[e]:Kr.push(e)}function uy(e){bo=!0,$x(e)}function Vn(){if(!dc&&Kr!==null){dc=!0;var e=0,t=De;try{var r=Kr;for(De=1;e<r.length;e++){var n=r[e];do n=n(!0);while(n!==null)}Kr=null,bo=!1}catch(s){throw Kr!==null&&(Kr=Kr.slice(e+1)),hx(Gu,Vn),s}finally{De=t,dc=!1}}return null}var Ls=[],Ms=0,Ml=null,Bl=0,fr=[],hr=0,cs=null,Zr=1,en="";function Qn(e,t){Ls[Ms++]=Bl,Ls[Ms++]=Ml,Ml=e,Bl=t}function Wx(e,t,r){fr[hr++]=Zr,fr[hr++]=en,fr[hr++]=cs,cs=e;var n=Zr;e=en;var s=32-Fr(n)-1;n&=~(1<<s),r+=1;var i=32-Fr(t)+s;if(30<i){var l=s-s%5;i=(n&(1<<l)-1).toString(32),n>>=l,s-=l,Zr=1<<32-Fr(t)+s|r<<s|n,en=i+e}else Zr=1<<i|r<<s|n,en=e}function t0(e){e.return!==null&&(Qn(e,1),Wx(e,1,0))}function r0(e){for(;e===Ml;)Ml=Ls[--Ms],Ls[Ms]=null,Bl=Ls[--Ms],Ls[Ms]=null;for(;e===cs;)cs=fr[--hr],fr[hr]=null,en=fr[--hr],fr[hr]=null,Zr=fr[--hr],fr[hr]=null}var sr=null,nr=null,Ye=!1,Tr=null;function Hx(e,t){var r=mr(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,t=e.deletions,t===null?(e.deletions=[r],e.flags|=16):t.push(r)}function Gd(e,t){switch(e.tag){case 5:var r=e.type;return t=t.nodeType!==1||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,sr=e,nr=Fn(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,sr=e,nr=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(r=cs!==null?{id:Zr,overflow:en}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},r=mr(18,null,null,0),r.stateNode=t,r.return=e,e.child=r,sr=e,nr=null,!0):!1;default:return!1}}function iu(e){return(e.mode&1)!==0&&(e.flags&128)===0}function lu(e){if(Ye){var t=nr;if(t){var r=t;if(!Gd(e,t)){if(iu(e))throw Error(oe(418));t=Fn(r.nextSibling);var n=sr;t&&Gd(e,t)?Hx(n,r):(e.flags=e.flags&-4097|2,Ye=!1,sr=e)}}else{if(iu(e))throw Error(oe(418));e.flags=e.flags&-4097|2,Ye=!1,sr=e}}}function Xd(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;sr=e}function el(e){if(e!==sr)return!1;if(!Ye)return Xd(e),Ye=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!ru(e.type,e.memoizedProps)),t&&(t=nr)){if(iu(e))throw Vx(),Error(oe(418));for(;t;)Hx(e,t),t=Fn(t.nextSibling)}if(Xd(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(oe(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"){if(t===0){nr=Fn(e.nextSibling);break e}t--}else r!=="$"&&r!=="$!"&&r!=="$?"||t++}e=e.nextSibling}nr=null}}else nr=sr?Fn(e.stateNode.nextSibling):null;return!0}function Vx(){for(var e=nr;e;)e=Fn(e.nextSibling)}function na(){nr=sr=null,Ye=!1}function n0(e){Tr===null?Tr=[e]:Tr.push(e)}var dy=fn.ReactCurrentBatchConfig;function ka(e,t,r){if(e=r.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(oe(309));var n=r.stateNode}if(!n)throw Error(oe(147,e));var s=n,i=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===i?t.ref:(t=function(l){var o=s.refs;l===null?delete o[i]:o[i]=l},t._stringRef=i,t)}if(typeof e!="string")throw Error(oe(284));if(!r._owner)throw Error(oe(290,e))}return e}function tl(e,t){throw e=Object.prototype.toString.call(t),Error(oe(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function Kd(e){var t=e._init;return t(e._payload)}function Gx(e){function t(y,g){if(e){var w=y.deletions;w===null?(y.deletions=[g],y.flags|=16):w.push(g)}}function r(y,g){if(!e)return null;for(;g!==null;)t(y,g),g=g.sibling;return null}function n(y,g){for(y=new Map;g!==null;)g.key!==null?y.set(g.key,g):y.set(g.index,g),g=g.sibling;return y}function s(y,g){return y=In(y,g),y.index=0,y.sibling=null,y}function i(y,g,w){return y.index=w,e?(w=y.alternate,w!==null?(w=w.index,w<g?(y.flags|=2,g):w):(y.flags|=2,g)):(y.flags|=1048576,g)}function l(y){return e&&y.alternate===null&&(y.flags|=2),y}function o(y,g,w,b){return g===null||g.tag!==6?(g=vc(w,y.mode,b),g.return=y,g):(g=s(g,w),g.return=y,g)}function c(y,g,w,b){var P=w.type;return P===Fs?u(y,g,w.props.children,b,w.key):g!==null&&(g.elementType===P||typeof P=="object"&&P!==null&&P.$$typeof===yn&&Kd(P)===g.type)?(b=s(g,w.props),b.ref=ka(y,g,w),b.return=y,b):(b=El(w.type,w.key,w.props,null,y.mode,b),b.ref=ka(y,g,w),b.return=y,b)}function d(y,g,w,b){return g===null||g.tag!==4||g.stateNode.containerInfo!==w.containerInfo||g.stateNode.implementation!==w.implementation?(g=yc(w,y.mode,b),g.return=y,g):(g=s(g,w.children||[]),g.return=y,g)}function u(y,g,w,b,P){return g===null||g.tag!==7?(g=is(w,y.mode,b,P),g.return=y,g):(g=s(g,w),g.return=y,g)}function f(y,g,w){if(typeof g=="string"&&g!==""||typeof g=="number")return g=vc(""+g,y.mode,w),g.return=y,g;if(typeof g=="object"&&g!==null){switch(g.$$typeof){case Hi:return w=El(g.type,g.key,g.props,null,y.mode,w),w.ref=ka(y,null,g),w.return=y,w;case As:return g=yc(g,y.mode,w),g.return=y,g;case yn:var b=g._init;return f(y,b(g._payload),w)}if(Da(g)||Sa(g))return g=is(g,y.mode,w,null),g.return=y,g;tl(y,g)}return null}function h(y,g,w,b){var P=g!==null?g.key:null;if(typeof w=="string"&&w!==""||typeof w=="number")return P!==null?null:o(y,g,""+w,b);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case Hi:return w.key===P?c(y,g,w,b):null;case As:return w.key===P?d(y,g,w,b):null;case yn:return P=w._init,h(y,g,P(w._payload),b)}if(Da(w)||Sa(w))return P!==null?null:u(y,g,w,b,null);tl(y,w)}return null}function m(y,g,w,b,P){if(typeof b=="string"&&b!==""||typeof b=="number")return y=y.get(w)||null,o(g,y,""+b,P);if(typeof b=="object"&&b!==null){switch(b.$$typeof){case Hi:return y=y.get(b.key===null?w:b.key)||null,c(g,y,b,P);case As:return y=y.get(b.key===null?w:b.key)||null,d(g,y,b,P);case yn:var L=b._init;return m(y,g,w,L(b._payload),P)}if(Da(b)||Sa(b))return y=y.get(w)||null,u(g,y,b,P,null);tl(g,b)}return null}function p(y,g,w,b){for(var P=null,L=null,E=g,I=g=0,S=null;E!==null&&I<w.length;I++){E.index>I?(S=E,E=null):S=E.sibling;var R=h(y,E,w[I],b);if(R===null){E===null&&(E=S);break}e&&E&&R.alternate===null&&t(y,E),g=i(R,g,I),L===null?P=R:L.sibling=R,L=R,E=S}if(I===w.length)return r(y,E),Ye&&Qn(y,I),P;if(E===null){for(;I<w.length;I++)E=f(y,w[I],b),E!==null&&(g=i(E,g,I),L===null?P=E:L.sibling=E,L=E);return Ye&&Qn(y,I),P}for(E=n(y,E);I<w.length;I++)S=m(E,y,I,w[I],b),S!==null&&(e&&S.alternate!==null&&E.delete(S.key===null?I:S.key),g=i(S,g,I),L===null?P=S:L.sibling=S,L=S);return e&&E.forEach(function(U){return t(y,U)}),Ye&&Qn(y,I),P}function x(y,g,w,b){var P=Sa(w);if(typeof P!="function")throw Error(oe(150));if(w=P.call(w),w==null)throw Error(oe(151));for(var L=P=null,E=g,I=g=0,S=null,R=w.next();E!==null&&!R.done;I++,R=w.next()){E.index>I?(S=E,E=null):S=E.sibling;var U=h(y,E,R.value,b);if(U===null){E===null&&(E=S);break}e&&E&&U.alternate===null&&t(y,E),g=i(U,g,I),L===null?P=U:L.sibling=U,L=U,E=S}if(R.done)return r(y,E),Ye&&Qn(y,I),P;if(E===null){for(;!R.done;I++,R=w.next())R=f(y,R.value,b),R!==null&&(g=i(R,g,I),L===null?P=R:L.sibling=R,L=R);return Ye&&Qn(y,I),P}for(E=n(y,E);!R.done;I++,R=w.next())R=m(E,y,I,R.value,b),R!==null&&(e&&R.alternate!==null&&E.delete(R.key===null?I:R.key),g=i(R,g,I),L===null?P=R:L.sibling=R,L=R);return e&&E.forEach(function(G){return t(y,G)}),Ye&&Qn(y,I),P}function v(y,g,w,b){if(typeof w=="object"&&w!==null&&w.type===Fs&&w.key===null&&(w=w.props.children),typeof w=="object"&&w!==null){switch(w.$$typeof){case Hi:e:{for(var P=w.key,L=g;L!==null;){if(L.key===P){if(P=w.type,P===Fs){if(L.tag===7){r(y,L.sibling),g=s(L,w.props.children),g.return=y,y=g;break e}}else if(L.elementType===P||typeof P=="object"&&P!==null&&P.$$typeof===yn&&Kd(P)===L.type){r(y,L.sibling),g=s(L,w.props),g.ref=ka(y,L,w),g.return=y,y=g;break e}r(y,L);break}else t(y,L);L=L.sibling}w.type===Fs?(g=is(w.props.children,y.mode,b,w.key),g.return=y,y=g):(b=El(w.type,w.key,w.props,null,y.mode,b),b.ref=ka(y,g,w),b.return=y,y=b)}return l(y);case As:e:{for(L=w.key;g!==null;){if(g.key===L)if(g.tag===4&&g.stateNode.containerInfo===w.containerInfo&&g.stateNode.implementation===w.implementation){r(y,g.sibling),g=s(g,w.children||[]),g.return=y,y=g;break e}else{r(y,g);break}else t(y,g);g=g.sibling}g=yc(w,y.mode,b),g.return=y,y=g}return l(y);case yn:return L=w._init,v(y,g,L(w._payload),b)}if(Da(w))return p(y,g,w,b);if(Sa(w))return x(y,g,w,b);tl(y,w)}return typeof w=="string"&&w!==""||typeof w=="number"?(w=""+w,g!==null&&g.tag===6?(r(y,g.sibling),g=s(g,w),g.return=y,y=g):(r(y,g),g=vc(w,y.mode,b),g.return=y,y=g),l(y)):r(y,g)}return v}var sa=Gx(!0),Xx=Gx(!1),Ul=Hn(null),zl=null,Bs=null,s0=null;function a0(){s0=Bs=zl=null}function i0(e){var t=Ul.current;Ge(Ul),e._currentValue=t}function ou(e,t,r){for(;e!==null;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,n!==null&&(n.childLanes|=t)):n!==null&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===r)break;e=e.return}}function Ks(e,t){zl=e,s0=Bs=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(Ht=!0),e.firstContext=null)}function gr(e){var t=e._currentValue;if(s0!==e)if(e={context:e,memoizedValue:t,next:null},Bs===null){if(zl===null)throw Error(oe(308));Bs=e,zl.dependencies={lanes:0,firstContext:e}}else Bs=Bs.next=e;return t}var ns=null;function l0(e){ns===null?ns=[e]:ns.push(e)}function Kx(e,t,r,n){var s=t.interleaved;return s===null?(r.next=r,l0(t)):(r.next=s.next,s.next=r),t.interleaved=r,on(e,n)}function on(e,t){e.lanes|=t;var r=e.alternate;for(r!==null&&(r.lanes|=t),r=e,e=e.return;e!==null;)e.childLanes|=t,r=e.alternate,r!==null&&(r.childLanes|=t),r=e,e=e.return;return r.tag===3?r.stateNode:null}var wn=!1;function o0(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Yx(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function tn(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function On(e,t,r){var n=e.updateQueue;if(n===null)return null;if(n=n.shared,Ae&2){var s=n.pending;return s===null?t.next=t:(t.next=s.next,s.next=t),n.pending=t,on(e,r)}return s=n.interleaved,s===null?(t.next=t,l0(n)):(t.next=s.next,s.next=t),n.interleaved=t,on(e,r)}function wl(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194240)!==0)){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,Xu(e,r)}}function Yd(e,t){var r=e.updateQueue,n=e.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var s=null,i=null;if(r=r.firstBaseUpdate,r!==null){do{var l={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};i===null?s=i=l:i=i.next=l,r=r.next}while(r!==null);i===null?s=i=t:i=i.next=t}else s=i=t;r={baseState:n.baseState,firstBaseUpdate:s,lastBaseUpdate:i,shared:n.shared,effects:n.effects},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function $l(e,t,r,n){var s=e.updateQueue;wn=!1;var i=s.firstBaseUpdate,l=s.lastBaseUpdate,o=s.shared.pending;if(o!==null){s.shared.pending=null;var c=o,d=c.next;c.next=null,l===null?i=d:l.next=d,l=c;var u=e.alternate;u!==null&&(u=u.updateQueue,o=u.lastBaseUpdate,o!==l&&(o===null?u.firstBaseUpdate=d:o.next=d,u.lastBaseUpdate=c))}if(i!==null){var f=s.baseState;l=0,u=d=c=null,o=i;do{var h=o.lane,m=o.eventTime;if((n&h)===h){u!==null&&(u=u.next={eventTime:m,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var p=e,x=o;switch(h=t,m=r,x.tag){case 1:if(p=x.payload,typeof p=="function"){f=p.call(m,f,h);break e}f=p;break e;case 3:p.flags=p.flags&-65537|128;case 0:if(p=x.payload,h=typeof p=="function"?p.call(m,f,h):p,h==null)break e;f=et({},f,h);break e;case 2:wn=!0}}o.callback!==null&&o.lane!==0&&(e.flags|=64,h=s.effects,h===null?s.effects=[o]:h.push(o))}else m={eventTime:m,lane:h,tag:o.tag,payload:o.payload,callback:o.callback,next:null},u===null?(d=u=m,c=f):u=u.next=m,l|=h;if(o=o.next,o===null){if(o=s.shared.pending,o===null)break;h=o,o=h.next,h.next=null,s.lastBaseUpdate=h,s.shared.pending=null}}while(!0);if(u===null&&(c=f),s.baseState=c,s.firstBaseUpdate=d,s.lastBaseUpdate=u,t=s.shared.interleaved,t!==null){s=t;do l|=s.lane,s=s.next;while(s!==t)}else i===null&&(s.shared.lanes=0);ds|=l,e.lanes=l,e.memoizedState=f}}function Jd(e,t,r){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var n=e[t],s=n.callback;if(s!==null){if(n.callback=null,n=r,typeof s!="function")throw Error(oe(191,s));s.call(n)}}}var Pi={},Wr=Hn(Pi),xi=Hn(Pi),mi=Hn(Pi);function ss(e){if(e===Pi)throw Error(oe(174));return e}function c0(e,t){switch(ze(mi,t),ze(xi,e),ze(Wr,Pi),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:$c(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=$c(t,e)}Ge(Wr),ze(Wr,t)}function aa(){Ge(Wr),Ge(xi),Ge(mi)}function Jx(e){ss(mi.current);var t=ss(Wr.current),r=$c(t,e.type);t!==r&&(ze(xi,e),ze(Wr,r))}function u0(e){xi.current===e&&(Ge(Wr),Ge(xi))}var Qe=Hn(0);function Wl(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var fc=[];function d0(){for(var e=0;e<fc.length;e++)fc[e]._workInProgressVersionPrimary=null;fc.length=0}var bl=fn.ReactCurrentDispatcher,hc=fn.ReactCurrentBatchConfig,us=0,Ze=null,dt=null,xt=null,Hl=!1,Ga=!1,pi=0,fy=0;function At(){throw Error(oe(321))}function f0(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!Rr(e[r],t[r]))return!1;return!0}function h0(e,t,r,n,s,i){if(us=i,Ze=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,bl.current=e===null||e.memoizedState===null?py:gy,e=r(n,s),Ga){i=0;do{if(Ga=!1,pi=0,25<=i)throw Error(oe(301));i+=1,xt=dt=null,t.updateQueue=null,bl.current=vy,e=r(n,s)}while(Ga)}if(bl.current=Vl,t=dt!==null&&dt.next!==null,us=0,xt=dt=Ze=null,Hl=!1,t)throw Error(oe(300));return e}function x0(){var e=pi!==0;return pi=0,e}function Br(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return xt===null?Ze.memoizedState=xt=e:xt=xt.next=e,xt}function vr(){if(dt===null){var e=Ze.alternate;e=e!==null?e.memoizedState:null}else e=dt.next;var t=xt===null?Ze.memoizedState:xt.next;if(t!==null)xt=t,dt=e;else{if(e===null)throw Error(oe(310));dt=e,e={memoizedState:dt.memoizedState,baseState:dt.baseState,baseQueue:dt.baseQueue,queue:dt.queue,next:null},xt===null?Ze.memoizedState=xt=e:xt=xt.next=e}return xt}function gi(e,t){return typeof t=="function"?t(e):t}function xc(e){var t=vr(),r=t.queue;if(r===null)throw Error(oe(311));r.lastRenderedReducer=e;var n=dt,s=n.baseQueue,i=r.pending;if(i!==null){if(s!==null){var l=s.next;s.next=i.next,i.next=l}n.baseQueue=s=i,r.pending=null}if(s!==null){i=s.next,n=n.baseState;var o=l=null,c=null,d=i;do{var u=d.lane;if((us&u)===u)c!==null&&(c=c.next={lane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),n=d.hasEagerState?d.eagerState:e(n,d.action);else{var f={lane:u,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null};c===null?(o=c=f,l=n):c=c.next=f,Ze.lanes|=u,ds|=u}d=d.next}while(d!==null&&d!==i);c===null?l=n:c.next=o,Rr(n,t.memoizedState)||(Ht=!0),t.memoizedState=n,t.baseState=l,t.baseQueue=c,r.lastRenderedState=n}if(e=r.interleaved,e!==null){s=e;do i=s.lane,Ze.lanes|=i,ds|=i,s=s.next;while(s!==e)}else s===null&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function mc(e){var t=vr(),r=t.queue;if(r===null)throw Error(oe(311));r.lastRenderedReducer=e;var n=r.dispatch,s=r.pending,i=t.memoizedState;if(s!==null){r.pending=null;var l=s=s.next;do i=e(i,l.action),l=l.next;while(l!==s);Rr(i,t.memoizedState)||(Ht=!0),t.memoizedState=i,t.baseQueue===null&&(t.baseState=i),r.lastRenderedState=i}return[i,n]}function qx(){}function Qx(e,t){var r=Ze,n=vr(),s=t(),i=!Rr(n.memoizedState,s);if(i&&(n.memoizedState=s,Ht=!0),n=n.queue,m0(tm.bind(null,r,n,e),[e]),n.getSnapshot!==t||i||xt!==null&&xt.memoizedState.tag&1){if(r.flags|=2048,vi(9,em.bind(null,r,n,s,t),void 0,null),vt===null)throw Error(oe(349));us&30||Zx(r,t,s)}return s}function Zx(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=Ze.updateQueue,t===null?(t={lastEffect:null,stores:null},Ze.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function em(e,t,r,n){t.value=r,t.getSnapshot=n,rm(t)&&nm(e)}function tm(e,t,r){return r(function(){rm(t)&&nm(e)})}function rm(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!Rr(e,r)}catch{return!0}}function nm(e){var t=on(e,1);t!==null&&Or(t,e,1,-1)}function qd(e){var t=Br();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:gi,lastRenderedState:e},t.queue=e,e=e.dispatch=my.bind(null,Ze,e),[t.memoizedState,e]}function vi(e,t,r,n){return e={tag:e,create:t,destroy:r,deps:n,next:null},t=Ze.updateQueue,t===null?(t={lastEffect:null,stores:null},Ze.updateQueue=t,t.lastEffect=e.next=e):(r=t.lastEffect,r===null?t.lastEffect=e.next=e:(n=r.next,r.next=e,e.next=n,t.lastEffect=e)),e}function sm(){return vr().memoizedState}function Nl(e,t,r,n){var s=Br();Ze.flags|=e,s.memoizedState=vi(1|t,r,void 0,n===void 0?null:n)}function No(e,t,r,n){var s=vr();n=n===void 0?null:n;var i=void 0;if(dt!==null){var l=dt.memoizedState;if(i=l.destroy,n!==null&&f0(n,l.deps)){s.memoizedState=vi(t,r,i,n);return}}Ze.flags|=e,s.memoizedState=vi(1|t,r,i,n)}function Qd(e,t){return Nl(8390656,8,e,t)}function m0(e,t){return No(2048,8,e,t)}function am(e,t){return No(4,2,e,t)}function im(e,t){return No(4,4,e,t)}function lm(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function om(e,t,r){return r=r!=null?r.concat([e]):null,No(4,4,lm.bind(null,t,e),r)}function p0(){}function cm(e,t){var r=vr();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&f0(t,n[1])?n[0]:(r.memoizedState=[e,t],e)}function um(e,t){var r=vr();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&f0(t,n[1])?n[0]:(e=e(),r.memoizedState=[e,t],e)}function dm(e,t,r){return us&21?(Rr(r,t)||(r=px(),Ze.lanes|=r,ds|=r,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,Ht=!0),e.memoizedState=r)}function hy(e,t){var r=De;De=r!==0&&4>r?r:4,e(!0);var n=hc.transition;hc.transition={};try{e(!1),t()}finally{De=r,hc.transition=n}}function fm(){return vr().memoizedState}function xy(e,t,r){var n=Rn(e);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},hm(e))xm(t,r);else if(r=Kx(e,t,r,n),r!==null){var s=Bt();Or(r,e,n,s),mm(r,t,n)}}function my(e,t,r){var n=Rn(e),s={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(hm(e))xm(t,s);else{var i=e.alternate;if(e.lanes===0&&(i===null||i.lanes===0)&&(i=t.lastRenderedReducer,i!==null))try{var l=t.lastRenderedState,o=i(l,r);if(s.hasEagerState=!0,s.eagerState=o,Rr(o,l)){var c=t.interleaved;c===null?(s.next=s,l0(t)):(s.next=c.next,c.next=s),t.interleaved=s;return}}catch{}finally{}r=Kx(e,t,s,n),r!==null&&(s=Bt(),Or(r,e,n,s),mm(r,t,n))}}function hm(e){var t=e.alternate;return e===Ze||t!==null&&t===Ze}function xm(e,t){Ga=Hl=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function mm(e,t,r){if(r&4194240){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,Xu(e,r)}}var Vl={readContext:gr,useCallback:At,useContext:At,useEffect:At,useImperativeHandle:At,useInsertionEffect:At,useLayoutEffect:At,useMemo:At,useReducer:At,useRef:At,useState:At,useDebugValue:At,useDeferredValue:At,useTransition:At,useMutableSource:At,useSyncExternalStore:At,useId:At,unstable_isNewReconciler:!1},py={readContext:gr,useCallback:function(e,t){return Br().memoizedState=[e,t===void 0?null:t],e},useContext:gr,useEffect:Qd,useImperativeHandle:function(e,t,r){return r=r!=null?r.concat([e]):null,Nl(4194308,4,lm.bind(null,t,e),r)},useLayoutEffect:function(e,t){return Nl(4194308,4,e,t)},useInsertionEffect:function(e,t){return Nl(4,2,e,t)},useMemo:function(e,t){var r=Br();return t=t===void 0?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var n=Br();return t=r!==void 0?r(t):t,n.memoizedState=n.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},n.queue=e,e=e.dispatch=xy.bind(null,Ze,e),[n.memoizedState,e]},useRef:function(e){var t=Br();return e={current:e},t.memoizedState=e},useState:qd,useDebugValue:p0,useDeferredValue:function(e){return Br().memoizedState=e},useTransition:function(){var e=qd(!1),t=e[0];return e=hy.bind(null,e[1]),Br().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var n=Ze,s=Br();if(Ye){if(r===void 0)throw Error(oe(407));r=r()}else{if(r=t(),vt===null)throw Error(oe(349));us&30||Zx(n,t,r)}s.memoizedState=r;var i={value:r,getSnapshot:t};return s.queue=i,Qd(tm.bind(null,n,i,e),[e]),n.flags|=2048,vi(9,em.bind(null,n,i,r,t),void 0,null),r},useId:function(){var e=Br(),t=vt.identifierPrefix;if(Ye){var r=en,n=Zr;r=(n&~(1<<32-Fr(n)-1)).toString(32)+r,t=":"+t+"R"+r,r=pi++,0<r&&(t+="H"+r.toString(32)),t+=":"}else r=fy++,t=":"+t+"r"+r.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},gy={readContext:gr,useCallback:cm,useContext:gr,useEffect:m0,useImperativeHandle:om,useInsertionEffect:am,useLayoutEffect:im,useMemo:um,useReducer:xc,useRef:sm,useState:function(){return xc(gi)},useDebugValue:p0,useDeferredValue:function(e){var t=vr();return dm(t,dt.memoizedState,e)},useTransition:function(){var e=xc(gi)[0],t=vr().memoizedState;return[e,t]},useMutableSource:qx,useSyncExternalStore:Qx,useId:fm,unstable_isNewReconciler:!1},vy={readContext:gr,useCallback:cm,useContext:gr,useEffect:m0,useImperativeHandle:om,useInsertionEffect:am,useLayoutEffect:im,useMemo:um,useReducer:mc,useRef:sm,useState:function(){return mc(gi)},useDebugValue:p0,useDeferredValue:function(e){var t=vr();return dt===null?t.memoizedState=e:dm(t,dt.memoizedState,e)},useTransition:function(){var e=mc(gi)[0],t=vr().memoizedState;return[e,t]},useMutableSource:qx,useSyncExternalStore:Qx,useId:fm,unstable_isNewReconciler:!1};function _r(e,t){if(e&&e.defaultProps){t=et({},t),e=e.defaultProps;for(var r in e)t[r]===void 0&&(t[r]=e[r]);return t}return t}function cu(e,t,r,n){t=e.memoizedState,r=r(n,t),r=r==null?t:et({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var jo={isMounted:function(e){return(e=e._reactInternals)?gs(e)===e:!1},enqueueSetState:function(e,t,r){e=e._reactInternals;var n=Bt(),s=Rn(e),i=tn(n,s);i.payload=t,r!=null&&(i.callback=r),t=On(e,i,s),t!==null&&(Or(t,e,s,n),wl(t,e,s))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var n=Bt(),s=Rn(e),i=tn(n,s);i.tag=1,i.payload=t,r!=null&&(i.callback=r),t=On(e,i,s),t!==null&&(Or(t,e,s,n),wl(t,e,s))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=Bt(),n=Rn(e),s=tn(r,n);s.tag=2,t!=null&&(s.callback=t),t=On(e,s,n),t!==null&&(Or(t,e,n,r),wl(t,e,n))}};function Zd(e,t,r,n,s,i,l){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(n,i,l):t.prototype&&t.prototype.isPureReactComponent?!ui(r,n)||!ui(s,i):!0}function pm(e,t,r){var n=!1,s=Mn,i=t.contextType;return typeof i=="object"&&i!==null?i=gr(i):(s=Gt(t)?os:It.current,n=t.contextTypes,i=(n=n!=null)?ra(e,s):Mn),t=new t(r,i),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=jo,e.stateNode=t,t._reactInternals=e,n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=s,e.__reactInternalMemoizedMaskedChildContext=i),t}function ef(e,t,r,n){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,n),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,n),t.state!==e&&jo.enqueueReplaceState(t,t.state,null)}function uu(e,t,r,n){var s=e.stateNode;s.props=r,s.state=e.memoizedState,s.refs={},o0(e);var i=t.contextType;typeof i=="object"&&i!==null?s.context=gr(i):(i=Gt(t)?os:It.current,s.context=ra(e,i)),s.state=e.memoizedState,i=t.getDerivedStateFromProps,typeof i=="function"&&(cu(e,t,i,r),s.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(t=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),t!==s.state&&jo.enqueueReplaceState(s,s.state,null),$l(e,r,s,n),s.state=e.memoizedState),typeof s.componentDidMount=="function"&&(e.flags|=4194308)}function ia(e,t){try{var r="",n=t;do r+=G1(n),n=n.return;while(n);var s=r}catch(i){s=`
Error generating stack: `+i.message+`
`+i.stack}return{value:e,source:t,stack:s,digest:null}}function pc(e,t,r){return{value:e,source:null,stack:r??null,digest:t??null}}function du(e,t){try{console.error(t.value)}catch(r){setTimeout(function(){throw r})}}var yy=typeof WeakMap=="function"?WeakMap:Map;function gm(e,t,r){r=tn(-1,r),r.tag=3,r.payload={element:null};var n=t.value;return r.callback=function(){Xl||(Xl=!0,bu=n),du(e,t)},r}function vm(e,t,r){r=tn(-1,r),r.tag=3;var n=e.type.getDerivedStateFromError;if(typeof n=="function"){var s=t.value;r.payload=function(){return n(s)},r.callback=function(){du(e,t)}}var i=e.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(r.callback=function(){du(e,t),typeof n!="function"&&(Pn===null?Pn=new Set([this]):Pn.add(this));var l=t.stack;this.componentDidCatch(t.value,{componentStack:l!==null?l:""})}),r}function tf(e,t,r){var n=e.pingCache;if(n===null){n=e.pingCache=new yy;var s=new Set;n.set(t,s)}else s=n.get(t),s===void 0&&(s=new Set,n.set(t,s));s.has(r)||(s.add(r),e=Py.bind(null,e,t,r),t.then(e,e))}function rf(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function nf(e,t,r,n,s){return e.mode&1?(e.flags|=65536,e.lanes=s,e):(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(t=tn(-1,1),t.tag=2,On(r,t,1))),r.lanes|=1),e)}var wy=fn.ReactCurrentOwner,Ht=!1;function Dt(e,t,r,n){t.child=e===null?Xx(t,null,r,n):sa(t,e.child,r,n)}function sf(e,t,r,n,s){r=r.render;var i=t.ref;return Ks(t,s),n=h0(e,t,r,n,i,s),r=x0(),e!==null&&!Ht?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,cn(e,t,s)):(Ye&&r&&t0(t),t.flags|=1,Dt(e,t,n,s),t.child)}function af(e,t,r,n,s){if(e===null){var i=r.type;return typeof i=="function"&&!S0(i)&&i.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(t.tag=15,t.type=i,ym(e,t,i,n,s)):(e=El(r.type,null,n,t,t.mode,s),e.ref=t.ref,e.return=t,t.child=e)}if(i=e.child,!(e.lanes&s)){var l=i.memoizedProps;if(r=r.compare,r=r!==null?r:ui,r(l,n)&&e.ref===t.ref)return cn(e,t,s)}return t.flags|=1,e=In(i,n),e.ref=t.ref,e.return=t,t.child=e}function ym(e,t,r,n,s){if(e!==null){var i=e.memoizedProps;if(ui(i,n)&&e.ref===t.ref)if(Ht=!1,t.pendingProps=n=i,(e.lanes&s)!==0)e.flags&131072&&(Ht=!0);else return t.lanes=e.lanes,cn(e,t,s)}return fu(e,t,r,n,s)}function wm(e,t,r){var n=t.pendingProps,s=n.children,i=e!==null?e.memoizedState:null;if(n.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},ze(zs,Zt),Zt|=r;else{if(!(r&1073741824))return e=i!==null?i.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,ze(zs,Zt),Zt|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=i!==null?i.baseLanes:r,ze(zs,Zt),Zt|=n}else i!==null?(n=i.baseLanes|r,t.memoizedState=null):n=r,ze(zs,Zt),Zt|=n;return Dt(e,t,s,r),t.child}function bm(e,t){var r=t.ref;(e===null&&r!==null||e!==null&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function fu(e,t,r,n,s){var i=Gt(r)?os:It.current;return i=ra(t,i),Ks(t,s),r=h0(e,t,r,n,i,s),n=x0(),e!==null&&!Ht?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,cn(e,t,s)):(Ye&&n&&t0(t),t.flags|=1,Dt(e,t,r,s),t.child)}function lf(e,t,r,n,s){if(Gt(r)){var i=!0;Ll(t)}else i=!1;if(Ks(t,s),t.stateNode===null)jl(e,t),pm(t,r,n),uu(t,r,n,s),n=!0;else if(e===null){var l=t.stateNode,o=t.memoizedProps;l.props=o;var c=l.context,d=r.contextType;typeof d=="object"&&d!==null?d=gr(d):(d=Gt(r)?os:It.current,d=ra(t,d));var u=r.getDerivedStateFromProps,f=typeof u=="function"||typeof l.getSnapshotBeforeUpdate=="function";f||typeof l.UNSAFE_componentWillReceiveProps!="function"&&typeof l.componentWillReceiveProps!="function"||(o!==n||c!==d)&&ef(t,l,n,d),wn=!1;var h=t.memoizedState;l.state=h,$l(t,n,l,s),c=t.memoizedState,o!==n||h!==c||Vt.current||wn?(typeof u=="function"&&(cu(t,r,u,n),c=t.memoizedState),(o=wn||Zd(t,r,o,n,h,c,d))?(f||typeof l.UNSAFE_componentWillMount!="function"&&typeof l.componentWillMount!="function"||(typeof l.componentWillMount=="function"&&l.componentWillMount(),typeof l.UNSAFE_componentWillMount=="function"&&l.UNSAFE_componentWillMount()),typeof l.componentDidMount=="function"&&(t.flags|=4194308)):(typeof l.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=c),l.props=n,l.state=c,l.context=d,n=o):(typeof l.componentDidMount=="function"&&(t.flags|=4194308),n=!1)}else{l=t.stateNode,Yx(e,t),o=t.memoizedProps,d=t.type===t.elementType?o:_r(t.type,o),l.props=d,f=t.pendingProps,h=l.context,c=r.contextType,typeof c=="object"&&c!==null?c=gr(c):(c=Gt(r)?os:It.current,c=ra(t,c));var m=r.getDerivedStateFromProps;(u=typeof m=="function"||typeof l.getSnapshotBeforeUpdate=="function")||typeof l.UNSAFE_componentWillReceiveProps!="function"&&typeof l.componentWillReceiveProps!="function"||(o!==f||h!==c)&&ef(t,l,n,c),wn=!1,h=t.memoizedState,l.state=h,$l(t,n,l,s);var p=t.memoizedState;o!==f||h!==p||Vt.current||wn?(typeof m=="function"&&(cu(t,r,m,n),p=t.memoizedState),(d=wn||Zd(t,r,d,n,h,p,c)||!1)?(u||typeof l.UNSAFE_componentWillUpdate!="function"&&typeof l.componentWillUpdate!="function"||(typeof l.componentWillUpdate=="function"&&l.componentWillUpdate(n,p,c),typeof l.UNSAFE_componentWillUpdate=="function"&&l.UNSAFE_componentWillUpdate(n,p,c)),typeof l.componentDidUpdate=="function"&&(t.flags|=4),typeof l.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof l.componentDidUpdate!="function"||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),typeof l.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=p),l.props=n,l.state=p,l.context=c,n=d):(typeof l.componentDidUpdate!="function"||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),typeof l.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),n=!1)}return hu(e,t,r,n,i,s)}function hu(e,t,r,n,s,i){bm(e,t);var l=(t.flags&128)!==0;if(!n&&!l)return s&&Vd(t,r,!1),cn(e,t,i);n=t.stateNode,wy.current=t;var o=l&&typeof r.getDerivedStateFromError!="function"?null:n.render();return t.flags|=1,e!==null&&l?(t.child=sa(t,e.child,null,i),t.child=sa(t,null,o,i)):Dt(e,t,o,i),t.memoizedState=n.state,s&&Vd(t,r,!0),t.child}function Nm(e){var t=e.stateNode;t.pendingContext?Hd(e,t.pendingContext,t.pendingContext!==t.context):t.context&&Hd(e,t.context,!1),c0(e,t.containerInfo)}function of(e,t,r,n,s){return na(),n0(s),t.flags|=256,Dt(e,t,r,n),t.child}var xu={dehydrated:null,treeContext:null,retryLane:0};function mu(e){return{baseLanes:e,cachePool:null,transitions:null}}function jm(e,t,r){var n=t.pendingProps,s=Qe.current,i=!1,l=(t.flags&128)!==0,o;if((o=l)||(o=e!==null&&e.memoizedState===null?!1:(s&2)!==0),o?(i=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(s|=1),ze(Qe,s&1),e===null)return lu(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(l=n.children,e=n.fallback,i?(n=t.mode,i=t.child,l={mode:"hidden",children:l},!(n&1)&&i!==null?(i.childLanes=0,i.pendingProps=l):i=Eo(l,n,0,null),e=is(e,n,r,null),i.return=t,e.return=t,i.sibling=e,t.child=i,t.child.memoizedState=mu(r),t.memoizedState=xu,e):g0(t,l));if(s=e.memoizedState,s!==null&&(o=s.dehydrated,o!==null))return by(e,t,l,n,o,s,r);if(i){i=n.fallback,l=t.mode,s=e.child,o=s.sibling;var c={mode:"hidden",children:n.children};return!(l&1)&&t.child!==s?(n=t.child,n.childLanes=0,n.pendingProps=c,t.deletions=null):(n=In(s,c),n.subtreeFlags=s.subtreeFlags&14680064),o!==null?i=In(o,i):(i=is(i,l,r,null),i.flags|=2),i.return=t,n.return=t,n.sibling=i,t.child=n,n=i,i=t.child,l=e.child.memoizedState,l=l===null?mu(r):{baseLanes:l.baseLanes|r,cachePool:null,transitions:l.transitions},i.memoizedState=l,i.childLanes=e.childLanes&~r,t.memoizedState=xu,n}return i=e.child,e=i.sibling,n=In(i,{mode:"visible",children:n.children}),!(t.mode&1)&&(n.lanes=r),n.return=t,n.sibling=null,e!==null&&(r=t.deletions,r===null?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=n,t.memoizedState=null,n}function g0(e,t){return t=Eo({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function rl(e,t,r,n){return n!==null&&n0(n),sa(t,e.child,null,r),e=g0(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function by(e,t,r,n,s,i,l){if(r)return t.flags&256?(t.flags&=-257,n=pc(Error(oe(422))),rl(e,t,l,n)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(i=n.fallback,s=t.mode,n=Eo({mode:"visible",children:n.children},s,0,null),i=is(i,s,l,null),i.flags|=2,n.return=t,i.return=t,n.sibling=i,t.child=n,t.mode&1&&sa(t,e.child,null,l),t.child.memoizedState=mu(l),t.memoizedState=xu,i);if(!(t.mode&1))return rl(e,t,l,null);if(s.data==="$!"){if(n=s.nextSibling&&s.nextSibling.dataset,n)var o=n.dgst;return n=o,i=Error(oe(419)),n=pc(i,n,void 0),rl(e,t,l,n)}if(o=(l&e.childLanes)!==0,Ht||o){if(n=vt,n!==null){switch(l&-l){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(n.suspendedLanes|l)?0:s,s!==0&&s!==i.retryLane&&(i.retryLane=s,on(e,s),Or(n,e,s,-1))}return j0(),n=pc(Error(oe(421))),rl(e,t,l,n)}return s.data==="$?"?(t.flags|=128,t.child=e.child,t=Ry.bind(null,e),s._reactRetry=t,null):(e=i.treeContext,nr=Fn(s.nextSibling),sr=t,Ye=!0,Tr=null,e!==null&&(fr[hr++]=Zr,fr[hr++]=en,fr[hr++]=cs,Zr=e.id,en=e.overflow,cs=t),t=g0(t,n.children),t.flags|=4096,t)}function cf(e,t,r){e.lanes|=t;var n=e.alternate;n!==null&&(n.lanes|=t),ou(e.return,t,r)}function gc(e,t,r,n,s){var i=e.memoizedState;i===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:s}:(i.isBackwards=t,i.rendering=null,i.renderingStartTime=0,i.last=n,i.tail=r,i.tailMode=s)}function Sm(e,t,r){var n=t.pendingProps,s=n.revealOrder,i=n.tail;if(Dt(e,t,n.children,r),n=Qe.current,n&2)n=n&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&cf(e,r,t);else if(e.tag===19)cf(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(ze(Qe,n),!(t.mode&1))t.memoizedState=null;else switch(s){case"forwards":for(r=t.child,s=null;r!==null;)e=r.alternate,e!==null&&Wl(e)===null&&(s=r),r=r.sibling;r=s,r===null?(s=t.child,t.child=null):(s=r.sibling,r.sibling=null),gc(t,!1,s,r,i);break;case"backwards":for(r=null,s=t.child,t.child=null;s!==null;){if(e=s.alternate,e!==null&&Wl(e)===null){t.child=s;break}e=s.sibling,s.sibling=r,r=s,s=e}gc(t,!0,r,null,i);break;case"together":gc(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function jl(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function cn(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),ds|=t.lanes,!(r&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(oe(153));if(t.child!==null){for(e=t.child,r=In(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=In(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function Ny(e,t,r){switch(t.tag){case 3:Nm(t),na();break;case 5:Jx(t);break;case 1:Gt(t.type)&&Ll(t);break;case 4:c0(t,t.stateNode.containerInfo);break;case 10:var n=t.type._context,s=t.memoizedProps.value;ze(Ul,n._currentValue),n._currentValue=s;break;case 13:if(n=t.memoizedState,n!==null)return n.dehydrated!==null?(ze(Qe,Qe.current&1),t.flags|=128,null):r&t.child.childLanes?jm(e,t,r):(ze(Qe,Qe.current&1),e=cn(e,t,r),e!==null?e.sibling:null);ze(Qe,Qe.current&1);break;case 19:if(n=(r&t.childLanes)!==0,e.flags&128){if(n)return Sm(e,t,r);t.flags|=128}if(s=t.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),ze(Qe,Qe.current),n)break;return null;case 22:case 23:return t.lanes=0,wm(e,t,r)}return cn(e,t,r)}var _m,pu,Em,Tm;_m=function(e,t){for(var r=t.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};pu=function(){};Em=function(e,t,r,n){var s=e.memoizedProps;if(s!==n){e=t.stateNode,ss(Wr.current);var i=null;switch(r){case"input":s=Mc(e,s),n=Mc(e,n),i=[];break;case"select":s=et({},s,{value:void 0}),n=et({},n,{value:void 0}),i=[];break;case"textarea":s=zc(e,s),n=zc(e,n),i=[];break;default:typeof s.onClick!="function"&&typeof n.onClick=="function"&&(e.onclick=Il)}Wc(r,n);var l;r=null;for(d in s)if(!n.hasOwnProperty(d)&&s.hasOwnProperty(d)&&s[d]!=null)if(d==="style"){var o=s[d];for(l in o)o.hasOwnProperty(l)&&(r||(r={}),r[l]="")}else d!=="dangerouslySetInnerHTML"&&d!=="children"&&d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&d!=="autoFocus"&&(ni.hasOwnProperty(d)?i||(i=[]):(i=i||[]).push(d,null));for(d in n){var c=n[d];if(o=s!=null?s[d]:void 0,n.hasOwnProperty(d)&&c!==o&&(c!=null||o!=null))if(d==="style")if(o){for(l in o)!o.hasOwnProperty(l)||c&&c.hasOwnProperty(l)||(r||(r={}),r[l]="");for(l in c)c.hasOwnProperty(l)&&o[l]!==c[l]&&(r||(r={}),r[l]=c[l])}else r||(i||(i=[]),i.push(d,r)),r=c;else d==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,o=o?o.__html:void 0,c!=null&&o!==c&&(i=i||[]).push(d,c)):d==="children"?typeof c!="string"&&typeof c!="number"||(i=i||[]).push(d,""+c):d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&(ni.hasOwnProperty(d)?(c!=null&&d==="onScroll"&&Ve("scroll",e),i||o===c||(i=[])):(i=i||[]).push(d,c))}r&&(i=i||[]).push("style",r);var d=i;(t.updateQueue=d)&&(t.flags|=4)}};Tm=function(e,t,r,n){r!==n&&(t.flags|=4)};function Aa(e,t){if(!Ye)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:n.sibling=null}}function Ft(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,n=0;if(t)for(var s=e.child;s!==null;)r|=s.lanes|s.childLanes,n|=s.subtreeFlags&14680064,n|=s.flags&14680064,s.return=e,s=s.sibling;else for(s=e.child;s!==null;)r|=s.lanes|s.childLanes,n|=s.subtreeFlags,n|=s.flags,s.return=e,s=s.sibling;return e.subtreeFlags|=n,e.childLanes=r,t}function jy(e,t,r){var n=t.pendingProps;switch(r0(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ft(t),null;case 1:return Gt(t.type)&&Dl(),Ft(t),null;case 3:return n=t.stateNode,aa(),Ge(Vt),Ge(It),d0(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(e===null||e.child===null)&&(el(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,Tr!==null&&(Su(Tr),Tr=null))),pu(e,t),Ft(t),null;case 5:u0(t);var s=ss(mi.current);if(r=t.type,e!==null&&t.stateNode!=null)Em(e,t,r,n,s),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!n){if(t.stateNode===null)throw Error(oe(166));return Ft(t),null}if(e=ss(Wr.current),el(t)){n=t.stateNode,r=t.type;var i=t.memoizedProps;switch(n[Ur]=t,n[hi]=i,e=(t.mode&1)!==0,r){case"dialog":Ve("cancel",n),Ve("close",n);break;case"iframe":case"object":case"embed":Ve("load",n);break;case"video":case"audio":for(s=0;s<Ma.length;s++)Ve(Ma[s],n);break;case"source":Ve("error",n);break;case"img":case"image":case"link":Ve("error",n),Ve("load",n);break;case"details":Ve("toggle",n);break;case"input":gd(n,i),Ve("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!i.multiple},Ve("invalid",n);break;case"textarea":yd(n,i),Ve("invalid",n)}Wc(r,i),s=null;for(var l in i)if(i.hasOwnProperty(l)){var o=i[l];l==="children"?typeof o=="string"?n.textContent!==o&&(i.suppressHydrationWarning!==!0&&Zi(n.textContent,o,e),s=["children",o]):typeof o=="number"&&n.textContent!==""+o&&(i.suppressHydrationWarning!==!0&&Zi(n.textContent,o,e),s=["children",""+o]):ni.hasOwnProperty(l)&&o!=null&&l==="onScroll"&&Ve("scroll",n)}switch(r){case"input":Vi(n),vd(n,i,!0);break;case"textarea":Vi(n),wd(n);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(n.onclick=Il)}n=s,t.updateQueue=n,n!==null&&(t.flags|=4)}else{l=s.nodeType===9?s:s.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=tx(r)),e==="http://www.w3.org/1999/xhtml"?r==="script"?(e=l.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof n.is=="string"?e=l.createElement(r,{is:n.is}):(e=l.createElement(r),r==="select"&&(l=e,n.multiple?l.multiple=!0:n.size&&(l.size=n.size))):e=l.createElementNS(e,r),e[Ur]=t,e[hi]=n,_m(e,t,!1,!1),t.stateNode=e;e:{switch(l=Hc(r,n),r){case"dialog":Ve("cancel",e),Ve("close",e),s=n;break;case"iframe":case"object":case"embed":Ve("load",e),s=n;break;case"video":case"audio":for(s=0;s<Ma.length;s++)Ve(Ma[s],e);s=n;break;case"source":Ve("error",e),s=n;break;case"img":case"image":case"link":Ve("error",e),Ve("load",e),s=n;break;case"details":Ve("toggle",e),s=n;break;case"input":gd(e,n),s=Mc(e,n),Ve("invalid",e);break;case"option":s=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},s=et({},n,{value:void 0}),Ve("invalid",e);break;case"textarea":yd(e,n),s=zc(e,n),Ve("invalid",e);break;default:s=n}Wc(r,s),o=s;for(i in o)if(o.hasOwnProperty(i)){var c=o[i];i==="style"?sx(e,c):i==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&rx(e,c)):i==="children"?typeof c=="string"?(r!=="textarea"||c!=="")&&si(e,c):typeof c=="number"&&si(e,""+c):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(ni.hasOwnProperty(i)?c!=null&&i==="onScroll"&&Ve("scroll",e):c!=null&&zu(e,i,c,l))}switch(r){case"input":Vi(e),vd(e,n,!1);break;case"textarea":Vi(e),wd(e);break;case"option":n.value!=null&&e.setAttribute("value",""+Ln(n.value));break;case"select":e.multiple=!!n.multiple,i=n.value,i!=null?Hs(e,!!n.multiple,i,!1):n.defaultValue!=null&&Hs(e,!!n.multiple,n.defaultValue,!0);break;default:typeof s.onClick=="function"&&(e.onclick=Il)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return Ft(t),null;case 6:if(e&&t.stateNode!=null)Tm(e,t,e.memoizedProps,n);else{if(typeof n!="string"&&t.stateNode===null)throw Error(oe(166));if(r=ss(mi.current),ss(Wr.current),el(t)){if(n=t.stateNode,r=t.memoizedProps,n[Ur]=t,(i=n.nodeValue!==r)&&(e=sr,e!==null))switch(e.tag){case 3:Zi(n.nodeValue,r,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&Zi(n.nodeValue,r,(e.mode&1)!==0)}i&&(t.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[Ur]=t,t.stateNode=n}return Ft(t),null;case 13:if(Ge(Qe),n=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(Ye&&nr!==null&&t.mode&1&&!(t.flags&128))Vx(),na(),t.flags|=98560,i=!1;else if(i=el(t),n!==null&&n.dehydrated!==null){if(e===null){if(!i)throw Error(oe(318));if(i=t.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(oe(317));i[Ur]=t}else na(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;Ft(t),i=!1}else Tr!==null&&(Su(Tr),Tr=null),i=!0;if(!i)return t.flags&65536?t:null}return t.flags&128?(t.lanes=r,t):(n=n!==null,n!==(e!==null&&e.memoizedState!==null)&&n&&(t.child.flags|=8192,t.mode&1&&(e===null||Qe.current&1?ft===0&&(ft=3):j0())),t.updateQueue!==null&&(t.flags|=4),Ft(t),null);case 4:return aa(),pu(e,t),e===null&&di(t.stateNode.containerInfo),Ft(t),null;case 10:return i0(t.type._context),Ft(t),null;case 17:return Gt(t.type)&&Dl(),Ft(t),null;case 19:if(Ge(Qe),i=t.memoizedState,i===null)return Ft(t),null;if(n=(t.flags&128)!==0,l=i.rendering,l===null)if(n)Aa(i,!1);else{if(ft!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(l=Wl(e),l!==null){for(t.flags|=128,Aa(i,!1),n=l.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),t.subtreeFlags=0,n=r,r=t.child;r!==null;)i=r,e=n,i.flags&=14680066,l=i.alternate,l===null?(i.childLanes=0,i.lanes=e,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=l.childLanes,i.lanes=l.lanes,i.child=l.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=l.memoizedProps,i.memoizedState=l.memoizedState,i.updateQueue=l.updateQueue,i.type=l.type,e=l.dependencies,i.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return ze(Qe,Qe.current&1|2),t.child}e=e.sibling}i.tail!==null&&st()>la&&(t.flags|=128,n=!0,Aa(i,!1),t.lanes=4194304)}else{if(!n)if(e=Wl(l),e!==null){if(t.flags|=128,n=!0,r=e.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),Aa(i,!0),i.tail===null&&i.tailMode==="hidden"&&!l.alternate&&!Ye)return Ft(t),null}else 2*st()-i.renderingStartTime>la&&r!==1073741824&&(t.flags|=128,n=!0,Aa(i,!1),t.lanes=4194304);i.isBackwards?(l.sibling=t.child,t.child=l):(r=i.last,r!==null?r.sibling=l:t.child=l,i.last=l)}return i.tail!==null?(t=i.tail,i.rendering=t,i.tail=t.sibling,i.renderingStartTime=st(),t.sibling=null,r=Qe.current,ze(Qe,n?r&1|2:r&1),t):(Ft(t),null);case 22:case 23:return N0(),n=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==n&&(t.flags|=8192),n&&t.mode&1?Zt&1073741824&&(Ft(t),t.subtreeFlags&6&&(t.flags|=8192)):Ft(t),null;case 24:return null;case 25:return null}throw Error(oe(156,t.tag))}function Sy(e,t){switch(r0(t),t.tag){case 1:return Gt(t.type)&&Dl(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return aa(),Ge(Vt),Ge(It),d0(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return u0(t),null;case 13:if(Ge(Qe),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(oe(340));na()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return Ge(Qe),null;case 4:return aa(),null;case 10:return i0(t.type._context),null;case 22:case 23:return N0(),null;case 24:return null;default:return null}}var nl=!1,Ot=!1,_y=typeof WeakSet=="function"?WeakSet:Set,ye=null;function Us(e,t){var r=e.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){tt(e,t,n)}else r.current=null}function gu(e,t,r){try{r()}catch(n){tt(e,t,n)}}var uf=!1;function Ey(e,t){if(eu=Ol,e=Ox(),e0(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var s=n.anchorOffset,i=n.focusNode;n=n.focusOffset;try{r.nodeType,i.nodeType}catch{r=null;break e}var l=0,o=-1,c=-1,d=0,u=0,f=e,h=null;t:for(;;){for(var m;f!==r||s!==0&&f.nodeType!==3||(o=l+s),f!==i||n!==0&&f.nodeType!==3||(c=l+n),f.nodeType===3&&(l+=f.nodeValue.length),(m=f.firstChild)!==null;)h=f,f=m;for(;;){if(f===e)break t;if(h===r&&++d===s&&(o=l),h===i&&++u===n&&(c=l),(m=f.nextSibling)!==null)break;f=h,h=f.parentNode}f=m}r=o===-1||c===-1?null:{start:o,end:c}}else r=null}r=r||{start:0,end:0}}else r=null;for(tu={focusedElem:e,selectionRange:r},Ol=!1,ye=t;ye!==null;)if(t=ye,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,ye=e;else for(;ye!==null;){t=ye;try{var p=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(p!==null){var x=p.memoizedProps,v=p.memoizedState,y=t.stateNode,g=y.getSnapshotBeforeUpdate(t.elementType===t.type?x:_r(t.type,x),v);y.__reactInternalSnapshotBeforeUpdate=g}break;case 3:var w=t.stateNode.containerInfo;w.nodeType===1?w.textContent="":w.nodeType===9&&w.documentElement&&w.removeChild(w.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(oe(163))}}catch(b){tt(t,t.return,b)}if(e=t.sibling,e!==null){e.return=t.return,ye=e;break}ye=t.return}return p=uf,uf=!1,p}function Xa(e,t,r){var n=t.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var s=n=n.next;do{if((s.tag&e)===e){var i=s.destroy;s.destroy=void 0,i!==void 0&&gu(t,r,i)}s=s.next}while(s!==n)}}function So(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var r=t=t.next;do{if((r.tag&e)===e){var n=r.create;r.destroy=n()}r=r.next}while(r!==t)}}function vu(e){var t=e.ref;if(t!==null){var r=e.stateNode;switch(e.tag){case 5:e=r;break;default:e=r}typeof t=="function"?t(e):t.current=e}}function Cm(e){var t=e.alternate;t!==null&&(e.alternate=null,Cm(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[Ur],delete t[hi],delete t[su],delete t[oy],delete t[cy])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function km(e){return e.tag===5||e.tag===3||e.tag===4}function df(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||km(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function yu(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.nodeType===8?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(r.nodeType===8?(t=r.parentNode,t.insertBefore(e,r)):(t=r,t.appendChild(e)),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=Il));else if(n!==4&&(e=e.child,e!==null))for(yu(e,t,r),e=e.sibling;e!==null;)yu(e,t,r),e=e.sibling}function wu(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(n!==4&&(e=e.child,e!==null))for(wu(e,t,r),e=e.sibling;e!==null;)wu(e,t,r),e=e.sibling}var bt=null,Er=!1;function mn(e,t,r){for(r=r.child;r!==null;)Am(e,t,r),r=r.sibling}function Am(e,t,r){if($r&&typeof $r.onCommitFiberUnmount=="function")try{$r.onCommitFiberUnmount(po,r)}catch{}switch(r.tag){case 5:Ot||Us(r,t);case 6:var n=bt,s=Er;bt=null,mn(e,t,r),bt=n,Er=s,bt!==null&&(Er?(e=bt,r=r.stateNode,e.nodeType===8?e.parentNode.removeChild(r):e.removeChild(r)):bt.removeChild(r.stateNode));break;case 18:bt!==null&&(Er?(e=bt,r=r.stateNode,e.nodeType===8?uc(e.parentNode,r):e.nodeType===1&&uc(e,r),oi(e)):uc(bt,r.stateNode));break;case 4:n=bt,s=Er,bt=r.stateNode.containerInfo,Er=!0,mn(e,t,r),bt=n,Er=s;break;case 0:case 11:case 14:case 15:if(!Ot&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){s=n=n.next;do{var i=s,l=i.destroy;i=i.tag,l!==void 0&&(i&2||i&4)&&gu(r,t,l),s=s.next}while(s!==n)}mn(e,t,r);break;case 1:if(!Ot&&(Us(r,t),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(o){tt(r,t,o)}mn(e,t,r);break;case 21:mn(e,t,r);break;case 22:r.mode&1?(Ot=(n=Ot)||r.memoizedState!==null,mn(e,t,r),Ot=n):mn(e,t,r);break;default:mn(e,t,r)}}function ff(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var r=e.stateNode;r===null&&(r=e.stateNode=new _y),t.forEach(function(n){var s=Iy.bind(null,e,n);r.has(n)||(r.add(n),n.then(s,s))})}}function Nr(e,t){var r=t.deletions;if(r!==null)for(var n=0;n<r.length;n++){var s=r[n];try{var i=e,l=t,o=l;e:for(;o!==null;){switch(o.tag){case 5:bt=o.stateNode,Er=!1;break e;case 3:bt=o.stateNode.containerInfo,Er=!0;break e;case 4:bt=o.stateNode.containerInfo,Er=!0;break e}o=o.return}if(bt===null)throw Error(oe(160));Am(i,l,s),bt=null,Er=!1;var c=s.alternate;c!==null&&(c.return=null),s.return=null}catch(d){tt(s,t,d)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)Fm(t,e),t=t.sibling}function Fm(e,t){var r=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(Nr(t,e),Dr(e),n&4){try{Xa(3,e,e.return),So(3,e)}catch(x){tt(e,e.return,x)}try{Xa(5,e,e.return)}catch(x){tt(e,e.return,x)}}break;case 1:Nr(t,e),Dr(e),n&512&&r!==null&&Us(r,r.return);break;case 5:if(Nr(t,e),Dr(e),n&512&&r!==null&&Us(r,r.return),e.flags&32){var s=e.stateNode;try{si(s,"")}catch(x){tt(e,e.return,x)}}if(n&4&&(s=e.stateNode,s!=null)){var i=e.memoizedProps,l=r!==null?r.memoizedProps:i,o=e.type,c=e.updateQueue;if(e.updateQueue=null,c!==null)try{o==="input"&&i.type==="radio"&&i.name!=null&&Zh(s,i),Hc(o,l);var d=Hc(o,i);for(l=0;l<c.length;l+=2){var u=c[l],f=c[l+1];u==="style"?sx(s,f):u==="dangerouslySetInnerHTML"?rx(s,f):u==="children"?si(s,f):zu(s,u,f,d)}switch(o){case"input":Bc(s,i);break;case"textarea":ex(s,i);break;case"select":var h=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!i.multiple;var m=i.value;m!=null?Hs(s,!!i.multiple,m,!1):h!==!!i.multiple&&(i.defaultValue!=null?Hs(s,!!i.multiple,i.defaultValue,!0):Hs(s,!!i.multiple,i.multiple?[]:"",!1))}s[hi]=i}catch(x){tt(e,e.return,x)}}break;case 6:if(Nr(t,e),Dr(e),n&4){if(e.stateNode===null)throw Error(oe(162));s=e.stateNode,i=e.memoizedProps;try{s.nodeValue=i}catch(x){tt(e,e.return,x)}}break;case 3:if(Nr(t,e),Dr(e),n&4&&r!==null&&r.memoizedState.isDehydrated)try{oi(t.containerInfo)}catch(x){tt(e,e.return,x)}break;case 4:Nr(t,e),Dr(e);break;case 13:Nr(t,e),Dr(e),s=e.child,s.flags&8192&&(i=s.memoizedState!==null,s.stateNode.isHidden=i,!i||s.alternate!==null&&s.alternate.memoizedState!==null||(w0=st())),n&4&&ff(e);break;case 22:if(u=r!==null&&r.memoizedState!==null,e.mode&1?(Ot=(d=Ot)||u,Nr(t,e),Ot=d):Nr(t,e),Dr(e),n&8192){if(d=e.memoizedState!==null,(e.stateNode.isHidden=d)&&!u&&e.mode&1)for(ye=e,u=e.child;u!==null;){for(f=ye=u;ye!==null;){switch(h=ye,m=h.child,h.tag){case 0:case 11:case 14:case 15:Xa(4,h,h.return);break;case 1:Us(h,h.return);var p=h.stateNode;if(typeof p.componentWillUnmount=="function"){n=h,r=h.return;try{t=n,p.props=t.memoizedProps,p.state=t.memoizedState,p.componentWillUnmount()}catch(x){tt(n,r,x)}}break;case 5:Us(h,h.return);break;case 22:if(h.memoizedState!==null){xf(f);continue}}m!==null?(m.return=h,ye=m):xf(f)}u=u.sibling}e:for(u=null,f=e;;){if(f.tag===5){if(u===null){u=f;try{s=f.stateNode,d?(i=s.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(o=f.stateNode,c=f.memoizedProps.style,l=c!=null&&c.hasOwnProperty("display")?c.display:null,o.style.display=nx("display",l))}catch(x){tt(e,e.return,x)}}}else if(f.tag===6){if(u===null)try{f.stateNode.nodeValue=d?"":f.memoizedProps}catch(x){tt(e,e.return,x)}}else if((f.tag!==22&&f.tag!==23||f.memoizedState===null||f===e)&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===e)break e;for(;f.sibling===null;){if(f.return===null||f.return===e)break e;u===f&&(u=null),f=f.return}u===f&&(u=null),f.sibling.return=f.return,f=f.sibling}}break;case 19:Nr(t,e),Dr(e),n&4&&ff(e);break;case 21:break;default:Nr(t,e),Dr(e)}}function Dr(e){var t=e.flags;if(t&2){try{e:{for(var r=e.return;r!==null;){if(km(r)){var n=r;break e}r=r.return}throw Error(oe(160))}switch(n.tag){case 5:var s=n.stateNode;n.flags&32&&(si(s,""),n.flags&=-33);var i=df(e);wu(e,i,s);break;case 3:case 4:var l=n.stateNode.containerInfo,o=df(e);yu(e,o,l);break;default:throw Error(oe(161))}}catch(c){tt(e,e.return,c)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function Ty(e,t,r){ye=e,Om(e)}function Om(e,t,r){for(var n=(e.mode&1)!==0;ye!==null;){var s=ye,i=s.child;if(s.tag===22&&n){var l=s.memoizedState!==null||nl;if(!l){var o=s.alternate,c=o!==null&&o.memoizedState!==null||Ot;o=nl;var d=Ot;if(nl=l,(Ot=c)&&!d)for(ye=s;ye!==null;)l=ye,c=l.child,l.tag===22&&l.memoizedState!==null?mf(s):c!==null?(c.return=l,ye=c):mf(s);for(;i!==null;)ye=i,Om(i),i=i.sibling;ye=s,nl=o,Ot=d}hf(e)}else s.subtreeFlags&8772&&i!==null?(i.return=s,ye=i):hf(e)}}function hf(e){for(;ye!==null;){var t=ye;if(t.flags&8772){var r=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:Ot||So(5,t);break;case 1:var n=t.stateNode;if(t.flags&4&&!Ot)if(r===null)n.componentDidMount();else{var s=t.elementType===t.type?r.memoizedProps:_r(t.type,r.memoizedProps);n.componentDidUpdate(s,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var i=t.updateQueue;i!==null&&Jd(t,i,n);break;case 3:var l=t.updateQueue;if(l!==null){if(r=null,t.child!==null)switch(t.child.tag){case 5:r=t.child.stateNode;break;case 1:r=t.child.stateNode}Jd(t,l,r)}break;case 5:var o=t.stateNode;if(r===null&&t.flags&4){r=o;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&r.focus();break;case"img":c.src&&(r.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var d=t.alternate;if(d!==null){var u=d.memoizedState;if(u!==null){var f=u.dehydrated;f!==null&&oi(f)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(oe(163))}Ot||t.flags&512&&vu(t)}catch(h){tt(t,t.return,h)}}if(t===e){ye=null;break}if(r=t.sibling,r!==null){r.return=t.return,ye=r;break}ye=t.return}}function xf(e){for(;ye!==null;){var t=ye;if(t===e){ye=null;break}var r=t.sibling;if(r!==null){r.return=t.return,ye=r;break}ye=t.return}}function mf(e){for(;ye!==null;){var t=ye;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{So(4,t)}catch(c){tt(t,r,c)}break;case 1:var n=t.stateNode;if(typeof n.componentDidMount=="function"){var s=t.return;try{n.componentDidMount()}catch(c){tt(t,s,c)}}var i=t.return;try{vu(t)}catch(c){tt(t,i,c)}break;case 5:var l=t.return;try{vu(t)}catch(c){tt(t,l,c)}}}catch(c){tt(t,t.return,c)}if(t===e){ye=null;break}var o=t.sibling;if(o!==null){o.return=t.return,ye=o;break}ye=t.return}}var Cy=Math.ceil,Gl=fn.ReactCurrentDispatcher,v0=fn.ReactCurrentOwner,pr=fn.ReactCurrentBatchConfig,Ae=0,vt=null,it=null,_t=0,Zt=0,zs=Hn(0),ft=0,yi=null,ds=0,_o=0,y0=0,Ka=null,Wt=null,w0=0,la=1/0,Xr=null,Xl=!1,bu=null,Pn=null,sl=!1,Sn=null,Kl=0,Ya=0,Nu=null,Sl=-1,_l=0;function Bt(){return Ae&6?st():Sl!==-1?Sl:Sl=st()}function Rn(e){return e.mode&1?Ae&2&&_t!==0?_t&-_t:dy.transition!==null?(_l===0&&(_l=px()),_l):(e=De,e!==0||(e=window.event,e=e===void 0?16:jx(e.type)),e):1}function Or(e,t,r,n){if(50<Ya)throw Ya=0,Nu=null,Error(oe(185));Ai(e,r,n),(!(Ae&2)||e!==vt)&&(e===vt&&(!(Ae&2)&&(_o|=r),ft===4&&Nn(e,_t)),Xt(e,n),r===1&&Ae===0&&!(t.mode&1)&&(la=st()+500,bo&&Vn()))}function Xt(e,t){var r=e.callbackNode;dv(e,t);var n=Fl(e,e===vt?_t:0);if(n===0)r!==null&&jd(r),e.callbackNode=null,e.callbackPriority=0;else if(t=n&-n,e.callbackPriority!==t){if(r!=null&&jd(r),t===1)e.tag===0?uy(pf.bind(null,e)):$x(pf.bind(null,e)),iy(function(){!(Ae&6)&&Vn()}),r=null;else{switch(gx(n)){case 1:r=Gu;break;case 4:r=xx;break;case 16:r=Al;break;case 536870912:r=mx;break;default:r=Al}r=Um(r,Pm.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function Pm(e,t){if(Sl=-1,_l=0,Ae&6)throw Error(oe(327));var r=e.callbackNode;if(Ys()&&e.callbackNode!==r)return null;var n=Fl(e,e===vt?_t:0);if(n===0)return null;if(n&30||n&e.expiredLanes||t)t=Yl(e,n);else{t=n;var s=Ae;Ae|=2;var i=Im();(vt!==e||_t!==t)&&(Xr=null,la=st()+500,as(e,t));do try{Fy();break}catch(o){Rm(e,o)}while(!0);a0(),Gl.current=i,Ae=s,it!==null?t=0:(vt=null,_t=0,t=ft)}if(t!==0){if(t===2&&(s=Yc(e),s!==0&&(n=s,t=ju(e,s))),t===1)throw r=yi,as(e,0),Nn(e,n),Xt(e,st()),r;if(t===6)Nn(e,n);else{if(s=e.current.alternate,!(n&30)&&!ky(s)&&(t=Yl(e,n),t===2&&(i=Yc(e),i!==0&&(n=i,t=ju(e,i))),t===1))throw r=yi,as(e,0),Nn(e,n),Xt(e,st()),r;switch(e.finishedWork=s,e.finishedLanes=n,t){case 0:case 1:throw Error(oe(345));case 2:Zn(e,Wt,Xr);break;case 3:if(Nn(e,n),(n&130023424)===n&&(t=w0+500-st(),10<t)){if(Fl(e,0)!==0)break;if(s=e.suspendedLanes,(s&n)!==n){Bt(),e.pingedLanes|=e.suspendedLanes&s;break}e.timeoutHandle=nu(Zn.bind(null,e,Wt,Xr),t);break}Zn(e,Wt,Xr);break;case 4:if(Nn(e,n),(n&4194240)===n)break;for(t=e.eventTimes,s=-1;0<n;){var l=31-Fr(n);i=1<<l,l=t[l],l>s&&(s=l),n&=~i}if(n=s,n=st()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*Cy(n/1960))-n,10<n){e.timeoutHandle=nu(Zn.bind(null,e,Wt,Xr),n);break}Zn(e,Wt,Xr);break;case 5:Zn(e,Wt,Xr);break;default:throw Error(oe(329))}}}return Xt(e,st()),e.callbackNode===r?Pm.bind(null,e):null}function ju(e,t){var r=Ka;return e.current.memoizedState.isDehydrated&&(as(e,t).flags|=256),e=Yl(e,t),e!==2&&(t=Wt,Wt=r,t!==null&&Su(t)),e}function Su(e){Wt===null?Wt=e:Wt.push.apply(Wt,e)}function ky(e){for(var t=e;;){if(t.flags&16384){var r=t.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var s=r[n],i=s.getSnapshot;s=s.value;try{if(!Rr(i(),s))return!1}catch{return!1}}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Nn(e,t){for(t&=~y0,t&=~_o,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-Fr(t),n=1<<r;e[r]=-1,t&=~n}}function pf(e){if(Ae&6)throw Error(oe(327));Ys();var t=Fl(e,0);if(!(t&1))return Xt(e,st()),null;var r=Yl(e,t);if(e.tag!==0&&r===2){var n=Yc(e);n!==0&&(t=n,r=ju(e,n))}if(r===1)throw r=yi,as(e,0),Nn(e,t),Xt(e,st()),r;if(r===6)throw Error(oe(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Zn(e,Wt,Xr),Xt(e,st()),null}function b0(e,t){var r=Ae;Ae|=1;try{return e(t)}finally{Ae=r,Ae===0&&(la=st()+500,bo&&Vn())}}function fs(e){Sn!==null&&Sn.tag===0&&!(Ae&6)&&Ys();var t=Ae;Ae|=1;var r=pr.transition,n=De;try{if(pr.transition=null,De=1,e)return e()}finally{De=n,pr.transition=r,Ae=t,!(Ae&6)&&Vn()}}function N0(){Zt=zs.current,Ge(zs)}function as(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(r!==-1&&(e.timeoutHandle=-1,ay(r)),it!==null)for(r=it.return;r!==null;){var n=r;switch(r0(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&Dl();break;case 3:aa(),Ge(Vt),Ge(It),d0();break;case 5:u0(n);break;case 4:aa();break;case 13:Ge(Qe);break;case 19:Ge(Qe);break;case 10:i0(n.type._context);break;case 22:case 23:N0()}r=r.return}if(vt=e,it=e=In(e.current,null),_t=Zt=t,ft=0,yi=null,y0=_o=ds=0,Wt=Ka=null,ns!==null){for(t=0;t<ns.length;t++)if(r=ns[t],n=r.interleaved,n!==null){r.interleaved=null;var s=n.next,i=r.pending;if(i!==null){var l=i.next;i.next=s,n.next=l}r.pending=n}ns=null}return e}function Rm(e,t){do{var r=it;try{if(a0(),bl.current=Vl,Hl){for(var n=Ze.memoizedState;n!==null;){var s=n.queue;s!==null&&(s.pending=null),n=n.next}Hl=!1}if(us=0,xt=dt=Ze=null,Ga=!1,pi=0,v0.current=null,r===null||r.return===null){ft=1,yi=t,it=null;break}e:{var i=e,l=r.return,o=r,c=t;if(t=_t,o.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var d=c,u=o,f=u.tag;if(!(u.mode&1)&&(f===0||f===11||f===15)){var h=u.alternate;h?(u.updateQueue=h.updateQueue,u.memoizedState=h.memoizedState,u.lanes=h.lanes):(u.updateQueue=null,u.memoizedState=null)}var m=rf(l);if(m!==null){m.flags&=-257,nf(m,l,o,i,t),m.mode&1&&tf(i,d,t),t=m,c=d;var p=t.updateQueue;if(p===null){var x=new Set;x.add(c),t.updateQueue=x}else p.add(c);break e}else{if(!(t&1)){tf(i,d,t),j0();break e}c=Error(oe(426))}}else if(Ye&&o.mode&1){var v=rf(l);if(v!==null){!(v.flags&65536)&&(v.flags|=256),nf(v,l,o,i,t),n0(ia(c,o));break e}}i=c=ia(c,o),ft!==4&&(ft=2),Ka===null?Ka=[i]:Ka.push(i),i=l;do{switch(i.tag){case 3:i.flags|=65536,t&=-t,i.lanes|=t;var y=gm(i,c,t);Yd(i,y);break e;case 1:o=c;var g=i.type,w=i.stateNode;if(!(i.flags&128)&&(typeof g.getDerivedStateFromError=="function"||w!==null&&typeof w.componentDidCatch=="function"&&(Pn===null||!Pn.has(w)))){i.flags|=65536,t&=-t,i.lanes|=t;var b=vm(i,o,t);Yd(i,b);break e}}i=i.return}while(i!==null)}Lm(r)}catch(P){t=P,it===r&&r!==null&&(it=r=r.return);continue}break}while(!0)}function Im(){var e=Gl.current;return Gl.current=Vl,e===null?Vl:e}function j0(){(ft===0||ft===3||ft===2)&&(ft=4),vt===null||!(ds&268435455)&&!(_o&268435455)||Nn(vt,_t)}function Yl(e,t){var r=Ae;Ae|=2;var n=Im();(vt!==e||_t!==t)&&(Xr=null,as(e,t));do try{Ay();break}catch(s){Rm(e,s)}while(!0);if(a0(),Ae=r,Gl.current=n,it!==null)throw Error(oe(261));return vt=null,_t=0,ft}function Ay(){for(;it!==null;)Dm(it)}function Fy(){for(;it!==null&&!rv();)Dm(it)}function Dm(e){var t=Bm(e.alternate,e,Zt);e.memoizedProps=e.pendingProps,t===null?Lm(e):it=t,v0.current=null}function Lm(e){var t=e;do{var r=t.alternate;if(e=t.return,t.flags&32768){if(r=Sy(r,t),r!==null){r.flags&=32767,it=r;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{ft=6,it=null;return}}else if(r=jy(r,t,Zt),r!==null){it=r;return}if(t=t.sibling,t!==null){it=t;return}it=t=e}while(t!==null);ft===0&&(ft=5)}function Zn(e,t,r){var n=De,s=pr.transition;try{pr.transition=null,De=1,Oy(e,t,r,n)}finally{pr.transition=s,De=n}return null}function Oy(e,t,r,n){do Ys();while(Sn!==null);if(Ae&6)throw Error(oe(327));r=e.finishedWork;var s=e.finishedLanes;if(r===null)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(oe(177));e.callbackNode=null,e.callbackPriority=0;var i=r.lanes|r.childLanes;if(fv(e,i),e===vt&&(it=vt=null,_t=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||sl||(sl=!0,Um(Al,function(){return Ys(),null})),i=(r.flags&15990)!==0,r.subtreeFlags&15990||i){i=pr.transition,pr.transition=null;var l=De;De=1;var o=Ae;Ae|=4,v0.current=null,Ey(e,r),Fm(r,e),Qv(tu),Ol=!!eu,tu=eu=null,e.current=r,Ty(r),nv(),Ae=o,De=l,pr.transition=i}else e.current=r;if(sl&&(sl=!1,Sn=e,Kl=s),i=e.pendingLanes,i===0&&(Pn=null),iv(r.stateNode),Xt(e,st()),t!==null)for(n=e.onRecoverableError,r=0;r<t.length;r++)s=t[r],n(s.value,{componentStack:s.stack,digest:s.digest});if(Xl)throw Xl=!1,e=bu,bu=null,e;return Kl&1&&e.tag!==0&&Ys(),i=e.pendingLanes,i&1?e===Nu?Ya++:(Ya=0,Nu=e):Ya=0,Vn(),null}function Ys(){if(Sn!==null){var e=gx(Kl),t=pr.transition,r=De;try{if(pr.transition=null,De=16>e?16:e,Sn===null)var n=!1;else{if(e=Sn,Sn=null,Kl=0,Ae&6)throw Error(oe(331));var s=Ae;for(Ae|=4,ye=e.current;ye!==null;){var i=ye,l=i.child;if(ye.flags&16){var o=i.deletions;if(o!==null){for(var c=0;c<o.length;c++){var d=o[c];for(ye=d;ye!==null;){var u=ye;switch(u.tag){case 0:case 11:case 15:Xa(8,u,i)}var f=u.child;if(f!==null)f.return=u,ye=f;else for(;ye!==null;){u=ye;var h=u.sibling,m=u.return;if(Cm(u),u===d){ye=null;break}if(h!==null){h.return=m,ye=h;break}ye=m}}}var p=i.alternate;if(p!==null){var x=p.child;if(x!==null){p.child=null;do{var v=x.sibling;x.sibling=null,x=v}while(x!==null)}}ye=i}}if(i.subtreeFlags&2064&&l!==null)l.return=i,ye=l;else e:for(;ye!==null;){if(i=ye,i.flags&2048)switch(i.tag){case 0:case 11:case 15:Xa(9,i,i.return)}var y=i.sibling;if(y!==null){y.return=i.return,ye=y;break e}ye=i.return}}var g=e.current;for(ye=g;ye!==null;){l=ye;var w=l.child;if(l.subtreeFlags&2064&&w!==null)w.return=l,ye=w;else e:for(l=g;ye!==null;){if(o=ye,o.flags&2048)try{switch(o.tag){case 0:case 11:case 15:So(9,o)}}catch(P){tt(o,o.return,P)}if(o===l){ye=null;break e}var b=o.sibling;if(b!==null){b.return=o.return,ye=b;break e}ye=o.return}}if(Ae=s,Vn(),$r&&typeof $r.onPostCommitFiberRoot=="function")try{$r.onPostCommitFiberRoot(po,e)}catch{}n=!0}return n}finally{De=r,pr.transition=t}}return!1}function gf(e,t,r){t=ia(r,t),t=gm(e,t,1),e=On(e,t,1),t=Bt(),e!==null&&(Ai(e,1,t),Xt(e,t))}function tt(e,t,r){if(e.tag===3)gf(e,e,r);else for(;t!==null;){if(t.tag===3){gf(t,e,r);break}else if(t.tag===1){var n=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(Pn===null||!Pn.has(n))){e=ia(r,e),e=vm(t,e,1),t=On(t,e,1),e=Bt(),t!==null&&(Ai(t,1,e),Xt(t,e));break}}t=t.return}}function Py(e,t,r){var n=e.pingCache;n!==null&&n.delete(t),t=Bt(),e.pingedLanes|=e.suspendedLanes&r,vt===e&&(_t&r)===r&&(ft===4||ft===3&&(_t&130023424)===_t&&500>st()-w0?as(e,0):y0|=r),Xt(e,t)}function Mm(e,t){t===0&&(e.mode&1?(t=Ki,Ki<<=1,!(Ki&130023424)&&(Ki=4194304)):t=1);var r=Bt();e=on(e,t),e!==null&&(Ai(e,t,r),Xt(e,r))}function Ry(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),Mm(e,r)}function Iy(e,t){var r=0;switch(e.tag){case 13:var n=e.stateNode,s=e.memoizedState;s!==null&&(r=s.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(oe(314))}n!==null&&n.delete(t),Mm(e,r)}var Bm;Bm=function(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps||Vt.current)Ht=!0;else{if(!(e.lanes&r)&&!(t.flags&128))return Ht=!1,Ny(e,t,r);Ht=!!(e.flags&131072)}else Ht=!1,Ye&&t.flags&1048576&&Wx(t,Bl,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;jl(e,t),e=t.pendingProps;var s=ra(t,It.current);Ks(t,r),s=h0(null,t,n,e,s,r);var i=x0();return t.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Gt(n)?(i=!0,Ll(t)):i=!1,t.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,o0(t),s.updater=jo,t.stateNode=s,s._reactInternals=t,uu(t,n,e,r),t=hu(null,t,n,!0,i,r)):(t.tag=0,Ye&&i&&t0(t),Dt(null,t,s,r),t=t.child),t;case 16:n=t.elementType;e:{switch(jl(e,t),e=t.pendingProps,s=n._init,n=s(n._payload),t.type=n,s=t.tag=Ly(n),e=_r(n,e),s){case 0:t=fu(null,t,n,e,r);break e;case 1:t=lf(null,t,n,e,r);break e;case 11:t=sf(null,t,n,e,r);break e;case 14:t=af(null,t,n,_r(n.type,e),r);break e}throw Error(oe(306,n,""))}return t;case 0:return n=t.type,s=t.pendingProps,s=t.elementType===n?s:_r(n,s),fu(e,t,n,s,r);case 1:return n=t.type,s=t.pendingProps,s=t.elementType===n?s:_r(n,s),lf(e,t,n,s,r);case 3:e:{if(Nm(t),e===null)throw Error(oe(387));n=t.pendingProps,i=t.memoizedState,s=i.element,Yx(e,t),$l(t,n,null,r);var l=t.memoizedState;if(n=l.element,i.isDehydrated)if(i={element:n,isDehydrated:!1,cache:l.cache,pendingSuspenseBoundaries:l.pendingSuspenseBoundaries,transitions:l.transitions},t.updateQueue.baseState=i,t.memoizedState=i,t.flags&256){s=ia(Error(oe(423)),t),t=of(e,t,n,r,s);break e}else if(n!==s){s=ia(Error(oe(424)),t),t=of(e,t,n,r,s);break e}else for(nr=Fn(t.stateNode.containerInfo.firstChild),sr=t,Ye=!0,Tr=null,r=Xx(t,null,n,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(na(),n===s){t=cn(e,t,r);break e}Dt(e,t,n,r)}t=t.child}return t;case 5:return Jx(t),e===null&&lu(t),n=t.type,s=t.pendingProps,i=e!==null?e.memoizedProps:null,l=s.children,ru(n,s)?l=null:i!==null&&ru(n,i)&&(t.flags|=32),bm(e,t),Dt(e,t,l,r),t.child;case 6:return e===null&&lu(t),null;case 13:return jm(e,t,r);case 4:return c0(t,t.stateNode.containerInfo),n=t.pendingProps,e===null?t.child=sa(t,null,n,r):Dt(e,t,n,r),t.child;case 11:return n=t.type,s=t.pendingProps,s=t.elementType===n?s:_r(n,s),sf(e,t,n,s,r);case 7:return Dt(e,t,t.pendingProps,r),t.child;case 8:return Dt(e,t,t.pendingProps.children,r),t.child;case 12:return Dt(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(n=t.type._context,s=t.pendingProps,i=t.memoizedProps,l=s.value,ze(Ul,n._currentValue),n._currentValue=l,i!==null)if(Rr(i.value,l)){if(i.children===s.children&&!Vt.current){t=cn(e,t,r);break e}}else for(i=t.child,i!==null&&(i.return=t);i!==null;){var o=i.dependencies;if(o!==null){l=i.child;for(var c=o.firstContext;c!==null;){if(c.context===n){if(i.tag===1){c=tn(-1,r&-r),c.tag=2;var d=i.updateQueue;if(d!==null){d=d.shared;var u=d.pending;u===null?c.next=c:(c.next=u.next,u.next=c),d.pending=c}}i.lanes|=r,c=i.alternate,c!==null&&(c.lanes|=r),ou(i.return,r,t),o.lanes|=r;break}c=c.next}}else if(i.tag===10)l=i.type===t.type?null:i.child;else if(i.tag===18){if(l=i.return,l===null)throw Error(oe(341));l.lanes|=r,o=l.alternate,o!==null&&(o.lanes|=r),ou(l,r,t),l=i.sibling}else l=i.child;if(l!==null)l.return=i;else for(l=i;l!==null;){if(l===t){l=null;break}if(i=l.sibling,i!==null){i.return=l.return,l=i;break}l=l.return}i=l}Dt(e,t,s.children,r),t=t.child}return t;case 9:return s=t.type,n=t.pendingProps.children,Ks(t,r),s=gr(s),n=n(s),t.flags|=1,Dt(e,t,n,r),t.child;case 14:return n=t.type,s=_r(n,t.pendingProps),s=_r(n.type,s),af(e,t,n,s,r);case 15:return ym(e,t,t.type,t.pendingProps,r);case 17:return n=t.type,s=t.pendingProps,s=t.elementType===n?s:_r(n,s),jl(e,t),t.tag=1,Gt(n)?(e=!0,Ll(t)):e=!1,Ks(t,r),pm(t,n,s),uu(t,n,s,r),hu(null,t,n,!0,e,r);case 19:return Sm(e,t,r);case 22:return wm(e,t,r)}throw Error(oe(156,t.tag))};function Um(e,t){return hx(e,t)}function Dy(e,t,r,n){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function mr(e,t,r,n){return new Dy(e,t,r,n)}function S0(e){return e=e.prototype,!(!e||!e.isReactComponent)}function Ly(e){if(typeof e=="function")return S0(e)?1:0;if(e!=null){if(e=e.$$typeof,e===Wu)return 11;if(e===Hu)return 14}return 2}function In(e,t){var r=e.alternate;return r===null?(r=mr(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&14680064,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function El(e,t,r,n,s,i){var l=2;if(n=e,typeof e=="function")S0(e)&&(l=1);else if(typeof e=="string")l=5;else e:switch(e){case Fs:return is(r.children,s,i,t);case $u:l=8,s|=8;break;case Rc:return e=mr(12,r,t,s|2),e.elementType=Rc,e.lanes=i,e;case Ic:return e=mr(13,r,t,s),e.elementType=Ic,e.lanes=i,e;case Dc:return e=mr(19,r,t,s),e.elementType=Dc,e.lanes=i,e;case Jh:return Eo(r,s,i,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case Kh:l=10;break e;case Yh:l=9;break e;case Wu:l=11;break e;case Hu:l=14;break e;case yn:l=16,n=null;break e}throw Error(oe(130,e==null?e:typeof e,""))}return t=mr(l,r,t,s),t.elementType=e,t.type=n,t.lanes=i,t}function is(e,t,r,n){return e=mr(7,e,n,t),e.lanes=r,e}function Eo(e,t,r,n){return e=mr(22,e,n,t),e.elementType=Jh,e.lanes=r,e.stateNode={isHidden:!1},e}function vc(e,t,r){return e=mr(6,e,null,t),e.lanes=r,e}function yc(e,t,r){return t=mr(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function My(e,t,r,n,s){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Zo(0),this.expirationTimes=Zo(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Zo(0),this.identifierPrefix=n,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function _0(e,t,r,n,s,i,l,o,c){return e=new My(e,t,r,o,c),t===1?(t=1,i===!0&&(t|=8)):t=0,i=mr(3,null,null,t),e.current=i,i.stateNode=e,i.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},o0(i),e}function By(e,t,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:As,key:n==null?null:""+n,children:e,containerInfo:t,implementation:r}}function zm(e){if(!e)return Mn;e=e._reactInternals;e:{if(gs(e)!==e||e.tag!==1)throw Error(oe(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Gt(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(oe(171))}if(e.tag===1){var r=e.type;if(Gt(r))return zx(e,r,t)}return t}function $m(e,t,r,n,s,i,l,o,c){return e=_0(r,n,!0,e,s,i,l,o,c),e.context=zm(null),r=e.current,n=Bt(),s=Rn(r),i=tn(n,s),i.callback=t??null,On(r,i,s),e.current.lanes=s,Ai(e,s,n),Xt(e,n),e}function To(e,t,r,n){var s=t.current,i=Bt(),l=Rn(s);return r=zm(r),t.context===null?t.context=r:t.pendingContext=r,t=tn(i,l),t.payload={element:e},n=n===void 0?null:n,n!==null&&(t.callback=n),e=On(s,t,l),e!==null&&(Or(e,s,l,i),wl(e,s,l)),l}function Jl(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function vf(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function E0(e,t){vf(e,t),(e=e.alternate)&&vf(e,t)}function Uy(){return null}var Wm=typeof reportError=="function"?reportError:function(e){console.error(e)};function T0(e){this._internalRoot=e}Co.prototype.render=T0.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(oe(409));To(e,t,null,null)};Co.prototype.unmount=T0.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;fs(function(){To(null,e,null,null)}),t[ln]=null}};function Co(e){this._internalRoot=e}Co.prototype.unstable_scheduleHydration=function(e){if(e){var t=wx();e={blockedOn:null,target:e,priority:t};for(var r=0;r<bn.length&&t!==0&&t<bn[r].priority;r++);bn.splice(r,0,e),r===0&&Nx(e)}};function C0(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function ko(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function yf(){}function zy(e,t,r,n,s){if(s){if(typeof n=="function"){var i=n;n=function(){var d=Jl(l);i.call(d)}}var l=$m(t,n,e,0,null,!1,!1,"",yf);return e._reactRootContainer=l,e[ln]=l.current,di(e.nodeType===8?e.parentNode:e),fs(),l}for(;s=e.lastChild;)e.removeChild(s);if(typeof n=="function"){var o=n;n=function(){var d=Jl(c);o.call(d)}}var c=_0(e,0,!1,null,null,!1,!1,"",yf);return e._reactRootContainer=c,e[ln]=c.current,di(e.nodeType===8?e.parentNode:e),fs(function(){To(t,c,r,n)}),c}function Ao(e,t,r,n,s){var i=r._reactRootContainer;if(i){var l=i;if(typeof s=="function"){var o=s;s=function(){var c=Jl(l);o.call(c)}}To(t,l,e,s)}else l=zy(r,t,e,s,n);return Jl(l)}vx=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=La(t.pendingLanes);r!==0&&(Xu(t,r|1),Xt(t,st()),!(Ae&6)&&(la=st()+500,Vn()))}break;case 13:fs(function(){var n=on(e,1);if(n!==null){var s=Bt();Or(n,e,1,s)}}),E0(e,1)}};Ku=function(e){if(e.tag===13){var t=on(e,134217728);if(t!==null){var r=Bt();Or(t,e,134217728,r)}E0(e,134217728)}};yx=function(e){if(e.tag===13){var t=Rn(e),r=on(e,t);if(r!==null){var n=Bt();Or(r,e,t,n)}E0(e,t)}};wx=function(){return De};bx=function(e,t){var r=De;try{return De=e,t()}finally{De=r}};Gc=function(e,t,r){switch(t){case"input":if(Bc(e,r),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var n=r[t];if(n!==e&&n.form===e.form){var s=wo(n);if(!s)throw Error(oe(90));Qh(n),Bc(n,s)}}}break;case"textarea":ex(e,r);break;case"select":t=r.value,t!=null&&Hs(e,!!r.multiple,t,!1)}};lx=b0;ox=fs;var $y={usingClientEntryPoint:!1,Events:[Oi,Is,wo,ax,ix,b0]},Fa={findFiberByHostInstance:rs,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},Wy={bundleType:Fa.bundleType,version:Fa.version,rendererPackageName:Fa.rendererPackageName,rendererConfig:Fa.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:fn.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=dx(e),e===null?null:e.stateNode},findFiberByHostInstance:Fa.findFiberByHostInstance||Uy,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var al=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!al.isDisabled&&al.supportsFiber)try{po=al.inject(Wy),$r=al}catch{}}or.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=$y;or.createPortal=function(e,t){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!C0(t))throw Error(oe(200));return By(e,t,null,r)};or.createRoot=function(e,t){if(!C0(e))throw Error(oe(299));var r=!1,n="",s=Wm;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(n=t.identifierPrefix),t.onRecoverableError!==void 0&&(s=t.onRecoverableError)),t=_0(e,1,!1,null,null,r,!1,n,s),e[ln]=t.current,di(e.nodeType===8?e.parentNode:e),new T0(t)};or.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(oe(188)):(e=Object.keys(e).join(","),Error(oe(268,e)));return e=dx(t),e=e===null?null:e.stateNode,e};or.flushSync=function(e){return fs(e)};or.hydrate=function(e,t,r){if(!ko(t))throw Error(oe(200));return Ao(null,e,t,!0,r)};or.hydrateRoot=function(e,t,r){if(!C0(e))throw Error(oe(405));var n=r!=null&&r.hydratedSources||null,s=!1,i="",l=Wm;if(r!=null&&(r.unstable_strictMode===!0&&(s=!0),r.identifierPrefix!==void 0&&(i=r.identifierPrefix),r.onRecoverableError!==void 0&&(l=r.onRecoverableError)),t=$m(t,null,e,1,r??null,s,!1,i,l),e[ln]=t.current,di(e),n)for(e=0;e<n.length;e++)r=n[e],s=r._getVersion,s=s(r._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[r,s]:t.mutableSourceEagerHydrationData.push(r,s);return new Co(t)};or.render=function(e,t,r){if(!ko(t))throw Error(oe(200));return Ao(null,e,t,!1,r)};or.unmountComponentAtNode=function(e){if(!ko(e))throw Error(oe(40));return e._reactRootContainer?(fs(function(){Ao(null,null,e,!1,function(){e._reactRootContainer=null,e[ln]=null})}),!0):!1};or.unstable_batchedUpdates=b0;or.unstable_renderSubtreeIntoContainer=function(e,t,r,n){if(!ko(r))throw Error(oe(200));if(e==null||e._reactInternals===void 0)throw Error(oe(38));return Ao(e,t,r,!1,n)};or.version="18.3.1-next-f1338f8080-20240426";function Hm(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Hm)}catch(e){console.error(e)}}Hm(),Hh.exports=or;var Hy=Hh.exports,wf=Hy;Oc.createRoot=wf.createRoot,Oc.hydrateRoot=wf.hydrateRoot;/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function wi(){return wi=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},wi.apply(this,arguments)}var _n;(function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"})(_n||(_n={}));const bf="popstate";function Vy(e){e===void 0&&(e={});function t(n,s){let{pathname:i,search:l,hash:o}=n.location;return _u("",{pathname:i,search:l,hash:o},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function r(n,s){return typeof s=="string"?s:ql(s)}return Xy(t,r,null,e)}function lt(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function Vm(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function Gy(){return Math.random().toString(36).substr(2,8)}function Nf(e,t){return{usr:e.state,key:e.key,idx:t}}function _u(e,t,r,n){return r===void 0&&(r=null),wi({pathname:typeof e=="string"?e:e.pathname,search:"",hash:""},typeof t=="string"?ha(t):t,{state:r,key:t&&t.key||n||Gy()})}function ql(e){let{pathname:t="/",search:r="",hash:n=""}=e;return r&&r!=="?"&&(t+=r.charAt(0)==="?"?r:"?"+r),n&&n!=="#"&&(t+=n.charAt(0)==="#"?n:"#"+n),t}function ha(e){let t={};if(e){let r=e.indexOf("#");r>=0&&(t.hash=e.substr(r),e=e.substr(0,r));let n=e.indexOf("?");n>=0&&(t.search=e.substr(n),e=e.substr(0,n)),e&&(t.pathname=e)}return t}function Xy(e,t,r,n){n===void 0&&(n={});let{window:s=document.defaultView,v5Compat:i=!1}=n,l=s.history,o=_n.Pop,c=null,d=u();d==null&&(d=0,l.replaceState(wi({},l.state,{idx:d}),""));function u(){return(l.state||{idx:null}).idx}function f(){o=_n.Pop;let v=u(),y=v==null?null:v-d;d=v,c&&c({action:o,location:x.location,delta:y})}function h(v,y){o=_n.Push;let g=_u(x.location,v,y);d=u()+1;let w=Nf(g,d),b=x.createHref(g);try{l.pushState(w,"",b)}catch(P){if(P instanceof DOMException&&P.name==="DataCloneError")throw P;s.location.assign(b)}i&&c&&c({action:o,location:x.location,delta:1})}function m(v,y){o=_n.Replace;let g=_u(x.location,v,y);d=u();let w=Nf(g,d),b=x.createHref(g);l.replaceState(w,"",b),i&&c&&c({action:o,location:x.location,delta:0})}function p(v){let y=s.location.origin!=="null"?s.location.origin:s.location.href,g=typeof v=="string"?v:ql(v);return g=g.replace(/ $/,"%20"),lt(y,"No window.location.(origin|href) available to create URL for href: "+g),new URL(g,y)}let x={get action(){return o},get location(){return e(s,l)},listen(v){if(c)throw new Error("A history only accepts one active listener");return s.addEventListener(bf,f),c=v,()=>{s.removeEventListener(bf,f),c=null}},createHref(v){return t(s,v)},createURL:p,encodeLocation(v){let y=p(v);return{pathname:y.pathname,search:y.search,hash:y.hash}},push:h,replace:m,go(v){return l.go(v)}};return x}var jf;(function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"})(jf||(jf={}));function Ky(e,t,r){return r===void 0&&(r="/"),Yy(e,t,r)}function Yy(e,t,r,n){let s=typeof t=="string"?ha(t):t,i=k0(s.pathname||"/",r);if(i==null)return null;let l=Gm(e);Jy(l);let o=null;for(let c=0;o==null&&c<l.length;++c){let d=o2(i);o=a2(l[c],d)}return o}function Gm(e,t,r,n){t===void 0&&(t=[]),r===void 0&&(r=[]),n===void 0&&(n="");let s=(i,l,o)=>{let c={relativePath:o===void 0?i.path||"":o,caseSensitive:i.caseSensitive===!0,childrenIndex:l,route:i};c.relativePath.startsWith("/")&&(lt(c.relativePath.startsWith(n),'Absolute route path "'+c.relativePath+'" nested under path '+('"'+n+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),c.relativePath=c.relativePath.slice(n.length));let d=Dn([n,c.relativePath]),u=r.concat(c);i.children&&i.children.length>0&&(lt(i.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+d+'".')),Gm(i.children,t,u,d)),!(i.path==null&&!i.index)&&t.push({path:d,score:n2(d,i.index),routesMeta:u})};return e.forEach((i,l)=>{var o;if(i.path===""||!((o=i.path)!=null&&o.includes("?")))s(i,l);else for(let c of Xm(i.path))s(i,l,c)}),t}function Xm(e){let t=e.split("/");if(t.length===0)return[];let[r,...n]=t,s=r.endsWith("?"),i=r.replace(/\?$/,"");if(n.length===0)return s?[i,""]:[i];let l=Xm(n.join("/")),o=[];return o.push(...l.map(c=>c===""?i:[i,c].join("/"))),s&&o.push(...l),o.map(c=>e.startsWith("/")&&c===""?"/":c)}function Jy(e){e.sort((t,r)=>t.score!==r.score?r.score-t.score:s2(t.routesMeta.map(n=>n.childrenIndex),r.routesMeta.map(n=>n.childrenIndex)))}const qy=/^:[\w-]+$/,Qy=3,Zy=2,e2=1,t2=10,r2=-2,Sf=e=>e==="*";function n2(e,t){let r=e.split("/"),n=r.length;return r.some(Sf)&&(n+=r2),t&&(n+=Zy),r.filter(s=>!Sf(s)).reduce((s,i)=>s+(qy.test(i)?Qy:i===""?e2:t2),n)}function s2(e,t){return e.length===t.length&&e.slice(0,-1).every((n,s)=>n===t[s])?e[e.length-1]-t[t.length-1]:0}function a2(e,t,r){let{routesMeta:n}=e,s={},i="/",l=[];for(let o=0;o<n.length;++o){let c=n[o],d=o===n.length-1,u=i==="/"?t:t.slice(i.length)||"/",f=i2({path:c.relativePath,caseSensitive:c.caseSensitive,end:d},u),h=c.route;if(!f)return null;Object.assign(s,f.params),l.push({params:s,pathname:Dn([i,f.pathname]),pathnameBase:f2(Dn([i,f.pathnameBase])),route:h}),f.pathnameBase!=="/"&&(i=Dn([i,f.pathnameBase]))}return l}function i2(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[r,n]=l2(e.path,e.caseSensitive,e.end),s=t.match(r);if(!s)return null;let i=s[0],l=i.replace(/(.)\/+$/,"$1"),o=s.slice(1);return{params:n.reduce((d,u,f)=>{let{paramName:h,isOptional:m}=u;if(h==="*"){let x=o[f]||"";l=i.slice(0,i.length-x.length).replace(/(.)\/+$/,"$1")}const p=o[f];return m&&!p?d[h]=void 0:d[h]=(p||"").replace(/%2F/g,"/"),d},{}),pathname:i,pathnameBase:l,pattern:e}}function l2(e,t,r){t===void 0&&(t=!1),r===void 0&&(r=!0),Vm(e==="*"||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were '+('"'+e.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+e.replace(/\*$/,"/*")+'".'));let n=[],s="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(l,o,c)=>(n.push({paramName:o,isOptional:c!=null}),c?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(n.push({paramName:"*"}),s+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?s+="\\/*$":e!==""&&e!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,t?void 0:"i"),n]}function o2(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return Vm(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+t+").")),e}}function k0(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let r=t.endsWith("/")?t.length-1:t.length,n=e.charAt(r);return n&&n!=="/"?null:e.slice(r)||"/"}function c2(e,t){t===void 0&&(t="/");let{pathname:r,search:n="",hash:s=""}=typeof e=="string"?ha(e):e;return{pathname:r?r.startsWith("/")?r:u2(r,t):t,search:h2(n),hash:x2(s)}}function u2(e,t){let r=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(s=>{s===".."?r.length>1&&r.pop():s!=="."&&r.push(s)}),r.length>1?r.join("/"):"/"}function wc(e,t,r,n){return"Cannot include a '"+e+"' character in a manually specified "+("`to."+t+"` field ["+JSON.stringify(n)+"].  Please separate it out to the ")+("`to."+r+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function d2(e){return e.filter((t,r)=>r===0||t.route.path&&t.route.path.length>0)}function Km(e,t){let r=d2(e);return t?r.map((n,s)=>s===r.length-1?n.pathname:n.pathnameBase):r.map(n=>n.pathnameBase)}function Ym(e,t,r,n){n===void 0&&(n=!1);let s;typeof e=="string"?s=ha(e):(s=wi({},e),lt(!s.pathname||!s.pathname.includes("?"),wc("?","pathname","search",s)),lt(!s.pathname||!s.pathname.includes("#"),wc("#","pathname","hash",s)),lt(!s.search||!s.search.includes("#"),wc("#","search","hash",s)));let i=e===""||s.pathname==="",l=i?"/":s.pathname,o;if(l==null)o=r;else{let f=t.length-1;if(!n&&l.startsWith("..")){let h=l.split("/");for(;h[0]==="..";)h.shift(),f-=1;s.pathname=h.join("/")}o=f>=0?t[f]:"/"}let c=c2(s,o),d=l&&l!=="/"&&l.endsWith("/"),u=(i||l===".")&&r.endsWith("/");return!c.pathname.endsWith("/")&&(d||u)&&(c.pathname+="/"),c}const Dn=e=>e.join("/").replace(/\/\/+/g,"/"),f2=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),h2=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,x2=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function m2(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}const Jm=["post","put","patch","delete"];new Set(Jm);const p2=["get",...Jm];new Set(p2);/**
 * React Router v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function bi(){return bi=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},bi.apply(this,arguments)}const A0=C.createContext(null),g2=C.createContext(null),vs=C.createContext(null),Fo=C.createContext(null),Gn=C.createContext({outlet:null,matches:[],isDataRoute:!1}),qm=C.createContext(null);function v2(e,t){let{relative:r}=t===void 0?{}:t;Ri()||lt(!1);let{basename:n,navigator:s}=C.useContext(vs),{hash:i,pathname:l,search:o}=Zm(e,{relative:r}),c=l;return n!=="/"&&(c=l==="/"?n:Dn([n,l])),s.createHref({pathname:c,search:o,hash:i})}function Ri(){return C.useContext(Fo)!=null}function xa(){return Ri()||lt(!1),C.useContext(Fo).location}function Qm(e){C.useContext(vs).static||C.useLayoutEffect(e)}function ma(){let{isDataRoute:e}=C.useContext(Gn);return e?P2():y2()}function y2(){Ri()||lt(!1);let e=C.useContext(A0),{basename:t,future:r,navigator:n}=C.useContext(vs),{matches:s}=C.useContext(Gn),{pathname:i}=xa(),l=JSON.stringify(Km(s,r.v7_relativeSplatPath)),o=C.useRef(!1);return Qm(()=>{o.current=!0}),C.useCallback(function(d,u){if(u===void 0&&(u={}),!o.current)return;if(typeof d=="number"){n.go(d);return}let f=Ym(d,JSON.parse(l),i,u.relative==="path");e==null&&t!=="/"&&(f.pathname=f.pathname==="/"?t:Dn([t,f.pathname])),(u.replace?n.replace:n.push)(f,u.state,u)},[t,n,l,i,e])}const w2=C.createContext(null);function b2(e){let t=C.useContext(Gn).outlet;return t&&C.createElement(w2.Provider,{value:e},t)}function Zm(e,t){let{relative:r}=t===void 0?{}:t,{future:n}=C.useContext(vs),{matches:s}=C.useContext(Gn),{pathname:i}=xa(),l=JSON.stringify(Km(s,n.v7_relativeSplatPath));return C.useMemo(()=>Ym(e,JSON.parse(l),i,r==="path"),[e,l,i,r])}function N2(e,t){return j2(e,t)}function j2(e,t,r,n){Ri()||lt(!1);let{navigator:s}=C.useContext(vs),{matches:i}=C.useContext(Gn),l=i[i.length-1],o=l?l.params:{};l&&l.pathname;let c=l?l.pathnameBase:"/";l&&l.route;let d=xa(),u;if(t){var f;let v=typeof t=="string"?ha(t):t;c==="/"||(f=v.pathname)!=null&&f.startsWith(c)||lt(!1),u=v}else u=d;let h=u.pathname||"/",m=h;if(c!=="/"){let v=c.replace(/^\//,"").split("/");m="/"+h.replace(/^\//,"").split("/").slice(v.length).join("/")}let p=Ky(e,{pathname:m}),x=C2(p&&p.map(v=>Object.assign({},v,{params:Object.assign({},o,v.params),pathname:Dn([c,s.encodeLocation?s.encodeLocation(v.pathname).pathname:v.pathname]),pathnameBase:v.pathnameBase==="/"?c:Dn([c,s.encodeLocation?s.encodeLocation(v.pathnameBase).pathname:v.pathnameBase])})),i,r,n);return t&&x?C.createElement(Fo.Provider,{value:{location:bi({pathname:"/",search:"",hash:"",state:null,key:"default"},u),navigationType:_n.Pop}},x):x}function S2(){let e=O2(),t=m2(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),r=e instanceof Error?e.stack:null,s={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return C.createElement(C.Fragment,null,C.createElement("h2",null,"Unexpected Application Error!"),C.createElement("h3",{style:{fontStyle:"italic"}},t),r?C.createElement("pre",{style:s},r):null,null)}const _2=C.createElement(S2,null);class E2 extends C.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,r){return r.location!==t.location||r.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:r.error,location:r.location,revalidation:t.revalidation||r.revalidation}}componentDidCatch(t,r){console.error("React Router caught the following error during render",t,r)}render(){return this.state.error!==void 0?C.createElement(Gn.Provider,{value:this.props.routeContext},C.createElement(qm.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function T2(e){let{routeContext:t,match:r,children:n}=e,s=C.useContext(A0);return s&&s.static&&s.staticContext&&(r.route.errorElement||r.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=r.route.id),C.createElement(Gn.Provider,{value:t},n)}function C2(e,t,r,n){var s;if(t===void 0&&(t=[]),r===void 0&&(r=null),n===void 0&&(n=null),e==null){var i;if(!r)return null;if(r.errors)e=r.matches;else if((i=n)!=null&&i.v7_partialHydration&&t.length===0&&!r.initialized&&r.matches.length>0)e=r.matches;else return null}let l=e,o=(s=r)==null?void 0:s.errors;if(o!=null){let u=l.findIndex(f=>f.route.id&&(o==null?void 0:o[f.route.id])!==void 0);u>=0||lt(!1),l=l.slice(0,Math.min(l.length,u+1))}let c=!1,d=-1;if(r&&n&&n.v7_partialHydration)for(let u=0;u<l.length;u++){let f=l[u];if((f.route.HydrateFallback||f.route.hydrateFallbackElement)&&(d=u),f.route.id){let{loaderData:h,errors:m}=r,p=f.route.loader&&h[f.route.id]===void 0&&(!m||m[f.route.id]===void 0);if(f.route.lazy||p){c=!0,d>=0?l=l.slice(0,d+1):l=[l[0]];break}}}return l.reduceRight((u,f,h)=>{let m,p=!1,x=null,v=null;r&&(m=o&&f.route.id?o[f.route.id]:void 0,x=f.route.errorElement||_2,c&&(d<0&&h===0?(R2("route-fallback"),p=!0,v=null):d===h&&(p=!0,v=f.route.hydrateFallbackElement||null)));let y=t.concat(l.slice(0,h+1)),g=()=>{let w;return m?w=x:p?w=v:f.route.Component?w=C.createElement(f.route.Component,null):f.route.element?w=f.route.element:w=u,C.createElement(T2,{match:f,routeContext:{outlet:u,matches:y,isDataRoute:r!=null},children:w})};return r&&(f.route.ErrorBoundary||f.route.errorElement||h===0)?C.createElement(E2,{location:r.location,revalidation:r.revalidation,component:x,error:m,children:g(),routeContext:{outlet:null,matches:y,isDataRoute:!0}}):g()},null)}var ep=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(ep||{}),tp=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(tp||{});function k2(e){let t=C.useContext(A0);return t||lt(!1),t}function A2(e){let t=C.useContext(g2);return t||lt(!1),t}function F2(e){let t=C.useContext(Gn);return t||lt(!1),t}function rp(e){let t=F2(),r=t.matches[t.matches.length-1];return r.route.id||lt(!1),r.route.id}function O2(){var e;let t=C.useContext(qm),r=A2(),n=rp();return t!==void 0?t:(e=r.errors)==null?void 0:e[n]}function P2(){let{router:e}=k2(ep.UseNavigateStable),t=rp(tp.UseNavigateStable),r=C.useRef(!1);return Qm(()=>{r.current=!0}),C.useCallback(function(s,i){i===void 0&&(i={}),r.current&&(typeof s=="number"?e.navigate(s):e.navigate(s,bi({fromRouteId:t},i)))},[e,t])}const _f={};function R2(e,t,r){_f[e]||(_f[e]=!0)}function I2(e,t){e==null||e.v7_startTransition,e==null||e.v7_relativeSplatPath}function D2(e){return b2(e.context)}function Ke(e){lt(!1)}function L2(e){let{basename:t="/",children:r=null,location:n,navigationType:s=_n.Pop,navigator:i,static:l=!1,future:o}=e;Ri()&&lt(!1);let c=t.replace(/^\/*/,"/"),d=C.useMemo(()=>({basename:c,navigator:i,static:l,future:bi({v7_relativeSplatPath:!1},o)}),[c,o,i,l]);typeof n=="string"&&(n=ha(n));let{pathname:u="/",search:f="",hash:h="",state:m=null,key:p="default"}=n,x=C.useMemo(()=>{let v=k0(u,c);return v==null?null:{location:{pathname:v,search:f,hash:h,state:m,key:p},navigationType:s}},[c,u,f,h,m,p,s]);return x==null?null:C.createElement(vs.Provider,{value:d},C.createElement(Fo.Provider,{children:r,value:x}))}function M2(e){let{children:t,location:r}=e;return N2(Eu(t),r)}new Promise(()=>{});function Eu(e,t){t===void 0&&(t=[]);let r=[];return C.Children.forEach(e,(n,s)=>{if(!C.isValidElement(n))return;let i=[...t,s];if(n.type===C.Fragment){r.push.apply(r,Eu(n.props.children,i));return}n.type!==Ke&&lt(!1),!n.props.index||!n.props.children||lt(!1);let l={id:n.props.id||i.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(l.children=Eu(n.props.children,i)),r.push(l)}),r}/**
 * React Router DOM v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Tu(){return Tu=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Tu.apply(this,arguments)}function B2(e,t){if(e==null)return{};var r={},n=Object.keys(e),s,i;for(i=0;i<n.length;i++)s=n[i],!(t.indexOf(s)>=0)&&(r[s]=e[s]);return r}function U2(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function z2(e,t){return e.button===0&&(!t||t==="_self")&&!U2(e)}const $2=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],W2="6";try{window.__reactRouterVersion=W2}catch{}const H2="startTransition",Ef=P1[H2];function V2(e){let{basename:t,children:r,future:n,window:s}=e,i=C.useRef();i.current==null&&(i.current=Vy({window:s,v5Compat:!0}));let l=i.current,[o,c]=C.useState({action:l.action,location:l.location}),{v7_startTransition:d}=n||{},u=C.useCallback(f=>{d&&Ef?Ef(()=>c(f)):c(f)},[c,d]);return C.useLayoutEffect(()=>l.listen(u),[l,u]),C.useEffect(()=>I2(n),[n]),C.createElement(L2,{basename:t,children:r,location:o.location,navigationType:o.action,navigator:l,future:n})}const G2=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",X2=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Ql=C.forwardRef(function(t,r){let{onClick:n,relative:s,reloadDocument:i,replace:l,state:o,target:c,to:d,preventScrollReset:u,viewTransition:f}=t,h=B2(t,$2),{basename:m}=C.useContext(vs),p,x=!1;if(typeof d=="string"&&X2.test(d)&&(p=d,G2))try{let w=new URL(window.location.href),b=d.startsWith("//")?new URL(w.protocol+d):new URL(d),P=k0(b.pathname,m);b.origin===w.origin&&P!=null?d=P+b.search+b.hash:x=!0}catch{}let v=v2(d,{relative:s}),y=K2(d,{replace:l,state:o,target:c,preventScrollReset:u,relative:s,viewTransition:f});function g(w){n&&n(w),w.defaultPrevented||y(w)}return C.createElement("a",Tu({},h,{href:p||v,onClick:x||i?n:g,ref:r,target:c}))});var Tf;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(Tf||(Tf={}));var Cf;(function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})(Cf||(Cf={}));function K2(e,t){let{target:r,replace:n,state:s,preventScrollReset:i,relative:l,viewTransition:o}=t===void 0?{}:t,c=ma(),d=xa(),u=Zm(e,{relative:l});return C.useCallback(f=>{if(z2(f,r)){f.preventDefault();let h=n!==void 0?n:ql(d)===ql(u);c(e,{replace:h,state:s,preventScrollReset:i,relative:l,viewTransition:o})}},[d,c,u,n,s,r,e,i,l,o])}/**
 * @license lucide-react v0.427.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Y2=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),np=(...e)=>e.filter((t,r,n)=>!!t&&n.indexOf(t)===r).join(" ");/**
 * @license lucide-react v0.427.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var J2={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.427.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q2=C.forwardRef(({color:e="currentColor",size:t=24,strokeWidth:r=2,absoluteStrokeWidth:n,className:s="",children:i,iconNode:l,...o},c)=>C.createElement("svg",{ref:c,...J2,width:t,height:t,stroke:e,strokeWidth:n?Number(r)*24/Number(t):r,className:np("lucide",s),...o},[...l.map(([d,u])=>C.createElement(d,u)),...Array.isArray(i)?i:[i]]));/**
 * @license lucide-react v0.427.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ce=(e,t)=>{const r=C.forwardRef(({className:n,...s},i)=>C.createElement(q2,{ref:i,iconNode:t,className:np(`lucide-${Y2(e)}`,n),...s}));return r.displayName=`${e}`,r};/**
 * @license lucide-react v0.427.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q2=Ce("Archive",[["rect",{width:"20",height:"5",x:"2",y:"3",rx:"1",key:"1wp1u1"}],["path",{d:"M4 8v11a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8",key:"1s80jp"}],["path",{d:"M10 12h4",key:"a56b0p"}]]);/**
 * @license lucide-react v0.427.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z2=Ce("ArrowUpRight",[["path",{d:"M7 7h10v10",key:"1tivn9"}],["path",{d:"M7 17 17 7",key:"1vkiza"}]]);/**
 * @license lucide-react v0.427.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sp=Ce("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]);/**
 * @license lucide-react v0.427.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kf=Ce("Briefcase",[["path",{d:"M16 20V4a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16",key:"jecpp"}],["rect",{width:"20",height:"14",x:"2",y:"6",rx:"2",key:"i6l2r4"}]]);/**
 * @license lucide-react v0.427.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Oo=Ce("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.427.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ew=Ce("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.427.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bn=Ce("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.427.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Af=Ce("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);/**
 * @license lucide-react v0.427.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ht=Ce("CircleCheck",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.427.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yr=Ce("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.427.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tw=Ce("Clipboard",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}]]);/**
 * @license lucide-react v0.427.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yt=Ce("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.427.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rw=Ce("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]);/**
 * @license lucide-react v0.427.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oa=Ce("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.427.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const es=Ce("EllipsisVertical",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]]);/**
 * @license lucide-react v0.427.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ap=Ce("FileCheck",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"m9 15 2 2 4-4",key:"1grp1n"}]]);/**
 * @license lucide-react v0.427.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yt=Ce("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.427.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xn=Ce("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-react v0.427.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nw=Ce("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);/**
 * @license lucide-react v0.427.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sw=Ce("LayoutDashboard",[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]]);/**
 * @license lucide-react v0.427.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aw=Ce("Link2",[["path",{d:"M9 17H7A5 5 0 0 1 7 7h2",key:"8i5ue5"}],["path",{d:"M15 7h2a5 5 0 1 1 0 10h-2",key:"1b9ql8"}],["line",{x1:"8",x2:"16",y1:"12",y2:"12",key:"1jonct"}]]);/**
 * @license lucide-react v0.427.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ip=Ce("Paperclip",[["path",{d:"m21.44 11.05-9.19 9.19a6 6 0 0 1-8.49-8.49l8.57-8.57A4 4 0 1 1 18 8.84l-8.59 8.57a2 2 0 0 1-2.83-2.83l8.49-8.48",key:"1u3ebp"}]]);/**
 * @license lucide-react v0.427.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iw=Ce("Pen",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]]);/**
 * @license lucide-react v0.427.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ar=Ce("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.427.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Po=Ce("Receipt",[["path",{d:"M4 2v20l2-1 2 1 2-1 2 1 2-1 2 1 2-1 2 1V2l-2 1-2-1-2 1-2-1-2 1-2-1-2 1Z",key:"q3az6g"}],["path",{d:"M16 8h-6a2 2 0 1 0 0 4h4a2 2 0 1 1 0 4H8",key:"1h4pet"}],["path",{d:"M12 17.5v-11",key:"1jc1ny"}]]);/**
 * @license lucide-react v0.427.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lw=Ce("Reply",[["polyline",{points:"9 17 4 12 9 7",key:"hvgpf2"}],["path",{d:"M20 18v-2a4 4 0 0 0-4-4H4",key:"5vmcpk"}]]);/**
 * @license lucide-react v0.427.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hn=Ce("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.427.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lp=Ce("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]]);/**
 * @license lucide-react v0.427.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const op=Ce("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.427.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cp=Ce("ShoppingCart",[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]]);/**
 * @license lucide-react v0.427.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ow=Ce("SquareCheckBig",[["path",{d:"M21 10.5V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h12.5",key:"1uzm8b"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.427.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cw=Ce("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]]);/**
 * @license lucide-react v0.427.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uw=Ce("Star",[["polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2",key:"8f66p6"}]]);/**
 * @license lucide-react v0.427.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const F0=Ce("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.427.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dw=Ce("TrendingDown",[["polyline",{points:"22 17 13.5 8.5 8.5 13.5 2 7",key:"1r2t7k"}],["polyline",{points:"16 17 22 17 22 11",key:"11uiuu"}]]);/**
 * @license lucide-react v0.427.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ro=Ce("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);/**
 * @license lucide-react v0.427.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ja=Ce("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.427.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const O0=Ce("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.427.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fw=Ce("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.427.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ue=Ce("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);function up(e){var t,r,n="";if(typeof e=="string"||typeof e=="number")n+=e;else if(typeof e=="object")if(Array.isArray(e)){var s=e.length;for(t=0;t<s;t++)e[t]&&(r=up(e[t]))&&(n&&(n+=" "),n+=r)}else for(r in e)e[r]&&(n&&(n+=" "),n+=r);return n}function hw(){for(var e,t,r=0,n="",s=arguments.length;r<s;r++)(e=arguments[r])&&(t=up(e))&&(n&&(n+=" "),n+=t);return n}const P0="-",xw=e=>{const t=pw(e),{conflictingClassGroups:r,conflictingClassGroupModifiers:n}=e;return{getClassGroupId:l=>{const o=l.split(P0);return o[0]===""&&o.length!==1&&o.shift(),dp(o,t)||mw(l)},getConflictingClassGroupIds:(l,o)=>{const c=r[l]||[];return o&&n[l]?[...c,...n[l]]:c}}},dp=(e,t)=>{var l;if(e.length===0)return t.classGroupId;const r=e[0],n=t.nextPart.get(r),s=n?dp(e.slice(1),n):void 0;if(s)return s;if(t.validators.length===0)return;const i=e.join(P0);return(l=t.validators.find(({validator:o})=>o(i)))==null?void 0:l.classGroupId},Ff=/^\[(.+)\]$/,mw=e=>{if(Ff.test(e)){const t=Ff.exec(e)[1],r=t==null?void 0:t.substring(0,t.indexOf(":"));if(r)return"arbitrary.."+r}},pw=e=>{const{theme:t,prefix:r}=e,n={nextPart:new Map,validators:[]};return vw(Object.entries(e.classGroups),r).forEach(([i,l])=>{Cu(l,n,i,t)}),n},Cu=(e,t,r,n)=>{e.forEach(s=>{if(typeof s=="string"){const i=s===""?t:Of(t,s);i.classGroupId=r;return}if(typeof s=="function"){if(gw(s)){Cu(s(n),t,r,n);return}t.validators.push({validator:s,classGroupId:r});return}Object.entries(s).forEach(([i,l])=>{Cu(l,Of(t,i),r,n)})})},Of=(e,t)=>{let r=e;return t.split(P0).forEach(n=>{r.nextPart.has(n)||r.nextPart.set(n,{nextPart:new Map,validators:[]}),r=r.nextPart.get(n)}),r},gw=e=>e.isThemeGetter,vw=(e,t)=>t?e.map(([r,n])=>{const s=n.map(i=>typeof i=="string"?t+i:typeof i=="object"?Object.fromEntries(Object.entries(i).map(([l,o])=>[t+l,o])):i);return[r,s]}):e,yw=e=>{if(e<1)return{get:()=>{},set:()=>{}};let t=0,r=new Map,n=new Map;const s=(i,l)=>{r.set(i,l),t++,t>e&&(t=0,n=r,r=new Map)};return{get(i){let l=r.get(i);if(l!==void 0)return l;if((l=n.get(i))!==void 0)return s(i,l),l},set(i,l){r.has(i)?r.set(i,l):s(i,l)}}},fp="!",ww=e=>{const{separator:t,experimentalParseClassName:r}=e,n=t.length===1,s=t[0],i=t.length,l=o=>{const c=[];let d=0,u=0,f;for(let v=0;v<o.length;v++){let y=o[v];if(d===0){if(y===s&&(n||o.slice(v,v+i)===t)){c.push(o.slice(u,v)),u=v+i;continue}if(y==="/"){f=v;continue}}y==="["?d++:y==="]"&&d--}const h=c.length===0?o:o.substring(u),m=h.startsWith(fp),p=m?h.substring(1):h,x=f&&f>u?f-u:void 0;return{modifiers:c,hasImportantModifier:m,baseClassName:p,maybePostfixModifierPosition:x}};return r?o=>r({className:o,parseClassName:l}):l},bw=e=>{if(e.length<=1)return e;const t=[];let r=[];return e.forEach(n=>{n[0]==="["?(t.push(...r.sort(),n),r=[]):r.push(n)}),t.push(...r.sort()),t},Nw=e=>({cache:yw(e.cacheSize),parseClassName:ww(e),...xw(e)}),jw=/\s+/,Sw=(e,t)=>{const{parseClassName:r,getClassGroupId:n,getConflictingClassGroupIds:s}=t,i=[],l=e.trim().split(jw);let o="";for(let c=l.length-1;c>=0;c-=1){const d=l[c],{modifiers:u,hasImportantModifier:f,baseClassName:h,maybePostfixModifierPosition:m}=r(d);let p=!!m,x=n(p?h.substring(0,m):h);if(!x){if(!p){o=d+(o.length>0?" "+o:o);continue}if(x=n(h),!x){o=d+(o.length>0?" "+o:o);continue}p=!1}const v=bw(u).join(":"),y=f?v+fp:v,g=y+x;if(i.includes(g))continue;i.push(g);const w=s(x,p);for(let b=0;b<w.length;++b){const P=w[b];i.push(y+P)}o=d+(o.length>0?" "+o:o)}return o};function _w(){let e=0,t,r,n="";for(;e<arguments.length;)(t=arguments[e++])&&(r=hp(t))&&(n&&(n+=" "),n+=r);return n}const hp=e=>{if(typeof e=="string")return e;let t,r="";for(let n=0;n<e.length;n++)e[n]&&(t=hp(e[n]))&&(r&&(r+=" "),r+=t);return r};function Ew(e,...t){let r,n,s,i=l;function l(c){const d=t.reduce((u,f)=>f(u),e());return r=Nw(d),n=r.cache.get,s=r.cache.set,i=o,o(c)}function o(c){const d=n(c);if(d)return d;const u=Sw(c,r);return s(c,u),u}return function(){return i(_w.apply(null,arguments))}}const He=e=>{const t=r=>r[e]||[];return t.isThemeGetter=!0,t},xp=/^\[(?:([a-z-]+):)?(.+)\]$/i,Tw=/^\d+\/\d+$/,Cw=new Set(["px","full","screen"]),kw=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,Aw=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,Fw=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,Ow=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,Pw=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,Gr=e=>Js(e)||Cw.has(e)||Tw.test(e),pn=e=>pa(e,"length",zw),Js=e=>!!e&&!Number.isNaN(Number(e)),bc=e=>pa(e,"number",Js),Oa=e=>!!e&&Number.isInteger(Number(e)),Rw=e=>e.endsWith("%")&&Js(e.slice(0,-1)),Ee=e=>xp.test(e),gn=e=>kw.test(e),Iw=new Set(["length","size","percentage"]),Dw=e=>pa(e,Iw,mp),Lw=e=>pa(e,"position",mp),Mw=new Set(["image","url"]),Bw=e=>pa(e,Mw,Ww),Uw=e=>pa(e,"",$w),Pa=()=>!0,pa=(e,t,r)=>{const n=xp.exec(e);return n?n[1]?typeof t=="string"?n[1]===t:t.has(n[1]):r(n[2]):!1},zw=e=>Aw.test(e)&&!Fw.test(e),mp=()=>!1,$w=e=>Ow.test(e),Ww=e=>Pw.test(e),Hw=()=>{const e=He("colors"),t=He("spacing"),r=He("blur"),n=He("brightness"),s=He("borderColor"),i=He("borderRadius"),l=He("borderSpacing"),o=He("borderWidth"),c=He("contrast"),d=He("grayscale"),u=He("hueRotate"),f=He("invert"),h=He("gap"),m=He("gradientColorStops"),p=He("gradientColorStopPositions"),x=He("inset"),v=He("margin"),y=He("opacity"),g=He("padding"),w=He("saturate"),b=He("scale"),P=He("sepia"),L=He("skew"),E=He("space"),I=He("translate"),S=()=>["auto","contain","none"],R=()=>["auto","hidden","clip","visible","scroll"],U=()=>["auto",Ee,t],G=()=>[Ee,t],se=()=>["",Gr,pn],Ne=()=>["auto",Js,Ee],ae=()=>["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],xe=()=>["solid","dashed","dotted","double","none"],ee=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],Y=()=>["start","end","center","between","around","evenly","stretch"],F=()=>["","0",Ee],K=()=>["auto","avoid","all","avoid-page","page","left","right","column"],te=()=>[Js,Ee];return{cacheSize:500,separator:":",theme:{colors:[Pa],spacing:[Gr,pn],blur:["none","",gn,Ee],brightness:te(),borderColor:[e],borderRadius:["none","","full",gn,Ee],borderSpacing:G(),borderWidth:se(),contrast:te(),grayscale:F(),hueRotate:te(),invert:F(),gap:G(),gradientColorStops:[e],gradientColorStopPositions:[Rw,pn],inset:U(),margin:U(),opacity:te(),padding:G(),saturate:te(),scale:te(),sepia:F(),skew:te(),space:G(),translate:G()},classGroups:{aspect:[{aspect:["auto","square","video",Ee]}],container:["container"],columns:[{columns:[gn]}],"break-after":[{"break-after":K()}],"break-before":[{"break-before":K()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[...ae(),Ee]}],overflow:[{overflow:R()}],"overflow-x":[{"overflow-x":R()}],"overflow-y":[{"overflow-y":R()}],overscroll:[{overscroll:S()}],"overscroll-x":[{"overscroll-x":S()}],"overscroll-y":[{"overscroll-y":S()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[x]}],"inset-x":[{"inset-x":[x]}],"inset-y":[{"inset-y":[x]}],start:[{start:[x]}],end:[{end:[x]}],top:[{top:[x]}],right:[{right:[x]}],bottom:[{bottom:[x]}],left:[{left:[x]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",Oa,Ee]}],basis:[{basis:U()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",Ee]}],grow:[{grow:F()}],shrink:[{shrink:F()}],order:[{order:["first","last","none",Oa,Ee]}],"grid-cols":[{"grid-cols":[Pa]}],"col-start-end":[{col:["auto",{span:["full",Oa,Ee]},Ee]}],"col-start":[{"col-start":Ne()}],"col-end":[{"col-end":Ne()}],"grid-rows":[{"grid-rows":[Pa]}],"row-start-end":[{row:["auto",{span:[Oa,Ee]},Ee]}],"row-start":[{"row-start":Ne()}],"row-end":[{"row-end":Ne()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",Ee]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",Ee]}],gap:[{gap:[h]}],"gap-x":[{"gap-x":[h]}],"gap-y":[{"gap-y":[h]}],"justify-content":[{justify:["normal",...Y()]}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal",...Y(),"baseline"]}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[...Y(),"baseline"]}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[g]}],px:[{px:[g]}],py:[{py:[g]}],ps:[{ps:[g]}],pe:[{pe:[g]}],pt:[{pt:[g]}],pr:[{pr:[g]}],pb:[{pb:[g]}],pl:[{pl:[g]}],m:[{m:[v]}],mx:[{mx:[v]}],my:[{my:[v]}],ms:[{ms:[v]}],me:[{me:[v]}],mt:[{mt:[v]}],mr:[{mr:[v]}],mb:[{mb:[v]}],ml:[{ml:[v]}],"space-x":[{"space-x":[E]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[E]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit","svw","lvw","dvw",Ee,t]}],"min-w":[{"min-w":[Ee,t,"min","max","fit"]}],"max-w":[{"max-w":[Ee,t,"none","full","min","max","fit","prose",{screen:[gn]},gn]}],h:[{h:[Ee,t,"auto","min","max","fit","svh","lvh","dvh"]}],"min-h":[{"min-h":[Ee,t,"min","max","fit","svh","lvh","dvh"]}],"max-h":[{"max-h":[Ee,t,"min","max","fit","svh","lvh","dvh"]}],size:[{size:[Ee,t,"auto","min","max","fit"]}],"font-size":[{text:["base",gn,pn]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",bc]}],"font-family":[{font:[Pa]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",Ee]}],"line-clamp":[{"line-clamp":["none",Js,bc]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",Gr,Ee]}],"list-image":[{"list-image":["none",Ee]}],"list-style-type":[{list:["none","disc","decimal",Ee]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[e]}],"placeholder-opacity":[{"placeholder-opacity":[y]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[e]}],"text-opacity":[{"text-opacity":[y]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...xe(),"wavy"]}],"text-decoration-thickness":[{decoration:["auto","from-font",Gr,pn]}],"underline-offset":[{"underline-offset":["auto",Gr,Ee]}],"text-decoration-color":[{decoration:[e]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:G()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",Ee]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",Ee]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[y]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[...ae(),Lw]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",Dw]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},Bw]}],"bg-color":[{bg:[e]}],"gradient-from-pos":[{from:[p]}],"gradient-via-pos":[{via:[p]}],"gradient-to-pos":[{to:[p]}],"gradient-from":[{from:[m]}],"gradient-via":[{via:[m]}],"gradient-to":[{to:[m]}],rounded:[{rounded:[i]}],"rounded-s":[{"rounded-s":[i]}],"rounded-e":[{"rounded-e":[i]}],"rounded-t":[{"rounded-t":[i]}],"rounded-r":[{"rounded-r":[i]}],"rounded-b":[{"rounded-b":[i]}],"rounded-l":[{"rounded-l":[i]}],"rounded-ss":[{"rounded-ss":[i]}],"rounded-se":[{"rounded-se":[i]}],"rounded-ee":[{"rounded-ee":[i]}],"rounded-es":[{"rounded-es":[i]}],"rounded-tl":[{"rounded-tl":[i]}],"rounded-tr":[{"rounded-tr":[i]}],"rounded-br":[{"rounded-br":[i]}],"rounded-bl":[{"rounded-bl":[i]}],"border-w":[{border:[o]}],"border-w-x":[{"border-x":[o]}],"border-w-y":[{"border-y":[o]}],"border-w-s":[{"border-s":[o]}],"border-w-e":[{"border-e":[o]}],"border-w-t":[{"border-t":[o]}],"border-w-r":[{"border-r":[o]}],"border-w-b":[{"border-b":[o]}],"border-w-l":[{"border-l":[o]}],"border-opacity":[{"border-opacity":[y]}],"border-style":[{border:[...xe(),"hidden"]}],"divide-x":[{"divide-x":[o]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[o]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[y]}],"divide-style":[{divide:xe()}],"border-color":[{border:[s]}],"border-color-x":[{"border-x":[s]}],"border-color-y":[{"border-y":[s]}],"border-color-s":[{"border-s":[s]}],"border-color-e":[{"border-e":[s]}],"border-color-t":[{"border-t":[s]}],"border-color-r":[{"border-r":[s]}],"border-color-b":[{"border-b":[s]}],"border-color-l":[{"border-l":[s]}],"divide-color":[{divide:[s]}],"outline-style":[{outline:["",...xe()]}],"outline-offset":[{"outline-offset":[Gr,Ee]}],"outline-w":[{outline:[Gr,pn]}],"outline-color":[{outline:[e]}],"ring-w":[{ring:se()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[e]}],"ring-opacity":[{"ring-opacity":[y]}],"ring-offset-w":[{"ring-offset":[Gr,pn]}],"ring-offset-color":[{"ring-offset":[e]}],shadow:[{shadow:["","inner","none",gn,Uw]}],"shadow-color":[{shadow:[Pa]}],opacity:[{opacity:[y]}],"mix-blend":[{"mix-blend":[...ee(),"plus-lighter","plus-darker"]}],"bg-blend":[{"bg-blend":ee()}],filter:[{filter:["","none"]}],blur:[{blur:[r]}],brightness:[{brightness:[n]}],contrast:[{contrast:[c]}],"drop-shadow":[{"drop-shadow":["","none",gn,Ee]}],grayscale:[{grayscale:[d]}],"hue-rotate":[{"hue-rotate":[u]}],invert:[{invert:[f]}],saturate:[{saturate:[w]}],sepia:[{sepia:[P]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[r]}],"backdrop-brightness":[{"backdrop-brightness":[n]}],"backdrop-contrast":[{"backdrop-contrast":[c]}],"backdrop-grayscale":[{"backdrop-grayscale":[d]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[u]}],"backdrop-invert":[{"backdrop-invert":[f]}],"backdrop-opacity":[{"backdrop-opacity":[y]}],"backdrop-saturate":[{"backdrop-saturate":[w]}],"backdrop-sepia":[{"backdrop-sepia":[P]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[l]}],"border-spacing-x":[{"border-spacing-x":[l]}],"border-spacing-y":[{"border-spacing-y":[l]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",Ee]}],duration:[{duration:te()}],ease:[{ease:["linear","in","out","in-out",Ee]}],delay:[{delay:te()}],animate:[{animate:["none","spin","ping","pulse","bounce",Ee]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[b]}],"scale-x":[{"scale-x":[b]}],"scale-y":[{"scale-y":[b]}],rotate:[{rotate:[Oa,Ee]}],"translate-x":[{"translate-x":[I]}],"translate-y":[{"translate-y":[I]}],"skew-x":[{"skew-x":[L]}],"skew-y":[{"skew-y":[L]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",Ee]}],accent:[{accent:["auto",e]}],appearance:[{appearance:["none","auto"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",Ee]}],"caret-color":[{caret:[e]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":G()}],"scroll-mx":[{"scroll-mx":G()}],"scroll-my":[{"scroll-my":G()}],"scroll-ms":[{"scroll-ms":G()}],"scroll-me":[{"scroll-me":G()}],"scroll-mt":[{"scroll-mt":G()}],"scroll-mr":[{"scroll-mr":G()}],"scroll-mb":[{"scroll-mb":G()}],"scroll-ml":[{"scroll-ml":G()}],"scroll-p":[{"scroll-p":G()}],"scroll-px":[{"scroll-px":G()}],"scroll-py":[{"scroll-py":G()}],"scroll-ps":[{"scroll-ps":G()}],"scroll-pe":[{"scroll-pe":G()}],"scroll-pt":[{"scroll-pt":G()}],"scroll-pr":[{"scroll-pr":G()}],"scroll-pb":[{"scroll-pb":G()}],"scroll-pl":[{"scroll-pl":G()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",Ee]}],fill:[{fill:[e,"none"]}],"stroke-w":[{stroke:[Gr,pn,bc]}],stroke:[{stroke:[e,"none"]}],sr:["sr-only","not-sr-only"],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}},Vw=Ew(Hw);function Ba(...e){return Vw(hw(e))}const pp="http://localhost:5000",we={register:"/api/users/register",login:"/api/users/login",users:"/api/users",projects:"/api/projects",tasks:e=>`/api/projects/${e}/tasks`,expenses:"/api/expenses",timesheets:"/api/timesheets",salesOrders:"/api/sales-orders",purchaseOrders:"/api/purchase-orders",customerInvoices:"/api/customer-invoices",vendorBills:"/api/vendor-bills",dashboard:{stats:"/api/dashboard/stats",projects:"/api/dashboard/projects"}},be=async(e,t={})=>{const r=`${pp}${e}`,n={headers:{"Content-Type":"application/json"}};try{return await(await fetch(r,{...n,...t,headers:{...n.headers,...t.headers}})).json()}catch(s){throw console.error("API call error:",s),s}},Gw=e=>{localStorage.setItem("user",JSON.stringify(e))},gp=()=>{const e=localStorage.getItem("user");return e?JSON.parse(e):null},Xw=()=>{localStorage.removeItem("user")},kr={getAll:async()=>await be(we.projects,{method:"GET"}),getById:async e=>await be(`${we.projects}/${e}`,{method:"GET"}),create:async e=>await be(we.projects,{method:"POST",body:JSON.stringify(e)}),update:async(e,t)=>await be(`${we.projects}/${e}`,{method:"PUT",body:JSON.stringify(t)}),delete:async e=>await be(`${we.projects}/${e}`,{method:"DELETE"})},xr={getAll:async(e={})=>{const t=new URLSearchParams;Object.keys(e).forEach(n=>{e[n]!==void 0&&e[n]!==null&&e[n]!==""&&(Array.isArray(e[n])?e[n].forEach(s=>t.append(n,s)):t.append(n,e[n]))});const r=t.toString();return await be(`${we.expenses}${r?"?"+r:""}`,{method:"GET"})},getStats:async(e={})=>{const t=new URLSearchParams;Object.keys(e).forEach(n=>{e[n]!==void 0&&e[n]!==null&&e[n]!==""&&t.append(n,e[n])});const r=t.toString();return await be(`${we.expenses}/stats${r?"?"+r:""}`,{method:"GET"})},getById:async e=>await be(`${we.expenses}/${e}`,{method:"GET"}),create:async e=>await be(we.expenses,{method:"POST",body:JSON.stringify(e)}),update:async(e,t)=>await be(`${we.expenses}/${e}`,{method:"PUT",body:JSON.stringify(t)}),approve:async e=>await be(`${we.expenses}/${e}/approve`,{method:"PATCH"}),reject:async(e,t)=>await be(`${we.expenses}/${e}/reject`,{method:"PATCH",body:JSON.stringify({reason:t})}),addToInvoice:async(e,t)=>await be(`${we.expenses}/${e}/add-to-invoice`,{method:"PATCH",body:JSON.stringify(t)}),bulkApprove:async e=>await be(`${we.expenses}/bulk-approve`,{method:"POST",body:JSON.stringify({expense_ids:e})}),bulkReject:async(e,t)=>await be(`${we.expenses}/bulk-reject`,{method:"POST",body:JSON.stringify({expense_ids:e,reason:t})}),uploadReceipt:async e=>{const t=new FormData;t.append("receipt",e);const r=`${pp}${we.expenses}/upload-receipt`;try{return await(await fetch(r,{method:"POST",body:t})).json()}catch(n){throw console.error("Receipt upload error:",n),n}}},Kw={getAll:async()=>await be(we.users,{method:"GET"}),getByEmail:async e=>await be(`${we.users}/${e}`,{method:"GET"})},il={getAll:async e=>await be(we.tasks(e),{method:"GET"}),create:async(e,t)=>await be(we.tasks(e),{method:"POST",body:JSON.stringify(t)}),update:async(e,t,r)=>await be(`${we.tasks(e)}/${t}`,{method:"PUT",body:JSON.stringify(r)})},zr={getAll:async(e={})=>{const t=new URLSearchParams;Object.keys(e).forEach(n=>{e[n]!==void 0&&e[n]!==null&&e[n]!==""&&(Array.isArray(e[n])?e[n].forEach(s=>t.append(n,s)):t.append(n,e[n]))});const r=t.toString();return await be(`${we.timesheets}${r?"?"+r:""}`,{method:"GET"})},getStats:async(e={})=>{const t=new URLSearchParams;Object.keys(e).forEach(n=>{e[n]!==void 0&&e[n]!==null&&e[n]!==""&&t.append(n,e[n])});const r=t.toString();return await be(`${we.timesheets}/stats${r?"?"+r:""}`,{method:"GET"})},getById:async e=>await be(`${we.timesheets}/${e}`,{method:"GET"}),create:async e=>await be(we.timesheets,{method:"POST",body:JSON.stringify(e)}),update:async(e,t)=>await be(`${we.timesheets}/${e}`,{method:"PUT",body:JSON.stringify(t)}),approve:async e=>await be(`${we.timesheets}/${e}/approve`,{method:"PATCH"}),reject:async(e,t)=>await be(`${we.timesheets}/${e}/reject`,{method:"PATCH",body:JSON.stringify({reason:t})}),bulkApprove:async e=>await be(`${we.timesheets}/bulk-approve`,{method:"POST",body:JSON.stringify({timesheet_ids:e})}),bulkReject:async(e,t)=>await be(`${we.timesheets}/bulk-reject`,{method:"POST",body:JSON.stringify({timesheet_ids:e,reason:t})}),getUserRates:async(e,t)=>{const r=new URLSearchParams;t&&r.append("date",t);const n=r.toString();return await be(`${we.timesheets}/user-rates/${e}${n?"?"+n:""}`,{method:"GET"})}},Yr={getAll:async(e={})=>{const t=new URLSearchParams;Object.keys(e).forEach(n=>{e[n]!==void 0&&e[n]!==null&&e[n]!==""&&(Array.isArray(e[n])?e[n].forEach(s=>t.append(n,s)):t.append(n,e[n]))});const r=t.toString();return await be(`${we.salesOrders}${r?"?"+r:""}`,{method:"GET"})},getStats:async(e={})=>{const t=new URLSearchParams;Object.keys(e).forEach(n=>{e[n]!==void 0&&e[n]!==null&&e[n]!==""&&t.append(n,e[n])});const r=t.toString();return await be(`${we.salesOrders}/stats${r?"?"+r:""}`,{method:"GET"})},getById:async e=>await be(`${we.salesOrders}/${e}`,{method:"GET"}),create:async e=>await be(we.salesOrders,{method:"POST",body:JSON.stringify(e)}),update:async(e,t)=>await be(`${we.salesOrders}/${e}`,{method:"PUT",body:JSON.stringify(t)}),confirm:async e=>await be(`${we.salesOrders}/${e}/confirm`,{method:"PATCH"}),cancel:async e=>await be(`${we.salesOrders}/${e}/cancel`,{method:"PATCH"})},Jr={getAll:async(e={})=>{const t=new URLSearchParams;Object.keys(e).forEach(n=>{e[n]!==void 0&&e[n]!==null&&e[n]!==""&&(Array.isArray(e[n])?e[n].forEach(s=>t.append(n,s)):t.append(n,e[n]))});const r=t.toString();return await be(`${we.purchaseOrders}${r?"?"+r:""}`,{method:"GET"})},getStats:async(e={})=>{const t=new URLSearchParams;Object.keys(e).forEach(n=>{e[n]!==void 0&&e[n]!==null&&e[n]!==""&&t.append(n,e[n])});const r=t.toString();return await be(`${we.purchaseOrders}/stats${r?"?"+r:""}`,{method:"GET"})},getById:async e=>await be(`${we.purchaseOrders}/${e}`,{method:"GET"}),create:async e=>await be(we.purchaseOrders,{method:"POST",body:JSON.stringify(e)}),update:async(e,t)=>await be(`${we.purchaseOrders}/${e}`,{method:"PUT",body:JSON.stringify(t)}),confirm:async e=>await be(`${we.purchaseOrders}/${e}/confirm`,{method:"PATCH"}),cancel:async e=>await be(`${we.purchaseOrders}/${e}/cancel`,{method:"PATCH"})},qr={getAll:async(e={})=>{const t=new URLSearchParams;Object.keys(e).forEach(n=>{e[n]!==void 0&&e[n]!==null&&e[n]!==""&&(Array.isArray(e[n])?e[n].forEach(s=>t.append(n,s)):t.append(n,e[n]))});const r=t.toString();return await be(`${we.customerInvoices}${r?"?"+r:""}`,{method:"GET"})},getStats:async(e={})=>{const t=new URLSearchParams;Object.keys(e).forEach(n=>{e[n]!==void 0&&e[n]!==null&&e[n]!==""&&t.append(n,e[n])});const r=t.toString();return await be(`${we.customerInvoices}/stats${r?"?"+r:""}`,{method:"GET"})},getById:async e=>await be(`${we.customerInvoices}/${e}`,{method:"GET"}),create:async e=>await be(we.customerInvoices,{method:"POST",body:JSON.stringify(e)}),update:async(e,t)=>await be(`${we.customerInvoices}/${e}`,{method:"PUT",body:JSON.stringify(t)}),post:async e=>await be(`${we.customerInvoices}/${e}/post`,{method:"PATCH"}),cancel:async e=>await be(`${we.customerInvoices}/${e}/cancel`,{method:"PATCH"})},Qr={getAll:async(e={})=>{const t=new URLSearchParams;Object.keys(e).forEach(n=>{e[n]!==void 0&&e[n]!==null&&e[n]!==""&&(Array.isArray(e[n])?e[n].forEach(s=>t.append(n,s)):t.append(n,e[n]))});const r=t.toString();return await be(`${we.vendorBills}${r?"?"+r:""}`,{method:"GET"})},getStats:async(e={})=>{const t=new URLSearchParams;Object.keys(e).forEach(n=>{e[n]!==void 0&&e[n]!==null&&e[n]!==""&&t.append(n,e[n])});const r=t.toString();return await be(`${we.vendorBills}/stats${r?"?"+r:""}`,{method:"GET"})},getById:async e=>await be(`${we.vendorBills}/${e}`,{method:"GET"}),create:async e=>await be(we.vendorBills,{method:"POST",body:JSON.stringify(e)}),update:async(e,t)=>await be(`${we.vendorBills}/${e}`,{method:"PUT",body:JSON.stringify(t)}),post:async e=>await be(`${we.vendorBills}/${e}/post`,{method:"PATCH"}),cancel:async e=>await be(`${we.vendorBills}/${e}/cancel`,{method:"PATCH"})},Pf={getStats:async()=>await be(we.dashboard.stats,{method:"GET"}),getProjects:async(e=null)=>{const t=new URLSearchParams;e&&t.append("status",e);const r=t.toString();return await be(`${we.dashboard.projects}${r?"?"+r:""}`,{method:"GET"})}},vp="/assets/logo-C-p5O994.png",Yw=[{icon:sw,label:"Dashboard",path:"/dashboard"},{icon:yt,label:"Projects",path:"/projects"},{icon:ow,label:"Tasks",path:"/tasks"},{icon:Po,label:"Expenses",path:"/expenses"},{icon:Oo,label:"Calendars",path:"/calendars"},{icon:Yt,label:"Timesheets",path:"/timesheets"}],Jw=[{icon:op,label:"Settings",path:"/settings"}];function qw(){const e=xa(),t=ma(),r=i=>{const l=`/app${i}`;return e.pathname===l},n=()=>{Xw(),t("/")},s=({item:i,isActive:l})=>{const o=i.icon;return a.jsxs(Ql,{to:`/app${i.path}`,className:Ba("flex items-center gap-2 px-4 py-2 rounded-lg transition-colors text-sm",l?"bg-gray-100 text-gray-900 font-medium":"text-gray-700 hover:bg-gray-50"),children:[a.jsx(o,{className:"w-4 h-4"}),a.jsx("span",{children:i.label})]})};return a.jsx("nav",{className:"bg-white border-b border-gray-200 px-6 py-3 sticky top-0 z-40",children:a.jsxs("div",{className:"flex items-center justify-between max-w-full",children:[a.jsx("div",{className:"flex items-center gap-3 flex-shrink-0",children:a.jsx("img",{src:vp,alt:"OneFlow Logo",className:"h-20 w-auto cursor-pointer",onClick:n,title:"Logout"})}),a.jsxs("div",{className:"flex items-center gap-1 flex-1 justify-center overflow-x-auto overflow-y-visible",children:[Yw.map(i=>a.jsx(s,{item:i,isActive:r(i.path)},i.path)),Jw.map(i=>a.jsx(s,{item:i,isActive:r(i.path)},i.path)),a.jsx(s,{item:{icon:sp,label:"Notifications",path:"/notifications"},isActive:r("/notifications")},"/notifications")]}),a.jsx("div",{className:"flex items-center gap-3 flex-shrink-0",children:a.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 rounded-lg hover:bg-gray-50 cursor-pointer",children:[a.jsx("div",{className:"w-8 h-8 bg-gray-700 rounded-full flex items-center justify-center",children:a.jsx("span",{className:"text-white font-semibold text-sm",children:"M"})}),a.jsx("span",{className:"text-sm font-medium text-gray-900 hidden sm:inline",children:"Marketing Team's"}),a.jsx(Bn,{className:"w-4 h-4 text-gray-400"})]})})]})})}function Qw(){return a.jsxs("div",{className:"flex flex-col min-h-screen bg-white",children:[a.jsx(qw,{}),a.jsx("main",{className:"flex-1 overflow-y-auto",children:a.jsx(D2,{})})]})}const Zw={Weekly:"bg-gray-100 text-gray-700",Monthly:"bg-gray-100 text-gray-700",Product:"bg-gray-100 text-gray-700",Business:"bg-gray-100 text-gray-700",Personal:"bg-gray-100 text-gray-700"};function eb({note:e}){const t=s=>s.split(" ").map(i=>i[0]).join("").toUpperCase().slice(0,2),r=s=>{const i=["bg-gray-400","bg-gray-500","bg-gray-600","bg-gray-700","bg-gray-800"],l=s.split("").reduce((o,c)=>o+c.charCodeAt(0),0);return i[l%i.length]},n=()=>e.image?e.image==="document"?a.jsx("div",{className:"mt-3 rounded-lg overflow-hidden bg-gray-100 h-32 flex items-center justify-center",children:a.jsxs("div",{className:"text-center",children:[a.jsx("svg",{className:"w-12 h-12 mx-auto text-gray-400 mb-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),a.jsx("p",{className:"text-xs text-gray-500",children:"Document"})]})}):e.image==="chart"?a.jsx("div",{className:"mt-3 rounded-lg overflow-hidden bg-gray-100 h-32 flex items-center justify-center",children:a.jsx("div",{className:"w-full h-full p-4",children:a.jsx("div",{className:"flex items-end justify-between h-full gap-2",children:[40,60,45,80,55,70,90].map((s,i)=>a.jsx("div",{className:"flex-1 bg-gray-600 rounded-t",style:{height:`${s}%`}},i))})})}):e.image==="products"?a.jsx("div",{className:"mt-3 rounded-lg overflow-hidden bg-gray-100 h-32 flex items-center justify-center",children:a.jsx("div",{className:"grid grid-cols-3 gap-2 p-4",children:[1,2,3,4,5,6].map(s=>a.jsx("div",{className:"w-full h-12 bg-white rounded border border-gray-200"},s))})}):null:null;return a.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-5 hover:shadow-md transition-shadow cursor-pointer shadow-sm",children:[a.jsx("div",{className:"flex flex-wrap gap-2 mb-3",children:e.badges.map(s=>a.jsx("span",{className:`px-2.5 py-1 rounded-full text-xs font-medium ${Zw[s]||"bg-gray-100 text-gray-700"}`,children:s},s))}),a.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:e.title}),e.description&&a.jsx("p",{className:"text-sm text-gray-600 mb-3 line-clamp-3",children:e.description}),n(),a.jsxs("div",{className:"flex items-center justify-between mt-4 pt-4 border-t border-gray-100",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("div",{className:`w-8 h-8 ${r(e.user.name)} rounded-full flex items-center justify-center`,children:a.jsx("span",{className:"text-xs font-semibold text-white",children:t(e.user.name)})}),a.jsx("span",{className:"text-sm text-gray-600",children:e.user.name})]}),a.jsx("span",{className:"text-xs text-gray-500",children:e.date})]})]})}const tb=[{id:1,title:"Product Team Meeting",description:"This monthly progress agenda is following this items: Introduction to Newest Product Plan, Monthly Revenue updates for each.",badges:["Weekly","Product"],user:{name:"Floyd Miles",avatar:"FM"},date:"Mar 5 04:25",image:null},{id:2,title:"Product Team Meeting",description:"This monthly progress agenda is following this items: Introduction to Newest Product Plan, Monthly Revenue updates for each.",badges:["Monthly","Business"],user:{name:"Dianne Russell",avatar:"DR"},date:"Apr 11 18:30",image:null},{id:3,title:"HR Interview",description:"This monthly progress agenda is following this items: Introduction to Newest Product Plan, Monthly Revenue updates for each.",badges:["Personal","Business"],user:{name:"Annette Black",avatar:"AB"},date:"Jun 23 14:31",image:null},{id:4,title:"Monthly Team Progress",description:"This monthly progress agenda is following this items: Introduction to Newest Product Plan, Monthly Revenue updates for each.",badges:["Monthly","Product"],user:{name:"Robert Fox",avatar:"RF"},date:"Jan 31 09:53",image:null},{id:5,title:"Product Team Meeting",description:"Some Summaries of this weeks meeting with some conclusion we get: Some of our product uploaded improved",badges:["Monthly","Business"],user:{name:"Brooklyn Simmons",avatar:"BS"},date:"Aug 15 10:29",image:null},{id:6,title:"Document Images",description:"Report Document of Weekly Meetings.",badges:["Personal"],user:{name:"Cameron Williamson",avatar:"CW"},date:"Dec 30 21:28",image:"document"},{id:7,title:"Weekly Team Progress",description:"This weekly progress agenda is following this items: Introduction to Newest Product Plan, Monthly Revenue updates for each.",badges:["Weekly","Product"],user:{name:"Dianne Russell",avatar:"DR"},date:"Feb 4 19:08",image:null},{id:8,title:"Revenue Progress",description:"",badges:["Business"],user:{name:"Ronald Richards",avatar:"RR"},date:"May 22 04:43",image:"chart"},{id:9,title:"Monthly Products",description:"Report Document of Weekly Meetings.",badges:["Product"],user:{name:"Albert Flores",avatar:"AF"},date:"Oct 4 15:49",image:"products"}];function rb(){return a.jsxs("div",{className:"h-full bg-gray-50",children:[a.jsx("header",{className:"bg-white border-b border-gray-200 px-8 py-6",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-6 flex-1",children:[a.jsx("h1",{className:"text-2xl font-semibold text-gray-900",children:"Notes"}),a.jsxs("div",{className:"relative flex-1 max-w-md",children:[a.jsx(hn,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),a.jsx("input",{type:"text",placeholder:"Q Search",className:"w-full pl-10 pr-4 py-2.5 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-400 focus:border-transparent text-sm"})]}),a.jsx("a",{href:"#",className:"text-sm text-gray-600 hover:text-gray-900",children:"Help Center"})]}),a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsxs("div",{className:"flex items-center gap-2 cursor-pointer hover:bg-gray-50 rounded-lg px-3 py-2",children:[a.jsx("div",{className:"w-8 h-8 bg-gray-700 rounded-full flex items-center justify-center",children:a.jsx("span",{className:"text-white font-semibold text-sm",children:"BF"})}),a.jsx("span",{className:"text-sm font-medium text-gray-900",children:"Brian F."}),a.jsx(Bn,{className:"w-4 h-4 text-gray-400"})]}),a.jsx("button",{className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white rounded-lg hover:bg-gray-50",style:{border:"1.5px solid #714b67"},children:"Sort By"}),a.jsx("button",{className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white rounded-lg hover:bg-gray-50",style:{border:"1.5px solid #714b67"},children:"Filter"}),a.jsx("button",{className:"px-4 py-2 text-sm font-medium text-white rounded-lg hover:opacity-90 transition-opacity",style:{backgroundColor:"#714b67"},children:"+ Add Notes"})]})]})}),a.jsx("div",{className:"p-8",children:a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 max-w-7xl mx-auto",children:tb.map(e=>a.jsx(eb,{note:e},e.id))})})]})}function nb({project:e,onEdit:t,onDelete:r,onOpen:n}){var l;const[s,i]=C.useState(!1);return a.jsxs("div",{onClick:o=>{try{if(o.target instanceof Element&&o.target.closest(".kebab"))return}catch{}n&&n()},className:"bg-white rounded-lg shadow-sm hover:shadow-md transition-transform transform hover:-translate-y-1 p-4 cursor-pointer w-full",children:[a.jsxs("div",{className:"flex items-start justify-between",children:[a.jsx("div",{className:"flex-1"}),a.jsxs("div",{className:"relative kebab",children:[a.jsx("button",{onClick:o=>{o.stopPropagation(),i(c=>!c)},className:"p-1 rounded hover:bg-gray-100",children:a.jsx(es,{className:"w-4 h-4 text-gray-600"})}),s&&a.jsxs("div",{onClick:o=>o.stopPropagation(),className:"absolute right-0 mt-2 bg-white border rounded shadow z-20",children:[a.jsx("button",{onClick:()=>{i(!1),n&&n()},className:"block px-4 py-2 text-sm",children:"Open"}),a.jsx("button",{onClick:()=>{i(!1),t&&t()},className:"block px-4 py-2 text-sm",children:"Edit"}),a.jsx("button",{onClick:()=>{i(!1),r&&r()},className:"block px-4 py-2 text-sm text-red-600",children:"Delete"})]})]})]}),e.image&&e.image.base64&&a.jsx("div",{className:"mt-3",children:a.jsx("img",{src:e.image.base64,alt:e.name,className:"w-full h-32 object-cover rounded-lg"})}),e.image&&e.image.url&&a.jsx("div",{className:"mt-3",children:a.jsx("img",{src:`http://localhost:5000${e.image.url}`,alt:e.name,className:"w-full h-32 object-cover rounded-lg"})}),a.jsxs("div",{className:"mt-3",children:[a.jsx("h4",{className:"text-md font-semibold text-gray-900",children:e.name}),a.jsx("p",{className:"mt-3 text-sm text-gray-600 leading-relaxed",children:e.description})]}),a.jsxs("div",{className:"mt-4",children:[a.jsx("div",{className:"w-full bg-gray-100 rounded h-2 overflow-hidden",children:a.jsx("div",{className:"h-2 bg-purple-600",style:{width:`${e.progress??0}%`}})}),a.jsxs("div",{className:"flex items-center justify-between mt-2 text-sm text-gray-600",children:[a.jsxs("div",{children:[a.jsxs("div",{children:[e.start,"  ",e.due]}),a.jsxs("div",{className:"text-xs text-gray-500",children:[e.tasks," tasks"]})]}),a.jsx("div",{className:"flex items-center gap-2",children:a.jsx("div",{className:"w-8 h-8 rounded-full bg-gray-700 text-white flex items-center justify-center text-sm",children:(((l=e.manager)==null?void 0:l.name)||"").split(" ").map(o=>o[0]).join("").slice(0,2)})})]})]})]})}function sb({project:e,onClose:t,onCreate:r,onUpdate:n}){var m;const[s,i]=C.useState({name:"",status:"New",start:"",due:"",tasks:0,progress:0,manager:{name:""},description:"",image:null}),[l,o]=C.useState(null),[c,d]=C.useState(!1);C.useEffect(()=>{var p,x;e&&(i({...e}),(p=e.image)!=null&&p.base64?o(e.image.base64):(x=e.image)!=null&&x.url&&o(`http://localhost:5000${e.image.url}`))},[e]);function u(p){var y;const x=(y=p.target.files)==null?void 0:y[0];if(!x)return;if(!x.type.startsWith("image/")){alert("Please select an image file");return}if(x.size>5*1024*1024){alert("Image size must be less than 5MB");return}d(!0);const v=new FileReader;v.onloadend=()=>{const g=v.result;o(g),i(w=>({...w,image:{base64:g,filename:x.name,mimetype:x.type,size:x.size}})),d(!1)},v.onerror=()=>{alert("Failed to read image file"),d(!1)},v.readAsDataURL(x)}function f(){o(null),i(p=>({...p,image:null}))}function h(p){p.preventDefault();const x={...s};e&&e.id?n&&n(x):r&&r(x)}return a.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 overflow-y-auto",children:[a.jsx("div",{className:"absolute inset-0 bg-black opacity-30",onClick:t}),a.jsxs("form",{onSubmit:h,className:"relative bg-white rounded-lg shadow-lg w-full max-w-2xl z-10 my-8 flex flex-col max-h-[95vh]",children:[a.jsxs("div",{className:"flex items-center justify-between p-6 pb-4 border-b bg-white rounded-t-lg sticky top-0 z-10",children:[a.jsx("h3",{className:"text-lg font-semibold",children:e?"Edit Project":"New Project"}),a.jsx("button",{type:"button",onClick:t,children:a.jsx(Ue,{className:"w-5 h-5 text-gray-600"})})]}),a.jsx("div",{className:"p-6 overflow-y-auto flex-1",children:a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm text-gray-700",children:"Name"}),a.jsx("input",{required:!0,value:s.name,onChange:p=>i(x=>({...x,name:p.target.value})),className:"mt-1 w-full border rounded px-3 py-2"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm text-gray-700",children:"Status"}),a.jsxs("select",{value:s.status,onChange:p=>i(x=>({...x,status:p.target.value})),className:"mt-1 w-full border rounded px-3 py-2",children:[a.jsx("option",{children:"New"}),a.jsx("option",{children:"In Progress"}),a.jsx("option",{children:"Completed"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm text-gray-700",children:"Start"}),a.jsx("input",{type:"date",value:s.start,onChange:p=>i(x=>({...x,start:p.target.value})),className:"mt-1 w-full border rounded px-3 py-2"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm text-gray-700",children:"Due"}),a.jsx("input",{type:"date",value:s.due,onChange:p=>i(x=>({...x,due:p.target.value})),className:"mt-1 w-full border rounded px-3 py-2"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm text-gray-700",children:"Tasks"}),a.jsx("input",{type:"number",min:0,value:s.tasks,onChange:p=>i(x=>({...x,tasks:Number(p.target.value)})),className:"mt-1 w-full border rounded px-3 py-2"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm text-gray-700",children:"Manager Name"}),a.jsx("input",{value:((m=s.manager)==null?void 0:m.name)||"",onChange:p=>i(x=>({...x,manager:{...x.manager,name:p.target.value}})),className:"mt-1 w-full border rounded px-3 py-2"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm text-gray-700",children:"Progress (%)"}),a.jsx("input",{type:"number",min:0,max:100,value:s.progress,onChange:p=>i(x=>({...x,progress:Number(p.target.value)})),className:"mt-1 w-full border rounded px-3 py-2"})]}),a.jsxs("div",{className:"md:col-span-2",children:[a.jsx("label",{className:"block text-sm text-gray-700",children:"Description"}),a.jsx("textarea",{value:s.description,onChange:p=>i(x=>({...x,description:p.target.value})),className:"mt-1 w-full border rounded px-3 py-2 h-28"})]}),a.jsxs("div",{className:"md:col-span-2",children:[a.jsx("label",{className:"block text-sm text-gray-700 mb-2",children:"Project Image"}),l?a.jsxs("div",{className:"relative",children:[a.jsx("img",{src:l,alt:"Preview",className:"w-full h-48 object-cover rounded-lg border-2 border-gray-200"}),a.jsx("button",{type:"button",onClick:f,className:"absolute top-2 right-2 p-2 bg-red-500 text-white rounded-full hover:bg-red-600 transition-colors shadow-lg",title:"Remove image",children:a.jsx(F0,{className:"w-4 h-4"})})]}):a.jsxs("label",{className:"flex flex-col items-center justify-center w-full h-48 border-2 border-gray-300 border-dashed rounded-lg cursor-pointer bg-gray-50 hover:bg-gray-100 transition-colors",children:[a.jsxs("div",{className:"flex flex-col items-center justify-center pt-5 pb-6",children:[a.jsx(O0,{className:"w-10 h-10 mb-3 text-gray-400"}),a.jsxs("p",{className:"mb-2 text-sm text-gray-500",children:[a.jsx("span",{className:"font-semibold",children:"Click to upload"})," or drag and drop"]}),a.jsx("p",{className:"text-xs text-gray-500",children:"PNG, JPG, GIF up to 5MB"})]}),a.jsx("input",{type:"file",className:"hidden",accept:"image/*",onChange:u,disabled:c})]}),c&&a.jsx("p",{className:"mt-2 text-sm text-gray-500",children:"Uploading image..."})]})]})}),a.jsx("div",{className:"p-6 pt-4 border-t bg-white rounded-b-lg sticky bottom-0 z-10",children:a.jsxs("div",{className:"flex justify-end gap-3",children:[a.jsx("button",{type:"button",onClick:t,className:"px-4 py-2 rounded bg-white border hover:bg-gray-50 transition-colors",children:"Cancel"}),a.jsx("button",{type:"submit",className:"px-4 py-2 rounded text-white hover:opacity-90 transition-opacity",style:{backgroundColor:"#714b67"},children:e?"Save":"Create"})]})})]})]})}function ab({project:e,onClose:t,onEdit:r,onDelete:n}){return e?a.jsxs("div",{className:"fixed inset-0 z-50 flex items-start justify-center p-6",children:[a.jsx("div",{className:"absolute inset-0 bg-black opacity-30",onClick:t}),a.jsxs("div",{className:"relative bg-white rounded-lg shadow-lg w-full max-w-2xl p-6 z-10",children:[a.jsxs("div",{className:"flex items-start justify-between",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"text-xl font-semibold text-gray-900",children:e.name}),a.jsxs("div",{className:"text-sm text-gray-500 mt-1",children:[e.start,"  ",e.due,"  ",e.tasks," tasks"]})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("button",{onClick:()=>r&&r(e),className:"px-3 py-1 rounded bg-white border",children:"Edit"}),a.jsx("button",{onClick:()=>n&&n(e.id),className:"px-3 py-1 rounded bg-red-50 text-red-600 border",children:"Delete"}),a.jsx("button",{onClick:t,className:"p-2 rounded",children:a.jsx(Ue,{className:"w-5 h-5 text-gray-600"})})]})]}),a.jsxs("div",{className:"mt-4",children:[a.jsx("h4",{className:"text-sm font-medium text-gray-700",children:"Description"}),a.jsx("p",{className:"mt-2 text-sm text-gray-600 whitespace-pre-wrap",children:e.description})]}),a.jsxs("div",{className:"mt-4",children:[a.jsx("h4",{className:"text-sm font-medium text-gray-700",children:"Progress"}),a.jsx("div",{className:"mt-2 w-full bg-gray-100 rounded h-3 overflow-hidden",children:a.jsx("div",{className:"h-3 bg-purple-600",style:{width:`${e.progress??0}%`}})}),a.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:[e.progress??0,"% complete"]})]})]})]}):null}const ib=["New","In Progress","Completed"];function lb(){const[e,t]=C.useState([]),[r,n]=C.useState(""),[s,i]=C.useState("Newest"),[l,o]=C.useState(!1),[c,d]=C.useState(null),[u,f]=C.useState(null),[h,m]=C.useState(null),[p,x]=C.useState(!0),[v,y]=C.useState(null);C.useEffect(()=>{g()},[]);async function g(){try{x(!0),y(null);const S=await kr.getAll();S.success?t(S.data):y(S.message||"Failed to load projects")}catch(S){console.error("Error fetching projects:",S),y("Unable to connect to server. Please try again.")}finally{x(!1)}}function w(){d(null),o(!0)}async function b(S){try{const R=await kr.create(S);R.success?(await g(),o(!1),m("Project created successfully"),setTimeout(()=>m(null),2800)):(m(R.message||"Failed to create project"),setTimeout(()=>m(null),3e3))}catch(R){console.error("Error creating project:",R),m("Failed to create project. Please try again."),setTimeout(()=>m(null),3e3)}}async function P(S){try{const R=await kr.update(S.id,S);R.success?(await g(),o(!1),m("Project updated successfully"),setTimeout(()=>m(null),2200)):(m(R.message||"Failed to update project"),setTimeout(()=>m(null),3e3))}catch(R){console.error("Error updating project:",R),m("Failed to update project. Please try again."),setTimeout(()=>m(null),3e3)}}async function L(S){if(window.confirm("Delete this project? This action cannot be undone."))try{const R=await kr.delete(S);R.success?(await g(),f(null),m("Project deleted successfully"),setTimeout(()=>m(null),2e3)):(m(R.message||"Failed to delete project"),setTimeout(()=>m(null),3e3))}catch(R){console.error("Error deleting project:",R),m("Failed to delete project. Please try again."),setTimeout(()=>m(null),3e3)}}const E=e.filter(S=>{const R=r.trim().toLowerCase();return R?`${S.name} ${S.description||""}`.toLowerCase().includes(R):!0});function I(S){return s==="Name"?S.sort((R,U)=>R.name.localeCompare(U.name)):s==="Progress"?S.sort((R,U)=>U.tasks-R.tasks):s==="Due"?S.sort((R,U)=>new Date(R.due||0)-new Date(U.due||0)):S.sort((R,U)=>new Date(U.start||0)-new Date(R.start||0))}return a.jsxs("div",{className:"h-full bg-gray-50",children:[a.jsx("header",{className:"bg-white border-b border-gray-200 px-8 py-6",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-6 flex-1",children:[a.jsx("h1",{className:"text-2xl font-semibold text-gray-900",children:"Projects"}),a.jsxs("div",{className:"relative flex-1 max-w-md",children:[a.jsx(hn,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),a.jsx("input",{value:r,onChange:S=>n(S.target.value),type:"text",placeholder:"Search projects",className:"w-full pl-10 pr-4 py-2.5 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-400 focus:border-transparent text-sm",disabled:p})]})]}),a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsxs("select",{value:s,onChange:S=>i(S.target.value),className:"px-3 py-2 rounded-lg text-sm border border-gray-200 bg-white",disabled:p,children:[a.jsx("option",{children:"Newest"}),a.jsx("option",{children:"Name"}),a.jsx("option",{children:"Progress"}),a.jsx("option",{children:"Due"})]}),a.jsxs("button",{onClick:w,className:"px-4 py-2 text-sm font-medium text-white rounded-lg hover:opacity-90 transition-opacity disabled:opacity-50",style:{backgroundColor:"#714b67"},disabled:p,children:[a.jsx(ar,{className:"inline w-4 h-4 mr-2"})," New Project"]})]})]})}),a.jsxs("div",{className:"p-6",children:[p&&a.jsx("div",{className:"flex items-center justify-center h-64",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"inline-block animate-spin rounded-full h-12 w-12 border-b-2 border-gray-900 mb-4"}),a.jsx("p",{className:"text-gray-600",children:"Loading projects..."})]})}),v&&!p&&a.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 mb-4",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("svg",{className:"w-5 h-5 text-red-600",fill:"currentColor",viewBox:"0 0 20 20",children:a.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})}),a.jsx("span",{className:"text-red-800 font-medium",children:v})]}),a.jsx("button",{onClick:g,className:"text-red-600 hover:text-red-800 font-medium text-sm",children:"Retry"})]})}),!p&&!v&&a.jsx("div",{className:"flex gap-6 overflow-x-auto pb-6",children:ib.map(S=>{const R=I(E.filter(U=>U.status===S));return a.jsxs("div",{className:"min-w-[300px] flex-shrink-0",children:[a.jsxs("div",{className:"flex items-center justify-between mb-3",children:[a.jsx("h3",{className:"text-lg font-medium text-gray-900",children:S}),a.jsx("div",{className:"text-sm text-gray-600",children:R.length})]}),a.jsx("div",{className:"space-y-4",children:R.map(U=>a.jsx(nb,{project:U,onEdit:()=>{d(U),o(!0)},onDelete:()=>L(U.id),onOpen:()=>f(U)},U.id))})]},S)})})]}),l&&a.jsx(sb,{project:c,onClose:()=>o(!1),onCreate:b,onUpdate:P}),u&&a.jsx(ab,{project:u,onClose:()=>f(null),onEdit:S=>{d(S),o(!0),f(null)},onDelete:S=>L(S)}),h&&a.jsx("div",{className:"fixed right-6 bottom-6 bg-gray-900 text-white px-4 py-2 rounded shadow",children:h})]})}function ob({task:e,onClick:t}){var n;const r=s=>{const i=["bg-gray-600","bg-gray-700","bg-slate-600","bg-zinc-600","bg-neutral-600"],l=s.split("").reduce((o,c)=>o+c.charCodeAt(0),0);return i[l%i.length]};return a.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 hover:shadow-md transition-all cursor-pointer overflow-hidden",onClick:t,children:[e.coverImage?a.jsx("div",{className:"h-32 overflow-hidden",children:a.jsx("img",{src:e.coverImage,alt:e.title,className:"w-full h-full object-cover"})}):a.jsx("div",{className:"h-32 bg-gradient-to-br from-purple-100 to-pink-100 flex items-center justify-center",children:a.jsx("span",{className:"text-4xl opacity-30",children:""})}),a.jsxs("div",{className:"p-5",children:[e.project&&a.jsx("div",{className:"mb-2",children:a.jsxs("span",{className:"text-xs font-medium text-gray-600",children:["Project: ",a.jsx("span",{className:"text-gray-900",children:e.project})]})}),a.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:e.title}),a.jsx("p",{className:"text-sm text-gray-600 mb-4 line-clamp-2",children:e.description}),a.jsx("div",{className:"mb-4",children:a.jsx("span",{className:"text-xs text-gray-500",children:e.dueDate})}),a.jsx("div",{className:"mb-4",children:a.jsxs("span",{className:"text-xs text-gray-600",children:[((n=e.taskList)==null?void 0:n.length)||e.tasks||0," tasks"]})}),a.jsx("div",{className:"flex items-center justify-start pt-3 border-t border-gray-100",children:a.jsx("div",{className:"flex items-center -space-x-2",children:e.assignedUsers.map((s,i)=>a.jsx("div",{className:`w-8 h-8 ${r(s.name)} rounded-full flex items-center justify-center border-2 border-white`,title:s.name,children:a.jsx("span",{className:"text-xs font-semibold text-white",children:s.initials})},i))})})]})]})}function Nc({title:e,count:t,tasks:r,isCompleted:n=!1,onTaskClick:s}){return a.jsx("div",{className:"flex-shrink-0 w-[400px]",children:a.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 h-full",children:[a.jsx("div",{className:"mb-4",children:a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsx("h3",{className:"text-base font-semibold text-gray-900",children:e}),a.jsx("span",{className:"text-sm text-gray-500 bg-white px-2.5 py-1 rounded-full",children:t})]})}),a.jsx("div",{className:"space-y-4",children:r.map(i=>a.jsx(ob,{task:i,onClick:()=>s(i)},i.id))})]})})}function cb({isOpen:e,onClose:t,task:r}){const[n,s]=C.useState(!1),[i,l]=C.useState(2);if(!e)return null;const o=r||{title:"Monthly Product Discussion",description:"Monthly Product Discussion by Design and Marketing Teams with CEO to Plan our future products sales and reports",project:"RD Sales",badges:["Feedback","Bug"],dueDate:"24 Jan 2023",assignedUsers:[{name:"Floyd Miles",initials:"FM"},{name:"Dianne Russell",initials:"DR"},{name:"Annette Black",initials:"AB"}]},c=u=>u.split(" ").map(f=>f[0]).join("").toUpperCase().slice(0,2),d=u=>{const f=["bg-gray-400","bg-gray-500","bg-gray-600","bg-gray-700","bg-gray-800"],h=u.split("").reduce((m,p)=>m+p.charCodeAt(0),0);return f[h%f.length]};return a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-5xl max-h-[90vh] overflow-hidden flex flex-col",children:[a.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[a.jsxs("div",{className:"flex-1",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Project:"}),a.jsx("span",{className:"text-sm font-semibold text-gray-900",children:o.project||o.title})]}),a.jsx("div",{className:"flex items-center gap-1 ml-auto mr-4",children:[...Array(5)].map((u,f)=>a.jsx(uw,{className:`w-4 h-4 cursor-pointer ${f<i?"fill-yellow-400 text-yellow-400":"text-gray-300"}`,onClick:()=>l(f+1)},f))}),a.jsxs("div",{className:"relative",children:[a.jsx("button",{onClick:()=>s(!n),className:"text-gray-400 hover:text-gray-600 p-1",children:a.jsx(es,{className:"w-5 h-5"})}),n&&a.jsxs("div",{className:"absolute right-0 mt-2 w-48 bg-white rounded-lg shadow-lg border border-gray-200 py-1 z-10",children:[a.jsx("button",{className:"w-full px-4 py-2 text-left text-sm text-gray-700 hover:bg-gray-50",children:"Edit"}),a.jsx("button",{className:"w-full px-4 py-2 text-left text-sm text-gray-700 hover:bg-gray-50",children:"Delete"}),a.jsx("button",{className:"w-full px-4 py-2 text-left text-sm text-gray-700 hover:bg-gray-50",children:"Change Cover"})]})]})]}),o.badges&&o.badges.length>0&&a.jsx("div",{className:"flex flex-wrap gap-2 mb-3",children:o.badges.map((u,f)=>a.jsx("span",{className:`px-3 py-1 rounded-md text-xs font-medium ${u.toLowerCase()==="feedback"?"bg-green-100 text-green-700":u.toLowerCase()==="bug"?"bg-red-100 text-red-700":"bg-gray-100 text-gray-700"}`,children:u},f))}),a.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:o.title})]}),a.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-600 transition-colors ml-4",children:a.jsx(Ue,{className:"w-5 h-5"})})]}),a.jsx("div",{className:"flex-1 overflow-y-auto",children:a.jsxs("div",{className:"flex",children:[a.jsxs("div",{className:"flex-1 p-6 border-r border-gray-200",children:[a.jsx("div",{className:"mb-6",children:a.jsxs("div",{className:"relative bg-gradient-to-br from-purple-100 to-pink-100 rounded-lg overflow-hidden h-48 flex items-center justify-center group",children:[a.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:a.jsx(nw,{className:"w-12 h-12 text-purple-300"})}),a.jsx("button",{className:"absolute bottom-4 right-4 bg-white px-4 py-2 rounded-lg text-sm font-medium text-gray-700 opacity-0 group-hover:opacity-100 transition-opacity shadow-md hover:shadow-lg",children:"Change Cover"})]})}),a.jsxs("div",{className:"mb-6",children:[a.jsx("h3",{className:"text-sm font-semibold text-gray-900 mb-2",children:"Description"}),a.jsx("p",{className:"text-sm text-gray-600",children:o.description||"No description available"})]}),a.jsxs("div",{className:"mb-6",children:[a.jsx("div",{className:"flex items-center justify-between mb-3",children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Af,{className:"w-4 h-4 text-gray-400"}),a.jsx("h3",{className:"text-sm font-semibold text-gray-900",children:"Task Checklist"})]})}),a.jsx("div",{className:"space-y-2 mb-3",children:["Prepare Design Document","Document Signature","Pitch Deck Presentation Design"].map((u,f)=>a.jsxs("div",{className:"flex items-center justify-between p-2 hover:bg-gray-50 rounded",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("input",{type:"checkbox",className:"w-4 h-4 text-gray-600 border-gray-300 rounded"}),a.jsx("span",{className:"text-sm text-gray-700",children:u})]}),a.jsx("button",{className:"text-gray-400 hover:text-gray-600",children:a.jsx(es,{className:"w-4 h-4"})})]},f))}),a.jsx("button",{className:"text-sm text-gray-600 hover:text-gray-900 font-medium",children:"+ Add Item"})]}),a.jsxs("div",{className:"mb-6",children:[a.jsx("div",{className:"flex items-center justify-between mb-3",children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Af,{className:"w-4 h-4 text-gray-400"}),a.jsx("h3",{className:"text-sm font-semibold text-gray-900",children:"Daily Sprint"})]})}),a.jsx("div",{className:"space-y-2 mb-3",children:["Prepare Design Document","Document Signature"].map((u,f)=>a.jsxs("div",{className:"flex items-center justify-between p-2 hover:bg-gray-50 rounded",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("input",{type:"checkbox",className:"w-4 h-4 text-gray-600 border-gray-300 rounded"}),a.jsx("span",{className:"text-sm text-gray-700",children:u})]}),a.jsx("button",{className:"text-gray-400 hover:text-gray-600",children:a.jsx(es,{className:"w-4 h-4"})})]},f))}),a.jsx("button",{className:"text-sm text-gray-600 hover:text-gray-900 font-medium",children:"+ Add Item"})]}),a.jsx("div",{className:"mb-6",children:a.jsx("button",{className:"w-full py-2 text-sm font-medium text-white rounded-lg hover:opacity-90 transition-opacity",style:{backgroundColor:"#714b67"},children:"+ Add New Checklist"})}),a.jsxs("div",{className:"mb-6",children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-900 mb-2",children:"Add Your Comment"}),a.jsxs("div",{className:"relative",children:[a.jsx("input",{type:"text",placeholder:"Add Your Comment",className:"w-full px-4 py-2 pr-20 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-400 focus:border-transparent text-sm"}),a.jsxs("div",{className:"absolute right-2 top-1/2 transform -translate-y-1/2 flex items-center gap-2",children:[a.jsx("button",{className:"text-gray-400 hover:text-gray-600",children:a.jsx(ip,{className:"w-4 h-4"})}),a.jsx("button",{className:"text-gray-400 hover:text-gray-600",children:a.jsx(lp,{className:"w-4 h-4"})})]})]})]}),a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsx("h3",{className:"text-sm font-semibold text-gray-900",children:"Activity"}),a.jsx("button",{className:"text-sm text-gray-600 hover:text-gray-900 font-medium",children:"Hide Activity Details"})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"flex items-start gap-3",children:[a.jsx("div",{className:"w-8 h-8 bg-gray-600 rounded-full flex items-center justify-center flex-shrink-0",children:a.jsx("span",{className:"text-xs font-semibold text-white",children:"FE"})}),a.jsxs("div",{className:"flex-1",children:[a.jsxs("p",{className:"text-sm text-gray-700",children:[a.jsx("span",{className:"font-medium",children:"Frank Edward"})," mentioned you in a comment in Design Team Reports ",a.jsx("span",{className:"font-medium",children:"@brianf"})," have you update this design so we can use it on next meeting?"]}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"3 hours ago | Design Team"})]}),a.jsx("button",{className:"text-gray-400 hover:text-gray-600 flex-shrink-0",children:a.jsx(es,{className:"w-4 h-4"})})]}),a.jsxs("div",{className:"flex items-start gap-3",children:[a.jsx("div",{className:"w-8 h-8 bg-gray-500 rounded-full flex items-center justify-center flex-shrink-0",children:a.jsx("span",{className:"text-xs font-semibold text-white",children:"JW"})}),a.jsxs("div",{className:"flex-1",children:[a.jsxs("p",{className:"text-sm text-gray-700",children:[a.jsx("span",{className:"font-medium",children:"James Wong"})," Changed the due date of Monthly Team Meeting to Sep 12"]}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Aug 24 | Design Team"})]}),a.jsx("button",{className:"text-gray-400 hover:text-gray-600 flex-shrink-0",children:a.jsx(es,{className:"w-4 h-4"})})]})]})]})]}),a.jsxs("div",{className:"w-64 p-6 bg-gray-50",children:[a.jsxs("div",{className:"mb-6",children:[a.jsx("h3",{className:"text-sm font-semibold text-gray-900 mb-3",children:"Member"}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("div",{className:"flex -space-x-2",children:(o.assignedUsers||[]).map((u,f)=>a.jsx("div",{className:`w-8 h-8 ${d(u.name)} rounded-full flex items-center justify-center border-2 border-white`,title:u.name,children:a.jsx("span",{className:"text-xs font-semibold text-white",children:u.initials||c(u.name)})},f))}),a.jsx("button",{className:"w-8 h-8 border-2 border-dashed border-gray-300 rounded-full flex items-center justify-center text-gray-400 hover:border-gray-400 hover:text-gray-600 transition-colors",children:a.jsx(ar,{className:"w-4 h-4"})})]})]}),a.jsxs("div",{className:"mb-6",children:[a.jsx("h3",{className:"text-sm font-semibold text-gray-900 mb-3",children:"Due Date"}),a.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 bg-white border border-gray-300 rounded-lg",children:[a.jsx(Oo,{className:"w-4 h-4 text-gray-400"}),a.jsx("span",{className:"text-sm text-gray-700 flex-1",children:o.dueDate||"No due date"}),a.jsx("svg",{className:"w-4 h-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]})]}),a.jsxs("div",{className:"mb-6",children:[a.jsxs("div",{className:"flex items-center justify-between mb-3",children:[a.jsx("h3",{className:"text-sm font-semibold text-gray-900",children:"Labels"}),a.jsx("button",{className:"text-gray-400 hover:text-gray-600",children:a.jsx(ar,{className:"w-4 h-4"})})]}),a.jsxs("div",{className:"flex flex-wrap gap-2",children:[a.jsx("span",{className:"px-2.5 py-1 rounded-full text-xs font-medium bg-amber-100 text-amber-800",children:"Internal"}),a.jsx("span",{className:"px-2.5 py-1 rounded-full text-xs font-medium bg-green-100 text-green-800",children:"Marketing"})]})]}),a.jsx("div",{children:a.jsxs("div",{className:"flex items-center justify-between mb-3",children:[a.jsx("h3",{className:"text-sm font-semibold text-gray-900",children:"Attachment"}),a.jsx("button",{className:"text-gray-400 hover:text-gray-600",children:a.jsx(ar,{className:"w-4 h-4"})})]})})]})]})})]})})}function ub({project:e,isOpen:t,onClose:r,onAddTask:n,onEditTask:s,onDeleteTask:i}){return!t||!e?null:a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-3xl max-h-[85vh] overflow-hidden flex flex-col",children:[a.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[a.jsxs("div",{className:"flex-1",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[a.jsx("span",{className:"text-sm text-gray-500",children:"Project:"}),a.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:e.project||e.title})]}),a.jsx("p",{className:"text-sm text-gray-600",children:e.description})]}),a.jsx("button",{onClick:r,className:"text-gray-400 hover:text-gray-600 transition-colors ml-4",children:a.jsx(Ue,{className:"w-5 h-5"})})]}),a.jsxs("div",{className:"flex-1 overflow-y-auto p-6",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Tasks"}),a.jsxs("button",{onClick:()=>n(e),className:"flex items-center gap-2 px-4 py-2 text-sm font-medium text-white rounded-lg hover:opacity-90 transition-opacity",style:{backgroundColor:"#714b67"},children:[a.jsx(ar,{className:"w-4 h-4"}),"Add Task"]})]}),a.jsx("div",{className:"space-y-3",children:e.taskList&&e.taskList.length>0?e.taskList.map((l,o)=>a.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg hover:bg-gray-100 transition-colors",children:[a.jsxs("div",{className:"flex-1",children:[a.jsx("h4",{className:"text-sm font-medium text-gray-900",children:l.title}),a.jsx("p",{className:"text-xs text-gray-600 mt-1",children:l.description}),l.deadline&&a.jsxs("span",{className:"text-xs text-gray-500 mt-1 inline-block",children:["Due: ",new Date(l.deadline).toLocaleDateString()]})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("button",{onClick:()=>s(l,e),className:"p-2 text-gray-600 hover:text-gray-900 hover:bg-gray-200 rounded transition-colors",title:"Edit Task",children:a.jsx(iw,{className:"w-4 h-4"})}),i&&a.jsx("button",{onClick:()=>i(l.id,e.projectId),className:"p-2 text-red-600 hover:text-red-900 hover:bg-red-100 rounded transition-colors",title:"Delete Task",children:a.jsx(F0,{className:"w-4 h-4"})})]})]},l.id||o)):a.jsx("div",{className:"text-center py-8 text-gray-500",children:a.jsx("p",{children:'No tasks yet. Click "Add Task" to create one.'})})})]})]})})}const db=[{id:1,name:"Alex User",initials:"AU",email:"alex@example.com"},{id:2,name:"Floyd Miles",initials:"FM",email:"floyd@example.com"},{id:3,name:"Dianne Russell",initials:"DR",email:"dianne@example.com"},{id:4,name:"Annette Black",initials:"AB",email:"annette@example.com"},{id:5,name:"Unknown User",initials:"U",email:"unknown@example.com"},{id:6,name:"Frank Edward",initials:"FE",email:"frank@example.com"},{id:7,name:"James Wong",initials:"JW",email:"james@example.com"}];function fb({task:e,project:t,isOpen:r,onClose:n,onSave:s}){const[i,l]=C.useState("description"),[o,c]=C.useState({title:"",description:"",tags:[],deadline:"",coverImage:null,assignee:"",state:"new",priority:"medium"}),[d,u]=C.useState(""),[f,h]=C.useState([]),[m,p]=C.useState(!1),[x,v]=C.useState(null),[y,g]=C.useState(0),[w,b]=C.useState(!1),P=C.useRef(null),L=C.useRef(null),E=C.useRef(null);C.useEffect(()=>{e&&(c({title:e.title||"",description:e.description||"",tags:e.tags||[],deadline:e.deadline||"",coverImage:e.coverImage||null,assignee:e.assignee||"",state:e.state||"new",priority:e.priority||"medium"}),h(e.timesheets||[]))},[e]),C.useEffect(()=>{const ee=Y=>{E.current&&!E.current.contains(Y.target)&&b(!1)};return document.addEventListener("mousedown",ee),()=>document.removeEventListener("mousedown",ee)},[]),C.useEffect(()=>(m?P.current=setInterval(()=>{g(ee=>ee+1)},1e3):P.current&&clearInterval(P.current),()=>{P.current&&clearInterval(P.current)}),[m]);const I=()=>{v(new Date),p(!0),g(0)},S=()=>{if(x){const ee=new Date,Y=Math.floor((ee-x)/1e3),F={id:Date.now(),employee:o.assignee||"Current User",loginTime:x.toLocaleString("en-US",{hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!0}),logoutTime:ee.toLocaleString("en-US",{hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!0}),timeLogged:Y,date:ee.toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}),fullLoginDateTime:x.toLocaleString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!0}),fullLogoutDateTime:ee.toLocaleString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!0})};h([...f,F]),p(!1),v(null),g(0)}},R=ee=>{const Y=Math.floor(ee/3600),F=Math.floor(ee%3600/60),K=ee%60;return`${Y}h ${F}m ${K}s`},U=ee=>{const Y=Math.floor(ee/3600),F=Math.floor(ee%3600/60);return`${Y}h ${F}m`},G=()=>{const ee=f.reduce((Y,F)=>Y+F.timeLogged,0);return U(ee)},se=ee=>{const Y=ee.target.files[0];if(Y){const F=new FileReader;F.onloadend=()=>{c({...o,coverImage:F.result})},F.readAsDataURL(Y)}},Ne=()=>{c({...o,coverImage:null}),L.current&&(L.current.value="")},ae=()=>{const ee={...e,...o,timesheets:f,lastModified:new Date().toISOString(),lastModifiedBy:o.assignee||"Current User"};s(ee)},xe=ee=>{c({...o,assignee:ee.name}),b(!1)};return r?a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-4xl max-h-[90vh] overflow-hidden flex flex-col",children:[a.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200 bg-gray-50",children:[a.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[a.jsx("span",{children:(t==null?void 0:t.project)||(t==null?void 0:t.title)||"Project"}),a.jsx("span",{children:">"}),a.jsx("span",{className:"font-medium text-gray-900",children:"Edit Task"})]}),a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("button",{onClick:n,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",children:"Discard"}),a.jsx("button",{onClick:ae,className:"px-4 py-2 text-sm font-medium text-white rounded-lg hover:opacity-90",style:{backgroundColor:"#714b67"},children:"Save"}),a.jsx("button",{onClick:n,className:"text-gray-400 hover:text-gray-600 transition-colors",children:a.jsx(Ue,{className:"w-5 h-5"})})]})]}),a.jsxs("div",{className:"flex-1 overflow-y-auto p-6",children:[a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Task Title"}),a.jsx("input",{type:"text",value:o.title,onChange:ee=>c({...o,title:ee.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500",placeholder:"Enter task title"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Assignee"}),a.jsxs("div",{className:"relative",ref:E,children:[a.jsxs("button",{type:"button",onClick:()=>b(!w),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 bg-white text-left flex items-center justify-between",children:[a.jsx("span",{className:"text-gray-900",children:o.assignee||"Select assignee"}),a.jsx(Bn,{className:"w-4 h-4 text-gray-400"})]}),w&&a.jsx("div",{className:"absolute z-10 w-full mt-1 bg-white border border-gray-300 rounded-lg shadow-lg max-h-60 overflow-auto",children:db.map(ee=>a.jsxs("button",{type:"button",onClick:()=>xe(ee),className:"w-full px-4 py-2 text-left hover:bg-gray-50 flex items-center gap-3 transition-colors",children:[a.jsx("div",{className:"w-8 h-8 bg-gray-600 rounded-full flex items-center justify-center flex-shrink-0",children:a.jsx("span",{className:"text-xs font-semibold text-white",children:ee.initials})}),a.jsxs("div",{className:"flex-1",children:[a.jsx("p",{className:"text-sm font-medium text-gray-900",children:ee.name}),a.jsx("p",{className:"text-xs text-gray-500",children:ee.email})]}),o.assignee===ee.name&&a.jsx("svg",{className:"w-5 h-5 text-purple-600",fill:"currentColor",viewBox:"0 0 20 20",children:a.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})]},ee.id))})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Status"}),a.jsxs("select",{value:o.state,onChange:ee=>c({...o,state:ee.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500",children:[a.jsx("option",{value:"new",children:"New"}),a.jsx("option",{value:"in_progress",children:"In Progress"}),a.jsx("option",{value:"blocked",children:"Blocked"}),a.jsx("option",{value:"done",children:"Done"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Priority"}),a.jsxs("select",{value:o.priority,onChange:ee=>c({...o,priority:ee.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500",children:[a.jsx("option",{value:"low",children:"Low"}),a.jsx("option",{value:"medium",children:"Medium"}),a.jsx("option",{value:"high",children:"High"}),a.jsx("option",{value:"urgent",children:"Urgent"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Deadline"}),a.jsx("input",{type:"datetime-local",value:o.deadline,min:new Date().toISOString().slice(0,16),onChange:ee=>c({...o,deadline:ee.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Cover Image"}),o.coverImage?a.jsxs("div",{className:"relative",children:[a.jsx("img",{src:o.coverImage,alt:"Cover",className:"w-full h-48 object-cover rounded-lg"}),a.jsx("button",{onClick:Ne,className:"absolute top-2 right-2 p-2 bg-red-500 text-white rounded-lg hover:bg-red-600",children:a.jsx(F0,{className:"w-4 h-4"})})]}):a.jsxs("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-8 text-center",children:[a.jsx(O0,{className:"w-8 h-8 text-gray-400 mx-auto mb-2"}),a.jsx("p",{className:"text-sm text-gray-600 mb-2",children:"Upload cover image"}),a.jsx("input",{ref:L,type:"file",accept:"image/*",onChange:se,className:"hidden",id:"image-upload"}),a.jsx("label",{htmlFor:"image-upload",className:"px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 cursor-pointer inline-block",children:"Choose File"})]})]})]}),a.jsxs("div",{className:"mt-8 border-t border-gray-200",children:[a.jsxs("div",{className:"flex gap-4 border-b border-gray-200",children:[a.jsx("button",{onClick:()=>l("description"),className:`px-4 py-3 text-sm font-medium border-b-2 transition-colors ${i==="description"?"border-purple-600 text-purple-600":"border-transparent text-gray-600 hover:text-gray-900"}`,children:"Description"}),a.jsx("button",{onClick:()=>l("timesheets"),className:`px-4 py-3 text-sm font-medium border-b-2 transition-colors ${i==="timesheets"?"border-purple-600 text-purple-600":"border-transparent text-gray-600 hover:text-gray-900"}`,children:"Timesheets"}),a.jsx("button",{onClick:()=>l("taskinfo"),className:`px-4 py-3 text-sm font-medium border-b-2 transition-colors ${i==="taskinfo"?"border-purple-600 text-purple-600":"border-transparent text-gray-600 hover:text-gray-900"}`,children:"Task Info"})]}),a.jsxs("div",{className:"py-6",children:[i==="description"&&a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Task Description"}),a.jsx("textarea",{value:o.description,onChange:ee=>c({...o,description:ee.target.value}),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 min-h-[200px]",placeholder:"Enter task description..."})]}),i==="timesheets"&&a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("h3",{className:"text-sm font-semibold text-gray-900",children:"Time Tracking"}),m&&a.jsxs("span",{className:"text-sm text-green-600 font-medium",children:["Running: ",R(y)]})]}),a.jsx("div",{className:"flex gap-2",children:m?a.jsx("button",{onClick:S,className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 text-sm font-medium",children:"Stop Tracking"}):a.jsx("button",{onClick:I,className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 text-sm font-medium",children:"Start Tracking"})})]}),a.jsx("div",{className:"mb-4 p-4 bg-gray-50 rounded-lg",children:a.jsxs("p",{className:"text-sm text-gray-600",children:["Total Time Logged: ",a.jsx("span",{className:"font-semibold text-gray-900",children:G()})]})}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full border border-gray-200 rounded-lg",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-700 uppercase tracking-wider",children:"Employee"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-700 uppercase tracking-wider",children:"Login Time"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-700 uppercase tracking-wider",children:"Logout Time"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-700 uppercase tracking-wider",children:"Time Logged"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-700 uppercase tracking-wider",children:"Date"})]})}),a.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:f.length>0?f.map((ee,Y)=>a.jsxs("tr",{className:"hover:bg-gray-50",children:[a.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:ee.employee}),a.jsx("td",{className:"px-4 py-3 text-sm text-gray-600",children:ee.fullLoginDateTime||ee.loginTime}),a.jsx("td",{className:"px-4 py-3 text-sm text-gray-600",children:ee.fullLogoutDateTime||ee.logoutTime}),a.jsx("td",{className:"px-4 py-3 text-sm text-gray-900 font-medium",children:U(ee.timeLogged)}),a.jsx("td",{className:"px-4 py-3 text-sm text-gray-600",children:ee.date})]},ee.id||Y)):a.jsx("tr",{children:a.jsx("td",{colSpan:"5",className:"px-4 py-8 text-center text-sm text-gray-500",children:"No time logged yet. Start tracking to begin."})})})]})})]}),i==="taskinfo"&&a.jsxs("div",{className:"space-y-4",children:[a.jsx("h3",{className:"text-sm font-semibold text-gray-900",children:"Task Information"}),a.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 space-y-3",children:[a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-sm text-gray-600",children:"Created:"}),a.jsx("span",{className:"text-sm text-gray-900 font-medium",children:new Date((e==null?void 0:e.created)||Date.now()).toLocaleString()})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-sm text-gray-600",children:"Last Modified:"}),a.jsx("span",{className:"text-sm text-gray-900 font-medium",children:e!=null&&e.lastModified?new Date(e.lastModified).toLocaleString():"Never"})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-sm text-gray-600",children:"Last Modified By:"}),a.jsx("span",{className:"text-sm text-gray-900 font-medium",children:(e==null?void 0:e.lastModifiedBy)||"N/A"})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-sm text-gray-600",children:"Status:"}),a.jsx("span",{className:"text-sm text-gray-900 font-medium",children:(e==null?void 0:e.status)||"In Progress"})]})]}),a.jsxs("div",{className:"mt-6",children:[a.jsx("h4",{className:"text-sm font-semibold text-gray-900 mb-3",children:"Change History"}),a.jsx("div",{className:"space-y-2",children:e!=null&&e.changeHistory&&e.changeHistory.length>0?e.changeHistory.map((ee,Y)=>a.jsxs("div",{className:"p-3 bg-gray-50 rounded border border-gray-200",children:[a.jsx("p",{className:"text-sm text-gray-900",children:ee.description}),a.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[new Date(ee.timestamp).toLocaleString()," by ",ee.user]})]},Y)):a.jsx("p",{className:"text-sm text-gray-500",children:"No change history available"})})]})]})]})]})]})]})}):null}function hb(){const[e,t]=C.useState(!1),[r,n]=C.useState("kanban"),[s,i]=C.useState(null),[l,o]=C.useState(!1),[c,d]=C.useState(null),[u,f]=C.useState(!1),[h,m]=C.useState(null),[p,x]=C.useState([]),[v,y]=C.useState({new:[],inProgress:[],done:[]}),[g,w]=C.useState(!0),[b,P]=C.useState(null);C.useEffect(()=>{L()},[]);const L=async()=>{try{w(!0);const xe=await kr.getAll();if(!xe.success)throw new Error("Failed to load projects");const ee=xe.data;x(ee);const Y=ee.map(T=>il.getAll(T.id)),F=await Promise.all(Y),K={new:[],inProgress:[],done:[]},te={new:new Map,inProgress:new Map,done:new Map};ee.forEach((T,M)=>{const D=F[M],B=D.success?D.data:[],q={new:[],inProgress:[],done:[]};B.forEach(W=>{const Z={id:W.id,title:W.title,description:W.description,deadline:W.due_date,tags:W.labels||[],assignee:"User",created:W.created_at,state:W.state,priority:W.priority,timesheets:[],changeHistory:[]};W.state==="new"?q.new.push(Z):W.state==="in_progress"||W.state==="blocked"?q.inProgress.push(Z):W.state==="done"&&q.done.push(Z)}),Object.keys(q).forEach(W=>{if(q[W].length>0){const Z=[...new Set(q[W].flatMap(je=>je.tags||[]))],ie=q[W].map(je=>je.deadline).filter(je=>je).map(je=>new Date(je)),ce=ie.length>0?new Date(Math.min(...ie)):null,ne=ie.length>0?new Date(Math.max(...ie)):null,me=ce&&ne?`${ce.toLocaleDateString()}  ${ne.toLocaleDateString()}`:"",Se={id:`${T.id}-${W}`,title:T.name,description:T.description,project:T.name,badges:Z,dueDate:me,tasks:q[W].length,assignedUsers:[{name:"User",initials:"U"}],taskList:q[W],projectId:T.id,projectData:T};K[W].push(Se)}})}),y(K),w(!1)}catch(xe){console.error("Error loading data:",xe),P(xe.message),w(!1)}},E=xe=>{d(xe),o(!0)},I=()=>{t(!1),i(null)},S=()=>{o(!1),d(null)},R=xe=>{const ee={id:Date.now(),title:"New Task",description:"",deadline:"",tags:[],assignee:"",created:new Date().toISOString(),timesheets:[],changeHistory:[{description:"Task created",timestamp:new Date().toISOString(),user:"Current User"}]};m(ee),d(xe),f(!0)},U=(xe,ee)=>{m(xe),d(ee),f(!0)},G=async xe=>{var ee;try{const Y=(c==null?void 0:c.projectId)||(c==null?void 0:c.id)||((ee=p[0])==null?void 0:ee.id);if(!Y){alert("No project selected");return}if(!xe.title||xe.title.trim().length===0){alert("Task title is required");return}const F={title:xe.title.trim(),description:xe.description||"",state:xe.state||"new",priority:xe.priority||"medium",due_date:xe.deadline||null,labels:xe.tags||[]},K=String(xe.id),te=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i.test(K);console.log("Saving task:",{taskId:xe.id,taskIdStr:K,isUUID:te,projectId:Y,taskData:F});let T;te?(console.log("Updating existing task:",xe.id),T=await il.update(Y,xe.id,F)):(console.log("Creating new task"),T=await il.create(Y,F)),T.success?(console.log("Task saved successfully:",T.data),await L(),f(!1),m(null)):alert("Failed to save task: "+T.message)}catch(Y){console.error("Error saving task:",Y),alert("Error saving task: "+Y.message)}},se=()=>{f(!1),m(null)},Ne=async(xe,ee)=>{if(confirm("Are you sure you want to delete this task?"))try{const Y=await il.delete(ee,xe);Y.success?await L():alert("Failed to delete task: "+Y.message)}catch(Y){console.error("Error deleting task:",Y),alert("Error deleting task: "+Y.message)}},ae=()=>{const xe={id:Date.now(),title:"",description:"",deadline:"",tags:[],assignee:"",created:new Date().toISOString(),timesheets:[],changeHistory:[{description:"Task created",timestamp:new Date().toISOString(),user:"Current User"}]};m(xe),d({project:"New Task",title:"New Task"}),f(!0)};return a.jsxs("div",{className:"h-full bg-gray-50",children:[a.jsx(cb,{isOpen:e,onClose:I,task:s}),a.jsx(ub,{project:c,isOpen:l,onClose:S,onAddTask:R,onEditTask:U,onDeleteTask:Ne}),a.jsx(fb,{task:h,project:c,isOpen:u,onClose:se,onSave:G}),a.jsx("header",{className:"bg-white border-b border-gray-200 px-8 py-6",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("h1",{className:"text-3xl font-semibold text-gray-900",children:"Tasks View"}),a.jsx("div",{className:"flex items-center gap-3",children:a.jsxs("button",{onClick:ae,className:"flex items-center gap-2 px-5 py-2.5 text-sm font-medium text-white rounded-lg hover:opacity-90 transition-opacity",style:{backgroundColor:"#714b67"},children:[a.jsx(ar,{className:"w-4 h-4"}),"New"]})})]})}),a.jsx("div",{className:"p-8",children:g?a.jsx("div",{className:"flex items-center justify-center h-64",children:a.jsx("p",{className:"text-gray-500",children:"Loading tasks..."})}):b?a.jsx("div",{className:"flex items-center justify-center h-64",children:a.jsxs("p",{className:"text-red-500",children:["Error: ",b]})}):a.jsxs("div",{className:"flex gap-6 overflow-x-auto pb-4",children:[a.jsx(Nc,{title:"New",count:v.new.length,tasks:v.new,onTaskClick:E}),a.jsx(Nc,{title:"In Progress",count:v.inProgress.length,tasks:v.inProgress,onTaskClick:E}),a.jsx(Nc,{title:"Completed",count:v.done.length,tasks:v.done,isCompleted:!0,onTaskClick:E})]})})]})}function xb({notification:e,getInitials:t,getAvatarColor:r}){const[n,s]=C.useState(!1),[i,l]=C.useState("");return a.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-5 hover:shadow-md transition-shadow",children:a.jsxs("div",{className:"flex items-start gap-4",children:[!e.isRead&&a.jsx("div",{className:"w-2 h-2 rounded-full mt-2 flex-shrink-0",style:{backgroundColor:"#714b67"}}),e.isRead&&a.jsx("div",{className:"w-2 flex-shrink-0"}),a.jsx("div",{className:`w-10 h-10 ${r(e.user.name)} rounded-full flex items-center justify-center flex-shrink-0`,children:a.jsx("span",{className:"text-sm font-semibold text-white",children:t(e.user.name)})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsxs("p",{className:"text-sm text-gray-700 mb-2",children:[a.jsx("span",{className:"font-semibold text-gray-900",children:e.user.name})," ",e.message," ",a.jsx("span",{className:"font-semibold text-gray-900",children:e.project})]}),e.quotedComment&&a.jsx("div",{className:"mb-3 pl-3 border-l-2 border-gray-300 bg-gray-50 rounded-r py-2",children:a.jsx("p",{className:"text-sm text-gray-600",children:e.quotedComment})}),a.jsxs("div",{className:"mb-2",children:[e.action==="reply"&&a.jsx(a.Fragment,{children:n?a.jsxs("div",{className:"space-y-2",children:[a.jsx("textarea",{value:i,onChange:o=>l(o.target.value),placeholder:"Type your reply...",className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-400 focus:border-transparent resize-none",rows:"3"}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("button",{onClick:()=>{s(!1),l("")},className:"px-3 py-1.5 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:"Cancel"}),a.jsxs("button",{onClick:()=>{s(!1),l("")},className:"flex items-center gap-1.5 px-3 py-1.5 text-sm font-medium text-white rounded-lg hover:opacity-90 transition-opacity",style:{backgroundColor:"#714b67"},children:[a.jsx(lp,{className:"w-3.5 h-3.5"}),"Send"]})]})]}):a.jsxs("button",{onClick:()=>s(!0),className:"flex items-center gap-1.5 px-3 py-1.5 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:[a.jsx(lw,{className:"w-3.5 h-3.5"}),"Reply"]})}),e.action==="accept-decline"&&a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsxs("button",{className:"flex items-center gap-1.5 px-3 py-1.5 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:[a.jsx(Ue,{className:"w-3.5 h-3.5"}),"Decline"]}),a.jsxs("button",{className:"flex items-center gap-1.5 px-3 py-1.5 text-sm font-medium text-white rounded-lg hover:opacity-90 transition-opacity",style:{backgroundColor:"#714b67"},children:[a.jsx(ew,{className:"w-3.5 h-3.5"}),"Accept"]})]})]}),a.jsxs("p",{className:"text-xs text-gray-500",children:[e.time," | ",e.team]})]}),a.jsx("button",{className:"text-gray-400 hover:text-gray-600 transition-colors flex-shrink-0",children:a.jsx(es,{className:"w-4 h-4"})})]})})}const Rf={all:[{id:1,isRead:!1,user:{name:"Frank Edward",avatar:"FE"},type:"mention",message:"mentioned you in a comment in",project:"Design Team Reports",quotedComment:"@brianf have you update this design so we can use it on next meeting?",action:"reply",time:"3 hours ago",team:"Design Team"},{id:2,isRead:!1,user:{name:"Elsa Wright",avatar:"EW"},type:"access",message:"Asking for edit access in",project:"Monthly Team Progress",action:"accept-decline",time:"Yesterday",team:"Marketing Team"},{id:3,isRead:!0,user:{name:"James Wong",avatar:"JW"},type:"mention",message:"mentioned you in a comment in",project:"Monthly Team Meeting",quotedComment:"@brianf let's we plan all this event by now",action:"reply",time:"Aug 24",team:"Design Team"}],tasks:[],archived:[]};function mb(){const[e,t]=C.useState("all"),r=Rf.all.filter(i=>!i.isRead).length,n=i=>i.split(" ").map(l=>l[0]).join("").toUpperCase().slice(0,2),s=i=>{const l=["bg-gray-400","bg-gray-500","bg-gray-600","bg-gray-700","bg-gray-800"],o=i.split("").reduce((c,d)=>c+d.charCodeAt(0),0);return l[o%l.length]};return a.jsx("div",{className:"h-full bg-gray-50",children:a.jsxs("div",{className:"w-full bg-white min-h-full",children:[a.jsxs("div",{className:"border-b border-gray-200 px-8 py-6",children:[a.jsxs("div",{className:"flex items-center justify-between mb-6",children:[a.jsx("h1",{className:"text-2xl font-semibold text-gray-900",children:"Notifications"}),a.jsx("button",{className:"text-gray-400 hover:text-gray-600 transition-colors",children:a.jsx(Ue,{className:"w-5 h-5"})})]}),a.jsxs("div",{className:"flex items-center gap-8 border-b border-gray-200",children:[a.jsxs("button",{onClick:()=>t("all"),className:`flex items-center gap-2 pb-4 px-1 relative ${e==="all"?"text-gray-900":"text-gray-600 hover:text-gray-900"} transition-colors`,children:[a.jsx(sp,{className:"w-4 h-4"}),a.jsx("span",{className:"text-sm font-medium",children:"All"}),r>0&&a.jsx("span",{className:"ml-1 px-1.5 py-0.5 text-xs font-semibold text-white rounded-full",style:{backgroundColor:"#714b67"},children:r}),e==="all"&&a.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-0.5",style:{backgroundColor:"#714b67"}})]}),a.jsxs("button",{onClick:()=>t("tasks"),className:`flex items-center gap-2 pb-4 px-1 relative ${e==="tasks"?"text-gray-900":"text-gray-600 hover:text-gray-900"} transition-colors`,children:[a.jsx(tw,{className:"w-4 h-4"}),a.jsx("span",{className:"text-sm font-medium",children:"Tasks"}),e==="tasks"&&a.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-0.5",style:{backgroundColor:"#714b67"}})]}),a.jsxs("button",{onClick:()=>t("archived"),className:`flex items-center gap-2 pb-4 px-1 relative ${e==="archived"?"text-gray-900":"text-gray-600 hover:text-gray-900"} transition-colors`,children:[a.jsx(Q2,{className:"w-4 h-4"}),a.jsx("span",{className:"text-sm font-medium",children:"Archived"}),e==="archived"&&a.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-0.5",style:{backgroundColor:"#714b67"}})]})]}),a.jsxs("div",{className:"flex items-center justify-between mt-4",children:[a.jsx("button",{className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white rounded-lg hover:bg-gray-50 transition-colors",style:{border:"1.5px solid #714b67"},children:"Mark All as Read"}),a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("button",{className:"text-gray-400 hover:text-gray-600 transition-colors",children:a.jsx(Xn,{className:"w-5 h-5"})}),a.jsx("button",{className:"text-gray-400 hover:text-gray-600 transition-colors",children:a.jsx(op,{className:"w-5 h-5"})})]})]})]}),a.jsx("div",{className:"p-8",children:a.jsx("div",{className:"space-y-4",children:Rf[e].map(i=>a.jsx(xb,{notification:i,getInitials:n,getAvatarColor:s},i.id))})})]})})}function pb(){return a.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[a.jsx("div",{className:"flex items-center justify-between mb-4",children:a.jsx("h3",{className:"text-sm font-semibold text-gray-900",children:"Completed Task"})}),a.jsx("div",{className:"mb-4",children:a.jsx("p",{className:"text-3xl font-bold text-gray-900",children:"21 Task"})}),a.jsx("button",{className:"w-full px-4 py-2 text-sm font-medium text-gray-700 bg-white rounded-lg hover:bg-gray-50 transition-colors",style:{border:"1.5px solid #714b67"},children:"View All"})]})}const If=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],Df=[45,75,35,60,51,40,55,65,50,70,45,60];function gb(){const[e,t]=C.useState(null),r=Math.max(...Df);return a.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsx("h3",{className:"text-sm font-semibold text-gray-900",children:"Active Projects"}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsxs("button",{className:"flex items-center gap-1 px-3 py-1.5 text-xs font-medium text-gray-700 bg-white rounded-lg hover:bg-gray-50",style:{border:"1.5px solid #714b67"},children:["January, 2023 - December, 2023",a.jsx(Bn,{className:"w-3 h-3"})]}),a.jsxs("button",{className:"flex items-center gap-1 px-3 py-1.5 text-xs font-medium text-gray-700 bg-white rounded-lg hover:bg-gray-50",style:{border:"1.5px solid #714b67"},children:["Month",a.jsx(Bn,{className:"w-3 h-3"})]})]})]}),a.jsxs("div",{className:"mb-4",children:[a.jsxs("div",{className:"flex items-baseline gap-2 mb-1",children:[a.jsx("p",{className:"text-3xl font-bold text-gray-900",children:"68 Projects"}),a.jsxs("div",{className:"flex items-center gap-1 text-green-600",children:[a.jsx(Ro,{className:"w-4 h-4"}),a.jsx("span",{className:"text-sm font-semibold",children:"12%"})]})]}),a.jsx("p",{className:"text-sm text-gray-500",children:"This Month"})]}),a.jsxs("div",{className:"relative",children:[a.jsxs("div",{className:"absolute left-0 top-0 bottom-12 flex flex-col justify-between text-xs text-gray-500",style:{width:"30px"},children:[a.jsx("span",{children:"100"}),a.jsx("span",{children:"50"}),a.jsx("span",{children:"25"}),a.jsx("span",{children:"0"})]}),a.jsxs("div",{className:"ml-8",children:[a.jsx("div",{className:"flex items-end justify-between h-48 gap-1 relative",children:Df.map((n,s)=>{const i=n/r*100,l=e===s;return a.jsxs("div",{className:"flex-1 flex flex-col items-center group cursor-pointer relative h-full",onMouseEnter:()=>t(s),onMouseLeave:()=>t(null),children:[l&&a.jsxs("div",{className:"absolute bottom-full mb-2 px-3 py-2 bg-gray-900 text-white text-xs rounded-lg shadow-lg z-20 whitespace-nowrap",style:{left:"50%",transform:"translateX(-50%)",marginBottom:"8px"},children:[a.jsxs("div",{className:"flex items-center gap-1 mb-1",children:[a.jsx(Oo,{className:"w-3 h-3"}),a.jsxs("span",{children:[If[s]," 2023"]})]}),a.jsxs("div",{children:["Active Projects ",n]}),a.jsx("div",{className:"absolute top-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-l-4 border-r-4 border-t-4 border-transparent border-t-gray-900"})]}),l&&a.jsx("div",{className:"absolute bottom-0 w-px border-l border-dashed border-gray-400 z-10",style:{left:"50%",transform:"translateX(-50%)",height:"100%",top:0}}),a.jsx("div",{className:"w-full h-full flex items-end",children:a.jsx("div",{className:"w-full rounded-t transition-all duration-200 relative z-0",style:{height:`${i}%`,backgroundColor:l?"#714b67":"#1f2937",minHeight:"8px"}})})]},s)})}),a.jsx("div",{className:"flex justify-between mt-2 text-xs text-gray-500",children:If.map((n,s)=>a.jsx("span",{className:"flex-1 text-center",children:n},s))})]})]})]})}const vb=[{name:"Product Hunt",logo:"P",value:5,change:"up",color:"bg-orange-500"},{name:"Google",logo:"G",value:2,change:"up",color:"bg-blue-500"},{name:"Wordpress",logo:"W",value:1,change:"up",color:"bg-blue-600"},{name:"Tripadvisor",logo:"T",value:3,change:"down",color:"bg-green-500"},{name:"Slack",logo:"S",value:2,change:"down",color:"bg-purple-500"},{name:"Zendesk",logo:"Z",value:3,change:"down",color:"bg-gray-900"}];function yb(){return a.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[a.jsx("h3",{className:"text-sm font-semibold text-gray-900 mb-4",children:"Top Companies"}),a.jsx("div",{className:"space-y-3",children:vb.map((e,t)=>a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsxs("span",{className:"text-sm font-medium text-gray-500",children:[t+1,"."]}),a.jsx("div",{className:`w-8 h-8 ${e.color} rounded flex items-center justify-center`,children:a.jsx("span",{className:"text-white font-bold text-sm",children:e.logo})}),a.jsx("span",{className:"text-sm font-medium text-gray-900",children:e.name})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"text-sm font-semibold text-gray-900",children:e.value}),e.change==="up"?a.jsx(Ro,{className:"w-4 h-4 text-green-600"}):a.jsx(dw,{className:"w-4 h-4 text-red-600"})]})]},t))})]})}const yp=[{name:"Agency",value:57},{name:"Development",value:38},{name:"Marketing",value:25},{name:"Communication",value:38},{name:"Web Development",value:13},{name:"Travel Agency",value:11}],wb=Math.max(...yp.map(e=>e.value));function bb(){return a.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsx("h3",{className:"text-sm font-semibold text-gray-900",children:"Active Companies"}),a.jsxs("button",{className:"flex items-center gap-1 px-3 py-1.5 text-xs font-medium text-gray-700 bg-white rounded-lg hover:bg-gray-50",style:{border:"1.5px solid #714b67"},children:["Year",a.jsx(Bn,{className:"w-3 h-3"})]})]}),a.jsxs("div",{className:"mb-4",children:[a.jsxs("div",{className:"flex items-baseline gap-2 mb-1",children:[a.jsx("p",{className:"text-3xl font-bold text-gray-900",children:"341 Companies"}),a.jsxs("div",{className:"flex items-center gap-1 text-green-600",children:[a.jsx(Ro,{className:"w-4 h-4"}),a.jsx("span",{className:"text-sm font-semibold",children:"12%"})]})]}),a.jsx("p",{className:"text-sm text-gray-500",children:"This Years"})]}),a.jsx("div",{className:"space-y-3",children:yp.map((e,t)=>{const r=e.value/wb*100;return a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center justify-between mb-1",children:[a.jsx("span",{className:"text-sm text-gray-700",children:e.name}),a.jsx("span",{className:"text-sm font-semibold text-gray-900",children:e.value})]}),a.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:a.jsx("div",{className:"bg-gray-800 h-2 rounded-full transition-all duration-300",style:{width:`${r}%`}})})]},t)})})]})}const Nb=[{day:"Sun",target:100,completed:75},{day:"Mon",target:100,completed:85},{day:"Tue",target:100,completed:60},{day:"Wed",target:100,completed:90},{day:"Thu",target:100,completed:70},{day:"Fri",target:100,completed:80},{day:"Sat",target:100,completed:65}];function jb(){return a.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[a.jsx("h3",{className:"text-sm font-semibold text-gray-900 mb-6",children:"Completed Project Target This Week"}),a.jsx("div",{className:"flex items-end justify-between gap-2 h-32",children:Nb.map((t,r)=>{const n=t.target/100*120,s=t.completed/100*120;return a.jsxs("div",{className:"flex-1 flex flex-col items-center",children:[a.jsxs("div",{className:"relative w-full flex flex-col items-center justify-end",style:{height:"120px"},children:[a.jsx("div",{className:"w-full bg-gray-200 rounded-t",style:{height:`${n}px`}}),a.jsx("div",{className:"absolute w-full bg-gray-900 rounded-t bottom-0",style:{height:`${s}px`}})]}),a.jsx("span",{className:"text-xs text-gray-500 mt-2",children:t.day})]},r)})})]})}function Sb(){const[e,t]=C.useState("analytics");return a.jsx("div",{className:"h-full bg-gray-50",children:a.jsxs("div",{className:"w-full bg-white min-h-full",children:[a.jsxs("div",{className:"border-b border-gray-200 px-8 py-6",children:[a.jsx("div",{className:"flex items-center justify-between mb-6",children:a.jsx("h1",{className:"text-2xl font-semibold text-gray-900",children:"Analytics"})}),a.jsxs("div",{className:"flex items-center gap-6 border-b border-gray-200",children:[a.jsxs("button",{onClick:()=>t("analytics"),className:`pb-4 px-1 relative ${e==="analytics"?"text-gray-900 font-medium":"text-gray-600 hover:text-gray-900"} transition-colors`,children:[a.jsx("span",{className:"text-sm",children:"Analytics"}),e==="analytics"&&a.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-0.5",style:{backgroundColor:"#714b67"}})]}),a.jsxs("button",{onClick:()=>t("sales"),className:`flex items-center gap-2 pb-4 px-1 relative ${e==="sales"?"text-gray-900 font-medium":"text-gray-600 hover:text-gray-900"} transition-colors`,children:[a.jsx(rw,{className:"w-4 h-4"}),a.jsx("span",{className:"text-sm",children:"Sales"}),e==="sales"&&a.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-0.5",style:{backgroundColor:"#714b67"}})]}),a.jsxs("button",{onClick:()=>t("activity"),className:`flex items-center gap-2 pb-4 px-1 relative ${e==="activity"?"text-gray-900 font-medium":"text-gray-600 hover:text-gray-900"} transition-colors`,children:[a.jsx(Yt,{className:"w-4 h-4"}),a.jsx("span",{className:"text-sm",children:"Activity"}),e==="activity"&&a.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-0.5",style:{backgroundColor:"#714b67"}})]})]})]}),a.jsx("div",{className:"p-8",children:a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-12 gap-6",children:[a.jsx("div",{className:"lg:col-span-9",children:a.jsx(gb,{})}),a.jsxs("div",{className:"lg:col-span-3 space-y-6",children:[a.jsx(pb,{}),a.jsx(yb,{})]}),a.jsxs("div",{className:"lg:col-span-12 grid grid-cols-1 md:grid-cols-2 gap-6",children:[a.jsx(bb,{}),a.jsx(jb,{})]})]})})]})})}const Lf=()=>{const e=ma(),[t,r]=C.useState({stats:{activeProjects:0,delayedTasks:0,hoursLogged:0,revenueEarned:0},projects:[],filteredProjects:[]}),[n,s]=C.useState({status:"all",search:""}),[i,l]=C.useState(!0),[o,c]=C.useState(null);C.useEffect(()=>{d()},[]),C.useEffect(()=>{u()},[n,t.projects]);const d=async()=>{try{l(!0),c(null);const[b,P]=await Promise.all([Pf.getStats(),Pf.getProjects()]);if(b.success&&P.success)r(L=>({...L,stats:b.data,projects:P.data,filteredProjects:P.data}));else throw new Error("Failed to load dashboard data")}catch(b){console.error("Dashboard data fetch error:",b),c(b.message)}finally{l(!1)}},u=()=>{let b=[...t.projects];if(n.status!=="all"&&(b=b.filter(P=>P.status===n.status)),n.search.trim()){const P=n.search.toLowerCase();b=b.filter(L=>{var E,I;return L.name.toLowerCase().includes(P)||((E=L.description)==null?void 0:E.toLowerCase().includes(P))||((I=L.manager)==null?void 0:I.name.toLowerCase().includes(P))})}r(P=>({...P,filteredProjects:b}))},f=b=>{s(P=>({...P,status:b}))},h=b=>{s(P=>({...P,search:b.target.value}))},m=b=>{e("/app/projects")},p=[{id:"active-projects",label:"Active Projects",value:t.stats.activeProjects,icon:kf,bgColor:"bg-blue-50",iconColor:"text-blue-600",description:"Currently in progress"},{id:"delayed-tasks",label:"Delayed Tasks",value:t.stats.delayedTasks,icon:Ja,bgColor:"bg-red-50",iconColor:"text-red-600",description:"Past due date"},{id:"hours-logged",label:"Hours Logged",value:t.stats.hoursLogged.toFixed(1),icon:Yt,bgColor:"bg-purple-50",iconColor:"text-purple-600",description:"Total time tracked"},{id:"revenue-earned",label:"Revenue Earned",value:`${t.stats.revenueEarned.toLocaleString()}`,icon:Ro,bgColor:"bg-green-50",iconColor:"text-green-600",description:"Approved expenses"}],x=[{id:"all",label:"All Projects"},{id:"planned",label:"Planned"},{id:"in_progress",label:"In Progress"},{id:"completed",label:"Completed"},{id:"on_hold",label:"On Hold"}],v=b=>b==="all"?t.projects.length:t.projects.filter(P=>P.status===b).length,y=b=>{const P={planned:{bg:"bg-blue-100",text:"text-blue-700",border:"border-blue-200"},in_progress:{bg:"bg-yellow-100",text:"text-yellow-700",border:"border-yellow-200"},completed:{bg:"bg-green-100",text:"text-green-700",border:"border-green-200"},on_hold:{bg:"bg-gray-100",text:"text-gray-700",border:"border-gray-200"}};return P[b]||P.planned},g=b=>b>=75?"bg-green-500":b>=50?"bg-yellow-500":b>=25?"bg-orange-500":"bg-red-500",w=b=>b?new Date(b).toLocaleDateString("en-GB",{day:"2-digit",month:"short"}):"N/A";return i?a.jsx("div",{className:"h-full bg-gray-50 flex items-center justify-center",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-[#714b67] mx-auto mb-4"}),a.jsx("p",{className:"text-gray-600",children:"Loading dashboard..."})]})}):o?a.jsx("div",{className:"h-full bg-gray-50 flex items-center justify-center",children:a.jsxs("div",{className:"text-center",children:[a.jsx(Ja,{className:"w-12 h-12 text-red-500 mx-auto mb-4"}),a.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Error Loading Dashboard"}),a.jsx("p",{className:"text-gray-600 mb-4",children:o}),a.jsx("button",{onClick:d,className:"px-4 py-2 bg-[#714b67] text-white rounded-lg hover:bg-[#5a3a52] transition-colors",children:"Retry"})]})}):a.jsx("div",{className:"h-full bg-gray-50 overflow-auto",children:a.jsxs("div",{className:"w-full bg-white min-h-full",children:[a.jsx("div",{className:"border-b border-gray-200 px-8 py-6 bg-gradient-to-r from-white to-gray-50",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl font-semibold text-gray-900",children:"Dashboard"}),a.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Welcome back! Here's what's happening with your projects today."})]}),a.jsx("button",{onClick:d,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:"Refresh"})]})}),a.jsxs("div",{className:"p-8 space-y-8",children:[a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:p.map(b=>{const P=b.icon;return a.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6 hover:shadow-lg transition-all duration-200 cursor-pointer group",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsx("div",{className:`${b.bgColor} p-3 rounded-lg group-hover:scale-110 transition-transform`,children:a.jsx(P,{className:`w-6 h-6 ${b.iconColor}`})}),a.jsx(Z2,{className:"w-5 h-5 text-gray-400 opacity-0 group-hover:opacity-100 transition-opacity"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm font-medium text-gray-600 mb-1",children:b.label}),a.jsx("p",{className:"text-3xl font-bold text-gray-900 mb-2",children:b.value}),a.jsx("p",{className:"text-xs text-gray-500",children:b.description})]})]},b.id)})}),a.jsx("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:a.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4",children:[a.jsxs("div",{className:"flex items-center gap-3 flex-wrap",children:[a.jsxs("div",{className:"flex items-center gap-2 text-gray-700",children:[a.jsx(Xn,{className:"w-5 h-5"}),a.jsx("span",{className:"text-sm font-medium",children:"Filter:"})]}),x.map(b=>a.jsxs("button",{onClick:()=>f(b.id),className:`px-4 py-2 rounded-lg text-sm font-medium transition-all duration-200 ${n.status===b.id?"bg-[#714b67] text-white shadow-md":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:[b.label," ",a.jsxs("span",{className:"ml-1 opacity-75",children:["(",v(b.id),")"]})]},b.id))]}),a.jsxs("div",{className:"relative",children:[a.jsx(hn,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),a.jsx("input",{type:"text",placeholder:"Search projects, managers...",value:n.search,onChange:h,className:"pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#714b67] focus:border-transparent w-full lg:w-80 transition-all"})]})]})}),t.filteredProjects.length===0?a.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-12 text-center",children:[a.jsx(kf,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),a.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No projects found"}),a.jsx("p",{className:"text-gray-600 mb-6",children:n.search?"Try adjusting your search or filter criteria":"Get started by creating your first project"}),a.jsx("button",{onClick:()=>e("/app/projects"),className:"px-6 py-3 bg-[#714b67] text-white rounded-lg hover:bg-[#5a3a52] transition-colors",children:"Go to Projects"})]}):a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:t.filteredProjects.map(b=>{var L,E;const P=y(b.status);return a.jsxs("div",{onClick:()=>m(b.id),className:"bg-white border border-gray-200 rounded-lg p-6 hover:shadow-xl hover:-translate-y-1 transition-all duration-200 cursor-pointer group",children:[a.jsxs("div",{className:"mb-4",children:[a.jsxs("div",{className:"flex items-start justify-between mb-2",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900 line-clamp-1 group-hover:text-[#714b67] transition-colors",children:b.name}),a.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium border ${P.bg} ${P.text} ${P.border}`,children:b.statusLabel})]}),b.description&&a.jsx("p",{className:"text-sm text-gray-600 line-clamp-2 mt-2",children:b.description})]}),a.jsxs("div",{className:"mb-4",children:[a.jsxs("div",{className:"flex justify-between items-center mb-2",children:[a.jsx("span",{className:"text-xs font-medium text-gray-700",children:"Progress"}),a.jsxs("span",{className:"text-xs font-semibold text-gray-900",children:[b.progress,"%"]})]}),a.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2 overflow-hidden",children:a.jsx("div",{className:`h-full transition-all duration-500 ${g(b.progress)}`,style:{width:`${b.progress}%`}})})]}),a.jsxs("div",{className:"grid grid-cols-3 gap-3 mb-4 py-3 border-t border-b border-gray-100",children:[a.jsxs("div",{className:"text-center",children:[a.jsx(ht,{className:"w-4 h-4 text-green-600 mx-auto mb-1"}),a.jsx("p",{className:"text-xs text-gray-600 mb-0.5",children:"Tasks"}),a.jsxs("p",{className:"text-sm font-semibold text-gray-900",children:[b.tasks.completed,"/",b.tasks.total]})]}),a.jsxs("div",{className:"text-center",children:[a.jsx(Ja,{className:"w-4 h-4 text-red-600 mx-auto mb-1"}),a.jsx("p",{className:"text-xs text-gray-600 mb-0.5",children:"Delayed"}),a.jsx("p",{className:"text-sm font-semibold text-gray-900",children:b.tasks.delayed})]}),a.jsxs("div",{className:"text-center",children:[a.jsx(Oo,{className:"w-4 h-4 text-blue-600 mx-auto mb-1"}),a.jsx("p",{className:"text-xs text-gray-600 mb-0.5",children:"Due"}),a.jsx("p",{className:"text-sm font-semibold text-gray-900",children:w(b.due)})]})]}),a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("div",{className:"w-8 h-8 bg-gray-200 rounded-full flex items-center justify-center",children:a.jsx(fw,{className:"w-4 h-4 text-gray-600"})}),a.jsx("span",{className:"text-xs text-gray-600 font-medium",children:((L=b.manager)==null?void 0:L.name)||"Unassigned"})]}),((E=b.budget)==null?void 0:E.amount)&&a.jsxs("span",{className:"text-xs font-semibold text-gray-900",children:[b.budget.currency," ",b.budget.amount.toLocaleString()]})]})]},b.id)})})]})]})})};function ku({title:e,children:t,className:r=""}){return a.jsxs("div",{className:`auth-box ${r} p-6 rounded-2xl bg-white border border-gray-200 shadow-sm`,children:[e&&a.jsx("h2",{className:"auth-title text-2xl font-semibold mb-6 text-gray-900",children:e}),t]})}function $s({label:e,type:t="text",name:r,placeholder:n="",...s}){return a.jsxs("label",{className:"block mb-4 text-sm text-gray-700",children:[a.jsx("div",{className:"mb-2 text-gray-600",children:e}),a.jsx("input",{className:"auth-input w-full rounded-md border border-gray-300 px-4 py-2 bg-white text-gray-900 placeholder-gray-400",type:t,name:r,placeholder:n,...s})]})}function Au({variant:e="login"}){return a.jsxs("header",{className:"w-full py-4 px-6 flex items-center justify-between border-b border-gray-100 bg-white",children:[a.jsx("div",{className:"flex items-center",children:a.jsx("img",{src:vp,alt:"OneFlow Logo",className:"h-20 w-auto"})}),a.jsx("div",{children:e==="login"?a.jsx(Ql,{to:"/signup",className:"px-4 py-2 rounded-md bg-purple-600 text-white hover:bg-purple-700",children:"Sign Up"}):a.jsx(Ql,{to:"/login",className:"px-4 py-2 rounded-md bg-purple-600 text-white hover:bg-purple-700",children:"Login"})})]})}function _b(){const e=ma(),[t,r]=C.useState({workEmail:"",password:""}),[n,s]=C.useState(!1),[i,l]=C.useState(""),o=d=>{r({...t,[d.target.name]:d.target.value}),i&&l("")},c=async d=>{d.preventDefault(),l(""),s(!0);try{const u=await be(we.login,{method:"POST",body:JSON.stringify(t)});u.success?(Gw(u.data.user),e("/app")):l(u.message||"Login failed. Please try again.")}catch(u){console.error("Login error:",u),l("Unable to connect to server. Please try again later.")}finally{s(!1)}};return a.jsxs("div",{className:"min-h-screen bg-white",children:[a.jsx(Au,{variant:"login"}),a.jsx("div",{className:"flex items-center justify-center p-6",children:a.jsx("div",{className:"max-w-md w-full",children:a.jsx(ku,{title:"Login into account",children:a.jsxs("form",{className:"space-y-2",onSubmit:c,children:[i&&a.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-md text-sm",children:i}),a.jsx($s,{label:"Work Email",name:"workEmail",type:"email",placeholder:"you@company.com",value:t.workEmail,onChange:o,required:!0}),a.jsx($s,{label:"Password",name:"password",type:"password",placeholder:"",value:t.password,onChange:o,required:!0}),a.jsx("div",{className:"text-sm text-purple-600 mt-2",children:"Forget password?"}),a.jsx("div",{className:"pt-4",children:a.jsx("button",{type:"submit",className:"auth-btn w-full text-white font-medium py-2 rounded-md disabled:opacity-50 disabled:cursor-not-allowed",disabled:n,children:n?"Logging in...":"Login"})})]})})})})]})}function Eb(){const e=ma(),[t,r]=C.useState({firstName:"",lastName:"",workEmail:"",password:"",role:"user"}),[n,s]=C.useState(!1),[i,l]=C.useState(!1),[o,c]=C.useState(""),[d,u]=C.useState(!1),f=m=>{r({...t,[m.target.name]:m.target.value}),o&&c("")},h=async m=>{if(m.preventDefault(),c(""),!n){c("Please agree to the Terms of Service and Privacy Policy");return}if(t.password.length<8){c("Password must be at least 8 characters long");return}l(!0);try{const p=await be(we.register,{method:"POST",body:JSON.stringify(t)});p.success?(u(!0),setTimeout(()=>{e("/login")},2e3)):c(p.message||"Registration failed. Please try again.")}catch(p){console.error("Registration error:",p),c("Unable to connect to server. Please try again later.")}finally{l(!1)}};return d?a.jsxs("div",{className:"min-h-screen bg-white",children:[a.jsx(Au,{variant:"signup"}),a.jsx("div",{className:"flex items-center justify-center p-6",children:a.jsx("div",{className:"max-w-3xl w-full",children:a.jsx(ku,{title:"Account Created Successfully! ",children:a.jsxs("div",{className:"text-center py-6",children:[a.jsx("div",{className:"bg-green-50 border border-green-200 text-green-700 px-4 py-3 rounded-md text-sm mb-4",children:"Your account has been created successfully!"}),a.jsx("p",{className:"text-gray-600 mb-4",children:"Redirecting you to login page..."}),a.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-purple-600 mx-auto"})]})})})})]}):a.jsxs("div",{className:"min-h-screen bg-white",children:[a.jsx(Au,{variant:"signup"}),a.jsx("div",{className:"flex items-center justify-center p-6",children:a.jsx("div",{className:"max-w-3xl w-full",children:a.jsx(ku,{title:"Create an account",children:a.jsxs("form",{className:"space-y-2",onSubmit:h,children:[o&&a.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-md text-sm",children:o}),a.jsx($s,{label:"First name",name:"firstName",placeholder:"John",value:t.firstName,onChange:f,required:!0}),a.jsx($s,{label:"Last name",name:"lastName",placeholder:"Doe",value:t.lastName,onChange:f,required:!0}),a.jsx($s,{label:"Work Email",name:"workEmail",type:"email",placeholder:"you@company.com",value:t.workEmail,onChange:f,required:!0}),a.jsx($s,{label:"Password",name:"password",type:"password",placeholder:"",value:t.password,onChange:f,required:!0}),a.jsxs("label",{className:"flex items-center text-sm text-gray-600 mt-2",children:[a.jsx("input",{type:"checkbox",className:"mr-2",checked:n,onChange:m=>s(m.target.checked)}),a.jsx("span",{children:"I agree to the Terms of Service and Privacy Policy."})]}),a.jsx("div",{className:"pt-4",children:a.jsx("button",{type:"submit",className:"auth-btn w-full text-white font-medium py-2 rounded-md disabled:opacity-50 disabled:cursor-not-allowed",disabled:i,children:i?"Creating account...":"Create an account"})})]})})})})]})}function Tb(){const e=ma();return a.jsx("div",{className:"min-h-screen flex items-center justify-center bg-white p-8",children:a.jsxs("div",{className:"max-w-4xl text-center",children:[a.jsx("h1",{className:"text-5xl md:text-6xl font-bold leading-tight mb-6",children:"From Planning to Payout Seamlessly"}),a.jsx("p",{className:"text-lg text-gray-600 mb-8",children:"Track pipelines, close more deals, and nurture long-term growth."}),a.jsxs("div",{className:"flex items-center justify-center gap-4",children:[a.jsx("button",{onClick:()=>e("/signup"),className:"auth-btn px-6 py-3 text-lg shadow-md",children:"Start For Free"}),a.jsx("button",{onClick:()=>e("/login"),className:"border border-gray-300 px-6 py-3 rounded-md text-gray-700 hover:bg-gray-50",children:"Login"})]})]})})}const Mf={draft:"bg-gray-100 text-gray-700",submitted:"bg-yellow-100 text-yellow-700",approved:"bg-green-100 text-green-700",rejected:"bg-red-100 text-red-700",reimbursed:"bg-blue-100 text-blue-700",paid:"bg-purple-100 text-purple-700"},Cb={draft:yt,submitted:Yt,approved:ht,rejected:yr,reimbursed:ht,paid:ht};function kb({expenses:e,selectedIds:t,onSelect:r,onSelectAll:n,onRowClick:s}){const i=e.length>0&&t.length===e.length,l=t.length>0&&t.length<e.length,o=(u,f="INR")=>new Intl.NumberFormat("en-IN",{style:"currency",currency:f,minimumFractionDigits:0,maximumFractionDigits:0}).format(u),c=u=>u?new Date(u).toLocaleDateString("en-IN",{day:"numeric",month:"short",year:"numeric"}):"-",d=u=>{const f=Cb[u]||yt;return a.jsxs("span",{className:`inline-flex items-center gap-1.5 px-2.5 py-1 rounded-full text-xs font-medium ${Mf[u]||Mf.draft}`,children:[a.jsx(f,{className:"w-3 h-3"}),u.charAt(0).toUpperCase()+u.slice(1)]})};return e.length===0?a.jsx("div",{className:"text-center py-12",children:a.jsx("p",{className:"text-gray-500",children:"No expenses found"})}):a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full border-collapse",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"border-b border-gray-200",children:[a.jsx("th",{className:"px-4 py-3 text-left",children:a.jsx("input",{type:"checkbox",checked:i,ref:u=>{u&&(u.indeterminate=l)},onChange:u=>n(u.target.checked),className:"w-4 h-4 text-purple-600 rounded focus:ring-purple-500"})}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Date"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Employee"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Project"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Category"}),a.jsx("th",{className:"px-4 py-3 text-right text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Amount"}),a.jsx("th",{className:"px-4 py-3 text-center text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Billable"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Status"}),a.jsx("th",{className:"px-4 py-3 text-center text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Receipt"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Invoice"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Notes"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Updated"})]})}),a.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:e.map(u=>a.jsxs("tr",{onClick:()=>s(u),className:"hover:bg-gray-50 cursor-pointer transition-colors",children:[a.jsx("td",{className:"px-4 py-3",onClick:f=>f.stopPropagation(),children:a.jsx("input",{type:"checkbox",checked:t.includes(u.id),onChange:f=>{f.stopPropagation(),r(u.id,f.target.checked)},className:"w-4 h-4 text-purple-600 rounded focus:ring-purple-500"})}),a.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:c(u.spentOn)}),a.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:a.jsxs("div",{children:[a.jsx("div",{className:"font-medium",children:u.employeeName||"Unknown"}),u.employeeEmail&&a.jsx("div",{className:"text-xs text-gray-500",children:u.employeeEmail})]})}),a.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:u.projectName||"-"}),a.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:u.category}),a.jsx("td",{className:"px-4 py-3 text-sm text-right font-medium text-gray-900",children:o(u.amount,u.currency)}),a.jsx("td",{className:"px-4 py-3 text-center",children:u.isBillable?a.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-700",children:"Yes"}):a.jsx("span",{className:"text-gray-400",children:"-"})}),a.jsx("td",{className:"px-4 py-3",children:d(u.status)}),a.jsx("td",{className:"px-4 py-3 text-center",children:u.receiptFileId?a.jsx(ip,{className:"w-4 h-4 text-gray-600 mx-auto"}):a.jsx("span",{className:"text-gray-300",children:"-"})}),a.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:u.invoiceNumber?a.jsx("span",{className:"text-blue-600 hover:underline",children:u.invoiceNumber}):a.jsx("span",{className:"text-gray-400",children:"-"})}),a.jsx("td",{className:"px-4 py-3 text-sm text-gray-500 max-w-xs truncate",children:u.note||"-"}),a.jsx("td",{className:"px-4 py-3 text-sm text-gray-500",children:c(u.updatedAt)})]},u.id))})]})})}function Ab({filters:e,projects:t,employees:r,categories:n,onFilterChange:s,onSavedViewChange:i}){const[l,o]=C.useState(!1),c=[{id:"my-team",label:"My Team",filters:{status:["submitted","draft"]}},{id:"billable-only",label:"Billable Only",filters:{is_billable:"true"}},{id:"missing-receipts",label:"Missing Receipts",filters:{missing_receipt:"true"}}],d=[{key:"missing_receipt",label:"Missing Receipt",value:"true"},{key:"over_policy",label:"Over Policy",value:"true"},{key:"is_billable",label:"Billable",value:"true"},{key:"this_week",label:"This Week",value:u()},{key:"this_month",label:"This Month",value:f()}];function u(){const x=new Date,v=new Date(x);return v.setDate(x.getDate()-x.getDay()),{date_from:v.toISOString().split("T")[0],date_to:x.toISOString().split("T")[0]}}function f(){const x=new Date;return{date_from:new Date(x.getFullYear(),x.getMonth(),1).toISOString().split("T")[0],date_to:x.toISOString().split("T")[0]}}const h=x=>{x.value==="true"?s({[x.key]:x.value}):typeof x.value=="object"&&s(x.value)},m=x=>{s({[x]:void 0})},p=Object.keys(e).filter(x=>{const v=e[x];return!(v===void 0||v===""||v===null||Array.isArray(v)&&v.length===0)}).length;return a.jsxs("div",{className:"relative",children:[a.jsxs("button",{onClick:()=>o(!l),className:"flex items-center gap-2 px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",children:[a.jsx(Xn,{className:"w-4 h-4"}),a.jsx("span",{children:"Filters"}),p>0&&a.jsx("span",{className:"px-2 py-0.5 text-xs font-semibold text-white rounded-full",style:{backgroundColor:"#714b67"},children:p}),a.jsx(Bn,{className:`w-4 h-4 transition-transform ${l?"rotate-180":""}`})]}),l&&a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"fixed inset-0 z-10",onClick:()=>o(!1)}),a.jsxs("div",{className:"absolute right-0 mt-2 w-80 bg-white border border-gray-200 rounded-lg shadow-xl z-20",children:[a.jsxs("div",{className:"p-4 border-b border-gray-200",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsx("h3",{className:"text-sm font-semibold text-gray-900",children:"Filters"}),a.jsx("button",{onClick:()=>o(!1),className:"text-gray-400 hover:text-gray-600",children:a.jsx(Ue,{className:"w-4 h-4"})})]}),a.jsxs("div",{className:"mb-4",children:[a.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2",children:"Saved Views"}),a.jsxs("select",{onChange:x=>{if(x.target.value){const v=c.find(y=>y.id===x.target.value);v&&i(v.filters)}x.target.value=""},className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500",children:[a.jsx("option",{value:"",children:"Select a view..."}),c.map(x=>a.jsx("option",{value:x.id,children:x.label},x.id))]})]}),a.jsxs("div",{className:"mb-4",children:[a.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2",children:"Quick Filters"}),a.jsx("div",{className:"flex flex-wrap gap-2",children:d.map(x=>a.jsx("button",{onClick:()=>h(x),className:"px-3 py-1 text-xs font-medium text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200",children:x.label},x.key))})]})]}),a.jsxs("div",{className:"p-4 space-y-4 max-h-96 overflow-y-auto",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Project"}),a.jsxs("select",{value:e.project_id||"",onChange:x=>s({project_id:x.target.value||void 0}),className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500",children:[a.jsx("option",{value:"",children:"All Projects"}),t.map(x=>a.jsx("option",{value:x.id,children:x.name},x.id))]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Status"}),a.jsxs("select",{value:Array.isArray(e.status)?e.status[0]||"":e.status||"",onChange:x=>{const v=x.target.value;s({status:v?[v]:void 0})},className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500",children:[a.jsx("option",{value:"",children:"All Statuses"}),a.jsx("option",{value:"draft",children:"Draft"}),a.jsx("option",{value:"submitted",children:"Submitted"}),a.jsx("option",{value:"approved",children:"Approved"}),a.jsx("option",{value:"rejected",children:"Rejected"}),a.jsx("option",{value:"reimbursed",children:"Reimbursed"}),a.jsx("option",{value:"paid",children:"Paid"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Employee"}),a.jsxs("select",{value:e.user_id||"",onChange:x=>s({user_id:x.target.value||void 0}),className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500",children:[a.jsx("option",{value:"",children:"All Employees"}),r.map(x=>a.jsx("option",{value:x.id,children:x.name},x.id))]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Category"}),a.jsxs("select",{value:e.category||"",onChange:x=>s({category:x.target.value||void 0}),className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500",children:[a.jsx("option",{value:"",children:"All Categories"}),n.map(x=>a.jsx("option",{value:x,children:x},x))]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Billable"}),a.jsxs("select",{value:e.is_billable||"",onChange:x=>s({is_billable:x.target.value||void 0}),className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500",children:[a.jsx("option",{value:"",children:"All"}),a.jsx("option",{value:"true",children:"Billable"}),a.jsx("option",{value:"false",children:"Not Billable"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Date From"}),a.jsx("input",{type:"date",value:e.date_from||"",onChange:x=>s({date_from:x.target.value||void 0}),className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Date To"}),a.jsx("input",{type:"date",value:e.date_to||"",onChange:x=>s({date_to:x.target.value||void 0}),className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Amount Min"}),a.jsx("input",{type:"number",value:e.amount_min||"",onChange:x=>s({amount_min:x.target.value||void 0}),placeholder:"0",className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Amount Max"}),a.jsx("input",{type:"number",value:e.amount_max||"",onChange:x=>s({amount_max:x.target.value||void 0}),placeholder:"100000",className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500"})]})]}),p>0&&a.jsxs("div",{className:"p-4 border-t border-gray-200",children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsx("span",{className:"text-xs font-medium text-gray-700",children:"Active Filters"}),a.jsx("button",{onClick:()=>s({}),className:"text-xs hover:underline",style:{color:"#714b67"},children:"Clear All"})]}),a.jsx("div",{className:"flex flex-wrap gap-2",children:Object.keys(e).map(x=>{const v=e[x];if(v===void 0||v===""||v===null||Array.isArray(v)&&v.length===0)return null;let y=v;Array.isArray(v)&&(y=v.join(", "));const g=x.replace(/_/g," ").replace(/\b\w/g,w=>w.toUpperCase());return a.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 text-xs bg-gray-100 text-gray-700 rounded",children:[a.jsxs("span",{children:[g,": ",y]}),a.jsx("button",{onClick:w=>{w.stopPropagation(),m(x)},className:"text-gray-500 hover:text-gray-700 ml-1",type:"button",children:a.jsx(Ue,{className:"w-3 h-3"})})]},x)})})]})]})]})]})}function Fb({selectedCount:e,onBulkApprove:t,onBulkReject:r,onBulkAddToInvoice:n,onExportCSV:s}){const[i,l]=C.useState(!1),[o,c]=C.useState("");if(e===0)return null;const d=()=>{o.trim()&&(r(o),c(""),l(!1))};return a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"bg-purple-50 border border-purple-200 rounded-lg p-4 mb-4",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("div",{className:"flex items-center gap-3",children:a.jsxs("span",{className:"text-sm font-medium text-purple-900",children:[e," expense",e!==1?"s":""," selected"]})}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsxs("button",{onClick:t,className:"flex items-center gap-2 px-4 py-2 text-sm font-medium text-white bg-green-600 rounded-lg hover:bg-green-700",children:[a.jsx(ht,{className:"w-4 h-4"}),"Approve"]}),a.jsxs("button",{onClick:()=>l(!0),className:"flex items-center gap-2 px-4 py-2 text-sm font-medium text-white bg-red-600 rounded-lg hover:bg-red-700",children:[a.jsx(yr,{className:"w-4 h-4"}),"Reject"]}),a.jsxs("button",{onClick:n,className:"flex items-center gap-2 px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-lg hover:bg-blue-700",children:[a.jsx(yt,{className:"w-4 h-4"}),"Add to Invoice"]}),a.jsxs("button",{onClick:s,className:"flex items-center gap-2 px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",children:[a.jsx(oa,{className:"w-4 h-4"}),"Export CSV"]})]})]})}),i&&a.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black bg-opacity-50",children:a.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full p-6",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Reject Expenses"}),a.jsxs("p",{className:"text-sm text-gray-600 mb-4",children:["Please provide a reason for rejecting ",e," expense",e!==1?"s":"","."]}),a.jsx("textarea",{value:o,onChange:u=>c(u.target.value),placeholder:"Enter rejection reason...",rows:4,className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-red-500 mb-4"}),a.jsxs("div",{className:"flex items-center justify-end gap-3",children:[a.jsx("button",{onClick:()=>{l(!1),c("")},className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",children:"Cancel"}),a.jsx("button",{onClick:d,disabled:!o.trim(),className:"px-4 py-2 text-sm font-medium text-white bg-red-600 rounded-lg hover:bg-red-700 disabled:opacity-50 disabled:cursor-not-allowed",children:"Reject"})]})]})})]})}const Bf={draft:"bg-gray-100 text-gray-700",submitted:"bg-yellow-100 text-yellow-700",approved:"bg-green-100 text-green-700",rejected:"bg-red-100 text-red-700",reimbursed:"bg-blue-100 text-blue-700",paid:"bg-purple-100 text-purple-700"};function Ob({expense:e,onClose:t,onUpdate:r,onApprove:n,onReject:s,onAddToInvoice:i}){var Ne;const[l,o]=C.useState(e),[c,d]=C.useState(!1),[u,f]=C.useState(!1),[h,m]=C.useState(""),[p,x]=C.useState(null);C.useEffect(()=>{x(gp()),e!=null&&e.id&&!e.activityLog?v():o(e)},[e]);const v=async()=>{d(!0);try{const ae=await xr.getById(e.id);ae.success&&o(ae.data)}catch(ae){console.error("Error loading expense details:",ae)}finally{d(!1)}},y=(ae,xe="INR")=>new Intl.NumberFormat("en-IN",{style:"currency",currency:xe,minimumFractionDigits:0,maximumFractionDigits:0}).format(ae),g=ae=>ae?new Date(ae).toLocaleDateString("en-IN",{day:"numeric",month:"short",year:"numeric"}):"-",w=ae=>ae?new Date(ae).toLocaleString("en-IN",{day:"numeric",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"}):"-",b=ae=>{const xe=ae==="submitted"?Yt:ae==="approved"?ht:ae==="rejected"?yr:yt;return a.jsxs("span",{className:`inline-flex items-center gap-1.5 px-3 py-1.5 rounded-full text-sm font-medium ${Bf[ae]||Bf.draft}`,children:[a.jsx(xe,{className:"w-4 h-4"}),ae.charAt(0).toUpperCase()+ae.slice(1)]})},P=(l==null?void 0:l.status)==="submitted"&&(l==null?void 0:l.projectId)&&(l==null?void 0:l.userId)!==(p==null?void 0:p.id)&&(!((l==null?void 0:l.amount)>500)||(l==null?void 0:l.receiptFileId)),L=(l==null?void 0:l.status)==="submitted"||(l==null?void 0:l.status)==="approved",E=(l==null?void 0:l.status)==="approved"&&(l==null?void 0:l.isBillable)&&!(l!=null&&l.invoiceLineId),I=(l==null?void 0:l.status)==="draft"||(l==null?void 0:l.status)==="rejected",S=async()=>{try{const ae=await xr.approve(l.id);ae.success?(n(l.id),r(),t()):alert(ae.message||"Failed to approve expense")}catch(ae){console.error("Error approving expense:",ae),alert(ae.message||"Failed to approve expense")}},R=async()=>{if(h.trim())try{const ae=await xr.reject(l.id,h);ae.success?(s(l.id),r(),f(!1),m(""),t()):alert(ae.message||"Failed to reject expense")}catch(ae){console.error("Error rejecting expense:",ae),alert(ae.message||"Failed to reject expense")}},U=()=>{i([l])},G=l!=null&&l.receiptUrl?l.receiptUrl.startsWith("http")?l.receiptUrl:`http://localhost:5000${l.receiptUrl}`:null,se=(Ne=l==null?void 0:l.receiptMimeType)==null?void 0:Ne.startsWith("image/");return a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"fixed inset-0 z-40 bg-black bg-opacity-30",onClick:t}),a.jsx("div",{className:"fixed right-0 top-0 h-full w-full max-w-2xl bg-white shadow-xl z-50 overflow-y-auto",children:c?a.jsx("div",{className:"flex items-center justify-center h-full",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"inline-block animate-spin rounded-full h-12 w-12 border-b-2 border-gray-900 mb-4"}),a.jsx("p",{className:"text-gray-600",children:"Loading expense details..."})]})}):a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"sticky top-0 bg-white border-b border-gray-200 px-6 py-4 flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[b(l==null?void 0:l.status),a.jsxs("div",{children:[a.jsx("div",{className:"text-2xl font-semibold text-gray-900",children:y((l==null?void 0:l.amount)||0,l==null?void 0:l.currency)}),a.jsx("div",{className:"text-sm text-gray-500",children:l==null?void 0:l.currency})]})]}),a.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-600",children:a.jsx(Ue,{className:"w-5 h-5"})})]}),a.jsxs("div",{className:"p-6 space-y-6",children:[a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"Project"}),a.jsx("p",{className:"text-sm font-medium text-gray-900",children:(l==null?void 0:l.projectName)||"-"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"Category"}),a.jsx("p",{className:"text-sm font-medium text-gray-900",children:(l==null?void 0:l.category)||"-"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"Employee"}),a.jsx("p",{className:"text-sm font-medium text-gray-900",children:(l==null?void 0:l.employeeName)||"-"}),(l==null?void 0:l.employeeEmail)&&a.jsx("p",{className:"text-xs text-gray-500",children:l.employeeEmail})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"Expense Date"}),a.jsx("p",{className:"text-sm font-medium text-gray-900",children:g(l==null?void 0:l.spentOn)})]}),(l==null?void 0:l.merchant)&&a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"Merchant/Vendor"}),a.jsx("p",{className:"text-sm font-medium text-gray-900",children:l.merchant})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"Payment Method"}),a.jsx("p",{className:"text-sm font-medium text-gray-900",children:l!=null&&l.paymentMethod?l.paymentMethod.charAt(0).toUpperCase()+l.paymentMethod.slice(1).replace("_"," "):"-"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"Tax"}),a.jsx("p",{className:"text-sm font-medium text-gray-900",children:y((l==null?void 0:l.taxAmount)||0,l==null?void 0:l.currency)})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"Billable"}),a.jsx("p",{className:"text-sm font-medium text-gray-900",children:l!=null&&l.isBillable?a.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-700",children:"Yes"}):a.jsx("span",{className:"text-gray-400",children:"No"})})]})]}),(l==null?void 0:l.note)&&a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"Description/Notes"}),a.jsx("p",{className:"text-sm text-gray-900 whitespace-pre-wrap",children:l.note})]}),(l==null?void 0:l.amount)>500&&!(l!=null&&l.receiptFileId)&&a.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-3",children:a.jsxs("div",{className:"flex items-start gap-2",children:[a.jsx(Ja,{className:"w-5 h-5 text-yellow-600 flex-shrink-0 mt-0.5"}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm font-medium text-yellow-800",children:"Receipt Required"}),a.jsx("p",{className:"text-xs text-yellow-700 mt-1",children:"Expenses over 500 require a receipt for approval."})]})]})}),(l==null?void 0:l.duplicates)&&l.duplicates.length>0&&a.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3",children:a.jsxs("div",{className:"flex items-start gap-2",children:[a.jsx(Ja,{className:"w-5 h-5 text-blue-600 flex-shrink-0 mt-0.5"}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm font-medium text-blue-800",children:"Possible Duplicate"}),a.jsxs("p",{className:"text-xs text-blue-700 mt-1",children:["Found ",l.duplicates.length," similar expense(s) from the same employee on the same date with the same amount."]})]})]})}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-gray-500 mb-2",children:"Receipt"}),l!=null&&l.receiptFileId?a.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[se&&G?a.jsx("img",{src:G,alt:"Receipt",className:"max-w-full rounded-lg mb-2"}):a.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[a.jsx(yt,{className:"w-5 h-5"}),a.jsx("span",{children:l.receiptFilename||"Receipt file"})]}),G&&a.jsxs("a",{href:G,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-2 mt-2 text-sm text-purple-600 hover:text-purple-700",children:[a.jsx(oa,{className:"w-4 h-4"}),"Download Receipt"]})]}):a.jsx("p",{className:"text-sm text-gray-400",children:"No receipt attached"})]}),(l==null?void 0:l.invoiceNumber)&&a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"Linked Invoice"}),a.jsx("a",{href:`/app/invoices/${l.invoiceId}`,className:"text-sm text-blue-600 hover:text-blue-700 hover:underline",children:l.invoiceNumber})]}),a.jsxs("div",{className:"flex flex-wrap gap-2 pt-4 border-t border-gray-200",children:[P&&a.jsxs("button",{onClick:S,className:"flex items-center gap-2 px-4 py-2 text-sm font-medium text-white bg-green-600 rounded-lg hover:bg-green-700",children:[a.jsx(ht,{className:"w-4 h-4"}),"Approve"]}),L&&a.jsxs("button",{onClick:()=>f(!0),className:"flex items-center gap-2 px-4 py-2 text-sm font-medium text-white bg-red-600 rounded-lg hover:bg-red-700",children:[a.jsx(yr,{className:"w-4 h-4"}),"Reject"]}),E&&a.jsxs("button",{onClick:U,className:"flex items-center gap-2 px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-lg hover:bg-blue-700",children:[a.jsx(yt,{className:"w-4 h-4"}),"Add to Invoice"]}),!(l!=null&&l.projectId)&&a.jsxs("button",{onClick:()=>{},className:"flex items-center gap-2 px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",children:[a.jsx(aw,{className:"w-4 h-4"}),"Link to Project"]}),I&&a.jsxs("button",{onClick:()=>{},className:"flex items-center gap-2 px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",children:[a.jsx(cw,{className:"w-4 h-4"}),"Edit"]})]}),(l==null?void 0:l.activityLog)&&l.activityLog.length>0&&a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-gray-500 mb-2",children:"Activity Log"}),a.jsx("div",{className:"space-y-3",children:l.activityLog.map((ae,xe)=>a.jsxs("div",{className:"flex items-start gap-3 pb-3 border-b border-gray-100 last:border-0",children:[a.jsx("div",{className:"flex-shrink-0 w-2 h-2 rounded-full bg-purple-600 mt-2"}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsxs("p",{className:"text-sm text-gray-900",children:[a.jsx("span",{className:"font-medium",children:ae.actorName||"System"})," ",ae.operation==="I"&&"created",ae.operation==="U"&&"updated",ae.operation==="D"&&"deleted"," this expense"]}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:w(ae.timestamp)})]})]},xe))})]})]})]})}),u&&a.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black bg-opacity-50",children:a.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full p-6",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Reject Expense"}),a.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Please provide a reason for rejecting this expense."}),a.jsx("textarea",{value:h,onChange:ae=>m(ae.target.value),placeholder:"Enter rejection reason...",rows:4,className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-red-500 mb-4"}),a.jsxs("div",{className:"flex items-center justify-end gap-3",children:[a.jsx("button",{onClick:()=>{f(!1),m("")},className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",children:"Cancel"}),a.jsx("button",{onClick:R,disabled:!h.trim(),className:"px-4 py-2 text-sm font-medium text-white bg-red-600 rounded-lg hover:bg-red-700 disabled:opacity-50 disabled:cursor-not-allowed",children:"Reject"})]})]})})]})}const Pb=["cash","bank_transfer","card","upi","other"],Rb=["Travel","Meals","Accommodation","Transport","Office Supplies","Software","Hardware","Training","Marketing","Other"];function Ib({expense:e,projects:t,users:r,onClose:n,onSave:s}){const[i,l]=C.useState({user_id:(e==null?void 0:e.userId)||"",project_id:(e==null?void 0:e.projectId)||"",category:(e==null?void 0:e.category)||"",amount:(e==null?void 0:e.amount)||"",tax_amount:(e==null?void 0:e.taxAmount)||0,currency:(e==null?void 0:e.currency)||"INR",is_billable:(e==null?void 0:e.isBillable)||!1,spent_on:(e==null?void 0:e.spentOn)||new Date().toISOString().split("T")[0],merchant:(e==null?void 0:e.merchant)||"",payment_method:(e==null?void 0:e.paymentMethod)||"other",note:(e==null?void 0:e.note)||""}),[o,c]=C.useState(null),[d,u]=C.useState((e==null?void 0:e.receiptUrl)||null),[f,h]=C.useState(!1),[m,p]=C.useState(!1),[x,v]=C.useState({});C.useEffect(()=>{e!=null&&e.receiptUrl&&u(e.receiptUrl)},[e]);const y=b=>{const{name:P,value:L,type:E,checked:I}=b.target;l(S=>({...S,[P]:E==="checkbox"?I:L})),x[P]&&v(S=>{const R={...S};return delete R[P],R})},g=async b=>{const P=b.target.files[0];if(!P)return;if(!["image/jpeg","image/jpg","image/png","application/pdf"].includes(P.type)){v(E=>({...E,receipt:"Only PDF, PNG, and JPG files are allowed"}));return}if(P.size>10*1024*1024){v(E=>({...E,receipt:"File size must be less than 10MB"}));return}if(c(P),v(E=>{const I={...E};return delete I.receipt,I}),P.type.startsWith("image/")){const E=new FileReader;E.onload=I=>u(I.target.result),E.readAsDataURL(P)}else u(null)},w=async(b,P="draft")=>{var E;b.preventDefault();const L={};if(i.user_id||(L.user_id="Employee is required"),i.category||(L.category="Category is required"),(!i.amount||parseFloat(i.amount)<=0)&&(L.amount="Valid amount is required"),i.spent_on||(L.spent_on="Expense date is required"),parseFloat(i.amount)>500&&!o&&!(e!=null&&e.receiptFileId)&&(L.receipt="Receipt required for expenses over 500"),Object.keys(L).length>0){v(L);return}p(!0);try{let I=e==null?void 0:e.receiptFileId;if(o){h(!0);try{const U=await xr.uploadReceipt(o);if(U.success&&((E=U.data)!=null&&E.fileId))I=U.data.fileId,console.log("Receipt uploaded, fileId:",I);else throw new Error(U.message||"Failed to upload receipt")}catch(U){throw console.error("Receipt upload error:",U),new Error(U.message||"Failed to upload receipt")}finally{h(!1)}}const S={...i,amount:parseFloat(i.amount),tax_amount:parseFloat(i.tax_amount||0),receipt_file_id:I,status:P};let R;e?R=await xr.update(e.id,S):R=await xr.create(S),R.success?(s(R.data),n()):v({submit:R.message||"Failed to save expense"})}catch(I){console.error("Error saving expense:",I),v({submit:I.message||"Failed to save expense"})}finally{p(!1),h(!1)}};return a.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black bg-opacity-50",children:a.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[a.jsxs("div",{className:"sticky top-0 bg-white border-b border-gray-200 px-6 py-4 flex items-center justify-between",children:[a.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:e?"Edit Expense":"New Expense"}),a.jsx("button",{onClick:n,className:"text-gray-400 hover:text-gray-600",children:a.jsx(Ue,{className:"w-5 h-5"})})]}),a.jsxs("form",{onSubmit:b=>w(b,"draft"),className:"p-6 space-y-4",children:[x.submit&&a.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-3 text-sm text-red-800",children:x.submit}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Project ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsxs("select",{name:"project_id",value:i.project_id,onChange:y,className:`w-full px-3 py-2 text-sm border rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 ${x.project_id?"border-red-300":"border-gray-300"}`,children:[a.jsx("option",{value:"",children:"Select project..."}),t.map(b=>a.jsx("option",{value:b.id,children:b.name},b.id))]})]}),a.jsxs("div",{children:[a.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Employee ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsxs("select",{name:"user_id",value:i.user_id,onChange:y,className:`w-full px-3 py-2 text-sm border rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 ${x.user_id?"border-red-300":"border-gray-300"}`,children:[a.jsx("option",{value:"",children:"Select employee..."}),r&&r.map(b=>a.jsx("option",{value:b.id,children:b.full_name},b.id))]}),x.user_id&&a.jsx("p",{className:"mt-1 text-xs text-red-600",children:x.user_id})]}),a.jsxs("div",{children:[a.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Category ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsxs("select",{name:"category",value:i.category,onChange:y,className:`w-full px-3 py-2 text-sm border rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 ${x.category?"border-red-300":"border-gray-300"}`,children:[a.jsx("option",{value:"",children:"Select category..."}),Rb.map(b=>a.jsx("option",{value:b,children:b},b))]}),x.category&&a.jsx("p",{className:"mt-1 text-xs text-red-600",children:x.category})]}),a.jsxs("div",{children:[a.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Amount ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{type:"number",name:"amount",value:i.amount,onChange:y,step:"0.01",min:"0",className:`w-full px-3 py-2 text-sm border rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 ${x.amount?"border-red-300":"border-gray-300"}`}),x.amount&&a.jsx("p",{className:"mt-1 text-xs text-red-600",children:x.amount})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tax Amount"}),a.jsx("input",{type:"number",name:"tax_amount",value:i.tax_amount,onChange:y,step:"0.01",min:"0",className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Currency"}),a.jsxs("select",{name:"currency",value:i.currency,onChange:y,className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500",children:[a.jsx("option",{value:"INR",children:"INR ()"}),a.jsx("option",{value:"USD",children:"USD ($)"}),a.jsx("option",{value:"EUR",children:"EUR ()"})]})]}),a.jsxs("div",{children:[a.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Expense Date ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{type:"date",name:"spent_on",value:i.spent_on,onChange:y,className:`w-full px-3 py-2 text-sm border rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 ${x.spent_on?"border-red-300":"border-gray-300"}`}),x.spent_on&&a.jsx("p",{className:"mt-1 text-xs text-red-600",children:x.spent_on})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Merchant/Vendor"}),a.jsx("input",{type:"text",name:"merchant",value:i.merchant,onChange:y,className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Payment Method"}),a.jsx("select",{name:"payment_method",value:i.payment_method,onChange:y,className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500",children:Pb.map(b=>a.jsx("option",{value:b,children:b.charAt(0).toUpperCase()+b.slice(1).replace("_"," ")},b))})]})]}),a.jsxs("div",{className:"flex items-center",children:[a.jsx("input",{type:"checkbox",name:"is_billable",id:"is_billable",checked:i.is_billable,onChange:y,className:"w-4 h-4 text-purple-600 rounded focus:ring-purple-500"}),a.jsx("label",{htmlFor:"is_billable",className:"ml-2 text-sm font-medium text-gray-700",children:"Billable to customer"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description/Notes"}),a.jsx("textarea",{name:"note",value:i.note,onChange:y,rows:3,className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500"})]}),a.jsxs("div",{children:[a.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Receipt ",parseFloat(i.amount)>500&&a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsxs("label",{className:"flex items-center gap-2 px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 cursor-pointer",children:[a.jsx(O0,{className:"w-4 h-4"}),"Upload Receipt",a.jsx("input",{type:"file",accept:".pdf,.png,.jpg,.jpeg",onChange:g,className:"hidden"})]}),o&&a.jsx("span",{className:"text-sm text-gray-600",children:o.name}),(e==null?void 0:e.receiptFilename)&&!o&&a.jsxs("span",{className:"text-sm text-gray-600 flex items-center gap-1",children:[a.jsx(yt,{className:"w-4 h-4"}),e.receiptFilename]})]}),x.receipt&&a.jsx("p",{className:"mt-1 text-xs text-red-600",children:x.receipt}),d&&d.startsWith("data:image")&&a.jsx("div",{className:"mt-2",children:a.jsx("img",{src:d,alt:"Receipt preview",className:"max-w-xs rounded-lg border border-gray-300"})})]}),a.jsxs("div",{className:"flex items-center justify-end gap-3 pt-4 border-t border-gray-200",children:[a.jsx("button",{type:"button",onClick:n,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",children:"Cancel"}),!e&&a.jsx("button",{type:"button",onClick:b=>w(b,"draft"),disabled:m||f,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 disabled:opacity-50",children:m||f?"Saving...":"Save as Draft"}),a.jsx("button",{type:"submit",onClick:b=>w(b,"submitted"),disabled:m||f,className:"px-4 py-2 text-sm font-medium text-white rounded-lg hover:opacity-90 disabled:opacity-50",style:{backgroundColor:"#714b67"},children:m||f?"Submitting...":e?"Update":"Submit"})]})]})]})})}function Db({expenses:e,onClose:t,onSave:r}){var y;const[n,s]=C.useState("new"),[i,l]=C.useState(""),[o,c]=C.useState(""),[d,u]=C.useState(!1),[f,h]=C.useState({});C.useEffect(()=>{e.length>0&&e[0].projectId&&c("")},[e]);const m=async g=>{if(g.preventDefault(),h({}),n==="existing"&&!i){h({invoice:"Please select an invoice"});return}u(!0);try{const w=[];for(const P of e){const L={invoice_id:n==="existing"?i:null,customer_id:o},E=await xr.addToInvoice(P.id,L);w.push({expenseId:P.id,success:E.success,data:E.data})}w.every(P=>P.success)?(r(w),t()):h({submit:"Some expenses could not be added to invoice"})}catch(w){console.error("Error adding to invoice:",w),h({submit:w.message||"Failed to add expenses to invoice"})}finally{u(!1)}},p=(g,w="INR")=>new Intl.NumberFormat("en-IN",{style:"currency",currency:w,minimumFractionDigits:0,maximumFractionDigits:0}).format(g),x=e.reduce((g,w)=>g+w.amount+(w.taxAmount||0),0),v=((y=e[0])==null?void 0:y.currency)||"INR";return a.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black bg-opacity-50",children:a.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[a.jsxs("div",{className:"sticky top-0 bg-white border-b border-gray-200 px-6 py-4 flex items-center justify-between",children:[a.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Add to Invoice"}),a.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-600",children:a.jsx(Ue,{className:"w-5 h-5"})})]}),a.jsxs("form",{onSubmit:m,className:"p-6 space-y-4",children:[f.submit&&a.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-3 text-sm text-red-800",children:f.submit}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Invoice"}),a.jsxs("div",{className:"flex gap-4",children:[a.jsxs("label",{className:"flex items-center",children:[a.jsx("input",{type:"radio",name:"invoiceMode",value:"new",checked:n==="new",onChange:g=>s(g.target.value),className:"w-4 h-4 text-purple-600 focus:ring-purple-500"}),a.jsx("span",{className:"ml-2 text-sm text-gray-700",children:"Create New Invoice"})]}),a.jsxs("label",{className:"flex items-center",children:[a.jsx("input",{type:"radio",name:"invoiceMode",value:"existing",checked:n==="existing",onChange:g=>s(g.target.value),className:"w-4 h-4 text-purple-600 focus:ring-purple-500"}),a.jsx("span",{className:"ml-2 text-sm text-gray-700",children:"Add to Existing Invoice"})]})]})]}),n==="existing"&&a.jsxs("div",{children:[a.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Select Invoice ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsxs("select",{value:i,onChange:g=>l(g.target.value),className:`w-full px-3 py-2 text-sm border rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 ${f.invoice?"border-red-300":"border-gray-300"}`,children:[a.jsx("option",{value:"",children:"Select invoice..."}),a.jsx("option",{value:"placeholder",children:"Invoice #INV-001 (Draft)"})]}),f.invoice&&a.jsx("p",{className:"mt-1 text-xs text-red-600",children:f.invoice})]}),n==="new"&&a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Customer"}),a.jsx("input",{type:"text",value:o||"Customer from project",disabled:!0,className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg bg-gray-50 text-gray-600"}),a.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Customer will be prefilled from project"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Expense Lines"}),a.jsx("div",{className:"border border-gray-200 rounded-lg overflow-hidden",children:a.jsxs("table",{className:"w-full",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-4 py-2 text-left text-xs font-semibold text-gray-600",children:"Description"}),a.jsx("th",{className:"px-4 py-2 text-right text-xs font-semibold text-gray-600",children:"Amount"}),a.jsx("th",{className:"px-4 py-2 text-right text-xs font-semibold text-gray-600",children:"Tax"}),a.jsx("th",{className:"px-4 py-2 text-right text-xs font-semibold text-gray-600",children:"Total"})]})}),a.jsx("tbody",{className:"divide-y divide-gray-200",children:e.map(g=>{const w=`Expense  ${g.category}  ${g.employeeName||"Employee"}  ${g.spentOn}`,b=g.amount+(g.taxAmount||0);return a.jsxs("tr",{children:[a.jsx("td",{className:"px-4 py-2 text-sm text-gray-900",children:w}),a.jsx("td",{className:"px-4 py-2 text-sm text-right text-gray-900",children:p(g.amount,g.currency)}),a.jsx("td",{className:"px-4 py-2 text-sm text-right text-gray-900",children:p(g.taxAmount||0,g.currency)}),a.jsx("td",{className:"px-4 py-2 text-sm text-right font-medium text-gray-900",children:p(b,g.currency)})]},g.id)})}),a.jsx("tfoot",{className:"bg-gray-50",children:a.jsxs("tr",{children:[a.jsx("td",{colSpan:3,className:"px-4 py-2 text-sm font-semibold text-gray-900 text-right",children:"Total:"}),a.jsx("td",{className:"px-4 py-2 text-sm font-semibold text-gray-900 text-right",children:p(x,v)})]})})]})})]}),e.length>1&&a.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3 text-sm text-blue-800",children:[a.jsx("p",{className:"font-medium mb-1",children:"Note:"}),a.jsx("p",{children:"All expenses must be from the same project and customer. Selected expenses will be added as separate invoice lines."})]}),a.jsxs("div",{className:"flex items-center justify-end gap-3 pt-4 border-t border-gray-200",children:[a.jsx("button",{type:"button",onClick:t,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",children:"Cancel"}),a.jsxs("button",{type:"submit",disabled:d,className:"flex items-center gap-2 px-4 py-2 text-sm font-medium text-white rounded-lg hover:opacity-90 disabled:opacity-50",style:{backgroundColor:"#714b67"},children:[n==="new"&&a.jsx(ar,{className:"w-4 h-4"}),d?"Adding...":n==="new"?"Create Invoice":"Add to Invoice"]})]})]})]})})}function Lb(){const[e,t]=C.useState([]),[r,n]=C.useState([]),[s,i]=C.useState([]),[l,o]=C.useState({pendingApprovals:0,pendingAmount:0,pendingBillableAmount:0,missingReceipts:0}),[c,d]=C.useState({date_from:G(),date_to:new Date().toISOString().split("T")[0]}),[u,f]=C.useState(""),[h,m]=C.useState([]),[p,x]=C.useState(null),[v,y]=C.useState(!1),[g,w]=C.useState(!1),[b,P]=C.useState(null),[L,E]=C.useState(!1),[I,S]=C.useState(!0),[R,U]=C.useState(null);function G(){const ne=new Date;return ne.setDate(ne.getDate()-90),ne.toISOString().split("T")[0]}C.useEffect(()=>{se()},[c]);const se=async()=>{try{S(!0),U(null);const ne=await kr.getAll();ne.success&&n(ne.data);const me=await Kw.getAll();me.success&&i(me.data.users);const Se=await xr.getAll(c);Se.success?t(Se.data):U(Se.message||"Failed to load expenses");const je=await xr.getStats(c);je.success&&o(je.data)}catch(ne){console.error("Error loading data:",ne),U("Unable to connect to server. Please try again.")}finally{S(!1)}},Ne=ne=>{Object.keys(ne).length===0?d({date_from:G(),date_to:new Date().toISOString().split("T")[0]}):d(me=>{const Se={...me};return Object.keys(ne).forEach(je=>{const $e=ne[je];$e===void 0||$e===""||$e===null||Array.isArray($e)&&$e.length===0?delete Se[je]:Se[je]=$e}),Se}),m([])},ae=ne=>{d(ne),m([])},xe=(ne,me)=>{m(me?Se=>[...Se,ne]:Se=>Se.filter(je=>je!==ne))},ee=ne=>{m(ne?e.map(me=>me.id):[])},Y=ne=>{x(ne),y(!0)},F=async()=>{try{(await xr.bulkApprove(h)).success&&(m([]),se())}catch(ne){console.error("Error bulk approving:",ne)}},K=async ne=>{try{(await xr.bulkReject(h,ne)).success&&(m([]),se())}catch(me){console.error("Error bulk rejecting:",me)}},te=()=>{const ne=e.filter(me=>h.includes(me.id));ne.length>0&&(x(ne[0]),E(!0))},T=()=>{const ne=e.filter(We=>h.includes(We.id)),me=["Date","Employee","Project","Category","Amount","Billable","Status","Invoice"],Se=ne.map(We=>[We.spentOn||"",We.employeeName||"",We.projectName||"",We.category||"",We.amount||0,We.isBillable?"Yes":"No",We.status||"",We.invoiceNumber||""]),je=[me.join(","),...Se.map(We=>We.map(br=>`"${br}"`).join(","))].join(`
`),$e=new Blob([je],{type:"text/csv"}),Me=window.URL.createObjectURL($e),ge=document.createElement("a");ge.href=Me,ge.download=`expenses-${new Date().toISOString().split("T")[0]}.csv`,ge.click(),window.URL.revokeObjectURL(Me)},M=ne=>{m(me=>me.filter(Se=>Se!==ne)),se()},D=ne=>{m(me=>me.filter(Se=>Se!==ne)),se()},B=()=>{se(),w(!1),P(null)},q=()=>{se(),E(!1),m([])},W=ne=>new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR",minimumFractionDigits:0,maximumFractionDigits:0}).format(ne),Z=e.filter(ne=>{var Se,je,$e,Me;if(!u.trim())return!0;const me=u.toLowerCase();return((Se=ne.employeeName)==null?void 0:Se.toLowerCase().includes(me))||((je=ne.projectName)==null?void 0:je.toLowerCase().includes(me))||(($e=ne.category)==null?void 0:$e.toLowerCase().includes(me))||((Me=ne.note)==null?void 0:Me.toLowerCase().includes(me))}),ie=[...new Set(e.map(ne=>ne.category).filter(Boolean))],ce=e.reduce((ne,me)=>(me.userId&&!ne.find(Se=>Se.id===me.userId)&&ne.push({id:me.userId,name:me.employeeName||"Unknown"}),ne),[]);return a.jsxs("div",{className:"h-full bg-gray-50",children:[a.jsxs("header",{className:"bg-white border-b border-gray-200 px-8 py-6",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsxs("div",{className:"flex items-center gap-6 flex-1",children:[a.jsx("h1",{className:"text-2xl font-semibold text-gray-900",children:"Expenses"}),a.jsxs("div",{className:"relative flex-1 max-w-md",children:[a.jsx(hn,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),a.jsx("input",{value:u,onChange:ne=>f(ne.target.value),type:"text",placeholder:"Search expenses...",className:"w-full pl-10 pr-4 py-2.5 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-400 focus:border-transparent text-sm",disabled:I})]})]}),a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx(Ab,{filters:c,projects:r,employees:ce,categories:ie,onFilterChange:Ne,onSavedViewChange:ae}),a.jsxs("button",{onClick:()=>{P(null),w(!0)},className:"px-4 py-2 text-sm font-medium text-white rounded-lg hover:opacity-90 transition-opacity disabled:opacity-50",style:{backgroundColor:"#714b67"},disabled:I,children:[a.jsx(ar,{className:"inline w-4 h-4 mr-2"})," New Expense"]})]})]}),a.jsxs("div",{className:"grid grid-cols-4 gap-4 mb-4",children:[a.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4 hover:shadow-md transition-shadow cursor-pointer",children:[a.jsx("div",{className:"text-sm text-gray-600 mb-1",children:"Pending Approvals"}),a.jsx("div",{className:"text-2xl font-semibold",style:{color:"#714b67"},children:l.pendingApprovals})]}),a.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4 hover:shadow-md transition-shadow cursor-pointer",children:[a.jsx("div",{className:"text-sm text-gray-600 mb-1",children:" Pending"}),a.jsx("div",{className:"text-2xl font-semibold text-gray-900",children:W(l.pendingAmount)})]}),a.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4 hover:shadow-md transition-shadow cursor-pointer",children:[a.jsx("div",{className:"text-sm text-gray-600 mb-1",children:" Pending (Billable)"}),a.jsx("div",{className:"text-2xl font-semibold text-gray-900",children:W(l.pendingBillableAmount)})]}),a.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4 hover:shadow-md transition-shadow cursor-pointer",children:[a.jsx("div",{className:"text-sm text-gray-600 mb-1",children:"Missing Receipts"}),a.jsx("div",{className:"text-2xl font-semibold text-gray-900",children:l.missingReceipts})]})]}),a.jsxs("div",{className:"flex items-center gap-2 mb-4 flex-wrap",children:[a.jsx("button",{onClick:()=>Ne({status:["submitted","draft"]}),className:`px-3 py-1.5 text-sm font-medium rounded-lg transition-colors ${JSON.stringify(c.status)===JSON.stringify(["submitted","draft"])?"text-white":"bg-white text-gray-700 border border-gray-300 hover:bg-gray-50"}`,style:JSON.stringify(c.status)===JSON.stringify(["submitted","draft"])?{backgroundColor:"#714b67"}:{},children:"Pending"}),a.jsx("button",{onClick:()=>Ne({status:["approved"]}),className:`px-3 py-1.5 text-sm font-medium rounded-lg transition-colors ${JSON.stringify(c.status)===JSON.stringify(["approved"])?"text-white":"bg-white text-gray-700 border border-gray-300 hover:bg-gray-50"}`,style:JSON.stringify(c.status)===JSON.stringify(["approved"])?{backgroundColor:"#714b67"}:{},children:"Approved"}),a.jsx("button",{onClick:()=>Ne({status:["rejected"]}),className:`px-3 py-1.5 text-sm font-medium rounded-lg transition-colors ${JSON.stringify(c.status)===JSON.stringify(["rejected"])?"text-white":"bg-white text-gray-700 border border-gray-300 hover:bg-gray-50"}`,style:JSON.stringify(c.status)===JSON.stringify(["rejected"])?{backgroundColor:"#714b67"}:{},children:"Rejected"}),a.jsx("button",{onClick:()=>{const{status:ne,...me}=c;Ne(me)},className:`px-3 py-1.5 text-sm font-medium rounded-lg transition-colors ${c.status?"bg-white text-gray-700 border border-gray-300 hover:bg-gray-50":"text-white"}`,style:c.status?{}:{backgroundColor:"#714b67"},children:"All"})]})]}),a.jsxs("div",{className:"p-6",children:[I&&a.jsx("div",{className:"flex items-center justify-center h-64",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"inline-block animate-spin rounded-full h-12 w-12 border-b-2 border-gray-900 mb-4"}),a.jsx("p",{className:"text-gray-600",children:"Loading expenses..."})]})}),R&&!I&&a.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 mb-4",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("svg",{className:"w-5 h-5 text-red-600",fill:"currentColor",viewBox:"0 0 20 20",children:a.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})}),a.jsx("span",{className:"text-red-800 font-medium",children:R})]}),a.jsx("button",{onClick:se,className:"text-red-600 hover:text-red-800 font-medium text-sm",children:"Retry"})]})}),!I&&!R&&a.jsx(Fb,{selectedCount:h.length,onBulkApprove:F,onBulkReject:K,onBulkAddToInvoice:te,onExportCSV:T}),!I&&!R&&a.jsx(a.Fragment,{children:Z.length===0?a.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-12 text-center",children:[a.jsx(Po,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),a.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No expenses found"}),a.jsx("p",{className:"text-sm text-gray-500 mb-4",children:c.status?`No expenses with status: ${Array.isArray(c.status)?c.status.join(", "):c.status}`:"Try adjusting your filters or create a new expense."}),a.jsxs("div",{className:"flex items-center justify-center gap-3",children:[a.jsx("button",{onClick:()=>d({date_from:G(),date_to:new Date().toISOString().split("T")[0]}),className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",children:"Clear Filters"}),a.jsx("button",{onClick:()=>{P(null),w(!0)},className:"px-4 py-2 text-sm font-medium text-white rounded-lg hover:opacity-90",style:{backgroundColor:"#714b67"},children:"New Expense"})]})]}):a.jsx("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:a.jsx(kb,{expenses:Z,selectedIds:h,onSelect:xe,onSelectAll:ee,onRowClick:Y})})})]}),v&&p&&a.jsx(Ob,{expense:p,onClose:()=>{y(!1),x(null)},onUpdate:async()=>{if(await se(),p!=null&&p.id)try{const ne=await xr.getById(p.id);ne.success&&x(ne.data)}catch(ne){console.error("Error refreshing expense:",ne)}},onApprove:M,onReject:D,onAddToInvoice:ne=>{x(ne[0]),E(!0),y(!1)}}),g&&a.jsx(Ib,{expense:b,projects:r,users:s,onClose:()=>{w(!1),P(null)},onSave:B}),L&&p&&a.jsx(Db,{expenses:h.length>1?e.filter(ne=>h.includes(ne.id)):[p],onClose:()=>{E(!1),x(null)},onSave:q})]})}/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var Zl={};Zl.version="0.18.5";var wp=1252,Mb=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],bp=function(e){Mb.indexOf(e)!=-1&&(wp=e)};function Bb(){bp(1252)}var Ni=function(e){bp(e)};function Ub(){Ni(1200),Bb()}var ll=function(t){return String.fromCharCode(t)},Uf=function(t){return String.fromCharCode(t)},eo,En="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function ji(e){for(var t="",r=0,n=0,s=0,i=0,l=0,o=0,c=0,d=0;d<e.length;)r=e.charCodeAt(d++),i=r>>2,n=e.charCodeAt(d++),l=(r&3)<<4|n>>4,s=e.charCodeAt(d++),o=(n&15)<<2|s>>6,c=s&63,isNaN(n)?o=c=64:isNaN(s)&&(c=64),t+=En.charAt(i)+En.charAt(l)+En.charAt(o)+En.charAt(c);return t}function un(e){var t="",r=0,n=0,s=0,i=0,l=0,o=0,c=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var d=0;d<e.length;)i=En.indexOf(e.charAt(d++)),l=En.indexOf(e.charAt(d++)),r=i<<2|l>>4,t+=String.fromCharCode(r),o=En.indexOf(e.charAt(d++)),n=(l&15)<<4|o>>2,o!==64&&(t+=String.fromCharCode(n)),c=En.indexOf(e.charAt(d++)),s=(o&3)<<6|c,c!==64&&(t+=String.fromCharCode(s));return t}var Oe=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),xn=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}}();function hs(e){return Oe?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function zf(e){return Oe?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var Cr=function(t){return Oe?xn(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function Io(e){if(typeof ArrayBuffer>"u")return Cr(e);for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),n=0;n!=e.length;++n)r[n]=e.charCodeAt(n)&255;return t}function Ii(e){if(Array.isArray(e))return e.map(function(n){return String.fromCharCode(n)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function zb(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}var jt=Oe?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:xn(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var n=new Uint8Array(r),s=0;for(t=0,r=0;t<e.length;r+=s,++t)if(s=e[t].length,e[t]instanceof Uint8Array)n.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";n.set(new Uint8Array(e[t]),r)}return n}return[].concat.apply([],e.map(function(i){return Array.isArray(i)?i:[].slice.call(i)}))};function $b(e){for(var t=[],r=0,n=e.length+250,s=hs(e.length+255),i=0;i<e.length;++i){var l=e.charCodeAt(i);if(l<128)s[r++]=l;else if(l<2048)s[r++]=192|l>>6&31,s[r++]=128|l&63;else if(l>=55296&&l<57344){l=(l&1023)+64;var o=e.charCodeAt(++i)&1023;s[r++]=240|l>>8&7,s[r++]=128|l>>2&63,s[r++]=128|o>>6&15|(l&3)<<4,s[r++]=128|o&63}else s[r++]=224|l>>12&15,s[r++]=128|l>>6&63,s[r++]=128|l&63;r>n&&(t.push(s.slice(0,r)),r=0,s=hs(65535),n=65530)}return t.push(s.slice(0,r)),jt(t)}var qa=/\u0000/g,ol=/[\u0001-\u0006]/g;function qs(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function Ar(e,t){var r=""+e;return r.length>=t?r:rt("0",t-r.length)+r}function R0(e,t){var r=""+e;return r.length>=t?r:rt(" ",t-r.length)+r}function to(e,t){var r=""+e;return r.length>=t?r:r+rt(" ",t-r.length)}function Wb(e,t){var r=""+Math.round(e);return r.length>=t?r:rt("0",t-r.length)+r}function Hb(e,t){var r=""+e;return r.length>=t?r:rt("0",t-r.length)+r}var $f=Math.pow(2,32);function Es(e,t){if(e>$f||e<-$f)return Wb(e,t);var r=Math.round(e);return Hb(r,t)}function ro(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var Wf=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],jc=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function Vb(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',e}var nt={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},Hf={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},Gb={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function no(e,t,r){for(var n=e<0?-1:1,s=e*n,i=0,l=1,o=0,c=1,d=0,u=0,f=Math.floor(s);d<t&&(f=Math.floor(s),o=f*l+i,u=f*d+c,!(s-f<5e-8));)s=1/(s-f),i=l,l=o,c=d,d=u;if(u>t&&(d>t?(u=c,o=i):(u=d,o=l)),!r)return[0,n*o,u];var h=Math.floor(n*o/u);return[h,n*o-h*u,u]}function cl(e,t,r){if(e>2958465||e<0)return null;var n=e|0,s=Math.floor(86400*(e-n)),i=0,l=[],o={D:n,T:s,u:86400*(e-n)-s,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),t&&t.date1904&&(n+=1462),o.u>.9999&&(o.u=0,++s==86400&&(o.T=s=0,++n,++o.D)),n===60)l=r?[1317,10,29]:[1900,2,29],i=3;else if(n===0)l=r?[1317,8,29]:[1900,1,0],i=6;else{n>60&&--n;var c=new Date(1900,0,1);c.setDate(c.getDate()+n-1),l=[c.getFullYear(),c.getMonth()+1,c.getDate()],i=c.getDay(),n<60&&(i=(i+6)%7),r&&(i=Zb(c,l))}return o.y=l[0],o.m=l[1],o.d=l[2],o.S=s%60,s=Math.floor(s/60),o.M=s%60,s=Math.floor(s/60),o.H=s,o.q=i,o}var Np=new Date(1899,11,31,0,0,0),Xb=Np.getTime(),Kb=new Date(1900,2,1,0,0,0);function jp(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=Kb&&(r+=24*60*60*1e3),(r-(Xb+(e.getTimezoneOffset()-Np.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function I0(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function Yb(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function Jb(e){var t=e<0?12:11,r=I0(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function qb(e){var t=I0(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function Qb(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=Jb(e):t===10?r=e.toFixed(10).substr(0,12):r=qb(e),I0(Yb(r.toUpperCase()))}function Fu(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):Qb(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return Un(14,jp(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function Zb(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function eN(e,t,r,n){var s="",i=0,l=0,o=r.y,c,d=0;switch(e){case 98:o=r.y+543;case 121:switch(t.length){case 1:case 2:c=o%100,d=2;break;default:c=o%1e4,d=4;break}break;case 109:switch(t.length){case 1:case 2:c=r.m,d=t.length;break;case 3:return jc[r.m-1][1];case 5:return jc[r.m-1][0];default:return jc[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:c=r.d,d=t.length;break;case 3:return Wf[r.q][0];default:return Wf[r.q][1]}break;case 104:switch(t.length){case 1:case 2:c=1+(r.H+11)%12,d=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:c=r.H,d=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:c=r.M,d=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?Ar(r.S,t.length):(n>=2?l=n===3?1e3:100:l=n===1?10:1,i=Math.round(l*(r.S+r.u)),i>=60*l&&(i=0),t==="s"?i===0?"0":""+i/l:(s=Ar(i,2+n),t==="ss"?s.substr(0,2):"."+s.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":c=r.D*24+r.H;break;case"[m]":case"[mm]":c=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":c=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}d=t.length===3?1:2;break;case 101:c=o,d=1;break}var u=d>0?Ar(c,d):"";return u}function Tn(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,n=e.substr(0,r);r!=e.length;r+=t)n+=(n.length>0?",":"")+e.substr(r,t);return n}var Sp=/%/g;function tN(e,t,r){var n=t.replace(Sp,""),s=t.length-n.length;return rn(e,n,r*Math.pow(10,2*s))+rt("%",s)}function rN(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return rn(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function _p(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+_p(e,-t);var s=e.indexOf(".");s===-1&&(s=e.indexOf("E"));var i=Math.floor(Math.log(t)*Math.LOG10E)%s;if(i<0&&(i+=s),r=(t/Math.pow(10,i)).toPrecision(n+1+(s+i)%s),r.indexOf("e")===-1){var l=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(l-r.length+i):r+="E+"+(l-i);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,s)+"."+r.substr(2+s),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,c,d,u){return c+d+u.substr(0,(s+i)%s)+"."+u.substr(i)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var Ep=/# (\?+)( ?)\/( ?)(\d+)/;function nN(e,t,r){var n=parseInt(e[4],10),s=Math.round(t*n),i=Math.floor(s/n),l=s-i*n,o=n;return r+(i===0?"":""+i)+" "+(l===0?rt(" ",e[1].length+1+e[4].length):R0(l,e[1].length)+e[2]+"/"+e[3]+Ar(o,e[4].length))}function sN(e,t,r){return r+(t===0?"":""+t)+rt(" ",e[1].length+2+e[4].length)}var Tp=/^#*0*\.([0#]+)/,Cp=/\).*[0#]/,kp=/\(###\) ###\\?-####/;function Lt(e){for(var t="",r,n=0;n!=e.length;++n)switch(r=e.charCodeAt(n)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function Vf(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function Gf(e,t){var r=e-Math.floor(e),n=Math.pow(10,t);return t<(""+Math.round(r*n)).length?0:Math.round(r*n)}function aN(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function iN(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function ur(e,t,r){if(e.charCodeAt(0)===40&&!t.match(Cp)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?ur("n",n,r):"("+ur("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return rN(e,t,r);if(t.indexOf("%")!==-1)return tN(e,t,r);if(t.indexOf("E")!==-1)return _p(t,r);if(t.charCodeAt(0)===36)return"$"+ur(e,t.substr(t.charAt(1)==" "?2:1),r);var s,i,l,o,c=Math.abs(r),d=r<0?"-":"";if(t.match(/^00+$/))return d+Es(c,t.length);if(t.match(/^[#?]+$/))return s=Es(r,0),s==="0"&&(s=""),s.length>t.length?s:Lt(t.substr(0,t.length-s.length))+s;if(i=t.match(Ep))return nN(i,c,d);if(t.match(/^#+0+$/))return d+Es(c,t.length-t.indexOf("0"));if(i=t.match(Tp))return s=Vf(r,i[1].length).replace(/^([^\.]+)$/,"$1."+Lt(i[1])).replace(/\.$/,"."+Lt(i[1])).replace(/\.(\d*)$/,function(p,x){return"."+x+rt("0",Lt(i[1]).length-x.length)}),t.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),i=t.match(/^(0*)\.(#*)$/))return d+Vf(c,i[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=t.match(/^#{1,3},##0(\.?)$/))return d+Tn(Es(c,0));if(i=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+ur(e,t,-r):Tn(""+(Math.floor(r)+aN(r,i[1].length)))+"."+Ar(Gf(r,i[1].length),i[1].length);if(i=t.match(/^#,#*,#0/))return ur(e,t.replace(/^#,#*,/,""),r);if(i=t.match(/^([0#]+)(\\?-([0#]+))+$/))return s=qs(ur(e,t.replace(/[\\-]/g,""),r)),l=0,qs(qs(t.replace(/\\/g,"")).replace(/[0#]/g,function(p){return l<s.length?s.charAt(l++):p==="0"?"0":""}));if(t.match(kp))return s=ur(e,"##########",r),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var u="";if(i=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(i[4].length,7),o=no(c,Math.pow(10,l)-1,!1),s=""+d,u=rn("n",i[1],o[1]),u.charAt(u.length-1)==" "&&(u=u.substr(0,u.length-1)+"0"),s+=u+i[2]+"/"+i[3],u=to(o[2],l),u.length<i[4].length&&(u=Lt(i[4].substr(i[4].length-u.length))+u),s+=u,s;if(i=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(Math.max(i[1].length,i[4].length),7),o=no(c,Math.pow(10,l)-1,!0),d+(o[0]||(o[1]?"":"0"))+" "+(o[1]?R0(o[1],l)+i[2]+"/"+i[3]+to(o[2],l):rt(" ",2*l+1+i[2].length+i[3].length));if(i=t.match(/^[#0?]+$/))return s=Es(r,0),t.length<=s.length?s:Lt(t.substr(0,t.length-s.length))+s;if(i=t.match(/^([#0?]+)\.([#0]+)$/)){s=""+r.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),l=s.indexOf(".");var f=t.indexOf(".")-l,h=t.length-s.length-f;return Lt(t.substr(0,f)+s+t.substr(t.length-h))}if(i=t.match(/^00,000\.([#0]*0)$/))return l=Gf(r,i[1].length),r<0?"-"+ur(e,t,-r):Tn(iN(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(p){return"00,"+(p.length<3?Ar(0,3-p.length):"")+p})+"."+Ar(l,i[1].length);switch(t){case"###,##0.00":return ur(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var m=Tn(Es(c,0));return m!=="0"?d+m:"";case"###,###.00":return ur(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return ur(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function lN(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return rn(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function oN(e,t,r){var n=t.replace(Sp,""),s=t.length-n.length;return rn(e,n,r*Math.pow(10,2*s))+rt("%",s)}function Ap(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+Ap(e,-t);var s=e.indexOf(".");s===-1&&(s=e.indexOf("E"));var i=Math.floor(Math.log(t)*Math.LOG10E)%s;if(i<0&&(i+=s),r=(t/Math.pow(10,i)).toPrecision(n+1+(s+i)%s),!r.match(/[Ee]/)){var l=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(l-r.length+i):r+="E+"+(l-i),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,c,d,u){return c+d+u.substr(0,(s+i)%s)+"."+u.substr(i)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function Lr(e,t,r){if(e.charCodeAt(0)===40&&!t.match(Cp)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Lr("n",n,r):"("+Lr("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return lN(e,t,r);if(t.indexOf("%")!==-1)return oN(e,t,r);if(t.indexOf("E")!==-1)return Ap(t,r);if(t.charCodeAt(0)===36)return"$"+Lr(e,t.substr(t.charAt(1)==" "?2:1),r);var s,i,l,o,c=Math.abs(r),d=r<0?"-":"";if(t.match(/^00+$/))return d+Ar(c,t.length);if(t.match(/^[#?]+$/))return s=""+r,r===0&&(s=""),s.length>t.length?s:Lt(t.substr(0,t.length-s.length))+s;if(i=t.match(Ep))return sN(i,c,d);if(t.match(/^#+0+$/))return d+Ar(c,t.length-t.indexOf("0"));if(i=t.match(Tp))return s=(""+r).replace(/^([^\.]+)$/,"$1."+Lt(i[1])).replace(/\.$/,"."+Lt(i[1])),s=s.replace(/\.(\d*)$/,function(p,x){return"."+x+rt("0",Lt(i[1]).length-x.length)}),t.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),i=t.match(/^(0*)\.(#*)$/))return d+(""+c).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=t.match(/^#{1,3},##0(\.?)$/))return d+Tn(""+c);if(i=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Lr(e,t,-r):Tn(""+r)+"."+rt("0",i[1].length);if(i=t.match(/^#,#*,#0/))return Lr(e,t.replace(/^#,#*,/,""),r);if(i=t.match(/^([0#]+)(\\?-([0#]+))+$/))return s=qs(Lr(e,t.replace(/[\\-]/g,""),r)),l=0,qs(qs(t.replace(/\\/g,"")).replace(/[0#]/g,function(p){return l<s.length?s.charAt(l++):p==="0"?"0":""}));if(t.match(kp))return s=Lr(e,"##########",r),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var u="";if(i=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(i[4].length,7),o=no(c,Math.pow(10,l)-1,!1),s=""+d,u=rn("n",i[1],o[1]),u.charAt(u.length-1)==" "&&(u=u.substr(0,u.length-1)+"0"),s+=u+i[2]+"/"+i[3],u=to(o[2],l),u.length<i[4].length&&(u=Lt(i[4].substr(i[4].length-u.length))+u),s+=u,s;if(i=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(Math.max(i[1].length,i[4].length),7),o=no(c,Math.pow(10,l)-1,!0),d+(o[0]||(o[1]?"":"0"))+" "+(o[1]?R0(o[1],l)+i[2]+"/"+i[3]+to(o[2],l):rt(" ",2*l+1+i[2].length+i[3].length));if(i=t.match(/^[#0?]+$/))return s=""+r,t.length<=s.length?s:Lt(t.substr(0,t.length-s.length))+s;if(i=t.match(/^([#0]+)\.([#0]+)$/)){s=""+r.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),l=s.indexOf(".");var f=t.indexOf(".")-l,h=t.length-s.length-f;return Lt(t.substr(0,f)+s+t.substr(t.length-h))}if(i=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+Lr(e,t,-r):Tn(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(p){return"00,"+(p.length<3?Ar(0,3-p.length):"")+p})+"."+Ar(0,i[1].length);switch(t){case"###,###":case"##,###":case"#,###":var m=Tn(""+c);return m!=="0"?d+m:"";default:if(t.match(/\.[0#?]*$/))return Lr(e,t.slice(0,t.lastIndexOf(".")),r)+Lt(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function rn(e,t,r){return(r|0)===r?Lr(e,t,r):ur(e,t,r)}function cN(e){for(var t=[],r=!1,n=0,s=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:t[t.length]=e.substr(s,n-s),s=n+1}if(t[t.length]=e.substr(s),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var Fp=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Op(e){for(var t=0,r="",n="";t<e.length;)switch(r=e.charAt(t)){case"G":ro(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="/")return!0;++t;break;case"[":for(n=r;e.charAt(t++)!=="]"&&t<e.length;)n+=e.charAt(t);if(n.match(Fp))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function uN(e,t,r,n){for(var s=[],i="",l=0,o="",c="t",d,u,f,h="H";l<e.length;)switch(o=e.charAt(l)){case"G":if(!ro(e,l))throw new Error("unrecognized character "+o+" in "+e);s[s.length]={t:"G",v:"General"},l+=7;break;case'"':for(i="";(f=e.charCodeAt(++l))!==34&&l<e.length;)i+=String.fromCharCode(f);s[s.length]={t:"t",v:i},++l;break;case"\\":var m=e.charAt(++l),p=m==="("||m===")"?m:"t";s[s.length]={t:p,v:m},++l;break;case"_":s[s.length]={t:"t",v:" "},l+=2;break;case"@":s[s.length]={t:"T",v:t},++l;break;case"B":case"b":if(e.charAt(l+1)==="1"||e.charAt(l+1)==="2"){if(d==null&&(d=cl(t,r,e.charAt(l+1)==="2"),d==null))return"";s[s.length]={t:"X",v:e.substr(l,2)},c=o,l+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||d==null&&(d=cl(t,r),d==null))return"";for(i=o;++l<e.length&&e.charAt(l).toLowerCase()===o;)i+=o;o==="m"&&c.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=h),s[s.length]={t:o,v:i},c=o;break;case"A":case"a":case"":var x={t:o,v:o};if(d==null&&(d=cl(t,r)),e.substr(l,3).toUpperCase()==="A/P"?(d!=null&&(x.v=d.H>=12?"P":"A"),x.t="T",h="h",l+=3):e.substr(l,5).toUpperCase()==="AM/PM"?(d!=null&&(x.v=d.H>=12?"PM":"AM"),x.t="T",l+=5,h="h"):e.substr(l,5).toUpperCase()==="/"?(d!=null&&(x.v=d.H>=12?"":""),x.t="T",l+=5,h="h"):(x.t="t",++l),d==null&&x.t==="T")return"";s[s.length]=x,c=o;break;case"[":for(i=o;e.charAt(l++)!=="]"&&l<e.length;)i+=e.charAt(l);if(i.slice(-1)!=="]")throw'unterminated "[" block: |'+i+"|";if(i.match(Fp)){if(d==null&&(d=cl(t,r),d==null))return"";s[s.length]={t:"Z",v:i.toLowerCase()},c=i.charAt(1)}else i.indexOf("$")>-1&&(i=(i.match(/\$([^-\[\]]*)/)||[])[1]||"$",Op(e)||(s[s.length]={t:"t",v:i}));break;case".":if(d!=null){for(i=o;++l<e.length&&(o=e.charAt(l))==="0";)i+=o;s[s.length]={t:"s",v:i};break}case"0":case"#":for(i=o;++l<e.length&&"0#?.,E+-%".indexOf(o=e.charAt(l))>-1;)i+=o;s[s.length]={t:"n",v:i};break;case"?":for(i=o;e.charAt(++l)===o;)i+=o;s[s.length]={t:o,v:i},c=o;break;case"*":++l,(e.charAt(l)==" "||e.charAt(l)=="*")&&++l;break;case"(":case")":s[s.length]={t:n===1?"t":o,v:o},++l;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(i=o;l<e.length&&"0123456789".indexOf(e.charAt(++l))>-1;)i+=e.charAt(l);s[s.length]={t:"D",v:i};break;case" ":s[s.length]={t:o,v:o},++l;break;case"$":s[s.length]={t:"t",v:"$"},++l;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+e);s[s.length]={t:"t",v:o},++l;break}var v=0,y=0,g;for(l=s.length-1,c="t";l>=0;--l)switch(s[l].t){case"h":case"H":s[l].t=h,c="h",v<1&&(v=1);break;case"s":(g=s[l].v.match(/\.0+$/))&&(y=Math.max(y,g[0].length-1)),v<3&&(v=3);case"d":case"y":case"M":case"e":c=s[l].t;break;case"m":c==="s"&&(s[l].t="M",v<2&&(v=2));break;case"X":break;case"Z":v<1&&s[l].v.match(/[Hh]/)&&(v=1),v<2&&s[l].v.match(/[Mm]/)&&(v=2),v<3&&s[l].v.match(/[Ss]/)&&(v=3)}switch(v){case 0:break;case 1:d.u>=.5&&(d.u=0,++d.S),d.S>=60&&(d.S=0,++d.M),d.M>=60&&(d.M=0,++d.H);break;case 2:d.u>=.5&&(d.u=0,++d.S),d.S>=60&&(d.S=0,++d.M);break}var w="",b;for(l=0;l<s.length;++l)switch(s[l].t){case"t":case"T":case" ":case"D":break;case"X":s[l].v="",s[l].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":s[l].v=eN(s[l].t.charCodeAt(0),s[l].v,d,y),s[l].t="t";break;case"n":case"?":for(b=l+1;s[b]!=null&&((o=s[b].t)==="?"||o==="D"||(o===" "||o==="t")&&s[b+1]!=null&&(s[b+1].t==="?"||s[b+1].t==="t"&&s[b+1].v==="/")||s[l].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(s[b].v==="/"||s[b].v===" "&&s[b+1]!=null&&s[b+1].t=="?"));)s[l].v+=s[b].v,s[b]={v:"",t:";"},++b;w+=s[l].v,l=b-1;break;case"G":s[l].t="t",s[l].v=Fu(t,r);break}var P="",L,E;if(w.length>0){w.charCodeAt(0)==40?(L=t<0&&w.charCodeAt(0)===45?-t:t,E=rn("n",w,L)):(L=t<0&&n>1?-t:t,E=rn("n",w,L),L<0&&s[0]&&s[0].t=="t"&&(E=E.substr(1),s[0].v="-"+s[0].v)),b=E.length-1;var I=s.length;for(l=0;l<s.length;++l)if(s[l]!=null&&s[l].t!="t"&&s[l].v.indexOf(".")>-1){I=l;break}var S=s.length;if(I===s.length&&E.indexOf("E")===-1){for(l=s.length-1;l>=0;--l)s[l]==null||"n?".indexOf(s[l].t)===-1||(b>=s[l].v.length-1?(b-=s[l].v.length,s[l].v=E.substr(b+1,s[l].v.length)):b<0?s[l].v="":(s[l].v=E.substr(0,b+1),b=-1),s[l].t="t",S=l);b>=0&&S<s.length&&(s[S].v=E.substr(0,b+1)+s[S].v)}else if(I!==s.length&&E.indexOf("E")===-1){for(b=E.indexOf(".")-1,l=I;l>=0;--l)if(!(s[l]==null||"n?".indexOf(s[l].t)===-1)){for(u=s[l].v.indexOf(".")>-1&&l===I?s[l].v.indexOf(".")-1:s[l].v.length-1,P=s[l].v.substr(u+1);u>=0;--u)b>=0&&(s[l].v.charAt(u)==="0"||s[l].v.charAt(u)==="#")&&(P=E.charAt(b--)+P);s[l].v=P,s[l].t="t",S=l}for(b>=0&&S<s.length&&(s[S].v=E.substr(0,b+1)+s[S].v),b=E.indexOf(".")+1,l=I;l<s.length;++l)if(!(s[l]==null||"n?(".indexOf(s[l].t)===-1&&l!==I)){for(u=s[l].v.indexOf(".")>-1&&l===I?s[l].v.indexOf(".")+1:0,P=s[l].v.substr(0,u);u<s[l].v.length;++u)b<E.length&&(P+=E.charAt(b++));s[l].v=P,s[l].t="t",S=l}}}for(l=0;l<s.length;++l)s[l]!=null&&"n?".indexOf(s[l].t)>-1&&(L=n>1&&t<0&&l>0&&s[l-1].v==="-"?-t:t,s[l].v=rn(s[l].t,s[l].v,L),s[l].t="t");var R="";for(l=0;l!==s.length;++l)s[l]!=null&&(R+=s[l].v);return R}var Xf=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function Kf(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function dN(e,t){var r=cN(e),n=r.length,s=r[n-1].indexOf("@");if(n<4&&s>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||s>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=s>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=s>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=s>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var i=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,i];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var l=r[0].match(Xf),o=r[1].match(Xf);return Kf(t,l)?[n,r[0]]:Kf(t,o)?[n,r[1]]:[n,r[l!=null&&o!=null?2:1]]}return[n,i]}function Un(e,t,r){r==null&&(r={});var n="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?n=r.dateNF:n=e;break;case"number":e==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:nt)[e],n==null&&(n=r.table&&r.table[Hf[e]]||nt[Hf[e]]),n==null&&(n=Gb[e]||"General");break}if(ro(n,0))return Fu(t,r);t instanceof Date&&(t=jp(t,r.date1904));var s=dN(n,t);if(ro(s[1]))return Fu(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return uN(s[1],t,r,s[0])}function Pp(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(nt[r]==null){t<0&&(t=r);continue}if(nt[r]==e){t=r;break}}t<0&&(t=391)}return nt[t]=e,t}function Do(e){for(var t=0;t!=392;++t)e[t]!==void 0&&Pp(e[t],t)}function Lo(){nt=Vb()}var Rp=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function fN(e){var t=typeof e=="number"?nt[e]:e;return t=t.replace(Rp,"(\\d+)"),new RegExp("^"+t+"$")}function hN(e,t,r){var n=-1,s=-1,i=-1,l=-1,o=-1,c=-1;(t.match(Rp)||[]).forEach(function(f,h){var m=parseInt(r[h+1],10);switch(f.toLowerCase().charAt(0)){case"y":n=m;break;case"d":i=m;break;case"h":l=m;break;case"s":c=m;break;case"m":l>=0?o=m:s=m;break}}),c>=0&&o==-1&&s>=0&&(o=s,s=-1);var d=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(s>=1?s:1)).slice(-2)+"-"+("00"+(i>=1?i:1)).slice(-2);d.length==7&&(d="0"+d),d.length==8&&(d="20"+d);var u=("00"+(l>=0?l:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2);return l==-1&&o==-1&&c==-1?d:n==-1&&s==-1&&i==-1?u:d+"T"+u}var xN=function(){var e={};e.version="1.2.0";function t(){for(var E=0,I=new Array(256),S=0;S!=256;++S)E=S,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,I[S]=E;return typeof Int32Array<"u"?new Int32Array(I):I}var r=t();function n(E){var I=0,S=0,R=0,U=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(R=0;R!=256;++R)U[R]=E[R];for(R=0;R!=256;++R)for(S=E[R],I=256+R;I<4096;I+=256)S=U[I]=S>>>8^E[S&255];var G=[];for(R=1;R!=16;++R)G[R-1]=typeof Int32Array<"u"?U.subarray(R*256,R*256+256):U.slice(R*256,R*256+256);return G}var s=n(r),i=s[0],l=s[1],o=s[2],c=s[3],d=s[4],u=s[5],f=s[6],h=s[7],m=s[8],p=s[9],x=s[10],v=s[11],y=s[12],g=s[13],w=s[14];function b(E,I){for(var S=I^-1,R=0,U=E.length;R<U;)S=S>>>8^r[(S^E.charCodeAt(R++))&255];return~S}function P(E,I){for(var S=I^-1,R=E.length-15,U=0;U<R;)S=w[E[U++]^S&255]^g[E[U++]^S>>8&255]^y[E[U++]^S>>16&255]^v[E[U++]^S>>>24]^x[E[U++]]^p[E[U++]]^m[E[U++]]^h[E[U++]]^f[E[U++]]^u[E[U++]]^d[E[U++]]^c[E[U++]]^o[E[U++]]^l[E[U++]]^i[E[U++]]^r[E[U++]];for(R+=15;U<R;)S=S>>>8^r[(S^E[U++])&255];return~S}function L(E,I){for(var S=I^-1,R=0,U=E.length,G=0,se=0;R<U;)G=E.charCodeAt(R++),G<128?S=S>>>8^r[(S^G)&255]:G<2048?(S=S>>>8^r[(S^(192|G>>6&31))&255],S=S>>>8^r[(S^(128|G&63))&255]):G>=55296&&G<57344?(G=(G&1023)+64,se=E.charCodeAt(R++)&1023,S=S>>>8^r[(S^(240|G>>8&7))&255],S=S>>>8^r[(S^(128|G>>2&63))&255],S=S>>>8^r[(S^(128|se>>6&15|(G&3)<<4))&255],S=S>>>8^r[(S^(128|se&63))&255]):(S=S>>>8^r[(S^(224|G>>12&15))&255],S=S>>>8^r[(S^(128|G>>6&63))&255],S=S>>>8^r[(S^(128|G&63))&255]);return~S}return e.table=r,e.bstr=b,e.buf=P,e.str=L,e}(),Be=function(){var t={};t.version="1.2.1";function r(N,k){for(var j=N.split("/"),_=k.split("/"),A=0,O=0,H=Math.min(j.length,_.length);A<H;++A){if(O=j[A].length-_[A].length)return O;if(j[A]!=_[A])return j[A]<_[A]?-1:1}return j.length-_.length}function n(N){if(N.charAt(N.length-1)=="/")return N.slice(0,-1).indexOf("/")===-1?N:n(N.slice(0,-1));var k=N.lastIndexOf("/");return k===-1?N:N.slice(0,k+1)}function s(N){if(N.charAt(N.length-1)=="/")return s(N.slice(0,-1));var k=N.lastIndexOf("/");return k===-1?N:N.slice(k+1)}function i(N,k){typeof k=="string"&&(k=new Date(k));var j=k.getHours();j=j<<6|k.getMinutes(),j=j<<5|k.getSeconds()>>>1,N.write_shift(2,j);var _=k.getFullYear()-1980;_=_<<4|k.getMonth()+1,_=_<<5|k.getDate(),N.write_shift(2,_)}function l(N){var k=N.read_shift(2)&65535,j=N.read_shift(2)&65535,_=new Date,A=j&31;j>>>=5;var O=j&15;j>>>=4,_.setMilliseconds(0),_.setFullYear(j+1980),_.setMonth(O-1),_.setDate(A);var H=k&31;k>>>=5;var Q=k&63;return k>>>=6,_.setHours(k),_.setMinutes(Q),_.setSeconds(H<<1),_}function o(N){er(N,0);for(var k={},j=0;N.l<=N.length-4;){var _=N.read_shift(2),A=N.read_shift(2),O=N.l+A,H={};switch(_){case 21589:j=N.read_shift(1),j&1&&(H.mtime=N.read_shift(4)),A>5&&(j&2&&(H.atime=N.read_shift(4)),j&4&&(H.ctime=N.read_shift(4))),H.mtime&&(H.mt=new Date(H.mtime*1e3));break}N.l=O,k[_]=H}return k}var c;function d(){return c||(c={})}function u(N,k){if(N[0]==80&&N[1]==75)return ud(N,k);if((N[0]|32)==109&&(N[1]|32)==105)return u1(N,k);if(N.length<512)throw new Error("CFB file size "+N.length+" < 512");var j=3,_=512,A=0,O=0,H=0,Q=0,z=0,V=[],X=N.slice(0,512);er(X,0);var le=f(X);switch(j=le[0],j){case 3:_=512;break;case 4:_=4096;break;case 0:if(le[1]==0)return ud(N,k);default:throw new Error("Major Version: Expected 3 or 4 saw "+j)}_!==512&&(X=N.slice(0,_),er(X,28));var he=N.slice(0,_);h(X,j);var ve=X.read_shift(4,"i");if(j===3&&ve!==0)throw new Error("# Directory Sectors: Expected 0 saw "+ve);X.l+=4,H=X.read_shift(4,"i"),X.l+=4,X.chk("00100000","Mini Stream Cutoff Size: "),Q=X.read_shift(4,"i"),A=X.read_shift(4,"i"),z=X.read_shift(4,"i"),O=X.read_shift(4,"i");for(var ue=-1,pe=0;pe<109&&(ue=X.read_shift(4,"i"),!(ue<0));++pe)V[pe]=ue;var _e=m(N,_);v(z,O,_e,_,V);var Je=g(_e,H,V,_);Je[H].name="!Directory",A>0&&Q!==se&&(Je[Q].name="!MiniFAT"),Je[V[0]].name="!FAT",Je.fat_addrs=V,Je.ssz=_;var qe={},kt=[],ba=[],Na=[];w(H,Je,_e,kt,A,qe,ba,Q),p(ba,Na,kt),kt.shift();var ja={FileIndex:ba,FullPaths:Na};return k&&k.raw&&(ja.raw={header:he,sectors:_e}),ja}function f(N){if(N[N.l]==80&&N[N.l+1]==75)return[0,0];N.chk(Ne,"Header Signature: "),N.l+=16;var k=N.read_shift(2,"u");return[N.read_shift(2,"u"),k]}function h(N,k){var j=9;switch(N.l+=2,j=N.read_shift(2)){case 9:if(k!=3)throw new Error("Sector Shift: Expected 9 saw "+j);break;case 12:if(k!=4)throw new Error("Sector Shift: Expected 12 saw "+j);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+j)}N.chk("0600","Mini Sector Shift: "),N.chk("000000000000","Reserved: ")}function m(N,k){for(var j=Math.ceil(N.length/k)-1,_=[],A=1;A<j;++A)_[A-1]=N.slice(A*k,(A+1)*k);return _[j-1]=N.slice(j*k),_}function p(N,k,j){for(var _=0,A=0,O=0,H=0,Q=0,z=j.length,V=[],X=[];_<z;++_)V[_]=X[_]=_,k[_]=j[_];for(;Q<X.length;++Q)_=X[Q],A=N[_].L,O=N[_].R,H=N[_].C,V[_]===_&&(A!==-1&&V[A]!==A&&(V[_]=V[A]),O!==-1&&V[O]!==O&&(V[_]=V[O])),H!==-1&&(V[H]=_),A!==-1&&_!=V[_]&&(V[A]=V[_],X.lastIndexOf(A)<Q&&X.push(A)),O!==-1&&_!=V[_]&&(V[O]=V[_],X.lastIndexOf(O)<Q&&X.push(O));for(_=1;_<z;++_)V[_]===_&&(O!==-1&&V[O]!==O?V[_]=V[O]:A!==-1&&V[A]!==A&&(V[_]=V[A]));for(_=1;_<z;++_)if(N[_].type!==0){if(Q=_,Q!=V[Q])do Q=V[Q],k[_]=k[Q]+"/"+k[_];while(Q!==0&&V[Q]!==-1&&Q!=V[Q]);V[_]=-1}for(k[0]+="/",_=1;_<z;++_)N[_].type!==2&&(k[_]+="/")}function x(N,k,j){for(var _=N.start,A=N.size,O=[],H=_;j&&A>0&&H>=0;)O.push(k.slice(H*G,H*G+G)),A-=G,H=ts(j,H*4);return O.length===0?J(0):jt(O).slice(0,N.size)}function v(N,k,j,_,A){var O=se;if(N===se){if(k!==0)throw new Error("DIFAT chain shorter than expected")}else if(N!==-1){var H=j[N],Q=(_>>>2)-1;if(!H)return;for(var z=0;z<Q&&(O=ts(H,z*4))!==se;++z)A.push(O);v(ts(H,_-4),k-1,j,_,A)}}function y(N,k,j,_,A){var O=[],H=[];A||(A=[]);var Q=_-1,z=0,V=0;for(z=k;z>=0;){A[z]=!0,O[O.length]=z,H.push(N[z]);var X=j[Math.floor(z*4/_)];if(V=z*4&Q,_<4+V)throw new Error("FAT boundary crossed: "+z+" 4 "+_);if(!N[X])break;z=ts(N[X],V)}return{nodes:O,data:rh([H])}}function g(N,k,j,_){var A=N.length,O=[],H=[],Q=[],z=[],V=_-1,X=0,le=0,he=0,ve=0;for(X=0;X<A;++X)if(Q=[],he=X+k,he>=A&&(he-=A),!H[he]){z=[];var ue=[];for(le=he;le>=0;){ue[le]=!0,H[le]=!0,Q[Q.length]=le,z.push(N[le]);var pe=j[Math.floor(le*4/_)];if(ve=le*4&V,_<4+ve)throw new Error("FAT boundary crossed: "+le+" 4 "+_);if(!N[pe]||(le=ts(N[pe],ve),ue[le]))break}O[he]={nodes:Q,data:rh([z])}}return O}function w(N,k,j,_,A,O,H,Q){for(var z=0,V=_.length?2:0,X=k[N].data,le=0,he=0,ve;le<X.length;le+=128){var ue=X.slice(le,le+128);er(ue,64),he=ue.read_shift(2),ve=U0(ue,0,he-V),_.push(ve);var pe={name:ve,type:ue.read_shift(1),color:ue.read_shift(1),L:ue.read_shift(4,"i"),R:ue.read_shift(4,"i"),C:ue.read_shift(4,"i"),clsid:ue.read_shift(16),state:ue.read_shift(4,"i"),start:0,size:0},_e=ue.read_shift(2)+ue.read_shift(2)+ue.read_shift(2)+ue.read_shift(2);_e!==0&&(pe.ct=b(ue,ue.l-8));var Je=ue.read_shift(2)+ue.read_shift(2)+ue.read_shift(2)+ue.read_shift(2);Je!==0&&(pe.mt=b(ue,ue.l-8)),pe.start=ue.read_shift(4,"i"),pe.size=ue.read_shift(4,"i"),pe.size<0&&pe.start<0&&(pe.size=pe.type=0,pe.start=se,pe.name=""),pe.type===5?(z=pe.start,A>0&&z!==se&&(k[z].name="!StreamData")):pe.size>=4096?(pe.storage="fat",k[pe.start]===void 0&&(k[pe.start]=y(j,pe.start,k.fat_addrs,k.ssz)),k[pe.start].name=pe.name,pe.content=k[pe.start].data.slice(0,pe.size)):(pe.storage="minifat",pe.size<0?pe.size=0:z!==se&&pe.start!==se&&k[z]&&(pe.content=x(pe,k[z].data,(k[Q]||{}).data))),pe.content&&er(pe.content,0),O[ve]=pe,H.push(pe)}}function b(N,k){return new Date((rr(N,k+4)/1e7*Math.pow(2,32)+rr(N,k)/1e7-11644473600)*1e3)}function P(N,k){return d(),u(c.readFileSync(N),k)}function L(N,k){var j=k&&k.type;switch(j||Oe&&Buffer.isBuffer(N)&&(j="buffer"),j||"base64"){case"file":return P(N,k);case"base64":return u(Cr(un(N)),k);case"binary":return u(Cr(N),k)}return u(N,k)}function E(N,k){var j=k||{},_=j.root||"Root Entry";if(N.FullPaths||(N.FullPaths=[]),N.FileIndex||(N.FileIndex=[]),N.FullPaths.length!==N.FileIndex.length)throw new Error("inconsistent CFB structure");N.FullPaths.length===0&&(N.FullPaths[0]=_+"/",N.FileIndex[0]={name:_,type:5}),j.CLSID&&(N.FileIndex[0].clsid=j.CLSID),I(N)}function I(N){var k="Sh33tJ5";if(!Be.find(N,"/"+k)){var j=J(4);j[0]=55,j[1]=j[3]=50,j[2]=54,N.FileIndex.push({name:k,type:2,content:j,size:4,L:69,R:69,C:69}),N.FullPaths.push(N.FullPaths[0]+k),S(N)}}function S(N,k){E(N);for(var j=!1,_=!1,A=N.FullPaths.length-1;A>=0;--A){var O=N.FileIndex[A];switch(O.type){case 0:_?j=!0:(N.FileIndex.pop(),N.FullPaths.pop());break;case 1:case 2:case 5:_=!0,isNaN(O.R*O.L*O.C)&&(j=!0),O.R>-1&&O.L>-1&&O.R==O.L&&(j=!0);break;default:j=!0;break}}if(!(!j&&!k)){var H=new Date(1987,1,19),Q=0,z=Object.create?Object.create(null):{},V=[];for(A=0;A<N.FullPaths.length;++A)z[N.FullPaths[A]]=!0,N.FileIndex[A].type!==0&&V.push([N.FullPaths[A],N.FileIndex[A]]);for(A=0;A<V.length;++A){var X=n(V[A][0]);_=z[X],_||(V.push([X,{name:s(X).replace("/",""),type:1,clsid:xe,ct:H,mt:H,content:null}]),z[X]=!0)}for(V.sort(function(ve,ue){return r(ve[0],ue[0])}),N.FullPaths=[],N.FileIndex=[],A=0;A<V.length;++A)N.FullPaths[A]=V[A][0],N.FileIndex[A]=V[A][1];for(A=0;A<V.length;++A){var le=N.FileIndex[A],he=N.FullPaths[A];if(le.name=s(he).replace("/",""),le.L=le.R=le.C=-(le.color=1),le.size=le.content?le.content.length:0,le.start=0,le.clsid=le.clsid||xe,A===0)le.C=V.length>1?1:-1,le.size=0,le.type=5;else if(he.slice(-1)=="/"){for(Q=A+1;Q<V.length&&n(N.FullPaths[Q])!=he;++Q);for(le.C=Q>=V.length?-1:Q,Q=A+1;Q<V.length&&n(N.FullPaths[Q])!=n(he);++Q);le.R=Q>=V.length?-1:Q,le.type=1}else n(N.FullPaths[A+1]||"")==n(he)&&(le.R=A+1),le.type=2}}}function R(N,k){var j=k||{};if(j.fileType=="mad")return d1(N,j);switch(S(N),j.fileType){case"zip":return s1(N,j)}var _=function(ve){for(var ue=0,pe=0,_e=0;_e<ve.FileIndex.length;++_e){var Je=ve.FileIndex[_e];if(Je.content){var qe=Je.content.length;qe>0&&(qe<4096?ue+=qe+63>>6:pe+=qe+511>>9)}}for(var kt=ve.FullPaths.length+3>>2,ba=ue+7>>3,Na=ue+127>>7,ja=ba+pe+kt+Na,qn=ja+127>>7,Xo=qn<=109?0:Math.ceil((qn-109)/127);ja+qn+Xo+127>>7>qn;)Xo=++qn<=109?0:Math.ceil((qn-109)/127);var Vr=[1,Xo,qn,Na,kt,pe,ue,0];return ve.FileIndex[0].size=ue<<6,Vr[7]=(ve.FileIndex[0].start=Vr[0]+Vr[1]+Vr[2]+Vr[3]+Vr[4]+Vr[5])+(Vr[6]+7>>3),Vr}(N),A=J(_[7]<<9),O=0,H=0;{for(O=0;O<8;++O)A.write_shift(1,ae[O]);for(O=0;O<8;++O)A.write_shift(2,0);for(A.write_shift(2,62),A.write_shift(2,3),A.write_shift(2,65534),A.write_shift(2,9),A.write_shift(2,6),O=0;O<3;++O)A.write_shift(2,0);for(A.write_shift(4,0),A.write_shift(4,_[2]),A.write_shift(4,_[0]+_[1]+_[2]+_[3]-1),A.write_shift(4,0),A.write_shift(4,4096),A.write_shift(4,_[3]?_[0]+_[1]+_[2]-1:se),A.write_shift(4,_[3]),A.write_shift(-4,_[1]?_[0]-1:se),A.write_shift(4,_[1]),O=0;O<109;++O)A.write_shift(-4,O<_[2]?_[1]+O:-1)}if(_[1])for(H=0;H<_[1];++H){for(;O<236+H*127;++O)A.write_shift(-4,O<_[2]?_[1]+O:-1);A.write_shift(-4,H===_[1]-1?se:H+1)}var Q=function(ve){for(H+=ve;O<H-1;++O)A.write_shift(-4,O+1);ve&&(++O,A.write_shift(-4,se))};for(H=O=0,H+=_[1];O<H;++O)A.write_shift(-4,ee.DIFSECT);for(H+=_[2];O<H;++O)A.write_shift(-4,ee.FATSECT);Q(_[3]),Q(_[4]);for(var z=0,V=0,X=N.FileIndex[0];z<N.FileIndex.length;++z)X=N.FileIndex[z],X.content&&(V=X.content.length,!(V<4096)&&(X.start=H,Q(V+511>>9)));for(Q(_[6]+7>>3);A.l&511;)A.write_shift(-4,ee.ENDOFCHAIN);for(H=O=0,z=0;z<N.FileIndex.length;++z)X=N.FileIndex[z],X.content&&(V=X.content.length,!(!V||V>=4096)&&(X.start=H,Q(V+63>>6)));for(;A.l&511;)A.write_shift(-4,ee.ENDOFCHAIN);for(O=0;O<_[4]<<2;++O){var le=N.FullPaths[O];if(!le||le.length===0){for(z=0;z<17;++z)A.write_shift(4,0);for(z=0;z<3;++z)A.write_shift(4,-1);for(z=0;z<12;++z)A.write_shift(4,0);continue}X=N.FileIndex[O],O===0&&(X.start=X.size?X.start-1:se);var he=O===0&&j.root||X.name;if(V=2*(he.length+1),A.write_shift(64,he,"utf16le"),A.write_shift(2,V),A.write_shift(1,X.type),A.write_shift(1,X.color),A.write_shift(-4,X.L),A.write_shift(-4,X.R),A.write_shift(-4,X.C),X.clsid)A.write_shift(16,X.clsid,"hex");else for(z=0;z<4;++z)A.write_shift(4,0);A.write_shift(4,X.state||0),A.write_shift(4,0),A.write_shift(4,0),A.write_shift(4,0),A.write_shift(4,0),A.write_shift(4,X.start),A.write_shift(4,X.size),A.write_shift(4,0)}for(O=1;O<N.FileIndex.length;++O)if(X=N.FileIndex[O],X.size>=4096)if(A.l=X.start+1<<9,Oe&&Buffer.isBuffer(X.content))X.content.copy(A,A.l,0,X.size),A.l+=X.size+511&-512;else{for(z=0;z<X.size;++z)A.write_shift(1,X.content[z]);for(;z&511;++z)A.write_shift(1,0)}for(O=1;O<N.FileIndex.length;++O)if(X=N.FileIndex[O],X.size>0&&X.size<4096)if(Oe&&Buffer.isBuffer(X.content))X.content.copy(A,A.l,0,X.size),A.l+=X.size+63&-64;else{for(z=0;z<X.size;++z)A.write_shift(1,X.content[z]);for(;z&63;++z)A.write_shift(1,0)}if(Oe)A.l=A.length;else for(;A.l<A.length;)A.write_shift(1,0);return A}function U(N,k){var j=N.FullPaths.map(function(z){return z.toUpperCase()}),_=j.map(function(z){var V=z.split("/");return V[V.length-(z.slice(-1)=="/"?2:1)]}),A=!1;k.charCodeAt(0)===47?(A=!0,k=j[0].slice(0,-1)+k):A=k.indexOf("/")!==-1;var O=k.toUpperCase(),H=A===!0?j.indexOf(O):_.indexOf(O);if(H!==-1)return N.FileIndex[H];var Q=!O.match(ol);for(O=O.replace(qa,""),Q&&(O=O.replace(ol,"!")),H=0;H<j.length;++H)if((Q?j[H].replace(ol,"!"):j[H]).replace(qa,"")==O||(Q?_[H].replace(ol,"!"):_[H]).replace(qa,"")==O)return N.FileIndex[H];return null}var G=64,se=-2,Ne="d0cf11e0a1b11ae1",ae=[208,207,17,224,161,177,26,225],xe="00000000000000000000000000000000",ee={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:se,FREESECT:-1,HEADER_SIGNATURE:Ne,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:xe,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function Y(N,k,j){d();var _=R(N,j);c.writeFileSync(k,_)}function F(N){for(var k=new Array(N.length),j=0;j<N.length;++j)k[j]=String.fromCharCode(N[j]);return k.join("")}function K(N,k){var j=R(N,k);switch(k&&k.type||"buffer"){case"file":return d(),c.writeFileSync(k.filename,j),j;case"binary":return typeof j=="string"?j:F(j);case"base64":return ji(typeof j=="string"?j:F(j));case"buffer":if(Oe)return Buffer.isBuffer(j)?j:xn(j);case"array":return typeof j=="string"?Cr(j):j}return j}var te;function T(N){try{var k=N.InflateRaw,j=new k;if(j._processChunk(new Uint8Array([3,0]),j._finishFlushFlag),j.bytesRead)te=N;else throw new Error("zlib does not expose bytesRead")}catch(_){console.error("cannot use native zlib: "+(_.message||_))}}function M(N,k){if(!te)return od(N,k);var j=te.InflateRaw,_=new j,A=_._processChunk(N.slice(N.l),_._finishFlushFlag);return N.l+=_.bytesRead,A}function D(N){return te?te.deflateRawSync(N):rd(N)}var B=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],q=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],W=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function Z(N){var k=(N<<1|N<<11)&139536|(N<<5|N<<15)&558144;return(k>>16|k>>8|k)&255}for(var ie=typeof Uint8Array<"u",ce=ie?new Uint8Array(256):[],ne=0;ne<256;++ne)ce[ne]=Z(ne);function me(N,k){var j=ce[N&255];return k<=8?j>>>8-k:(j=j<<8|ce[N>>8&255],k<=16?j>>>16-k:(j=j<<8|ce[N>>16&255],j>>>24-k))}function Se(N,k){var j=k&7,_=k>>>3;return(N[_]|(j<=6?0:N[_+1]<<8))>>>j&3}function je(N,k){var j=k&7,_=k>>>3;return(N[_]|(j<=5?0:N[_+1]<<8))>>>j&7}function $e(N,k){var j=k&7,_=k>>>3;return(N[_]|(j<=4?0:N[_+1]<<8))>>>j&15}function Me(N,k){var j=k&7,_=k>>>3;return(N[_]|(j<=3?0:N[_+1]<<8))>>>j&31}function ge(N,k){var j=k&7,_=k>>>3;return(N[_]|(j<=1?0:N[_+1]<<8))>>>j&127}function We(N,k,j){var _=k&7,A=k>>>3,O=(1<<j)-1,H=N[A]>>>_;return j<8-_||(H|=N[A+1]<<8-_,j<16-_)||(H|=N[A+2]<<16-_,j<24-_)||(H|=N[A+3]<<24-_),H&O}function br(N,k,j){var _=k&7,A=k>>>3;return _<=5?N[A]|=(j&7)<<_:(N[A]|=j<<_&255,N[A+1]=(j&7)>>8-_),k+3}function Yn(N,k,j){var _=k&7,A=k>>>3;return j=(j&1)<<_,N[A]|=j,k+1}function Ss(N,k,j){var _=k&7,A=k>>>3;return j<<=_,N[A]|=j&255,j>>>=8,N[A+1]=j,k+8}function td(N,k,j){var _=k&7,A=k>>>3;return j<<=_,N[A]|=j&255,j>>>=8,N[A+1]=j&255,N[A+2]=j>>>8,k+16}function Wo(N,k){var j=N.length,_=2*j>k?2*j:k+5,A=0;if(j>=k)return N;if(Oe){var O=zf(_);if(N.copy)N.copy(O);else for(;A<N.length;++A)O[A]=N[A];return O}else if(ie){var H=new Uint8Array(_);if(H.set)H.set(N);else for(;A<j;++A)H[A]=N[A];return H}return N.length=_,N}function Ir(N){for(var k=new Array(N),j=0;j<N;++j)k[j]=0;return k}function zi(N,k,j){var _=1,A=0,O=0,H=0,Q=0,z=N.length,V=ie?new Uint16Array(32):Ir(32);for(O=0;O<32;++O)V[O]=0;for(O=z;O<j;++O)N[O]=0;z=N.length;var X=ie?new Uint16Array(z):Ir(z);for(O=0;O<z;++O)V[A=N[O]]++,_<A&&(_=A),X[O]=0;for(V[0]=0,O=1;O<=_;++O)V[O+16]=Q=Q+V[O-1]<<1;for(O=0;O<z;++O)Q=N[O],Q!=0&&(X[O]=V[Q+16]++);var le=0;for(O=0;O<z;++O)if(le=N[O],le!=0)for(Q=me(X[O],_)>>_-le,H=(1<<_+4-le)-1;H>=0;--H)k[Q|H<<le]=le&15|O<<4;return _}var Ho=ie?new Uint16Array(512):Ir(512),Vo=ie?new Uint16Array(32):Ir(32);if(!ie){for(var Jn=0;Jn<512;++Jn)Ho[Jn]=0;for(Jn=0;Jn<32;++Jn)Vo[Jn]=0}(function(){for(var N=[],k=0;k<32;k++)N.push(5);zi(N,Vo,32);var j=[];for(k=0;k<=143;k++)j.push(8);for(;k<=255;k++)j.push(9);for(;k<=279;k++)j.push(7);for(;k<=287;k++)j.push(8);zi(j,Ho,288)})();var e1=function(){for(var k=ie?new Uint8Array(32768):[],j=0,_=0;j<W.length-1;++j)for(;_<W[j+1];++_)k[_]=j;for(;_<32768;++_)k[_]=29;var A=ie?new Uint8Array(259):[];for(j=0,_=0;j<q.length-1;++j)for(;_<q[j+1];++_)A[_]=j;function O(Q,z){for(var V=0;V<Q.length;){var X=Math.min(65535,Q.length-V),le=V+X==Q.length;for(z.write_shift(1,+le),z.write_shift(2,X),z.write_shift(2,~X&65535);X-- >0;)z[z.l++]=Q[V++]}return z.l}function H(Q,z){for(var V=0,X=0,le=ie?new Uint16Array(32768):[];X<Q.length;){var he=Math.min(65535,Q.length-X);if(he<10){for(V=br(z,V,+(X+he==Q.length)),V&7&&(V+=8-(V&7)),z.l=V/8|0,z.write_shift(2,he),z.write_shift(2,~he&65535);he-- >0;)z[z.l++]=Q[X++];V=z.l*8;continue}V=br(z,V,+(X+he==Q.length)+2);for(var ve=0;he-- >0;){var ue=Q[X];ve=(ve<<5^ue)&32767;var pe=-1,_e=0;if((pe=le[ve])&&(pe|=X&-32768,pe>X&&(pe-=32768),pe<X))for(;Q[pe+_e]==Q[X+_e]&&_e<250;)++_e;if(_e>2){ue=A[_e],ue<=22?V=Ss(z,V,ce[ue+1]>>1)-1:(Ss(z,V,3),V+=5,Ss(z,V,ce[ue-23]>>5),V+=3);var Je=ue<8?0:ue-4>>2;Je>0&&(td(z,V,_e-q[ue]),V+=Je),ue=k[X-pe],V=Ss(z,V,ce[ue]>>3),V-=3;var qe=ue<4?0:ue-2>>1;qe>0&&(td(z,V,X-pe-W[ue]),V+=qe);for(var kt=0;kt<_e;++kt)le[ve]=X&32767,ve=(ve<<5^Q[X])&32767,++X;he-=_e-1}else ue<=143?ue=ue+48:V=Yn(z,V,1),V=Ss(z,V,ce[ue]),le[ve]=X&32767,++X}V=Ss(z,V,0)-1}return z.l=(V+7)/8|0,z.l}return function(z,V){return z.length<8?O(z,V):H(z,V)}}();function rd(N){var k=J(50+Math.floor(N.length*1.1)),j=e1(N,k);return k.slice(0,j)}var nd=ie?new Uint16Array(32768):Ir(32768),sd=ie?new Uint16Array(32768):Ir(32768),ad=ie?new Uint16Array(128):Ir(128),id=1,ld=1;function t1(N,k){var j=Me(N,k)+257;k+=5;var _=Me(N,k)+1;k+=5;var A=$e(N,k)+4;k+=4;for(var O=0,H=ie?new Uint8Array(19):Ir(19),Q=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],z=1,V=ie?new Uint8Array(8):Ir(8),X=ie?new Uint8Array(8):Ir(8),le=H.length,he=0;he<A;++he)H[B[he]]=O=je(N,k),z<O&&(z=O),V[O]++,k+=3;var ve=0;for(V[0]=0,he=1;he<=z;++he)X[he]=ve=ve+V[he-1]<<1;for(he=0;he<le;++he)(ve=H[he])!=0&&(Q[he]=X[ve]++);var ue=0;for(he=0;he<le;++he)if(ue=H[he],ue!=0){ve=ce[Q[he]]>>8-ue;for(var pe=(1<<7-ue)-1;pe>=0;--pe)ad[ve|pe<<ue]=ue&7|he<<3}var _e=[];for(z=1;_e.length<j+_;)switch(ve=ad[ge(N,k)],k+=ve&7,ve>>>=3){case 16:for(O=3+Se(N,k),k+=2,ve=_e[_e.length-1];O-- >0;)_e.push(ve);break;case 17:for(O=3+je(N,k),k+=3;O-- >0;)_e.push(0);break;case 18:for(O=11+ge(N,k),k+=7;O-- >0;)_e.push(0);break;default:_e.push(ve),z<ve&&(z=ve);break}var Je=_e.slice(0,j),qe=_e.slice(j);for(he=j;he<286;++he)Je[he]=0;for(he=_;he<30;++he)qe[he]=0;return id=zi(Je,nd,286),ld=zi(qe,sd,30),k}function r1(N,k){if(N[0]==3&&!(N[1]&3))return[hs(k),2];for(var j=0,_=0,A=zf(k||1<<18),O=0,H=A.length>>>0,Q=0,z=0;!(_&1);){if(_=je(N,j),j+=3,_>>>1)_>>1==1?(Q=9,z=5):(j=t1(N,j),Q=id,z=ld);else{j&7&&(j+=8-(j&7));var V=N[j>>>3]|N[(j>>>3)+1]<<8;if(j+=32,V>0)for(!k&&H<O+V&&(A=Wo(A,O+V),H=A.length);V-- >0;)A[O++]=N[j>>>3],j+=8;continue}for(;;){!k&&H<O+32767&&(A=Wo(A,O+32767),H=A.length);var X=We(N,j,Q),le=_>>>1==1?Ho[X]:nd[X];if(j+=le&15,le>>>=4,!(le>>>8&255))A[O++]=le;else{if(le==256)break;le-=257;var he=le<8?0:le-4>>2;he>5&&(he=0);var ve=O+q[le];he>0&&(ve+=We(N,j,he),j+=he),X=We(N,j,z),le=_>>>1==1?Vo[X]:sd[X],j+=le&15,le>>>=4;var ue=le<4?0:le-2>>1,pe=W[le];for(ue>0&&(pe+=We(N,j,ue),j+=ue),!k&&H<ve&&(A=Wo(A,ve+100),H=A.length);O<ve;)A[O]=A[O-pe],++O}}}return k?[A,j+7>>>3]:[A.slice(0,O),j+7>>>3]}function od(N,k){var j=N.slice(N.l||0),_=r1(j,k);return N.l+=_[1],_[0]}function cd(N,k){if(N)typeof console<"u"&&console.error(k);else throw new Error(k)}function ud(N,k){var j=N;er(j,0);var _=[],A=[],O={FileIndex:_,FullPaths:A};E(O,{root:k.root});for(var H=j.length-4;(j[H]!=80||j[H+1]!=75||j[H+2]!=5||j[H+3]!=6)&&H>=0;)--H;j.l=H+4,j.l+=4;var Q=j.read_shift(2);j.l+=6;var z=j.read_shift(4);for(j.l=z,H=0;H<Q;++H){j.l+=20;var V=j.read_shift(4),X=j.read_shift(4),le=j.read_shift(2),he=j.read_shift(2),ve=j.read_shift(2);j.l+=8;var ue=j.read_shift(4),pe=o(j.slice(j.l+le,j.l+le+he));j.l+=le+he+ve;var _e=j.l;j.l=ue+4,n1(j,V,X,O,pe),j.l=_e}return O}function n1(N,k,j,_,A){N.l+=2;var O=N.read_shift(2),H=N.read_shift(2),Q=l(N);if(O&8257)throw new Error("Unsupported ZIP encryption");for(var z=N.read_shift(4),V=N.read_shift(4),X=N.read_shift(4),le=N.read_shift(2),he=N.read_shift(2),ve="",ue=0;ue<le;++ue)ve+=String.fromCharCode(N[N.l++]);if(he){var pe=o(N.slice(N.l,N.l+he));(pe[21589]||{}).mt&&(Q=pe[21589].mt),((A||{})[21589]||{}).mt&&(Q=A[21589].mt)}N.l+=he;var _e=N.slice(N.l,N.l+V);switch(H){case 8:_e=M(N,X);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+H)}var Je=!1;O&8&&(z=N.read_shift(4),z==134695760&&(z=N.read_shift(4),Je=!0),V=N.read_shift(4),X=N.read_shift(4)),V!=k&&cd(Je,"Bad compressed size: "+k+" != "+V),X!=j&&cd(Je,"Bad uncompressed size: "+j+" != "+X),Go(_,ve,_e,{unsafe:!0,mt:Q})}function s1(N,k){var j=k||{},_=[],A=[],O=J(1),H=j.compression?8:0,Q=0,z=0,V=0,X=0,le=0,he=N.FullPaths[0],ve=he,ue=N.FileIndex[0],pe=[],_e=0;for(z=1;z<N.FullPaths.length;++z)if(ve=N.FullPaths[z].slice(he.length),ue=N.FileIndex[z],!(!ue.size||!ue.content||ve=="Sh33tJ5")){var Je=X,qe=J(ve.length);for(V=0;V<ve.length;++V)qe.write_shift(1,ve.charCodeAt(V)&127);qe=qe.slice(0,qe.l),pe[le]=xN.buf(ue.content,0);var kt=ue.content;H==8&&(kt=D(kt)),O=J(30),O.write_shift(4,67324752),O.write_shift(2,20),O.write_shift(2,Q),O.write_shift(2,H),ue.mt?i(O,ue.mt):O.write_shift(4,0),O.write_shift(-4,pe[le]),O.write_shift(4,kt.length),O.write_shift(4,ue.content.length),O.write_shift(2,qe.length),O.write_shift(2,0),X+=O.length,_.push(O),X+=qe.length,_.push(qe),X+=kt.length,_.push(kt),O=J(46),O.write_shift(4,33639248),O.write_shift(2,0),O.write_shift(2,20),O.write_shift(2,Q),O.write_shift(2,H),O.write_shift(4,0),O.write_shift(-4,pe[le]),O.write_shift(4,kt.length),O.write_shift(4,ue.content.length),O.write_shift(2,qe.length),O.write_shift(2,0),O.write_shift(2,0),O.write_shift(2,0),O.write_shift(2,0),O.write_shift(4,0),O.write_shift(4,Je),_e+=O.l,A.push(O),_e+=qe.length,A.push(qe),++le}return O=J(22),O.write_shift(4,101010256),O.write_shift(2,0),O.write_shift(2,0),O.write_shift(2,le),O.write_shift(2,le),O.write_shift(4,_e),O.write_shift(4,X),O.write_shift(2,0),jt([jt(_),jt(A),O])}var $i={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function a1(N,k){if(N.ctype)return N.ctype;var j=N.name||"",_=j.match(/\.([^\.]+)$/);return _&&$i[_[1]]||k&&(_=(j=k).match(/[\.\\]([^\.\\])+$/),_&&$i[_[1]])?$i[_[1]]:"application/octet-stream"}function i1(N){for(var k=ji(N),j=[],_=0;_<k.length;_+=76)j.push(k.slice(_,_+76));return j.join(`\r
`)+`\r
`}function l1(N){var k=N.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(V){var X=V.charCodeAt(0).toString(16).toUpperCase();return"="+(X.length==1?"0"+X:X)});k=k.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),k.charAt(0)==`
`&&(k="=0D"+k.slice(1)),k=k.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var j=[],_=k.split(`\r
`),A=0;A<_.length;++A){var O=_[A];if(O.length==0){j.push("");continue}for(var H=0;H<O.length;){var Q=76,z=O.slice(H,H+Q);z.charAt(Q-1)=="="?Q--:z.charAt(Q-2)=="="?Q-=2:z.charAt(Q-3)=="="&&(Q-=3),z=O.slice(H,H+Q),H+=Q,H<O.length&&(z+="="),j.push(z)}}return j.join(`\r
`)}function o1(N){for(var k=[],j=0;j<N.length;++j){for(var _=N[j];j<=N.length&&_.charAt(_.length-1)=="=";)_=_.slice(0,_.length-1)+N[++j];k.push(_)}for(var A=0;A<k.length;++A)k[A]=k[A].replace(/[=][0-9A-Fa-f]{2}/g,function(O){return String.fromCharCode(parseInt(O.slice(1),16))});return Cr(k.join(`\r
`))}function c1(N,k,j){for(var _="",A="",O="",H,Q=0;Q<10;++Q){var z=k[Q];if(!z||z.match(/^\s*$/))break;var V=z.match(/^(.*?):\s*([^\s].*)$/);if(V)switch(V[1].toLowerCase()){case"content-location":_=V[2].trim();break;case"content-type":O=V[2].trim();break;case"content-transfer-encoding":A=V[2].trim();break}}switch(++Q,A.toLowerCase()){case"base64":H=Cr(un(k.slice(Q).join("")));break;case"quoted-printable":H=o1(k.slice(Q));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+A)}var X=Go(N,_.slice(j.length),H,{unsafe:!0});O&&(X.ctype=O)}function u1(N,k){if(F(N.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var j=k&&k.root||"",_=(Oe&&Buffer.isBuffer(N)?N.toString("binary"):F(N)).split(`\r
`),A=0,O="";for(A=0;A<_.length;++A)if(O=_[A],!!/^Content-Location:/i.test(O)&&(O=O.slice(O.indexOf("file")),j||(j=O.slice(0,O.lastIndexOf("/")+1)),O.slice(0,j.length)!=j))for(;j.length>0&&(j=j.slice(0,j.length-1),j=j.slice(0,j.lastIndexOf("/")+1),O.slice(0,j.length)!=j););var H=(_[1]||"").match(/boundary="(.*?)"/);if(!H)throw new Error("MAD cannot find boundary");var Q="--"+(H[1]||""),z=[],V=[],X={FileIndex:z,FullPaths:V};E(X);var le,he=0;for(A=0;A<_.length;++A){var ve=_[A];ve!==Q&&ve!==Q+"--"||(he++&&c1(X,_.slice(le,A),j),le=A)}return X}function d1(N,k){var j=k||{},_=j.boundary||"SheetJS";_="------="+_;for(var A=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+_.slice(2)+'"',"","",""],O=N.FullPaths[0],H=O,Q=N.FileIndex[0],z=1;z<N.FullPaths.length;++z)if(H=N.FullPaths[z].slice(O.length),Q=N.FileIndex[z],!(!Q.size||!Q.content||H=="Sh33tJ5")){H=H.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(_e){return"_x"+_e.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(_e){return"_u"+_e.charCodeAt(0).toString(16)+"_"});for(var V=Q.content,X=Oe&&Buffer.isBuffer(V)?V.toString("binary"):F(V),le=0,he=Math.min(1024,X.length),ve=0,ue=0;ue<=he;++ue)(ve=X.charCodeAt(ue))>=32&&ve<128&&++le;var pe=le>=he*4/5;A.push(_),A.push("Content-Location: "+(j.root||"file:///C:/SheetJS/")+H),A.push("Content-Transfer-Encoding: "+(pe?"quoted-printable":"base64")),A.push("Content-Type: "+a1(Q,H)),A.push(""),A.push(pe?l1(X):i1(X))}return A.push(_+`--\r
`),A.join(`\r
`)}function f1(N){var k={};return E(k,N),k}function Go(N,k,j,_){var A=_&&_.unsafe;A||E(N);var O=!A&&Be.find(N,k);if(!O){var H=N.FullPaths[0];k.slice(0,H.length)==H?H=k:(H.slice(-1)!="/"&&(H+="/"),H=(H+k).replace("//","/")),O={name:s(k),type:2},N.FileIndex.push(O),N.FullPaths.push(H),A||Be.utils.cfb_gc(N)}return O.content=j,O.size=j?j.length:0,_&&(_.CLSID&&(O.clsid=_.CLSID),_.mt&&(O.mt=_.mt),_.ct&&(O.ct=_.ct)),O}function h1(N,k){E(N);var j=Be.find(N,k);if(j){for(var _=0;_<N.FileIndex.length;++_)if(N.FileIndex[_]==j)return N.FileIndex.splice(_,1),N.FullPaths.splice(_,1),!0}return!1}function x1(N,k,j){E(N);var _=Be.find(N,k);if(_){for(var A=0;A<N.FileIndex.length;++A)if(N.FileIndex[A]==_)return N.FileIndex[A].name=s(j),N.FullPaths[A]=j,!0}return!1}function m1(N){S(N,!0)}return t.find=U,t.read=L,t.parse=u,t.write=K,t.writeFile=Y,t.utils={cfb_new:f1,cfb_add:Go,cfb_del:h1,cfb_mov:x1,cfb_gc:m1,ReadShift:Za,CheckField:Qp,prep_blob:er,bconcat:jt,use_zlib:T,_deflateRaw:rd,_inflateRaw:od,consts:ee},t}();function mN(e){return typeof e=="string"?Io(e):Array.isArray(e)?zb(e):e}function Di(e,t,r){if(typeof Deno<"u"){if(r&&typeof t=="string")switch(r){case"utf8":t=new TextEncoder(r).encode(t);break;case"binary":t=Io(t);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(e,t)}var n=r=="utf8"?_i(t):t;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,e);if(typeof Blob<"u"){var s=new Blob([mN(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(s,e);if(typeof saveAs<"u")return saveAs(s,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var i=URL.createObjectURL(s);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),chrome.downloads.download({url:i,filename:e,saveAs:!0});var l=document.createElement("a");if(l.download!=null)return l.download=e,l.href=i,document.body.appendChild(l),l.click(),document.body.removeChild(l),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),i}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var o=File(e);return o.open("w"),o.encoding="binary",Array.isArray(t)&&(t=Ii(t)),o.write(t),o.close(),t}catch(c){if(!c.message||!c.message.match(/onstruct/))throw c}throw new Error("cannot save file "+e)}function Ct(e){for(var t=Object.keys(e),r=[],n=0;n<t.length;++n)Object.prototype.hasOwnProperty.call(e,t[n])&&r.push(t[n]);return r}function Yf(e,t){for(var r=[],n=Ct(e),s=0;s!==n.length;++s)r[e[n[s]][t]]==null&&(r[e[n[s]][t]]=n[s]);return r}function D0(e){for(var t=[],r=Ct(e),n=0;n!==r.length;++n)t[e[r[n]]]=r[n];return t}function Mo(e){for(var t=[],r=Ct(e),n=0;n!==r.length;++n)t[e[r[n]]]=parseInt(r[n],10);return t}function pN(e){for(var t=[],r=Ct(e),n=0;n!==r.length;++n)t[e[r[n]]]==null&&(t[e[r[n]]]=[]),t[e[r[n]]].push(r[n]);return t}var so=new Date(1899,11,30,0,0,0);function Jt(e,t){var r=e.getTime(),n=so.getTime()+(e.getTimezoneOffset()-so.getTimezoneOffset())*6e4;return(r-n)/(24*60*60*1e3)}var Ip=new Date,gN=so.getTime()+(Ip.getTimezoneOffset()-so.getTimezoneOffset())*6e4,Jf=Ip.getTimezoneOffset();function Dp(e){var t=new Date;return t.setTime(e*24*60*60*1e3+gN),t.getTimezoneOffset()!==Jf&&t.setTime(t.getTime()+(t.getTimezoneOffset()-Jf)*6e4),t}var qf=new Date("2017-02-19T19:06:09.000Z"),Lp=isNaN(qf.getFullYear())?new Date("2/19/17"):qf,vN=Lp.getFullYear()==2017;function Ut(e,t){var r=new Date(e);if(vN)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(Lp.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return e.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var s=e.match(/\d+/g)||["2017","2","19","0","0","0"],i=new Date(+s[0],+s[1]-1,+s[2],+s[3]||0,+s[4]||0,+s[5]||0);return e.indexOf("Z")>-1&&(i=new Date(i.getTime()-i.getTimezoneOffset()*60*1e3)),i}function Bo(e,t){if(Oe&&Buffer.isBuffer(e))return e.toString("binary");if(typeof TextDecoder<"u")try{var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(i){return r[i]||i})}catch{}for(var n=[],s=0;s!=e.length;++s)n.push(String.fromCharCode(e[s]));return n.join("")}function qt(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=qt(e[r]));return t}function rt(e,t){for(var r="";r.length<t;)r+=e;return r}function nn(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(n))||(n=n.replace(/[(](.*)[)]/,function(s,i){return r=-r,i}),!isNaN(t=Number(n)))?t/r:t}var yN=["january","february","march","april","may","june","july","august","september","october","november","december"];function Si(e){var t=new Date(e),r=new Date(NaN),n=t.getYear(),s=t.getMonth(),i=t.getDate();if(isNaN(i))return r;var l=e.toLowerCase();if(l.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(l=l.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),l.length>3&&yN.indexOf(l)==-1)return r}else if(l.match(/[a-z]/))return r;return n<0||n>8099?r:(s>0||i>1)&&n!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}function Te(e,t,r){if(e.FullPaths){if(typeof r=="string"){var n;return Oe?n=xn(r):n=$b(r),Be.utils.cfb_add(e,t,n)}Be.utils.cfb_add(e,t,r)}else e.file(t,r)}function L0(){return Be.utils.cfb_new()}var ct=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,wN={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},M0=D0(wN),B0=/[&<>'"]/g,bN=/[\u0000-\u0008\u000b-\u001f]/g;function Ie(e){var t=e+"";return t.replace(B0,function(r){return M0[r]}).replace(bN,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function Qf(e){return Ie(e).replace(/ /g,"_x0020_")}var Mp=/[\u0000-\u001f]/g;function NN(e){var t=e+"";return t.replace(B0,function(r){return M0[r]}).replace(/\n/g,"<br/>").replace(Mp,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function jN(e){var t=e+"";return t.replace(B0,function(r){return M0[r]}).replace(Mp,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}function SN(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function _N(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function Sc(e){for(var t="",r=0,n=0,s=0,i=0,l=0,o=0;r<e.length;){if(n=e.charCodeAt(r++),n<128){t+=String.fromCharCode(n);continue}if(s=e.charCodeAt(r++),n>191&&n<224){l=(n&31)<<6,l|=s&63,t+=String.fromCharCode(l);continue}if(i=e.charCodeAt(r++),n<240){t+=String.fromCharCode((n&15)<<12|(s&63)<<6|i&63);continue}l=e.charCodeAt(r++),o=((n&7)<<18|(s&63)<<12|(i&63)<<6|l&63)-65536,t+=String.fromCharCode(55296+(o>>>10&1023)),t+=String.fromCharCode(56320+(o&1023))}return t}function Zf(e){var t=hs(2*e.length),r,n,s=1,i=0,l=0,o;for(n=0;n<e.length;n+=s)s=1,(o=e.charCodeAt(n))<128?r=o:o<224?(r=(o&31)*64+(e.charCodeAt(n+1)&63),s=2):o<240?(r=(o&15)*4096+(e.charCodeAt(n+1)&63)*64+(e.charCodeAt(n+2)&63),s=3):(s=4,r=(o&7)*262144+(e.charCodeAt(n+1)&63)*4096+(e.charCodeAt(n+2)&63)*64+(e.charCodeAt(n+3)&63),r-=65536,l=55296+(r>>>10&1023),r=56320+(r&1023)),l!==0&&(t[i++]=l&255,t[i++]=l>>>8,l=0),t[i++]=r%256,t[i++]=r>>>8;return t.slice(0,i).toString("ucs2")}function eh(e){return xn(e,"binary").toString("utf8")}var ul="foo bar baz",Qa=Oe&&(eh(ul)==Sc(ul)&&eh||Zf(ul)==Sc(ul)&&Zf)||Sc,_i=Oe?function(e){return xn(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,n=0,s=0;r<e.length;)switch(n=e.charCodeAt(r++),!0){case n<128:t.push(String.fromCharCode(n));break;case n<2048:t.push(String.fromCharCode(192+(n>>6))),t.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,s=e.charCodeAt(r++)-56320+(n<<10),t.push(String.fromCharCode(240+(s>>18&7))),t.push(String.fromCharCode(144+(s>>12&63))),t.push(String.fromCharCode(128+(s>>6&63))),t.push(String.fromCharCode(128+(s&63)));break;default:t.push(String.fromCharCode(224+(n>>12))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)))}return t.join("")},EN=function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),s=0;s<e.length;++s)n=n.replace(e[s][0],e[s][1]);return n}}(),Bp=/(^\s|\s$|\n)/;function St(e,t){return"<"+e+(t.match(Bp)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function Ei(e){return Ct(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function de(e,t,r){return"<"+e+(r!=null?Ei(r):"")+(t!=null?(t.match(Bp)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function Ou(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(r){if(t)throw r}return""}function TN(e,t){switch(typeof e){case"string":var r=de("vt:lpwstr",Ie(e));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return de((e|0)==e?"vt:i4":"vt:r8",Ie(String(e)));case"boolean":return de("vt:bool",e?"true":"false")}if(e instanceof Date)return de("vt:filetime",Ou(e));throw new Error("Unable to serialize "+e)}var mt={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},ga=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],tr={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function CN(e,t){for(var r=1-2*(e[t+7]>>>7),n=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),s=e[t+6]&15,i=5;i>=0;--i)s=s*256+e[t+i];return n==2047?s==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,s+=Math.pow(2,52)),r*Math.pow(2,n-52)*s)}function kN(e,t,r){var n=(t<0||1/t==-1/0?1:0)<<7,s=0,i=0,l=n?-t:t;isFinite(l)?l==0?s=i=0:(s=Math.floor(Math.log(l)/Math.LN2),i=l*Math.pow(2,52-s),s<=-1023&&(!isFinite(i)||i<Math.pow(2,52))?s=-1022:(i-=Math.pow(2,52),s+=1023)):(s=2047,i=isNaN(t)?26985:0);for(var o=0;o<=5;++o,i/=256)e[r+o]=i&255;e[r+6]=(s&15)<<4|i&15,e[r+7]=s>>4|n}var th=function(e){for(var t=[],r=10240,n=0;n<e[0].length;++n)if(e[0][n])for(var s=0,i=e[0][n].length;s<i;s+=r)t.push.apply(t,e[0][n].slice(s,s+r));return t},rh=Oe?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:xn(t)})):th(e)}:th,nh=function(e,t,r){for(var n=[],s=t;s<r;s+=2)n.push(String.fromCharCode(Ua(e,s)));return n.join("").replace(qa,"")},U0=Oe?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(qa,""):nh(e,t,r)}:nh,sh=function(e,t,r){for(var n=[],s=t;s<t+r;++s)n.push(("0"+e[s].toString(16)).slice(-2));return n.join("")},Up=Oe?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):sh(e,t,r)}:sh,ah=function(e,t,r){for(var n=[],s=t;s<r;s++)n.push(String.fromCharCode(ks(e,s)));return n.join("")},Li=Oe?function(t,r,n){return Buffer.isBuffer(t)?t.toString("utf8",r,n):ah(t,r,n)}:ah,zp=function(e,t){var r=rr(e,t);return r>0?Li(e,t+4,t+4+r-1):""},$p=zp,Wp=function(e,t){var r=rr(e,t);return r>0?Li(e,t+4,t+4+r-1):""},Hp=Wp,Vp=function(e,t){var r=2*rr(e,t);return r>0?Li(e,t+4,t+4+r-1):""},Gp=Vp,Xp=function(t,r){var n=rr(t,r);return n>0?U0(t,r+4,r+4+n):""},Kp=Xp,Yp=function(e,t){var r=rr(e,t);return r>0?Li(e,t+4,t+4+r):""},Jp=Yp,qp=function(e,t){return CN(e,t)},ao=qp,z0=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};Oe&&($p=function(t,r){if(!Buffer.isBuffer(t))return zp(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},Hp=function(t,r){if(!Buffer.isBuffer(t))return Wp(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},Gp=function(t,r){if(!Buffer.isBuffer(t))return Vp(t,r);var n=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n-1)},Kp=function(t,r){if(!Buffer.isBuffer(t))return Xp(t,r);var n=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n)},Jp=function(t,r){if(!Buffer.isBuffer(t))return Yp(t,r);var n=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+n)},ao=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):qp(t,r)},z0=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var ks=function(e,t){return e[t]},Ua=function(e,t){return e[t+1]*256+e[t]},AN=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},rr=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},ts=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},FN=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function Za(e,t){var r="",n,s,i=[],l,o,c,d;switch(t){case"dbcs":if(d=this.l,Oe&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(c=0;c<e;++c)r+=String.fromCharCode(Ua(this,d)),d+=2;e*=2;break;case"utf8":r=Li(this,this.l,this.l+e);break;case"utf16le":e*=2,r=U0(this,this.l,this.l+e);break;case"wstr":return Za.call(this,e,"dbcs");case"lpstr-ansi":r=$p(this,this.l),e=4+rr(this,this.l);break;case"lpstr-cp":r=Hp(this,this.l),e=4+rr(this,this.l);break;case"lpwstr":r=Gp(this,this.l),e=4+2*rr(this,this.l);break;case"lpp4":e=4+rr(this,this.l),r=Kp(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+rr(this,this.l),r=Jp(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(l=ks(this,this.l+e++))!==0;)i.push(ll(l));r=i.join("");break;case"_wstr":for(e=0,r="";(l=Ua(this,this.l+e))!==0;)i.push(ll(l)),e+=2;e+=2,r=i.join("");break;case"dbcs-cont":for(r="",d=this.l,c=0;c<e;++c){if(this.lens&&this.lens.indexOf(d)!==-1)return l=ks(this,d),this.l=d+1,o=Za.call(this,e-c,l?"dbcs-cont":"sbcs-cont"),i.join("")+o;i.push(ll(Ua(this,d))),d+=2}r=i.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",d=this.l,c=0;c!=e;++c){if(this.lens&&this.lens.indexOf(d)!==-1)return l=ks(this,d),this.l=d+1,o=Za.call(this,e-c,l?"dbcs-cont":"sbcs-cont"),i.join("")+o;i.push(ll(ks(this,d))),d+=1}r=i.join("");break;default:switch(e){case 1:return n=ks(this,this.l),this.l++,n;case 2:return n=(t==="i"?AN:Ua)(this,this.l),this.l+=2,n;case 4:case-4:return t==="i"||!(this[this.l+3]&128)?(n=(e>0?ts:FN)(this,this.l),this.l+=4,n):(s=rr(this,this.l),this.l+=4,s);case 8:case-8:if(t==="f")return e==8?s=ao(this,this.l):s=ao([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,s;e=8;case 16:r=Up(this,this.l,e);break}}return this.l+=e,r}var ON=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},PN=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},RN=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function IN(e,t,r){var n=0,s=0;if(r==="dbcs"){for(s=0;s!=t.length;++s)RN(this,t.charCodeAt(s),this.l+2*s);n=2*t.length}else if(r==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),s=0;s!=t.length;++s)this[this.l+s]=t.charCodeAt(s)&255;n=t.length}else if(r==="hex"){for(;s<e;++s)this[this.l++]=parseInt(t.slice(2*s,2*s+2),16)||0;return this}else if(r==="utf16le"){var i=Math.min(this.l+e,this.length);for(s=0;s<Math.min(t.length,e);++s){var l=t.charCodeAt(s);this[this.l++]=l&255,this[this.l++]=l>>8}for(;this.l<i;)this[this.l++]=0;return this}else switch(e){case 1:n=1,this[this.l]=t&255;break;case 2:n=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:n=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:n=4,ON(this,t,this.l);break;case 8:if(n=8,r==="f"){kN(this,t,this.l);break}case 16:break;case-4:n=4,PN(this,t,this.l);break}return this.l+=n,this}function Qp(e,t){var r=Up(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function er(e,t){e.l=t,e.read_shift=Za,e.chk=Qp,e.write_shift=IN}function Hr(e,t){e.l+=t}function J(e){var t=hs(e);return er(t,0),t}function Kt(){var e=[],t=Oe?256:2048,r=function(d){var u=J(d);return er(u,0),u},n=r(t),s=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&e.push(n),n=null)},i=function(d){return n&&d<n.length-n.l?n:(s(),n=r(Math.max(d+1,t)))},l=function(){return s(),jt(e)},o=function(d){s(),n=d,n.l==null&&(n.l=n.length),i(t)};return{next:i,push:o,end:l,_bufs:e}}function re(e,t,r,n){var s=+t,i;if(!isNaN(s)){n||(n=CE[s].p||(r||[]).length||0),i=1+(s>=128?1:0)+1,n>=128&&++i,n>=16384&&++i,n>=2097152&&++i;var l=e.next(i);s<=127?l.write_shift(1,s):(l.write_shift(1,(s&127)+128),l.write_shift(1,s>>7));for(var o=0;o!=4;++o)if(n>=128)l.write_shift(1,(n&127)+128),n>>=7;else{l.write_shift(1,n);break}n>0&&z0(r)&&e.push(r)}}function ei(e,t,r){var n=qt(e);if(t.s?(n.cRel&&(n.c+=t.s.c),n.rRel&&(n.r+=t.s.r)):(n.cRel&&(n.c+=t.c),n.rRel&&(n.r+=t.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function ih(e,t,r){var n=qt(e);return n.s=ei(n.s,t.s,r),n.e=ei(n.e,t.s,r),n}function ti(e,t){if(e.cRel&&e.c<0)for(e=qt(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=qt(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=Le(e);return!e.cRel&&e.cRel!=null&&(r=MN(r)),!e.rRel&&e.rRel!=null&&(r=DN(r)),r}function _c(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+Pt(e.s.c)+":"+(e.e.cRel?"":"$")+Pt(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+Et(e.s.r)+":"+(e.e.rRel?"":"$")+Et(e.e.r):ti(e.s,t.biff)+":"+ti(e.e,t.biff)}function $0(e){return parseInt(LN(e),10)-1}function Et(e){return""+(e+1)}function DN(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function LN(e){return e.replace(/\$(\d+)$/,"$1")}function W0(e){for(var t=BN(e),r=0,n=0;n!==t.length;++n)r=26*r+t.charCodeAt(n)-64;return r-1}function Pt(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function MN(e){return e.replace(/^([A-Z])/,"$$$1")}function BN(e){return e.replace(/^\$([A-Z])/,"$1")}function UN(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function pt(e){for(var t=0,r=0,n=0;n<e.length;++n){var s=e.charCodeAt(n);s>=48&&s<=57?t=10*t+(s-48):s>=65&&s<=90&&(r=26*r+(s-64))}return{c:r-1,r:t-1}}function Le(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function lr(e){var t=e.indexOf(":");return t==-1?{s:pt(e),e:pt(e)}:{s:pt(e.slice(0,t)),e:pt(e.slice(t+1))}}function ot(e,t){return typeof t>"u"||typeof t=="number"?ot(e.s,e.e):(typeof e!="string"&&(e=Le(e)),typeof t!="string"&&(t=Le(t)),e==t?e:e+":"+t)}function Xe(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,s=0,i=e.length;for(r=0;n<i&&!((s=e.charCodeAt(n)-64)<1||s>26);++n)r=26*r+s;for(t.s.c=--r,r=0;n<i&&!((s=e.charCodeAt(n)-48)<0||s>9);++n)r=10*r+s;if(t.s.r=--r,n===i||s!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++n,r=0;n!=i&&!((s=e.charCodeAt(n)-64)<1||s>26);++n)r=26*r+s;for(t.e.c=--r,r=0;n!=i&&!((s=e.charCodeAt(n)-48)<0||s>9);++n)r=10*r+s;return t.e.r=--r,t}function lh(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=Un(e.z,r?Jt(t):t)}catch{}try{return e.w=Un((e.XF||{}).numFmtId||(r?14:0),r?Jt(t):t)}catch{return""+t}}function dn(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?Mi[e.v]||e.v:t==null?lh(e,e.v):lh(e,t))}function ys(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",n={};return n[r]=e,{SheetNames:[r],Sheets:n}}function Zp(e,t,r){var n=r||{},s=e?Array.isArray(e):n.dense,i=e||(s?[]:{}),l=0,o=0;if(i&&n.origin!=null){if(typeof n.origin=="number")l=n.origin;else{var c=typeof n.origin=="string"?pt(n.origin):n.origin;l=c.r,o=c.c}i["!ref"]||(i["!ref"]="A1:A1")}var d={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(i["!ref"]){var u=Xe(i["!ref"]);d.s.c=u.s.c,d.s.r=u.s.r,d.e.c=Math.max(d.e.c,u.e.c),d.e.r=Math.max(d.e.r,u.e.r),l==-1&&(d.e.r=l=u.e.r+1)}for(var f=0;f!=t.length;++f)if(t[f]){if(!Array.isArray(t[f]))throw new Error("aoa_to_sheet expects an array of arrays");for(var h=0;h!=t[f].length;++h)if(!(typeof t[f][h]>"u")){var m={v:t[f][h]},p=l+f,x=o+h;if(d.s.r>p&&(d.s.r=p),d.s.c>x&&(d.s.c=x),d.e.r<p&&(d.e.r=p),d.e.c<x&&(d.e.c=x),t[f][h]&&typeof t[f][h]=="object"&&!Array.isArray(t[f][h])&&!(t[f][h]instanceof Date))m=t[f][h];else if(Array.isArray(m.v)&&(m.f=t[f][h][1],m.v=m.v[0]),m.v===null)if(m.f)m.t="n";else if(n.nullError)m.t="e",m.v=0;else if(n.sheetStubs)m.t="z";else continue;else typeof m.v=="number"?m.t="n":typeof m.v=="boolean"?m.t="b":m.v instanceof Date?(m.z=n.dateNF||nt[14],n.cellDates?(m.t="d",m.w=Un(m.z,Jt(m.v))):(m.t="n",m.v=Jt(m.v),m.w=Un(m.z,m.v))):m.t="s";if(s)i[p]||(i[p]=[]),i[p][x]&&i[p][x].z&&(m.z=i[p][x].z),i[p][x]=m;else{var v=Le({c:x,r:p});i[v]&&i[v].z&&(m.z=i[v].z),i[v]=m}}}return d.s.c<1e7&&(i["!ref"]=ot(d)),i}function va(e,t){return Zp(null,e,t)}function zN(e){return e.read_shift(4,"i")}function Pr(e,t){return t||(t=J(4)),t.write_shift(4,e),t}function Rt(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function gt(e,t){var r=!1;return t==null&&(r=!0,t=J(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}function $N(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function WN(e,t){return t||(t=J(4)),t.write_shift(2,0),t.write_shift(2,0),t}function H0(e,t){var r=e.l,n=e.read_shift(1),s=Rt(e),i=[],l={t:s,h:s};if(n&1){for(var o=e.read_shift(4),c=0;c!=o;++c)i.push($N(e));l.r=i}else l.r=[{ich:0,ifnt:0}];return e.l=r+t,l}function HN(e,t){var r=!1;return t==null&&(r=!0,t=J(15+4*e.t.length)),t.write_shift(1,0),gt(e.t,t),r?t.slice(0,t.l):t}var VN=H0;function GN(e,t){var r=!1;return t==null&&(r=!0,t=J(23+4*e.t.length)),t.write_shift(1,1),gt(e.t,t),t.write_shift(4,1),WN({},t),r?t.slice(0,t.l):t}function wr(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function ws(e,t){return t==null&&(t=J(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function bs(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function Ns(e,t){return t==null&&(t=J(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}var XN=Rt,eg=gt;function V0(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}function io(e,t){var r=!1;return t==null&&(r=!0,t=J(127)),t.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}var KN=Rt,Pu=V0,G0=io;function tg(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,n=t[0]&2;e.l+=4;var s=n===0?ao([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):ts(t,0)>>2;return r?s/100:s}function rg(e,t){t==null&&(t=J(4));var r=0,n=0,s=e*100;if(e==(e|0)&&e>=-536870912&&e<1<<29?n=1:s==(s|0)&&s>=-536870912&&s<1<<29&&(n=1,r=1),n)t.write_shift(-4,((r?s:e)<<2)+(r+2));else throw new Error("unsupported RkNumber "+e)}function ng(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}function YN(e,t){return t||(t=J(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t}var js=ng,ya=YN;function wa(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function xs(e,t){return(t||J(8)).write_shift(8,e,"f")}function JN(e){var t={},r=e.read_shift(1),n=r>>>1,s=e.read_shift(1),i=e.read_shift(2,"i"),l=e.read_shift(1),o=e.read_shift(1),c=e.read_shift(1);switch(e.l++,n){case 0:t.auto=1;break;case 1:t.index=s;var d=a4[s];d&&(t.rgb=vh(d));break;case 2:t.rgb=vh([l,o,c]);break;case 3:t.theme=s;break}return i!=0&&(t.tint=i>0?i/32767:i/32768),t}function lo(e,t){if(t||(t=J(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;e.index!=null?(t.write_shift(1,2),t.write_shift(1,e.index)):e.theme!=null?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var r=e.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),t.write_shift(2,r),!e.rgb||e.theme!=null)t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);else{var n=e.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),t.write_shift(1,parseInt(n.slice(0,2),16)),t.write_shift(1,parseInt(n.slice(2,4),16)),t.write_shift(1,parseInt(n.slice(4,6),16)),t.write_shift(1,255)}return t}function qN(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function QN(e,t){t||(t=J(2));var r=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return t.write_shift(1,r),t.write_shift(1,0),t}var sg=2,Qt=3,dl=11,oo=19,fl=64,ZN=65,e4=71,t4=4108,r4=4126,Nt=80,oh={1:{n:"CodePage",t:sg},2:{n:"Category",t:Nt},3:{n:"PresentationFormat",t:Nt},4:{n:"ByteCount",t:Qt},5:{n:"LineCount",t:Qt},6:{n:"ParagraphCount",t:Qt},7:{n:"SlideCount",t:Qt},8:{n:"NoteCount",t:Qt},9:{n:"HiddenCount",t:Qt},10:{n:"MultimediaClipCount",t:Qt},11:{n:"ScaleCrop",t:dl},12:{n:"HeadingPairs",t:t4},13:{n:"TitlesOfParts",t:r4},14:{n:"Manager",t:Nt},15:{n:"Company",t:Nt},16:{n:"LinksUpToDate",t:dl},17:{n:"CharacterCount",t:Qt},19:{n:"SharedDoc",t:dl},22:{n:"HyperlinksChanged",t:dl},23:{n:"AppVersion",t:Qt,p:"version"},24:{n:"DigSig",t:ZN},26:{n:"ContentType",t:Nt},27:{n:"ContentStatus",t:Nt},28:{n:"Language",t:Nt},29:{n:"Version",t:Nt},255:{},2147483648:{n:"Locale",t:oo},2147483651:{n:"Behavior",t:oo},1919054434:{}},ch={1:{n:"CodePage",t:sg},2:{n:"Title",t:Nt},3:{n:"Subject",t:Nt},4:{n:"Author",t:Nt},5:{n:"Keywords",t:Nt},6:{n:"Comments",t:Nt},7:{n:"Template",t:Nt},8:{n:"LastAuthor",t:Nt},9:{n:"RevNumber",t:Nt},10:{n:"EditTime",t:fl},11:{n:"LastPrinted",t:fl},12:{n:"CreatedDate",t:fl},13:{n:"ModifiedDate",t:fl},14:{n:"PageCount",t:Qt},15:{n:"WordCount",t:Qt},16:{n:"CharCount",t:Qt},17:{n:"Thumbnail",t:e4},18:{n:"Application",t:Nt},19:{n:"DocSecurity",t:Qt},255:{},2147483648:{n:"Locale",t:oo},2147483651:{n:"Behavior",t:oo},1919054434:{}};function n4(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var s4=n4([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),a4=qt(s4),Mi={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},i4={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},hl={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function ag(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function ig(e,t){var r=pN(i4),n=[],s;n[n.length]=ct,n[n.length]=de("Types",null,{xmlns:mt.CT,"xmlns:xsd":mt.xsd,"xmlns:xsi":mt.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(c){return de("Default",null,{Extension:c[0],ContentType:c[1]})}));var i=function(c){e[c]&&e[c].length>0&&(s=e[c][0],n[n.length]=de("Override",null,{PartName:(s[0]=="/"?"":"/")+s,ContentType:hl[c][t.bookType]||hl[c].xlsx}))},l=function(c){(e[c]||[]).forEach(function(d){n[n.length]=de("Override",null,{PartName:(d[0]=="/"?"":"/")+d,ContentType:hl[c][t.bookType]||hl[c].xlsx})})},o=function(c){(e[c]||[]).forEach(function(d){n[n.length]=de("Override",null,{PartName:(d[0]=="/"?"":"/")+d,ContentType:r[c][0]})})};return i("workbooks"),l("sheets"),l("charts"),o("themes"),["strs","styles"].forEach(i),["coreprops","extprops","custprops"].forEach(o),o("vba"),o("comments"),o("threadedcomments"),o("drawings"),l("metadata"),o("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var Fe={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function lg(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function Qs(e){var t=[ct,de("Relationships",null,{xmlns:mt.RELS})];return Ct(e["!id"]).forEach(function(r){t[t.length]=de("Relationship",null,e["!id"][r])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function Re(e,t,r,n,s,i){if(s||(s={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,s.Id="rId"+t,s.Type=n,s.Target=r,[Fe.HLINK,Fe.XPATH,Fe.XMISS].indexOf(s.Type)>-1&&(s.TargetMode="External"),e["!id"][s.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][s.Id]=s,e[("/"+s.Target).replace("//","/")]=s,t}function l4(e){var t=[ct];t.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),t.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<e.length;++r)t.push('  <manifest:file-entry manifest:full-path="'+e[r][0]+'" manifest:media-type="'+e[r][1]+`"/>
`);return t.push("</manifest:manifest>"),t.join("")}function uh(e,t,r){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+t+`"/>
`,`  </rdf:Description>
`].join("")}function o4(e,t){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+`"/>
`,`  </rdf:Description>
`].join("")}function c4(e){var t=[ct];t.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=e.length;++r)t.push(uh(e[r][0],e[r][1])),t.push(o4("",e[r][0]));return t.push(uh("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}function og(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+Zl.version+"</meta:generator></office:meta></office:document-meta>"}var ls=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]];function Ec(e,t,r,n,s){s[e]!=null||t==null||t===""||(s[e]=t,t=Ie(t),n[n.length]=r?de(e,t,r):St(e,t))}function cg(e,t){var r=t||{},n=[ct,de("cp:coreProperties",null,{"xmlns:cp":mt.CORE_PROPS,"xmlns:dc":mt.dc,"xmlns:dcterms":mt.dcterms,"xmlns:dcmitype":mt.dcmitype,"xmlns:xsi":mt.xsi})],s={};if(!e&&!r.Props)return n.join("");e&&(e.CreatedDate!=null&&Ec("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:Ou(e.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,s),e.ModifiedDate!=null&&Ec("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:Ou(e.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,s));for(var i=0;i!=ls.length;++i){var l=ls[i],o=r.Props&&r.Props[l[1]]!=null?r.Props[l[1]]:e?e[l[1]]:null;o===!0?o="1":o===!1?o="0":typeof o=="number"&&(o=String(o)),o!=null&&Ec(l[0],o,null,n,s)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var Zs=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],ug=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function dg(e){var t=[],r=de;return e||(e={}),e.Application="SheetJS",t[t.length]=ct,t[t.length]=de("Properties",null,{xmlns:mt.EXT_PROPS,"xmlns:vt":mt.vt}),Zs.forEach(function(n){if(e[n[1]]!==void 0){var s;switch(n[2]){case"string":s=Ie(String(e[n[1]]));break;case"bool":s=e[n[1]]?"true":"false";break}s!==void 0&&(t[t.length]=r(n[0],s))}}),t[t.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=r("TitlesOfParts",r("vt:vector",e.SheetNames.map(function(n){return"<vt:lpstr>"+Ie(n)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}function fg(e){var t=[ct,de("Properties",null,{xmlns:mt.CUST_PROPS,"xmlns:vt":mt.vt})];if(!e)return t.join("");var r=1;return Ct(e).forEach(function(s){++r,t[t.length]=de("property",TN(e[s]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:Ie(s)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var dh={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"};function u4(e,t){var r=[];return Ct(dh).map(function(n){for(var s=0;s<ls.length;++s)if(ls[s][1]==n)return ls[s];for(s=0;s<Zs.length;++s)if(Zs[s][1]==n)return Zs[s];throw n}).forEach(function(n){if(e[n[1]]!=null){var s=t&&t.Props&&t.Props[n[1]]!=null?t.Props[n[1]]:e[n[1]];switch(n[2]){case"date":s=new Date(s).toISOString().replace(/\.\d*Z/,"Z");break}typeof s=="number"?s=String(s):s===!0||s===!1?s=s?"1":"0":s instanceof Date&&(s=new Date(s).toISOString().replace(/\.\d*Z/,"")),r.push(St(dh[n[1]]||n[1],s))}}),de("DocumentProperties",r.join(""),{xmlns:tr.o})}function d4(e,t){var r=["Worksheets","SheetNames"],n="CustomDocumentProperties",s=[];return e&&Ct(e).forEach(function(i){if(Object.prototype.hasOwnProperty.call(e,i)){for(var l=0;l<ls.length;++l)if(i==ls[l][1])return;for(l=0;l<Zs.length;++l)if(i==Zs[l][1])return;for(l=0;l<r.length;++l)if(i==r[l])return;var o=e[i],c="string";typeof o=="number"?(c="float",o=String(o)):o===!0||o===!1?(c="boolean",o=o?"1":"0"):o=String(o),s.push(de(Qf(i),o,{"dt:dt":c}))}}),t&&Ct(t).forEach(function(i){if(Object.prototype.hasOwnProperty.call(t,i)&&!(e&&Object.prototype.hasOwnProperty.call(e,i))){var l=t[i],o="string";typeof l=="number"?(o="float",l=String(l)):l===!0||l===!1?(o="boolean",l=l?"1":"0"):l instanceof Date?(o="dateTime.tz",l=l.toISOString()):l=String(l),s.push(de(Qf(i),l,{"dt:dt":o}))}}),"<"+n+' xmlns="'+tr.o+'">'+s.join("")+"</"+n+">"}function f4(e){var t=typeof e=="string"?new Date(Date.parse(e)):e,r=t.getTime()/1e3+11644473600,n=r%Math.pow(2,32),s=(r-n)/Math.pow(2,32);n*=1e7,s*=1e7;var i=n/Math.pow(2,32)|0;i>0&&(n=n%Math.pow(2,32),s+=i);var l=J(8);return l.write_shift(4,n),l.write_shift(4,s),l}function fh(e,t){var r=J(4),n=J(4);switch(r.write_shift(4,e==80?31:e),e){case 3:n.write_shift(-4,t);break;case 5:n=J(8),n.write_shift(8,t,"f");break;case 11:n.write_shift(4,t?1:0);break;case 64:n=f4(t);break;case 31:case 80:for(n=J(4+2*(t.length+1)+(t.length%2?0:2)),n.write_shift(4,t.length+1),n.write_shift(0,t,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return jt([r,n])}var hg=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function h4(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function hh(e,t,r){var n=J(8),s=[],i=[],l=8,o=0,c=J(8),d=J(8);if(c.write_shift(4,2),c.write_shift(4,1200),d.write_shift(4,1),i.push(c),s.push(d),l+=8+c.length,!t){d=J(8),d.write_shift(4,0),s.unshift(d);var u=[J(4)];for(u[0].write_shift(4,e.length),o=0;o<e.length;++o){var f=e[o][0];for(c=J(8+2*(f.length+1)+(f.length%2?0:2)),c.write_shift(4,o+2),c.write_shift(4,f.length+1),c.write_shift(0,f,"dbcs");c.l!=c.length;)c.write_shift(1,0);u.push(c)}c=jt(u),i.unshift(c),l+=8+c.length}for(o=0;o<e.length;++o)if(!(t&&!t[e[o][0]])&&!(hg.indexOf(e[o][0])>-1||ug.indexOf(e[o][0])>-1)&&e[o][1]!=null){var h=e[o][1],m=0;if(t){m=+t[e[o][0]];var p=r[m];if(p.p=="version"&&typeof h=="string"){var x=h.split(".");h=(+x[0]<<16)+(+x[1]||0)}c=fh(p.t,h)}else{var v=h4(h);v==-1&&(v=31,h=String(h)),c=fh(v,h)}i.push(c),d=J(8),d.write_shift(4,t?m:2+o),s.push(d),l+=8+c.length}var y=8*(i.length+1);for(o=0;o<i.length;++o)s[o].write_shift(4,y),y+=i[o].length;return n.write_shift(4,l),n.write_shift(4,i.length),jt([n].concat(s).concat(i))}function xh(e,t,r,n,s,i){var l=J(s?68:48),o=[l];l.write_shift(2,65534),l.write_shift(2,0),l.write_shift(4,842412599),l.write_shift(16,Be.utils.consts.HEADER_CLSID,"hex"),l.write_shift(4,s?2:1),l.write_shift(16,t,"hex"),l.write_shift(4,s?68:48);var c=hh(e,r,n);if(o.push(c),s){var d=hh(s,null,null);l.write_shift(16,i,"hex"),l.write_shift(4,68+c.length),o.push(d)}return jt(o)}function x4(e,t){t||(t=J(e));for(var r=0;r<e;++r)t.write_shift(1,0);return t}function m4(e,t){return e.read_shift(t)===1}function Mt(e,t){return t||(t=J(2)),t.write_shift(2,+!!e),t}function xg(e){return e.read_shift(2,"u")}function dr(e,t){return t||(t=J(2)),t.write_shift(2,e),t}function mg(e,t,r){return r||(r=J(2)),r.write_shift(1,t=="e"?+e:+!!e),r.write_shift(1,t=="e"?1:0),r}function pg(e,t,r){var n=e.read_shift(r&&r.biff>=12?2:1),s="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var i=e.read_shift(1);i&&(s="dbcs-cont")}else r.biff==12&&(s="wstr");r.biff>=2&&r.biff<=5&&(s="cpstr");var l=n?e.read_shift(n,s):"";return l}function p4(e){var t=e.t||"",r=J(3);r.write_shift(2,t.length),r.write_shift(1,1);var n=J(2*t.length);n.write_shift(2*t.length,t,"utf16le");var s=[r,n];return jt(s)}function g4(e,t,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var s=e.read_shift(1);return s===0?n=e.read_shift(t,"sbcs-cont"):n=e.read_shift(t,"dbcs-cont"),n}function v4(e,t,r){var n=e.read_shift(r&&r.biff==2?1:2);return n===0?(e.l++,""):g4(e,n,r)}function y4(e,t,r){if(r.biff>5)return v4(e,t,r);var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function gg(e,t,r){return r||(r=J(3+2*e.length)),r.write_shift(2,e.length),r.write_shift(1,1),r.write_shift(31,e,"utf16le"),r}function mh(e,t){t||(t=J(6+e.length*2)),t.write_shift(4,1+e.length);for(var r=0;r<e.length;++r)t.write_shift(2,e.charCodeAt(r));return t.write_shift(2,0),t}function w4(e){var t=J(512),r=0,n=e.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var s=n.indexOf("#"),i=s>-1?31:23;switch(n.charAt(0)){case"#":i=28;break;case".":i&=-3;break}t.write_shift(4,2),t.write_shift(4,i);var l=[8,6815827,6619237,4849780,83];for(r=0;r<l.length;++r)t.write_shift(4,l[r]);if(i==28)n=n.slice(1),mh(n,t);else if(i&2){for(l="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<l.length;++r)t.write_shift(1,parseInt(l[r],16));var o=s>-1?n.slice(0,s):n;for(t.write_shift(4,2*(o.length+1)),r=0;r<o.length;++r)t.write_shift(2,o.charCodeAt(r));t.write_shift(2,0),i&8&&mh(s>-1?n.slice(s+1):"",t)}else{for(l="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<l.length;++r)t.write_shift(1,parseInt(l[r],16));for(var c=0;n.slice(c*3,c*3+3)=="../"||n.slice(c*3,c*3+3)=="..\\";)++c;for(t.write_shift(2,c),t.write_shift(4,n.length-3*c+1),r=0;r<n.length-3*c;++r)t.write_shift(1,n.charCodeAt(r+3*c)&255);for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),r=0;r<6;++r)t.write_shift(4,0)}return t.slice(0,t.l)}function ms(e,t,r,n){return n||(n=J(6)),n.write_shift(2,e),n.write_shift(2,t),n.write_shift(2,r||0),n}function b4(e,t,r){var n=r.biff>8?4:2,s=e.read_shift(n),i=e.read_shift(n,"i"),l=e.read_shift(n,"i");return[s,i,l]}function N4(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),s=e.read_shift(2);return{s:{c:n,r:t},e:{c:s,r}}}function vg(e,t){return t||(t=J(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function X0(e,t,r){var n=1536,s=16;switch(r.bookType){case"biff8":break;case"biff5":n=1280,s=8;break;case"biff4":n=4,s=6;break;case"biff3":n=3,s=6;break;case"biff2":n=2,s=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var i=J(s);return i.write_shift(2,n),i.write_shift(2,t),s>4&&i.write_shift(2,29282),s>6&&i.write_shift(2,1997),s>8&&(i.write_shift(2,49161),i.write_shift(2,1),i.write_shift(2,1798),i.write_shift(2,0)),i}function j4(e,t){var r=!t||t.biff==8,n=J(r?112:54);for(n.write_shift(t.biff==8?2:1,7),r&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(r?0:536870912));n.l<n.length;)n.write_shift(1,r?0:32);return n}function S4(e,t){var r=!t||t.biff>=8?2:1,n=J(8+r*e.name.length);n.write_shift(4,e.pos),n.write_shift(1,e.hs||0),n.write_shift(1,e.dt),n.write_shift(1,e.name.length),t.biff>=8&&n.write_shift(1,1),n.write_shift(r*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var s=n.slice(0,n.l);return s.l=n.l,s}function _4(e,t){var r=J(8);r.write_shift(4,e.Count),r.write_shift(4,e.Unique);for(var n=[],s=0;s<e.length;++s)n[s]=p4(e[s]);var i=jt([r].concat(n));return i.parts=[r.length].concat(n.map(function(l){return l.length})),i}function E4(){var e=J(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function T4(e){var t=J(18),r=1718;return e&&e.RTL&&(r|=64),t.write_shift(2,r),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}function C4(e,t){var r=e.name||"Arial",n=t&&t.biff==5,s=n?15+r.length:16+2*r.length,i=J(s);return i.write_shift(2,e.sz*20),i.write_shift(4,0),i.write_shift(2,400),i.write_shift(4,0),i.write_shift(2,0),i.write_shift(1,r.length),n||i.write_shift(1,1),i.write_shift((n?1:2)*r.length,r,n?"sbcs":"utf16le"),i}function k4(e,t,r,n){var s=J(10);return ms(e,t,n,s),s.write_shift(4,r),s}function A4(e,t,r,n,s){var i=!s||s.biff==8,l=J(8+ +i+(1+i)*r.length);return ms(e,t,n,l),l.write_shift(2,r.length),i&&l.write_shift(1,1),l.write_shift((1+i)*r.length,r,i?"utf16le":"sbcs"),l}function F4(e,t,r,n){var s=r&&r.biff==5;n||(n=J(s?3+t.length:5+2*t.length)),n.write_shift(2,e),n.write_shift(s?1:2,t.length),s||n.write_shift(1,1),n.write_shift((s?1:2)*t.length,t,s?"sbcs":"utf16le");var i=n.length>n.l?n.slice(0,n.l):n;return i.l==null&&(i.l=i.length),i}function O4(e,t){var r=t.biff==8||!t.biff?4:2,n=J(2*r+6);return n.write_shift(r,e.s.r),n.write_shift(r,e.e.r+1),n.write_shift(2,e.s.c),n.write_shift(2,e.e.c+1),n.write_shift(2,0),n}function ph(e,t,r,n){var s=r&&r.biff==5;n||(n=J(s?16:20)),n.write_shift(2,0),e.style?(n.write_shift(2,e.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,e.numFmtId||0),n.write_shift(2,t<<4));var i=0;return e.numFmtId>0&&s&&(i|=1024),n.write_shift(4,i),n.write_shift(4,0),s||n.write_shift(4,0),n.write_shift(2,0),n}function P4(e){var t=J(8);return t.write_shift(4,0),t.write_shift(2,0),t.write_shift(2,0),t}function R4(e,t,r,n,s,i){var l=J(8);return ms(e,t,n,l),mg(r,i,l),l}function I4(e,t,r,n){var s=J(14);return ms(e,t,n,s),xs(r,s),s}function D4(e,t,r){if(r.biff<8)return L4(e,t,r);for(var n=[],s=e.l+t,i=e.read_shift(r.biff>8?4:2);i--!==0;)n.push(b4(e,r.biff>8?12:6,r));if(e.l!=s)throw new Error("Bad ExternSheet: "+e.l+" != "+s);return n}function L4(e,t,r){e[e.l+1]==3&&e[e.l]++;var n=pg(e,t,r);return n.charCodeAt(0)==3?n.slice(1):n}function M4(e){var t=J(2+e.length*8);t.write_shift(2,e.length);for(var r=0;r<e.length;++r)vg(e[r],t);return t}function B4(e){var t=J(24),r=pt(e[0]);t.write_shift(2,r.r),t.write_shift(2,r.r),t.write_shift(2,r.c),t.write_shift(2,r.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),s=0;s<16;++s)t.write_shift(1,parseInt(n[s],16));return jt([t,w4(e[1])])}function U4(e){var t=e[1].Tooltip,r=J(10+2*(t.length+1));r.write_shift(2,2048);var n=pt(e[0]);r.write_shift(2,n.r),r.write_shift(2,n.r),r.write_shift(2,n.c),r.write_shift(2,n.c);for(var s=0;s<t.length;++s)r.write_shift(2,t.charCodeAt(s));return r.write_shift(2,0),r}function z4(e){return e||(e=J(4)),e.write_shift(2,1),e.write_shift(2,1),e}function $4(e,t,r){if(!r.cellStyles)return Hr(e,t);var n=r&&r.biff>=12?4:2,s=e.read_shift(n),i=e.read_shift(n),l=e.read_shift(n),o=e.read_shift(n),c=e.read_shift(2);n==2&&(e.l+=2);var d={s,e:i,w:l,ixfe:o,flags:c};return(r.biff>=5||!r.biff)&&(d.level=c>>8&7),d}function W4(e,t){var r=J(12);r.write_shift(2,t),r.write_shift(2,t),r.write_shift(2,e.width*256),r.write_shift(2,0);var n=0;return e.hidden&&(n|=1),r.write_shift(1,n),n=e.level||0,r.write_shift(1,n),r.write_shift(2,0),r}function H4(e){for(var t=J(2*e),r=0;r<e;++r)t.write_shift(2,r+1);return t}function V4(e,t,r){var n=J(15);return Ui(n,e,t),n.write_shift(8,r,"f"),n}function G4(e,t,r){var n=J(9);return Ui(n,e,t),n.write_shift(2,r),n}var X4=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=D0({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(o,c){var d=[],u=hs(1);switch(c.type){case"base64":u=Cr(un(o));break;case"binary":u=Cr(o);break;case"buffer":case"array":u=o;break}er(u,0);var f=u.read_shift(1),h=!!(f&136),m=!1,p=!1;switch(f){case 2:break;case 3:break;case 48:m=!0,h=!0;break;case 49:m=!0,h=!0;break;case 131:break;case 139:break;case 140:p=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+f.toString(16))}var x=0,v=521;f==2&&(x=u.read_shift(2)),u.l+=3,f!=2&&(x=u.read_shift(4)),x>1048576&&(x=1e6),f!=2&&(v=u.read_shift(2));var y=u.read_shift(2),g=c.codepage||1252;f!=2&&(u.l+=16,u.read_shift(1),u[u.l]!==0&&(g=e[u[u.l]]),u.l+=1,u.l+=2),p&&(u.l+=36);for(var w=[],b={},P=Math.min(u.length,f==2?521:v-10-(m?264:0)),L=p?32:11;u.l<P&&u[u.l]!=13;)switch(b={},b.name=eo.utils.decode(g,u.slice(u.l,u.l+L)).replace(/[\u0000\r\n].*$/g,""),u.l+=L,b.type=String.fromCharCode(u.read_shift(1)),f!=2&&!p&&(b.offset=u.read_shift(4)),b.len=u.read_shift(1),f==2&&(b.offset=u.read_shift(2)),b.dec=u.read_shift(1),b.name.length&&w.push(b),f!=2&&(u.l+=p?13:14),b.type){case"B":(!m||b.len!=8)&&c.WTF&&console.log("Skipping "+b.name+":"+b.type);break;case"G":case"P":c.WTF&&console.log("Skipping "+b.name+":"+b.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+b.type)}if(u[u.l]!==13&&(u.l=v-1),u.read_shift(1)!==13)throw new Error("DBF Terminator not found "+u.l+" "+u[u.l]);u.l=v;var E=0,I=0;for(d[0]=[],I=0;I!=w.length;++I)d[0][I]=w[I].name;for(;x-- >0;){if(u[u.l]===42){u.l+=y;continue}for(++u.l,d[++E]=[],I=0,I=0;I!=w.length;++I){var S=u.slice(u.l,u.l+w[I].len);u.l+=w[I].len,er(S,0);var R=eo.utils.decode(g,S);switch(w[I].type){case"C":R.trim().length&&(d[E][I]=R.replace(/\s+$/,""));break;case"D":R.length===8?d[E][I]=new Date(+R.slice(0,4),+R.slice(4,6)-1,+R.slice(6,8)):d[E][I]=R;break;case"F":d[E][I]=parseFloat(R.trim());break;case"+":case"I":d[E][I]=p?S.read_shift(-4,"i")^2147483648:S.read_shift(4,"i");break;case"L":switch(R.trim().toUpperCase()){case"Y":case"T":d[E][I]=!0;break;case"N":case"F":d[E][I]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+R+"|")}break;case"M":if(!h)throw new Error("DBF Unexpected MEMO for type "+f.toString(16));d[E][I]="##MEMO##"+(p?parseInt(R.trim(),10):S.read_shift(4));break;case"N":R=R.replace(/\u0000/g,"").trim(),R&&R!="."&&(d[E][I]=+R||0);break;case"@":d[E][I]=new Date(S.read_shift(-8,"f")-621356832e5);break;case"T":d[E][I]=new Date((S.read_shift(4)-2440588)*864e5+S.read_shift(4));break;case"Y":d[E][I]=S.read_shift(4,"i")/1e4+S.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":d[E][I]=-S.read_shift(-8,"f");break;case"B":if(m&&w[I].len==8){d[E][I]=S.read_shift(8,"f");break}case"G":case"P":S.l+=w[I].len;break;case"0":if(w[I].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+w[I].type)}}}if(f!=2&&u.l<u.length&&u[u.l++]!=26)throw new Error("DBF EOF Marker missing "+(u.l-1)+" of "+u.length+" "+u[u.l-1].toString(16));return c&&c.sheetRows&&(d=d.slice(0,c.sheetRows)),c.DBF=w,d}function n(o,c){var d=c||{};d.dateNF||(d.dateNF="yyyymmdd");var u=va(r(o,d),d);return u["!cols"]=d.DBF.map(function(f){return{wch:f.len,DBF:f}}),delete d.DBF,u}function s(o,c){try{return ys(n(o,c),c)}catch(d){if(c&&c.WTF)throw d}return{SheetNames:[],Sheets:{}}}var i={B:8,C:250,L:1,D:8,"?":0,"":0};function l(o,c){var d=c||{};if(+d.codepage>=0&&Ni(+d.codepage),d.type=="string")throw new Error("Cannot write DBF to JS string");var u=Kt(),f=xo(o,{header:1,raw:!0,cellDates:!0}),h=f[0],m=f.slice(1),p=o["!cols"]||[],x=0,v=0,y=0,g=1;for(x=0;x<h.length;++x){if(((p[x]||{}).DBF||{}).name){h[x]=p[x].DBF.name,++y;continue}if(h[x]!=null){if(++y,typeof h[x]=="number"&&(h[x]=h[x].toString(10)),typeof h[x]!="string")throw new Error("DBF Invalid column name "+h[x]+" |"+typeof h[x]+"|");if(h.indexOf(h[x])!==x){for(v=0;v<1024;++v)if(h.indexOf(h[x]+"_"+v)==-1){h[x]+="_"+v;break}}}}var w=Xe(o["!ref"]),b=[],P=[],L=[];for(x=0;x<=w.e.c-w.s.c;++x){var E="",I="",S=0,R=[];for(v=0;v<m.length;++v)m[v][x]!=null&&R.push(m[v][x]);if(R.length==0||h[x]==null){b[x]="?";continue}for(v=0;v<R.length;++v){switch(typeof R[v]){case"number":I="B";break;case"string":I="C";break;case"boolean":I="L";break;case"object":I=R[v]instanceof Date?"D":"C";break;default:I="C"}S=Math.max(S,String(R[v]).length),E=E&&E!=I?"C":I}S>250&&(S=250),I=((p[x]||{}).DBF||{}).type,I=="C"&&p[x].DBF.len>S&&(S=p[x].DBF.len),E=="B"&&I=="N"&&(E="N",L[x]=p[x].DBF.dec,S=p[x].DBF.len),P[x]=E=="C"||I=="N"?S:i[E]||0,g+=P[x],b[x]=E}var U=u.next(32);for(U.write_shift(4,318902576),U.write_shift(4,m.length),U.write_shift(2,296+32*y),U.write_shift(2,g),x=0;x<4;++x)U.write_shift(4,0);for(U.write_shift(4,0|(+t[wp]||3)<<8),x=0,v=0;x<h.length;++x)if(h[x]!=null){var G=u.next(32),se=(h[x].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);G.write_shift(1,se,"sbcs"),G.write_shift(1,b[x]=="?"?"C":b[x],"sbcs"),G.write_shift(4,v),G.write_shift(1,P[x]||i[b[x]]||0),G.write_shift(1,L[x]||0),G.write_shift(1,2),G.write_shift(4,0),G.write_shift(1,0),G.write_shift(4,0),G.write_shift(4,0),v+=P[x]||i[b[x]]||0}var Ne=u.next(264);for(Ne.write_shift(4,13),x=0;x<65;++x)Ne.write_shift(4,0);for(x=0;x<m.length;++x){var ae=u.next(g);for(ae.write_shift(1,0),v=0;v<h.length;++v)if(h[v]!=null)switch(b[v]){case"L":ae.write_shift(1,m[x][v]==null?63:m[x][v]?84:70);break;case"B":ae.write_shift(8,m[x][v]||0,"f");break;case"N":var xe="0";for(typeof m[x][v]=="number"&&(xe=m[x][v].toFixed(L[v]||0)),y=0;y<P[v]-xe.length;++y)ae.write_shift(1,32);ae.write_shift(1,xe,"sbcs");break;case"D":m[x][v]?(ae.write_shift(4,("0000"+m[x][v].getFullYear()).slice(-4),"sbcs"),ae.write_shift(2,("00"+(m[x][v].getMonth()+1)).slice(-2),"sbcs"),ae.write_shift(2,("00"+m[x][v].getDate()).slice(-2),"sbcs")):ae.write_shift(8,"00000000","sbcs");break;case"C":var ee=String(m[x][v]!=null?m[x][v]:"").slice(0,P[v]);for(ae.write_shift(1,ee,"sbcs"),y=0;y<P[v]-ee.length;++y)ae.write_shift(1,32);break}}return u.next(1).write_shift(1,26),u.end()}return{to_workbook:s,to_sheet:n,from_sheet:l}}(),K4=function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+Ct(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(h,m){var p=e[m];return typeof p=="number"?Uf(p):p},n=function(h,m,p){var x=m.charCodeAt(0)-32<<4|p.charCodeAt(0)-48;return x==59?h:Uf(x)};e["|"]=254;function s(h,m){switch(m.type){case"base64":return i(un(h),m);case"binary":return i(h,m);case"buffer":return i(Oe&&Buffer.isBuffer(h)?h.toString("binary"):Ii(h),m);case"array":return i(Bo(h),m)}throw new Error("Unrecognized type "+m.type)}function i(h,m){var p=h.split(/[\n\r]+/),x=-1,v=-1,y=0,g=0,w=[],b=[],P=null,L={},E=[],I=[],S=[],R=0,U;for(+m.codepage>=0&&Ni(+m.codepage);y!==p.length;++y){R=0;var G=p[y].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(t,r),se=G.replace(/;;/g,"\0").split(";").map(function(B){return B.replace(/\u0000/g,";")}),Ne=se[0],ae;if(G.length>0)switch(Ne){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":se[1].charAt(0)=="P"&&b.push(G.slice(3).replace(/;;/g,";"));break;case"C":var xe=!1,ee=!1,Y=!1,F=!1,K=-1,te=-1;for(g=1;g<se.length;++g)switch(se[g].charAt(0)){case"A":break;case"X":v=parseInt(se[g].slice(1))-1,ee=!0;break;case"Y":for(x=parseInt(se[g].slice(1))-1,ee||(v=0),U=w.length;U<=x;++U)w[U]=[];break;case"K":ae=se[g].slice(1),ae.charAt(0)==='"'?ae=ae.slice(1,ae.length-1):ae==="TRUE"?ae=!0:ae==="FALSE"?ae=!1:isNaN(nn(ae))?isNaN(Si(ae).getDate())||(ae=Ut(ae)):(ae=nn(ae),P!==null&&Op(P)&&(ae=Dp(ae))),xe=!0;break;case"E":F=!0;var T=Gj(se[g].slice(1),{r:x,c:v});w[x][v]=[w[x][v],T];break;case"S":Y=!0,w[x][v]=[w[x][v],"S5S"];break;case"G":break;case"R":K=parseInt(se[g].slice(1))-1;break;case"C":te=parseInt(se[g].slice(1))-1;break;default:if(m&&m.WTF)throw new Error("SYLK bad record "+G)}if(xe&&(w[x][v]&&w[x][v].length==2?w[x][v][0]=ae:w[x][v]=ae,P=null),Y){if(F)throw new Error("SYLK shared formula cannot have own formula");var M=K>-1&&w[K][te];if(!M||!M[1])throw new Error("SYLK shared formula cannot find base");w[x][v][1]=Xj(M[1],{r:x-K,c:v-te})}break;case"F":var D=0;for(g=1;g<se.length;++g)switch(se[g].charAt(0)){case"X":v=parseInt(se[g].slice(1))-1,++D;break;case"Y":for(x=parseInt(se[g].slice(1))-1,U=w.length;U<=x;++U)w[U]=[];break;case"M":R=parseInt(se[g].slice(1))/20;break;case"F":break;case"G":break;case"P":P=b[parseInt(se[g].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(S=se[g].slice(1).split(" "),U=parseInt(S[0],10);U<=parseInt(S[1],10);++U)R=parseInt(S[2],10),I[U-1]=R===0?{hidden:!0}:{wch:R},K0(I[U-1]);break;case"C":v=parseInt(se[g].slice(1))-1,I[v]||(I[v]={});break;case"R":x=parseInt(se[g].slice(1))-1,E[x]||(E[x]={}),R>0?(E[x].hpt=R,E[x].hpx=jg(R)):R===0&&(E[x].hidden=!0);break;default:if(m&&m.WTF)throw new Error("SYLK bad record "+G)}D<1&&(P=null);break;default:if(m&&m.WTF)throw new Error("SYLK bad record "+G)}}return E.length>0&&(L["!rows"]=E),I.length>0&&(L["!cols"]=I),m&&m.sheetRows&&(w=w.slice(0,m.sheetRows)),[w,L]}function l(h,m){var p=s(h,m),x=p[0],v=p[1],y=va(x,m);return Ct(v).forEach(function(g){y[g]=v[g]}),y}function o(h,m){return ys(l(h,m),m)}function c(h,m,p,x){var v="C;Y"+(p+1)+";X"+(x+1)+";K";switch(h.t){case"n":v+=h.v||0,h.f&&!h.F&&(v+=";E"+J0(h.f,{r:p,c:x}));break;case"b":v+=h.v?"TRUE":"FALSE";break;case"e":v+=h.w||h.v;break;case"d":v+='"'+(h.w||h.v)+'"';break;case"s":v+='"'+h.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return v}function d(h,m){m.forEach(function(p,x){var v="F;W"+(x+1)+" "+(x+1)+" ";p.hidden?v+="0":(typeof p.width=="number"&&!p.wpx&&(p.wpx=co(p.width)),typeof p.wpx=="number"&&!p.wch&&(p.wch=uo(p.wpx)),typeof p.wch=="number"&&(v+=Math.round(p.wch))),v.charAt(v.length-1)!=" "&&h.push(v)})}function u(h,m){m.forEach(function(p,x){var v="F;";p.hidden?v+="M0;":p.hpt?v+="M"+20*p.hpt+";":p.hpx&&(v+="M"+20*fo(p.hpx)+";"),v.length>2&&h.push(v+"R"+(x+1))})}function f(h,m){var p=["ID;PWXL;N;E"],x=[],v=Xe(h["!ref"]),y,g=Array.isArray(h),w=`\r
`;p.push("P;PGeneral"),p.push("F;P0;DG0G8;M255"),h["!cols"]&&d(p,h["!cols"]),h["!rows"]&&u(p,h["!rows"]),p.push("B;Y"+(v.e.r-v.s.r+1)+";X"+(v.e.c-v.s.c+1)+";D"+[v.s.c,v.s.r,v.e.c,v.e.r].join(" "));for(var b=v.s.r;b<=v.e.r;++b)for(var P=v.s.c;P<=v.e.c;++P){var L=Le({r:b,c:P});y=g?(h[b]||[])[P]:h[L],!(!y||y.v==null&&(!y.f||y.F))&&x.push(c(y,h,b,P))}return p.join(w)+w+x.join(w)+w+"E"+w}return{to_workbook:o,to_sheet:l,from_sheet:f}}(),Y4=function(){function e(i,l){switch(l.type){case"base64":return t(un(i),l);case"binary":return t(i,l);case"buffer":return t(Oe&&Buffer.isBuffer(i)?i.toString("binary"):Ii(i),l);case"array":return t(Bo(i),l)}throw new Error("Unrecognized type "+l.type)}function t(i,l){for(var o=i.split(`
`),c=-1,d=-1,u=0,f=[];u!==o.length;++u){if(o[u].trim()==="BOT"){f[++c]=[],d=0;continue}if(!(c<0)){var h=o[u].trim().split(","),m=h[0],p=h[1];++u;for(var x=o[u]||"";(x.match(/["]/g)||[]).length&1&&u<o.length-1;)x+=`
`+o[++u];switch(x=x.trim(),+m){case-1:if(x==="BOT"){f[++c]=[],d=0;continue}else if(x!=="EOD")throw new Error("Unrecognized DIF special command "+x);break;case 0:x==="TRUE"?f[c][d]=!0:x==="FALSE"?f[c][d]=!1:isNaN(nn(p))?isNaN(Si(p).getDate())?f[c][d]=p:f[c][d]=Ut(p):f[c][d]=nn(p),++d;break;case 1:x=x.slice(1,x.length-1),x=x.replace(/""/g,'"'),x&&x.match(/^=".*"$/)&&(x=x.slice(2,-1)),f[c][d++]=x!==""?x:null;break}if(x==="EOD")break}}return l&&l.sheetRows&&(f=f.slice(0,l.sheetRows)),f}function r(i,l){return va(e(i,l),l)}function n(i,l){return ys(r(i,l),l)}var s=function(){var i=function(c,d,u,f,h){c.push(d),c.push(u+","+f),c.push('"'+h.replace(/"/g,'""')+'"')},l=function(c,d,u,f){c.push(d+","+u),c.push(d==1?'"'+f.replace(/"/g,'""')+'"':f)};return function(c){var d=[],u=Xe(c["!ref"]),f,h=Array.isArray(c);i(d,"TABLE",0,1,"sheetjs"),i(d,"VECTORS",0,u.e.r-u.s.r+1,""),i(d,"TUPLES",0,u.e.c-u.s.c+1,""),i(d,"DATA",0,0,"");for(var m=u.s.r;m<=u.e.r;++m){l(d,-1,0,"BOT");for(var p=u.s.c;p<=u.e.c;++p){var x=Le({r:m,c:p});if(f=h?(c[m]||[])[p]:c[x],!f){l(d,1,0,"");continue}switch(f.t){case"n":var v=f.w;!v&&f.v!=null&&(v=f.v),v==null?f.f&&!f.F?l(d,1,0,"="+f.f):l(d,1,0,""):l(d,0,v,"V");break;case"b":l(d,0,f.v?1:0,f.v?"TRUE":"FALSE");break;case"s":l(d,1,0,isNaN(f.v)?f.v:'="'+f.v+'"');break;case"d":f.w||(f.w=Un(f.z||nt[14],Jt(Ut(f.v)))),l(d,0,f.w,"V");break;default:l(d,1,0,"")}}}l(d,-1,0,"EOD");var y=`\r
`,g=d.join(y);return g}}();return{to_workbook:n,to_sheet:r,from_sheet:s}}(),yg=function(){function e(f){return f.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(f){return f.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(f,h){for(var m=f.split(`
`),p=-1,x=-1,v=0,y=[];v!==m.length;++v){var g=m[v].trim().split(":");if(g[0]==="cell"){var w=pt(g[1]);if(y.length<=w.r)for(p=y.length;p<=w.r;++p)y[p]||(y[p]=[]);switch(p=w.r,x=w.c,g[2]){case"t":y[p][x]=e(g[3]);break;case"v":y[p][x]=+g[3];break;case"vtf":var b=g[g.length-1];case"vtc":switch(g[3]){case"nl":y[p][x]=!!+g[4];break;default:y[p][x]=+g[4];break}g[2]=="vtf"&&(y[p][x]=[y[p][x],b])}}}return h&&h.sheetRows&&(y=y.slice(0,h.sheetRows)),y}function n(f,h){return va(r(f,h),h)}function s(f,h){return ys(n(f,h),h)}var i=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),l=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),c="--SocialCalcSpreadsheetControlSave--";function d(f){if(!f||!f["!ref"])return"";for(var h=[],m=[],p,x="",v=lr(f["!ref"]),y=Array.isArray(f),g=v.s.r;g<=v.e.r;++g)for(var w=v.s.c;w<=v.e.c;++w)if(x=Le({r:g,c:w}),p=y?(f[g]||[])[w]:f[x],!(!p||p.v==null||p.t==="z")){switch(m=["cell",x,"t"],p.t){case"s":case"str":m.push(t(p.v));break;case"n":p.f?(m[2]="vtf",m[3]="n",m[4]=p.v,m[5]=t(p.f)):(m[2]="v",m[3]=p.v);break;case"b":m[2]="vt"+(p.f?"f":"c"),m[3]="nl",m[4]=p.v?"1":"0",m[5]=t(p.f||(p.v?"TRUE":"FALSE"));break;case"d":var b=Jt(Ut(p.v));m[2]="vtc",m[3]="nd",m[4]=""+b,m[5]=p.w||Un(p.z||nt[14],b);break;case"e":continue}h.push(m.join(":"))}return h.push("sheet:c:"+(v.e.c-v.s.c+1)+":r:"+(v.e.r-v.s.r+1)+":tvf:1"),h.push("valueformat:1:text-wiki"),h.join(`
`)}function u(f){return[i,l,o,l,d(f),c].join(`
`)}return{to_workbook:s,to_sheet:n,from_sheet:u}}(),J4=function(){function e(u,f,h,m,p){p.raw?f[h][m]=u:u===""||(u==="TRUE"?f[h][m]=!0:u==="FALSE"?f[h][m]=!1:isNaN(nn(u))?isNaN(Si(u).getDate())?f[h][m]=u:f[h][m]=Ut(u):f[h][m]=nn(u))}function t(u,f){var h=f||{},m=[];if(!u||u.length===0)return m;for(var p=u.split(/[\r\n]/),x=p.length-1;x>=0&&p[x].length===0;)--x;for(var v=10,y=0,g=0;g<=x;++g)y=p[g].indexOf(" "),y==-1?y=p[g].length:y++,v=Math.max(v,y);for(g=0;g<=x;++g){m[g]=[];var w=0;for(e(p[g].slice(0,v).trim(),m,g,w,h),w=1;w<=(p[g].length-v)/10+1;++w)e(p[g].slice(v+(w-1)*10,v+w*10).trim(),m,g,w,h)}return h.sheetRows&&(m=m.slice(0,h.sheetRows)),m}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function s(u){for(var f={},h=!1,m=0,p=0;m<u.length;++m)(p=u.charCodeAt(m))==34?h=!h:!h&&p in r&&(f[p]=(f[p]||0)+1);p=[];for(m in f)Object.prototype.hasOwnProperty.call(f,m)&&p.push([f[m],m]);if(!p.length){f=n;for(m in f)Object.prototype.hasOwnProperty.call(f,m)&&p.push([f[m],m])}return p.sort(function(x,v){return x[0]-v[0]||n[x[1]]-n[v[1]]}),r[p.pop()[1]]||44}function i(u,f){var h=f||{},m="",p=h.dense?[]:{},x={s:{c:0,r:0},e:{c:0,r:0}};u.slice(0,4)=="sep="?u.charCodeAt(5)==13&&u.charCodeAt(6)==10?(m=u.charAt(4),u=u.slice(7)):u.charCodeAt(5)==13||u.charCodeAt(5)==10?(m=u.charAt(4),u=u.slice(6)):m=s(u.slice(0,1024)):h&&h.FS?m=h.FS:m=s(u.slice(0,1024));var v=0,y=0,g=0,w=0,b=0,P=m.charCodeAt(0),L=!1,E=0,I=u.charCodeAt(0);u=u.replace(/\r\n/mg,`
`);var S=h.dateNF!=null?fN(h.dateNF):null;function R(){var U=u.slice(w,b),G={};if(U.charAt(0)=='"'&&U.charAt(U.length-1)=='"'&&(U=U.slice(1,-1).replace(/""/g,'"')),U.length===0)G.t="z";else if(h.raw)G.t="s",G.v=U;else if(U.trim().length===0)G.t="s",G.v=U;else if(U.charCodeAt(0)==61)U.charCodeAt(1)==34&&U.charCodeAt(U.length-1)==34?(G.t="s",G.v=U.slice(2,-1).replace(/""/g,'"')):Kj(U)?(G.t="n",G.f=U.slice(1)):(G.t="s",G.v=U);else if(U=="TRUE")G.t="b",G.v=!0;else if(U=="FALSE")G.t="b",G.v=!1;else if(!isNaN(g=nn(U)))G.t="n",h.cellText!==!1&&(G.w=U),G.v=g;else if(!isNaN(Si(U).getDate())||S&&U.match(S)){G.z=h.dateNF||nt[14];var se=0;S&&U.match(S)&&(U=hN(U,h.dateNF,U.match(S)||[]),se=1),h.cellDates?(G.t="d",G.v=Ut(U,se)):(G.t="n",G.v=Jt(Ut(U,se))),h.cellText!==!1&&(G.w=Un(G.z,G.v instanceof Date?Jt(G.v):G.v)),h.cellNF||delete G.z}else G.t="s",G.v=U;if(G.t=="z"||(h.dense?(p[v]||(p[v]=[]),p[v][y]=G):p[Le({c:y,r:v})]=G),w=b+1,I=u.charCodeAt(w),x.e.c<y&&(x.e.c=y),x.e.r<v&&(x.e.r=v),E==P)++y;else if(y=0,++v,h.sheetRows&&h.sheetRows<=v)return!0}e:for(;b<u.length;++b)switch(E=u.charCodeAt(b)){case 34:I===34&&(L=!L);break;case P:case 10:case 13:if(!L&&R())break e;break}return b-w>0&&R(),p["!ref"]=ot(x),p}function l(u,f){return!(f&&f.PRN)||f.FS||u.slice(0,4)=="sep="||u.indexOf("	")>=0||u.indexOf(",")>=0||u.indexOf(";")>=0?i(u,f):va(t(u,f),f)}function o(u,f){var h="",m=f.type=="string"?[0,0,0,0]:oT(u,f);switch(f.type){case"base64":h=un(u);break;case"binary":h=u;break;case"buffer":f.codepage==65001?h=u.toString("utf8"):f.codepage&&typeof eo<"u"||(h=Oe&&Buffer.isBuffer(u)?u.toString("binary"):Ii(u));break;case"array":h=Bo(u);break;case"string":h=u;break;default:throw new Error("Unrecognized type "+f.type)}return m[0]==239&&m[1]==187&&m[2]==191?h=Qa(h.slice(3)):f.type!="string"&&f.type!="buffer"&&f.codepage==65001?h=Qa(h):f.type=="binary"&&typeof eo<"u",h.slice(0,19)=="socialcalc:version:"?yg.to_sheet(f.type=="string"?h:Qa(h),f):l(h,f)}function c(u,f){return ys(o(u,f),f)}function d(u){for(var f=[],h=Xe(u["!ref"]),m,p=Array.isArray(u),x=h.s.r;x<=h.e.r;++x){for(var v=[],y=h.s.c;y<=h.e.c;++y){var g=Le({r:x,c:y});if(m=p?(u[x]||[])[y]:u[g],!m||m.v==null){v.push("          ");continue}for(var w=(m.w||(dn(m),m.w)||"").slice(0,10);w.length<10;)w+=" ";v.push(w+(y===0?" ":""))}f.push(v.join(""))}return f.join(`
`)}return{to_workbook:c,to_sheet:o,from_sheet:d}}(),gh=function(){function e(T,M,D){if(T){er(T,T.l||0);for(var B=D.Enum||K;T.l<T.length;){var q=T.read_shift(2),W=B[q]||B[65535],Z=T.read_shift(2),ie=T.l+Z,ce=W.f&&W.f(T,Z,D);if(T.l=ie,M(ce,W,q))return}}}function t(T,M){switch(M.type){case"base64":return r(Cr(un(T)),M);case"binary":return r(Cr(T),M);case"buffer":case"array":return r(T,M)}throw"Unsupported type "+M.type}function r(T,M){if(!T)return T;var D=M||{},B=D.dense?[]:{},q="Sheet1",W="",Z=0,ie={},ce=[],ne=[],me={s:{r:0,c:0},e:{r:0,c:0}},Se=D.sheetRows||0;if(T[2]==0&&(T[3]==8||T[3]==9)&&T.length>=16&&T[14]==5&&T[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(T[2]==2)D.Enum=K,e(T,function(ge,We,br){switch(br){case 0:D.vers=ge,ge>=4096&&(D.qpro=!0);break;case 6:me=ge;break;case 204:ge&&(W=ge);break;case 222:W=ge;break;case 15:case 51:D.qpro||(ge[1].v=ge[1].v.slice(1));case 13:case 14:case 16:br==14&&(ge[2]&112)==112&&(ge[2]&15)>1&&(ge[2]&15)<15&&(ge[1].z=D.dateNF||nt[14],D.cellDates&&(ge[1].t="d",ge[1].v=Dp(ge[1].v))),D.qpro&&ge[3]>Z&&(B["!ref"]=ot(me),ie[q]=B,ce.push(q),B=D.dense?[]:{},me={s:{r:0,c:0},e:{r:0,c:0}},Z=ge[3],q=W||"Sheet"+(Z+1),W="");var Yn=D.dense?(B[ge[0].r]||[])[ge[0].c]:B[Le(ge[0])];if(Yn){Yn.t=ge[1].t,Yn.v=ge[1].v,ge[1].z!=null&&(Yn.z=ge[1].z),ge[1].f!=null&&(Yn.f=ge[1].f);break}D.dense?(B[ge[0].r]||(B[ge[0].r]=[]),B[ge[0].r][ge[0].c]=ge[1]):B[Le(ge[0])]=ge[1];break}},D);else if(T[2]==26||T[2]==14)D.Enum=te,T[2]==14&&(D.qpro=!0,T.l=0),e(T,function(ge,We,br){switch(br){case 204:q=ge;break;case 22:ge[1].v=ge[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(ge[3]>Z&&(B["!ref"]=ot(me),ie[q]=B,ce.push(q),B=D.dense?[]:{},me={s:{r:0,c:0},e:{r:0,c:0}},Z=ge[3],q="Sheet"+(Z+1)),Se>0&&ge[0].r>=Se)break;D.dense?(B[ge[0].r]||(B[ge[0].r]=[]),B[ge[0].r][ge[0].c]=ge[1]):B[Le(ge[0])]=ge[1],me.e.c<ge[0].c&&(me.e.c=ge[0].c),me.e.r<ge[0].r&&(me.e.r=ge[0].r);break;case 27:ge[14e3]&&(ne[ge[14e3][0]]=ge[14e3][1]);break;case 1537:ne[ge[0]]=ge[1],ge[0]==Z&&(q=ge[1]);break}},D);else throw new Error("Unrecognized LOTUS BOF "+T[2]);if(B["!ref"]=ot(me),ie[W||q]=B,ce.push(W||q),!ne.length)return{SheetNames:ce,Sheets:ie};for(var je={},$e=[],Me=0;Me<ne.length;++Me)ie[ce[Me]]?($e.push(ne[Me]||ce[Me]),je[ne[Me]]=ie[ne[Me]]||ie[ce[Me]]):($e.push(ne[Me]),je[ne[Me]]={"!ref":"A1"});return{SheetNames:$e,Sheets:je}}function n(T,M){var D=M||{};if(+D.codepage>=0&&Ni(+D.codepage),D.type=="string")throw new Error("Cannot write WK1 to JS string");var B=Kt(),q=Xe(T["!ref"]),W=Array.isArray(T),Z=[];fe(B,0,i(1030)),fe(B,6,c(q));for(var ie=Math.min(q.e.r,8191),ce=q.s.r;ce<=ie;++ce)for(var ne=Et(ce),me=q.s.c;me<=q.e.c;++me){ce===q.s.r&&(Z[me]=Pt(me));var Se=Z[me]+ne,je=W?(T[ce]||[])[me]:T[Se];if(!(!je||je.t=="z"))if(je.t=="n")(je.v|0)==je.v&&je.v>=-32768&&je.v<=32767?fe(B,13,m(ce,me,je.v)):fe(B,14,x(ce,me,je.v));else{var $e=dn(je);fe(B,15,f(ce,me,$e.slice(0,239)))}}return fe(B,1),B.end()}function s(T,M){var D=M||{};if(+D.codepage>=0&&Ni(+D.codepage),D.type=="string")throw new Error("Cannot write WK3 to JS string");var B=Kt();fe(B,0,l(T));for(var q=0,W=0;q<T.SheetNames.length;++q)(T.Sheets[T.SheetNames[q]]||{})["!ref"]&&fe(B,27,F(T.SheetNames[q],W++));var Z=0;for(q=0;q<T.SheetNames.length;++q){var ie=T.Sheets[T.SheetNames[q]];if(!(!ie||!ie["!ref"])){for(var ce=Xe(ie["!ref"]),ne=Array.isArray(ie),me=[],Se=Math.min(ce.e.r,8191),je=ce.s.r;je<=Se;++je)for(var $e=Et(je),Me=ce.s.c;Me<=ce.e.c;++Me){je===ce.s.r&&(me[Me]=Pt(Me));var ge=me[Me]+$e,We=ne?(ie[je]||[])[Me]:ie[ge];if(!(!We||We.t=="z"))if(We.t=="n")fe(B,23,R(je,Me,Z,We.v));else{var br=dn(We);fe(B,22,E(je,Me,Z,br.slice(0,239)))}}++Z}}return fe(B,1),B.end()}function i(T){var M=J(2);return M.write_shift(2,T),M}function l(T){var M=J(26);M.write_shift(2,4096),M.write_shift(2,4),M.write_shift(4,0);for(var D=0,B=0,q=0,W=0;W<T.SheetNames.length;++W){var Z=T.SheetNames[W],ie=T.Sheets[Z];if(!(!ie||!ie["!ref"])){++q;var ce=lr(ie["!ref"]);D<ce.e.r&&(D=ce.e.r),B<ce.e.c&&(B=ce.e.c)}}return D>8191&&(D=8191),M.write_shift(2,D),M.write_shift(1,q),M.write_shift(1,B),M.write_shift(2,0),M.write_shift(2,0),M.write_shift(1,1),M.write_shift(1,2),M.write_shift(4,0),M.write_shift(4,0),M}function o(T,M,D){var B={s:{c:0,r:0},e:{c:0,r:0}};return M==8&&D.qpro?(B.s.c=T.read_shift(1),T.l++,B.s.r=T.read_shift(2),B.e.c=T.read_shift(1),T.l++,B.e.r=T.read_shift(2),B):(B.s.c=T.read_shift(2),B.s.r=T.read_shift(2),M==12&&D.qpro&&(T.l+=2),B.e.c=T.read_shift(2),B.e.r=T.read_shift(2),M==12&&D.qpro&&(T.l+=2),B.s.c==65535&&(B.s.c=B.e.c=B.s.r=B.e.r=0),B)}function c(T){var M=J(8);return M.write_shift(2,T.s.c),M.write_shift(2,T.s.r),M.write_shift(2,T.e.c),M.write_shift(2,T.e.r),M}function d(T,M,D){var B=[{c:0,r:0},{t:"n",v:0},0,0];return D.qpro&&D.vers!=20768?(B[0].c=T.read_shift(1),B[3]=T.read_shift(1),B[0].r=T.read_shift(2),T.l+=2):(B[2]=T.read_shift(1),B[0].c=T.read_shift(2),B[0].r=T.read_shift(2)),B}function u(T,M,D){var B=T.l+M,q=d(T,M,D);if(q[1].t="s",D.vers==20768){T.l++;var W=T.read_shift(1);return q[1].v=T.read_shift(W,"utf8"),q}return D.qpro&&T.l++,q[1].v=T.read_shift(B-T.l,"cstr"),q}function f(T,M,D){var B=J(7+D.length);B.write_shift(1,255),B.write_shift(2,M),B.write_shift(2,T),B.write_shift(1,39);for(var q=0;q<B.length;++q){var W=D.charCodeAt(q);B.write_shift(1,W>=128?95:W)}return B.write_shift(1,0),B}function h(T,M,D){var B=d(T,M,D);return B[1].v=T.read_shift(2,"i"),B}function m(T,M,D){var B=J(7);return B.write_shift(1,255),B.write_shift(2,M),B.write_shift(2,T),B.write_shift(2,D,"i"),B}function p(T,M,D){var B=d(T,M,D);return B[1].v=T.read_shift(8,"f"),B}function x(T,M,D){var B=J(13);return B.write_shift(1,255),B.write_shift(2,M),B.write_shift(2,T),B.write_shift(8,D,"f"),B}function v(T,M,D){var B=T.l+M,q=d(T,M,D);if(q[1].v=T.read_shift(8,"f"),D.qpro)T.l=B;else{var W=T.read_shift(2);b(T.slice(T.l,T.l+W),q),T.l+=W}return q}function y(T,M,D){var B=M&32768;return M&=-32769,M=(B?T:0)+(M>=8192?M-16384:M),(B?"":"$")+(D?Pt(M):Et(M))}var g={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},w=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function b(T,M){er(T,0);for(var D=[],B=0,q="",W="",Z="",ie="";T.l<T.length;){var ce=T[T.l++];switch(ce){case 0:D.push(T.read_shift(8,"f"));break;case 1:W=y(M[0].c,T.read_shift(2),!0),q=y(M[0].r,T.read_shift(2),!1),D.push(W+q);break;case 2:{var ne=y(M[0].c,T.read_shift(2),!0),me=y(M[0].r,T.read_shift(2),!1);W=y(M[0].c,T.read_shift(2),!0),q=y(M[0].r,T.read_shift(2),!1),D.push(ne+me+":"+W+q)}break;case 3:if(T.l<T.length){console.error("WK1 premature formula end");return}break;case 4:D.push("("+D.pop()+")");break;case 5:D.push(T.read_shift(2));break;case 6:{for(var Se="";ce=T[T.l++];)Se+=String.fromCharCode(ce);D.push('"'+Se.replace(/"/g,'""')+'"')}break;case 8:D.push("-"+D.pop());break;case 23:D.push("+"+D.pop());break;case 22:D.push("NOT("+D.pop()+")");break;case 20:case 21:ie=D.pop(),Z=D.pop(),D.push(["AND","OR"][ce-20]+"("+Z+","+ie+")");break;default:if(ce<32&&w[ce])ie=D.pop(),Z=D.pop(),D.push(Z+w[ce]+ie);else if(g[ce]){if(B=g[ce][1],B==69&&(B=T[T.l++]),B>D.length){console.error("WK1 bad formula parse 0x"+ce.toString(16)+":|"+D.join("|")+"|");return}var je=D.slice(-B);D.length-=B,D.push(g[ce][0]+"("+je.join(",")+")")}else return ce<=7?console.error("WK1 invalid opcode "+ce.toString(16)):ce<=24?console.error("WK1 unsupported op "+ce.toString(16)):ce<=30?console.error("WK1 invalid opcode "+ce.toString(16)):ce<=115?console.error("WK1 unsupported function opcode "+ce.toString(16)):console.error("WK1 unrecognized opcode "+ce.toString(16))}}D.length==1?M[1].f=""+D[0]:console.error("WK1 bad formula parse |"+D.join("|")+"|")}function P(T){var M=[{c:0,r:0},{t:"n",v:0},0];return M[0].r=T.read_shift(2),M[3]=T[T.l++],M[0].c=T[T.l++],M}function L(T,M){var D=P(T);return D[1].t="s",D[1].v=T.read_shift(M-4,"cstr"),D}function E(T,M,D,B){var q=J(6+B.length);q.write_shift(2,T),q.write_shift(1,D),q.write_shift(1,M),q.write_shift(1,39);for(var W=0;W<B.length;++W){var Z=B.charCodeAt(W);q.write_shift(1,Z>=128?95:Z)}return q.write_shift(1,0),q}function I(T,M){var D=P(T);D[1].v=T.read_shift(2);var B=D[1].v>>1;if(D[1].v&1)switch(B&7){case 0:B=(B>>3)*5e3;break;case 1:B=(B>>3)*500;break;case 2:B=(B>>3)/20;break;case 3:B=(B>>3)/200;break;case 4:B=(B>>3)/2e3;break;case 5:B=(B>>3)/2e4;break;case 6:B=(B>>3)/16;break;case 7:B=(B>>3)/64;break}return D[1].v=B,D}function S(T,M){var D=P(T),B=T.read_shift(4),q=T.read_shift(4),W=T.read_shift(2);if(W==65535)return B===0&&q===3221225472?(D[1].t="e",D[1].v=15):B===0&&q===3489660928?(D[1].t="e",D[1].v=42):D[1].v=0,D;var Z=W&32768;return W=(W&32767)-16446,D[1].v=(1-Z*2)*(q*Math.pow(2,W+32)+B*Math.pow(2,W)),D}function R(T,M,D,B){var q=J(14);if(q.write_shift(2,T),q.write_shift(1,D),q.write_shift(1,M),B==0)return q.write_shift(4,0),q.write_shift(4,0),q.write_shift(2,65535),q;var W=0,Z=0,ie=0,ce=0;return B<0&&(W=1,B=-B),Z=Math.log2(B)|0,B/=Math.pow(2,Z-31),ce=B>>>0,ce&2147483648||(B/=2,++Z,ce=B>>>0),B-=ce,ce|=2147483648,ce>>>=0,B*=Math.pow(2,32),ie=B>>>0,q.write_shift(4,ie),q.write_shift(4,ce),Z+=16383+(W?32768:0),q.write_shift(2,Z),q}function U(T,M){var D=S(T);return T.l+=M-14,D}function G(T,M){var D=P(T),B=T.read_shift(4);return D[1].v=B>>6,D}function se(T,M){var D=P(T),B=T.read_shift(8,"f");return D[1].v=B,D}function Ne(T,M){var D=se(T);return T.l+=M-10,D}function ae(T,M){return T[T.l+M-1]==0?T.read_shift(M,"cstr"):""}function xe(T,M){var D=T[T.l++];D>M-1&&(D=M-1);for(var B="";B.length<D;)B+=String.fromCharCode(T[T.l++]);return B}function ee(T,M,D){if(!(!D.qpro||M<21)){var B=T.read_shift(1);T.l+=17,T.l+=1,T.l+=2;var q=T.read_shift(M-21,"cstr");return[B,q]}}function Y(T,M){for(var D={},B=T.l+M;T.l<B;){var q=T.read_shift(2);if(q==14e3){for(D[q]=[0,""],D[q][0]=T.read_shift(2);T[T.l];)D[q][1]+=String.fromCharCode(T[T.l]),T.l++;T.l++}}return D}function F(T,M){var D=J(5+T.length);D.write_shift(2,14e3),D.write_shift(2,M);for(var B=0;B<T.length;++B){var q=T.charCodeAt(B);D[D.l++]=q>127?95:q}return D[D.l++]=0,D}var K={0:{n:"BOF",f:xg},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:o},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:h},14:{n:"NUMBER",f:p},15:{n:"LABEL",f:u},16:{n:"FORMULA",f:v},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:u},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:ae},222:{n:"SHEETNAMELP",f:xe},65535:{n:""}},te={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:L},23:{n:"NUMBER17",f:S},24:{n:"NUMBER18",f:I},25:{n:"FORMULA19",f:U},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:Y},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:G},38:{n:"??"},39:{n:"NUMBER27",f:se},40:{n:"FORMULA28",f:Ne},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:ae},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:ee},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:s,to_workbook:t}}(),q4=/^\s|\s$|[\t\n\r]/;function wg(e,t){if(!t.bookSST)return"";var r=[ct];r[r.length]=de("sst",null,{xmlns:ga[0],count:e.Count,uniqueCount:e.Unique});for(var n=0;n!=e.length;++n)if(e[n]!=null){var s=e[n],i="<si>";s.r?i+=s.r:(i+="<t",s.t||(s.t=""),s.t.match(q4)&&(i+=' xml:space="preserve"'),i+=">"+Ie(s.t)+"</t>"),i+="</si>",r[r.length]=i}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function Q4(e){return[e.read_shift(4),e.read_shift(4)]}function Z4(e,t){return t||(t=J(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t}var ej=HN;function tj(e){var t=Kt();re(t,159,Z4(e));for(var r=0;r<e.length;++r)re(t,19,ej(e[r]));return re(t,160),t.end()}function rj(e){for(var t=[],r=e.split(""),n=0;n<r.length;++n)t[n]=r[n].charCodeAt(0);return t}function bg(e){var t=0,r,n=rj(e),s=n.length+1,i,l,o,c,d;for(r=hs(s),r[0]=n.length,i=1;i!=s;++i)r[i]=n[i-1];for(i=s-1;i>=0;--i)l=r[i],o=t&16384?1:0,c=t<<1&32767,d=o|c,t=d^l;return t^52811}var nj=function(){function e(s,i){switch(i.type){case"base64":return t(un(s),i);case"binary":return t(s,i);case"buffer":return t(Oe&&Buffer.isBuffer(s)?s.toString("binary"):Ii(s),i);case"array":return t(Bo(s),i)}throw new Error("Unrecognized type "+i.type)}function t(s,i){var l=i||{},o=l.dense?[]:{},c=s.match(/\\trowd.*?\\row\b/g);if(!c.length)throw new Error("RTF missing table");var d={s:{c:0,r:0},e:{c:0,r:c.length-1}};return c.forEach(function(u,f){Array.isArray(o)&&(o[f]=[]);for(var h=/\\\w+\b/g,m=0,p,x=-1;p=h.exec(u);){switch(p[0]){case"\\cell":var v=u.slice(m,h.lastIndex-p[0].length);if(v[0]==" "&&(v=v.slice(1)),++x,v.length){var y={v,t:"s"};Array.isArray(o)?o[f][x]=y:o[Le({r:f,c:x})]=y}break}m=h.lastIndex}x>d.e.c&&(d.e.c=x)}),o["!ref"]=ot(d),o}function r(s,i){return ys(e(s,i),i)}function n(s){for(var i=["{\\rtf1\\ansi"],l=Xe(s["!ref"]),o,c=Array.isArray(s),d=l.s.r;d<=l.e.r;++d){i.push("\\trowd\\trautofit1");for(var u=l.s.c;u<=l.e.c;++u)i.push("\\cellx"+(u+1));for(i.push("\\pard\\intbl"),u=l.s.c;u<=l.e.c;++u){var f=Le({r:d,c:u});o=c?(s[d]||[])[u]:s[f],!(!o||o.v==null&&(!o.f||o.F))&&(i.push(" "+(o.w||(dn(o),o.w))),i.push("\\cell"))}i.push("\\pard\\intbl\\row")}return i.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:n}}();function vh(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}var sj=6,sn=sj;function co(e){return Math.floor((e+Math.round(128/sn)/256)*sn)}function uo(e){return Math.floor((e-5)/sn*100+.5)/100}function Ru(e){return Math.round((e*sn+5)/sn*256)/256}function K0(e){e.width?(e.wpx=co(e.width),e.wch=uo(e.wpx),e.MDW=sn):e.wpx?(e.wch=uo(e.wpx),e.width=Ru(e.wch),e.MDW=sn):typeof e.wch=="number"&&(e.width=Ru(e.wch),e.wpx=co(e.width),e.MDW=sn),e.customWidth&&delete e.customWidth}var aj=96,Ng=aj;function fo(e){return e*96/Ng}function jg(e){return e*Ng/96}function ij(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var n=r[0];n<=r[1];++n)e[n]!=null&&(t[t.length]=de("numFmt",null,{numFmtId:n,formatCode:Ie(e[n])}))}),t.length===1?"":(t[t.length]="</numFmts>",t[0]=de("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}function lj(e){var t=[];return t[t.length]=de("cellXfs",null),e.forEach(function(r){t[t.length]=de("xf",null,r)}),t[t.length]="</cellXfs>",t.length===2?"":(t[0]=de("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}function Sg(e,t){var r=[ct,de("styleSheet",null,{xmlns:ga[0],"xmlns:vt":mt.vt})],n;return e.SSF&&(n=ij(e.SSF))!=null&&(r[r.length]=n),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=lj(t.cellXfs))&&(r[r.length]=n),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function oj(e,t){var r=e.read_shift(2),n=Rt(e);return[r,n]}function cj(e,t,r){r||(r=J(6+4*t.length)),r.write_shift(2,e),gt(t,r);var n=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),n}function uj(e,t,r){var n={};n.sz=e.read_shift(2)/20;var s=qN(e);s.fItalic&&(n.italic=1),s.fCondense&&(n.condense=1),s.fExtend&&(n.extend=1),s.fShadow&&(n.shadow=1),s.fOutline&&(n.outline=1),s.fStrikeout&&(n.strike=1);var i=e.read_shift(2);switch(i===700&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var l=e.read_shift(1);l!=0&&(n.underline=l);var o=e.read_shift(1);o>0&&(n.family=o);var c=e.read_shift(1);switch(c>0&&(n.charset=c),e.l++,n.color=JN(e),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=Rt(e),n}function dj(e,t){t||(t=J(25+4*32)),t.write_shift(2,e.sz*20),QN(e,t),t.write_shift(2,e.bold?700:400);var r=0;e.vertAlign=="superscript"?r=1:e.vertAlign=="subscript"&&(r=2),t.write_shift(2,r),t.write_shift(1,e.underline||0),t.write_shift(1,e.family||0),t.write_shift(1,e.charset||0),t.write_shift(1,0),lo(e.color,t);var n=0;return n=2,t.write_shift(1,n),gt(e.name,t),t.length>t.l?t.slice(0,t.l):t}var fj=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],Tc,hj=Hr;function yh(e,t){t||(t=J(4*3+8*7+16*1)),Tc||(Tc=D0(fj));var r=Tc[e.patternType];r==null&&(r=40),t.write_shift(4,r);var n=0;if(r!=40)for(lo({auto:1},t),lo({auto:1},t);n<12;++n)t.write_shift(4,0);else{for(;n<4;++n)t.write_shift(4,0);for(;n<12;++n)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function xj(e,t){var r=e.l+t,n=e.read_shift(2),s=e.read_shift(2);return e.l=r,{ixfe:n,numFmtId:s}}function _g(e,t,r){r||(r=J(16)),r.write_shift(2,t||0),r.write_shift(2,e.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var n=0;return r.write_shift(1,n),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function Ra(e,t){return t||(t=J(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var mj=Hr;function pj(e,t){return t||(t=J(51)),t.write_shift(1,0),Ra(null,t),Ra(null,t),Ra(null,t),Ra(null,t),Ra(null,t),t.length>t.l?t.slice(0,t.l):t}function gj(e,t){return t||(t=J(12+4*10)),t.write_shift(4,e.xfId),t.write_shift(2,1),t.write_shift(1,0),t.write_shift(1,0),io(e.name||"",t),t.length>t.l?t.slice(0,t.l):t}function vj(e,t,r){var n=J(2052);return n.write_shift(4,e),io(t,n),io(r,n),n.length>n.l?n.slice(0,n.l):n}function yj(e,t){if(t){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var s=n[0];s<=n[1];++s)t[s]!=null&&++r}),r!=0&&(re(e,615,Pr(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var s=n[0];s<=n[1];++s)t[s]!=null&&re(e,44,cj(s,t[s]))}),re(e,616))}}function wj(e){var t=1;re(e,611,Pr(t)),re(e,43,dj({sz:12,color:{theme:1},name:"Calibri",family:2})),re(e,612)}function bj(e){var t=2;re(e,603,Pr(t)),re(e,45,yh({patternType:"none"})),re(e,45,yh({patternType:"gray125"})),re(e,604)}function Nj(e){var t=1;re(e,613,Pr(t)),re(e,46,pj()),re(e,614)}function jj(e){var t=1;re(e,626,Pr(t)),re(e,47,_g({numFmtId:0},65535)),re(e,627)}function Sj(e,t){re(e,617,Pr(t.length)),t.forEach(function(r){re(e,47,_g(r,0))}),re(e,618)}function _j(e){var t=1;re(e,619,Pr(t)),re(e,48,gj({xfId:0,name:"Normal"})),re(e,620)}function Ej(e){var t=0;re(e,505,Pr(t)),re(e,506)}function Tj(e){var t=0;re(e,508,vj(t,"TableStyleMedium9","PivotStyleMedium4")),re(e,509)}function Cj(e,t){var r=Kt();return re(r,278),yj(r,e.SSF),wj(r),bj(r),Nj(r),jj(r),Sj(r,t.cellXfs),_j(r),Ej(r),Tj(r),re(r,279),r.end()}function Eg(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var r=[ct];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function kj(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:Rt(e)}}function Aj(e){var t=J(12+2*e.name.length);return t.write_shift(4,e.flags),t.write_shift(4,e.version),gt(e.name,t),t.slice(0,t.l)}function Fj(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function Oj(e){var t=J(4+8*e.length);t.write_shift(4,e.length);for(var r=0;r<e.length;++r)t.write_shift(4,e[r][0]),t.write_shift(4,e[r][1]);return t}function Pj(e,t){var r=J(8+2*t.length);return r.write_shift(4,e),gt(t,r),r.slice(0,r.l)}function Rj(e){return e.l+=4,e.read_shift(4)!=0}function Ij(e,t){var r=J(8);return r.write_shift(4,e),r.write_shift(4,1),r}function Dj(){var e=Kt();return re(e,332),re(e,334,Pr(1)),re(e,335,Aj({name:"XLDAPR",version:12e4,flags:3496657072})),re(e,336),re(e,339,Pj(1,"XLDAPR")),re(e,52),re(e,35,Pr(514)),re(e,4096,Pr(0)),re(e,4097,dr(1)),re(e,36),re(e,53),re(e,340),re(e,337,Ij(1)),re(e,51,Oj([[1,0]])),re(e,338),re(e,333),e.end()}function Tg(){var e=[ct];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function Lj(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=Le(r);var n=e.read_shift(1);return n&2&&(t.l="1"),n&8&&(t.a="1"),t}var Ws=1024;function Cg(e,t){for(var r=[21600,21600],n=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),s=[de("xml",null,{"xmlns:v":tr.v,"xmlns:o":tr.o,"xmlns:x":tr.x,"xmlns:mv":tr.mv}).replace(/\/>/,">"),de("o:shapelayout",de("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),de("v:shapetype",[de("v:stroke",null,{joinstyle:"miter"}),de("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:n})];Ws<e*1e3;)Ws+=1e3;return t.forEach(function(i){var l=pt(i[0]),o={color2:"#BEFF82",type:"gradient"};o.type=="gradient"&&(o.angle="-180");var c=o.type=="gradient"?de("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,d=de("v:fill",c,o),u={on:"t",obscured:"t"};++Ws,s=s.concat(["<v:shape"+Ei({id:"_x0000_s"+Ws,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(i[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",d,de("v:shadow",null,u),de("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",St("x:Anchor",[l.c+1,0,l.r+1,0,l.c+3,20,l.r+5,20].join(",")),St("x:AutoFill","False"),St("x:Row",String(l.r)),St("x:Column",String(l.c)),i[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),s.push("</xml>"),s.join("")}function kg(e){var t=[ct,de("comments",null,{xmlns:ga[0]})],r=[];return t.push("<authors>"),e.forEach(function(n){n[1].forEach(function(s){var i=Ie(s.a);r.indexOf(i)==-1&&(r.push(i),t.push("<author>"+i+"</author>")),s.T&&s.ID&&r.indexOf("tc="+s.ID)==-1&&(r.push("tc="+s.ID),t.push("<author>tc="+s.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach(function(n){var s=0,i=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?s=r.indexOf("tc="+n[1][0].ID):n[1].forEach(function(c){c.a&&(s=r.indexOf(Ie(c.a))),i.push(c.t||"")}),t.push('<comment ref="'+n[0]+'" authorId="'+s+'"><text>'),i.length<=1)t.push(St("t",Ie(i[0]||"")));else{for(var l=`Comment:
    `+i[0]+`
`,o=1;o<i.length;++o)l+=`Reply:
    `+i[o]+`
`;t.push(St("t",Ie(l)))}t.push("</text></comment>")}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function Mj(e,t,r){var n=[ct,de("ThreadedComments",null,{xmlns:mt.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(s){var i="";(s[1]||[]).forEach(function(l,o){if(!l.T){delete l.ID;return}l.a&&t.indexOf(l.a)==-1&&t.push(l.a);var c={ref:s[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};o==0?i=c.id:c.parentId=i,l.ID=c.id,l.a&&(c.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(l.a)).slice(-12)+"}"),n.push(de("threadedComment",St("text",l.t||""),c))})}),n.push("</ThreadedComments>"),n.join("")}function Bj(e){var t=[ct,de("personList",null,{xmlns:mt.TCMNT,"xmlns:x":ga[0]}).replace(/[\/]>/,">")];return e.forEach(function(r,n){t.push(de("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:r,providerId:"None"}))}),t.push("</personList>"),t.join("")}function Uj(e){var t={};t.iauthor=e.read_shift(4);var r=js(e);return t.rfx=r.s,t.ref=Le(r.s),e.l+=16,t}function zj(e,t){return t==null&&(t=J(36)),t.write_shift(4,e[1].iauthor),ya(e[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}var $j=Rt;function Wj(e){return gt(e.slice(0,54))}function Hj(e){var t=Kt(),r=[];return re(t,628),re(t,630),e.forEach(function(n){n[1].forEach(function(s){r.indexOf(s.a)>-1||(r.push(s.a.slice(0,54)),re(t,632,Wj(s.a)))})}),re(t,631),re(t,633),e.forEach(function(n){n[1].forEach(function(s){s.iauthor=r.indexOf(s.a);var i={s:pt(n[0]),e:pt(n[0])};re(t,635,zj([i,s])),s.t&&s.t.length>0&&re(t,637,GN(s)),re(t,636),delete s.iauthor})}),re(t,634),re(t,629),t.end()}function Vj(e,t){t.FullPaths.forEach(function(r,n){if(n!=0){var s=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");s.slice(-1)!=="/"&&Be.utils.cfb_add(e,s,t.FileIndex[n].content)}})}var Ag=["xlsb","xlsm","xlam","biff8","xla"],Gj=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(n,s,i,l){var o=!1,c=!1;i.length==0?c=!0:i.charAt(0)=="["&&(c=!0,i=i.slice(1,-1)),l.length==0?o=!0:l.charAt(0)=="["&&(o=!0,l=l.slice(1,-1));var d=i.length>0?parseInt(i,10)|0:0,u=l.length>0?parseInt(l,10)|0:0;return o?u+=t.c:--u,c?d+=t.r:--d,s+(o?"":"$")+Pt(u)+(c?"":"$")+Et(d)}return function(s,i){return t=i,s.replace(e,r)}}(),Y0=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,J0=function(){return function(t,r){return t.replace(Y0,function(n,s,i,l,o,c){var d=W0(l)-(i?0:r.c),u=$0(c)-(o?0:r.r),f=u==0?"":o?u+1:"["+u+"]",h=d==0?"":i?d+1:"["+d+"]";return s+"R"+f+"C"+h})}}();function Xj(e,t){return e.replace(Y0,function(r,n,s,i,l,o){return n+(s=="$"?s+i:Pt(W0(i)+t.c))+(l=="$"?l+o:Et($0(o)+t.r))})}function Kj(e){return e.length!=1}function at(e){e.l+=1}function zn(e,t){var r=e.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function Fg(e,t,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return Og(e);r.biff==12&&(n=4)}var s=e.read_shift(n),i=e.read_shift(n),l=zn(e),o=zn(e);return{s:{r:s,c:l[0],cRel:l[1],rRel:l[2]},e:{r:i,c:o[0],cRel:o[1],rRel:o[2]}}}function Og(e){var t=zn(e),r=zn(e),n=e.read_shift(1),s=e.read_shift(1);return{s:{r:t[0],c:n,cRel:t[1],rRel:t[2]},e:{r:r[0],c:s,cRel:r[1],rRel:r[2]}}}function Yj(e,t,r){if(r.biff<8)return Og(e);var n=e.read_shift(r.biff==12?4:2),s=e.read_shift(r.biff==12?4:2),i=zn(e),l=zn(e);return{s:{r:n,c:i[0],cRel:i[1],rRel:i[2]},e:{r:s,c:l[0],cRel:l[1],rRel:l[2]}}}function Pg(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return Jj(e);var n=e.read_shift(r&&r.biff==12?4:2),s=zn(e);return{r:n,c:s[0],cRel:s[1],rRel:s[2]}}function Jj(e){var t=zn(e),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function qj(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function Qj(e,t,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return Zj(e);var s=e.read_shift(n>=12?4:2),i=e.read_shift(2),l=(i&16384)>>14,o=(i&32768)>>15;if(i&=16383,o==1)for(;s>524287;)s-=1048576;if(l==1)for(;i>8191;)i=i-16384;return{r:s,c:i,cRel:l,rRel:o}}function Zj(e){var t=e.read_shift(2),r=e.read_shift(1),n=(t&32768)>>15,s=(t&16384)>>14;return t&=16383,n==1&&t>=8192&&(t=t-16384),s==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:s,rRel:n}}function eS(e,t,r){var n=(e[e.l++]&96)>>5,s=Fg(e,r.biff>=2&&r.biff<=5?6:8,r);return[n,s]}function tS(e,t,r){var n=(e[e.l++]&96)>>5,s=e.read_shift(2,"i"),i=8;if(r)switch(r.biff){case 5:e.l+=12,i=6;break;case 12:i=12;break}var l=Fg(e,i,r);return[n,s,l]}function rS(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function nS(e,t,r){var n=(e[e.l++]&96)>>5,s=e.read_shift(2),i=8;if(r)switch(r.biff){case 5:e.l+=12,i=6;break;case 12:i=12;break}return e.l+=i,[n,s]}function sS(e,t,r){var n=(e[e.l++]&96)>>5,s=Yj(e,t-1,r);return[n,s]}function aS(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[n]}function wh(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function iS(e,t,r){e.l+=2;for(var n=e.read_shift(r&&r.biff==2?1:2),s=[],i=0;i<=n;++i)s.push(e.read_shift(r&&r.biff==2?1:2));return s}function lS(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function oS(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function cS(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function uS(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[n]}function Rg(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function dS(e){return e.read_shift(2),Rg(e)}function fS(e){return e.read_shift(2),Rg(e)}function hS(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var s=Pg(e,0,r);return[n,s]}function xS(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var s=Qj(e,0,r);return[n,s]}function mS(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var s=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var i=Pg(e,0,r);return[n,s,i]}function pS(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var s=e.read_shift(r&&r.biff<=3?1:2);return[p_[s],Lg[s],n]}function gS(e,t,r){var n=e[e.l++],s=e.read_shift(1),i=r&&r.biff<=3?[n==88?-1:0,e.read_shift(1)]:vS(e);return[s,(i[0]===0?Lg:m_)[i[1]]]}function vS(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function yS(e,t,r){e.l+=r&&r.biff==2?3:4}function wS(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var n=e.read_shift(2),s=e.read_shift(r&&r.biff==2?1:2);return[n,s]}function bS(e){return e.l++,Mi[e.read_shift(1)]}function NS(e){return e.l++,e.read_shift(2)}function jS(e){return e.l++,e.read_shift(1)!==0}function SS(e){return e.l++,wa(e)}function _S(e,t,r){return e.l++,pg(e,t-1,r)}function ES(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=m4(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=Mi[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=wa(e);break;case 2:r[1]=y4(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function TS(e,t,r){for(var n=e.read_shift(r.biff==12?4:2),s=[],i=0;i!=n;++i)s.push((r.biff==12?js:N4)(e));return s}function CS(e,t,r){var n=0,s=0;r.biff==12?(n=e.read_shift(4),s=e.read_shift(4)):(s=1+e.read_shift(1),n=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--s==0&&(s=256));for(var i=0,l=[];i!=n&&(l[i]=[]);++i)for(var o=0;o!=s;++o)l[i][o]=ES(e,r.biff);return l}function kS(e,t,r){var n=e.read_shift(1)>>>5&3,s=!r||r.biff>=8?4:2,i=e.read_shift(s);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[n,0,i]}function AS(e,t,r){if(r.biff==5)return FS(e);var n=e.read_shift(1)>>>5&3,s=e.read_shift(2),i=e.read_shift(4);return[n,s,i]}function FS(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[t,r,n]}function OS(e,t,r){var n=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var s=e.read_shift(r&&r.biff==2?1:2);return[n,s]}function PS(e,t,r){var n=e.read_shift(1)>>>5&3,s=e.read_shift(r&&r.biff==2?1:2);return[n,s]}function RS(e,t,r){var n=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[n]}function IS(e,t,r){var n=(e[e.l++]&96)>>5,s=e.read_shift(2),i=4;if(r)switch(r.biff){case 5:i=15;break;case 12:i=6;break}return e.l+=i,[n,s]}var DS=Hr,LS=Hr,MS=Hr;function Bi(e,t,r){return e.l+=2,[qj(e)]}function q0(e){return e.l+=6,[]}var BS=Bi,US=q0,zS=q0,$S=Bi;function Ig(e){return e.l+=2,[xg(e),e.read_shift(2)&1]}var WS=Bi,HS=Ig,VS=q0,GS=Bi,XS=Bi,KS=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function YS(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),s=e.read_shift(2),i=e.read_shift(2),l=KS[r>>2&31];return{ixti:t,coltype:r&3,rt:l,idx:n,c:s,C:i}}function JS(e){return e.l+=2,[e.read_shift(4)]}function qS(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function QS(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function ZS(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function e_(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function t_(e){return e.l+=4,[0,0]}var bh={1:{n:"PtgExp",f:wS},2:{n:"PtgTbl",f:MS},3:{n:"PtgAdd",f:at},4:{n:"PtgSub",f:at},5:{n:"PtgMul",f:at},6:{n:"PtgDiv",f:at},7:{n:"PtgPower",f:at},8:{n:"PtgConcat",f:at},9:{n:"PtgLt",f:at},10:{n:"PtgLe",f:at},11:{n:"PtgEq",f:at},12:{n:"PtgGe",f:at},13:{n:"PtgGt",f:at},14:{n:"PtgNe",f:at},15:{n:"PtgIsect",f:at},16:{n:"PtgUnion",f:at},17:{n:"PtgRange",f:at},18:{n:"PtgUplus",f:at},19:{n:"PtgUminus",f:at},20:{n:"PtgPercent",f:at},21:{n:"PtgParen",f:at},22:{n:"PtgMissArg",f:at},23:{n:"PtgStr",f:_S},26:{n:"PtgSheet",f:qS},27:{n:"PtgEndSheet",f:QS},28:{n:"PtgErr",f:bS},29:{n:"PtgBool",f:jS},30:{n:"PtgInt",f:NS},31:{n:"PtgNum",f:SS},32:{n:"PtgArray",f:aS},33:{n:"PtgFunc",f:pS},34:{n:"PtgFuncVar",f:gS},35:{n:"PtgName",f:kS},36:{n:"PtgRef",f:hS},37:{n:"PtgArea",f:eS},38:{n:"PtgMemArea",f:OS},39:{n:"PtgMemErr",f:DS},40:{n:"PtgMemNoMem",f:LS},41:{n:"PtgMemFunc",f:PS},42:{n:"PtgRefErr",f:RS},43:{n:"PtgAreaErr",f:rS},44:{n:"PtgRefN",f:xS},45:{n:"PtgAreaN",f:sS},46:{n:"PtgMemAreaN",f:ZS},47:{n:"PtgMemNoMemN",f:e_},57:{n:"PtgNameX",f:AS},58:{n:"PtgRef3d",f:mS},59:{n:"PtgArea3d",f:tS},60:{n:"PtgRefErr3d",f:IS},61:{n:"PtgAreaErr3d",f:nS},255:{}},r_={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},n_={1:{n:"PtgElfLel",f:Ig},2:{n:"PtgElfRw",f:GS},3:{n:"PtgElfCol",f:BS},6:{n:"PtgElfRwV",f:XS},7:{n:"PtgElfColV",f:$S},10:{n:"PtgElfRadical",f:WS},11:{n:"PtgElfRadicalS",f:VS},13:{n:"PtgElfColS",f:US},15:{n:"PtgElfColSV",f:zS},16:{n:"PtgElfRadicalLel",f:HS},25:{n:"PtgList",f:YS},29:{n:"PtgSxName",f:JS},255:{}},s_={0:{n:"PtgAttrNoop",f:t_},1:{n:"PtgAttrSemi",f:uS},2:{n:"PtgAttrIf",f:oS},4:{n:"PtgAttrChoose",f:iS},8:{n:"PtgAttrGoto",f:lS},16:{n:"PtgAttrSum",f:yS},32:{n:"PtgAttrBaxcel",f:wh},33:{n:"PtgAttrBaxcel",f:wh},64:{n:"PtgAttrSpace",f:dS},65:{n:"PtgAttrSpaceSemi",f:fS},128:{n:"PtgAttrIfError",f:cS},255:{}};function a_(e,t,r,n){if(n.biff<8)return Hr(e,t);for(var s=e.l+t,i=[],l=0;l!==r.length;++l)switch(r[l][0]){case"PtgArray":r[l][1]=CS(e,0,n),i.push(r[l][1]);break;case"PtgMemArea":r[l][2]=TS(e,r[l][1],n),i.push(r[l][2]);break;case"PtgExp":n&&n.biff==12&&(r[l][1][1]=e.read_shift(4),i.push(r[l][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[l][0]}return t=s-e.l,t!==0&&i.push(Hr(e,t)),i}function i_(e,t,r){for(var n=e.l+t,s,i,l=[];n!=e.l;)t=n-e.l,i=e[e.l],s=bh[i]||bh[r_[i]],(i===24||i===25)&&(s=(i===24?n_:s_)[e[e.l+1]]),!s||!s.f?Hr(e,t):l.push([s.n,s.f(e,t,r)]);return l}function l_(e){for(var t=[],r=0;r<e.length;++r){for(var n=e[r],s=[],i=0;i<n.length;++i){var l=n[i];if(l)switch(l[0]){case 2:s.push('"'+l[1].replace(/"/g,'""')+'"');break;default:s.push(l[1])}else s.push("")}t.push(s.join(","))}return t.join(";")}var o_={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function c_(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function Dg(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!n)return"SH33TJSERR1";var s="";if(r.biff>8)switch(e[n[0]][0]){case 357:return s=n[1]==-1?"#REF":e.SheetNames[n[1]],n[1]==n[2]?s:s+":"+e.SheetNames[n[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[n[0]][0];case 355:default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return s=n[1]==-1?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?s:s+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map(function(i){return i.Name}).join(";;");default:return e[n[0]][0][3]?(s=n[1]==-1?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?s:s+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function Nh(e,t,r){var n=Dg(e,t,r);return n=="#REF"?n:c_(n,r)}function ca(e,t,r,n,s){var i=s&&s.biff||8,l={s:{c:0,r:0}},o=[],c,d,u,f=0,h=0,m,p="";if(!e[0]||!e[0][0])return"";for(var x=-1,v="",y=0,g=e[0].length;y<g;++y){var w=e[0][y];switch(w[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(c=o.pop(),d=o.pop(),x>=0){switch(e[0][x][1][0]){case 0:v=rt(" ",e[0][x][1][1]);break;case 1:v=rt("\r",e[0][x][1][1]);break;default:if(v="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][x][1][0])}d=d+v,x=-1}o.push(d+o_[w[0]]+c);break;case"PtgIsect":c=o.pop(),d=o.pop(),o.push(d+" "+c);break;case"PtgUnion":c=o.pop(),d=o.pop(),o.push(d+","+c);break;case"PtgRange":c=o.pop(),d=o.pop(),o.push(d+":"+c);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":u=ei(w[1][1],l,s),o.push(ti(u,i));break;case"PtgRefN":u=r?ei(w[1][1],r,s):w[1][1],o.push(ti(u,i));break;case"PtgRef3d":f=w[1][1],u=ei(w[1][2],l,s),p=Nh(n,f,s),o.push(p+"!"+ti(u,i));break;case"PtgFunc":case"PtgFuncVar":var b=w[1][0],P=w[1][1];b||(b=0),b&=127;var L=b==0?[]:o.slice(-b);o.length-=b,P==="User"&&(P=L.shift()),o.push(P+"("+L.join(",")+")");break;case"PtgBool":o.push(w[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(w[1]);break;case"PtgNum":o.push(String(w[1]));break;case"PtgStr":o.push('"'+w[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(w[1]);break;case"PtgAreaN":m=ih(w[1][1],r?{s:r}:l,s),o.push(_c(m,s));break;case"PtgArea":m=ih(w[1][1],l,s),o.push(_c(m,s));break;case"PtgArea3d":f=w[1][1],m=w[1][2],p=Nh(n,f,s),o.push(p+"!"+_c(m,s));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":h=w[1][2];var E=(n.names||[])[h-1]||(n[0]||[])[h],I=E?E.Name:"SH33TJSNAME"+String(h);I&&I.slice(0,6)=="_xlfn."&&!s.xlfn&&(I=I.slice(6)),o.push(I);break;case"PtgNameX":var S=w[1][1];h=w[1][2];var R;if(s.biff<=5)S<0&&(S=-S),n[S]&&(R=n[S][h]);else{var U="";if(((n[S]||[])[0]||[])[0]==14849||(((n[S]||[])[0]||[])[0]==1025?n[S][h]&&n[S][h].itab>0&&(U=n.SheetNames[n[S][h].itab-1]+"!"):U=n.SheetNames[h-1]+"!"),n[S]&&n[S][h])U+=n[S][h].Name;else if(n[0]&&n[0][h])U+=n[0][h].Name;else{var G=(Dg(n,S,s)||"").split(";;");G[h-1]?U=G[h-1]:U+="SH33TJSERRX"}o.push(U);break}R||(R={Name:"SH33TJSERRY"}),o.push(R.Name);break;case"PtgParen":var se="(",Ne=")";if(x>=0){switch(v="",e[0][x][1][0]){case 2:se=rt(" ",e[0][x][1][1])+se;break;case 3:se=rt("\r",e[0][x][1][1])+se;break;case 4:Ne=rt(" ",e[0][x][1][1])+Ne;break;case 5:Ne=rt("\r",e[0][x][1][1])+Ne;break;default:if(s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][x][1][0])}x=-1}o.push(se+o.pop()+Ne);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":u={c:w[1][1],r:w[1][0]};var ae={c:r.c,r:r.r};if(n.sharedf[Le(u)]){var xe=n.sharedf[Le(u)];o.push(ca(xe,l,ae,n,s))}else{var ee=!1;for(c=0;c!=n.arrayf.length;++c)if(d=n.arrayf[c],!(u.c<d[0].s.c||u.c>d[0].e.c)&&!(u.r<d[0].s.r||u.r>d[0].e.r)){o.push(ca(d[1],l,ae,n,s)),ee=!0;break}ee||o.push(w[1])}break;case"PtgArray":o.push("{"+l_(w[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":x=y;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+w[1].idx+"[#"+w[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(w));default:throw new Error("Unrecognized Formula Token: "+String(w))}var Y=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(s.biff!=3&&x>=0&&Y.indexOf(e[0][y][0])==-1){w=e[0][x];var F=!0;switch(w[1][0]){case 4:F=!1;case 0:v=rt(" ",w[1][1]);break;case 5:F=!1;case 1:v=rt("\r",w[1][1]);break;default:if(v="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+w[1][0])}o.push((F?v:"")+o.pop()+(F?"":v)),x=-1}}if(o.length>1&&s.WTF)throw new Error("bad formula stack");return o[0]}function u_(e){if(e==null){var t=J(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}else if(typeof e=="number")return xs(e);return xs(0)}function d_(e,t,r,n,s){var i=ms(t,r,s),l=u_(e.v),o=J(6),c=33;o.write_shift(2,c),o.write_shift(4,0);for(var d=J(e.bf.length),u=0;u<e.bf.length;++u)d[u]=e.bf[u];var f=jt([i,l,o,d]);return f}function Uo(e,t,r){var n=e.read_shift(4),s=i_(e,n,r),i=e.read_shift(4),l=i>0?a_(e,i,s,r):null;return[s,l]}var f_=Uo,zo=Uo,h_=Uo,x_=Uo,m_={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},Lg={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},p_={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function g_(e){var t="of:="+e.replace(Y0,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return t.replace(/;/g,"|").replace(/,/g,";")}function v_(e){return e.replace(/\./,"!")}var ri=typeof Map<"u";function Q0(e,t,r){var n=0,s=e.length;if(r){if(ri?r.has(t):Object.prototype.hasOwnProperty.call(r,t)){for(var i=ri?r.get(t):r[t];n<i.length;++n)if(e[i[n]].t===t)return e.Count++,i[n]}}else for(;n<s;++n)if(e[n].t===t)return e.Count++,n;return e[s]={t},e.Count++,e.Unique++,r&&(ri?(r.has(t)||r.set(t,[]),r.get(t).push(s)):(Object.prototype.hasOwnProperty.call(r,t)||(r[t]=[]),r[t].push(s))),s}function $o(e,t){var r={min:e+1,max:e+1},n=-1;return t.MDW&&(sn=t.MDW),t.width!=null?r.customWidth=1:t.wpx!=null?n=uo(t.wpx):t.wch!=null&&(n=t.wch),n>-1?(r.width=Ru(n),r.customWidth=1):t.width!=null&&(r.width=t.width),t.hidden&&(r.hidden=!0),t.level!=null&&(r.outlineLevel=r.level=t.level),r}function Mg(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function Kn(e,t,r){var n=r.revssf[t.z!=null?t.z:"General"],s=60,i=e.length;if(n==null&&r.ssf){for(;s<392;++s)if(r.ssf[s]==null){Pp(t.z,s),r.ssf[s]=t.z,r.revssf[t.z]=n=s;break}}for(s=0;s!=i;++s)if(e[s].numFmtId===n)return s;return e[i]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},i}function y_(e,t,r){if(e&&e["!ref"]){var n=Xe(e["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+r+"): "+e["!ref"])}}function w_(e){if(e.length===0)return"";for(var t='<mergeCells count="'+e.length+'">',r=0;r!=e.length;++r)t+='<mergeCell ref="'+ot(e[r])+'"/>';return t+"</mergeCells>"}function b_(e,t,r,n,s){var i=!1,l={},o=null;if(n.bookType!=="xlsx"&&t.vbaraw){var c=t.SheetNames[r];try{t.Workbook&&(c=t.Workbook.Sheets[r].CodeName||c)}catch{}i=!0,l.codeName=_i(Ie(c))}if(e&&e["!outline"]){var d={summaryBelow:1,summaryRight:1};e["!outline"].above&&(d.summaryBelow=0),e["!outline"].left&&(d.summaryRight=0),o=(o||"")+de("outlinePr",null,d)}!i&&!o||(s[s.length]=de("sheetPr",o,l))}var N_=["objects","scenarios","selectLockedCells","selectUnlockedCells"],j_=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function S_(e){var t={sheet:1};return N_.forEach(function(r){e[r]!=null&&e[r]&&(t[r]="1")}),j_.forEach(function(r){e[r]!=null&&!e[r]&&(t[r]="0")}),e.password&&(t.password=bg(e.password).toString(16).toUpperCase()),de("sheetProtection",null,t)}function __(e){return Mg(e),de("pageMargins",null,e)}function E_(e,t){for(var r=["<cols>"],n,s=0;s!=t.length;++s)(n=t[s])&&(r[r.length]=de("col",null,$o(s,n)));return r[r.length]="</cols>",r.join("")}function T_(e,t,r,n){var s=typeof e.ref=="string"?e.ref:ot(e.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var i=r.Workbook.Names,l=lr(s);l.s.r==l.e.r&&(l.e.r=lr(t["!ref"]).e.r,s=ot(l));for(var o=0;o<i.length;++o){var c=i[o];if(c.Name=="_xlnm._FilterDatabase"&&c.Sheet==n){c.Ref="'"+r.SheetNames[n]+"'!"+s;break}}return o==i.length&&i.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+s}),de("autoFilter",null,{ref:s})}function C_(e,t,r,n){var s={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(s.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),de("sheetViews",de("sheetView",null,s),{})}function k_(e,t,r,n){if(e.c&&r["!comments"].push([t,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var s="",i=e.t,l=e.v;if(e.t!=="z")switch(e.t){case"b":s=e.v?"1":"0";break;case"n":s=""+e.v;break;case"e":s=Mi[e.v];break;case"d":n&&n.cellDates?s=Ut(e.v,-1).toISOString():(e=qt(e),e.t="n",s=""+(e.v=Jt(Ut(e.v)))),typeof e.z>"u"&&(e.z=nt[14]);break;default:s=e.v;break}var o=St("v",Ie(s)),c={r:t},d=Kn(n.cellXfs,e,n);switch(d!==0&&(c.s=d),e.t){case"n":break;case"d":c.t="d";break;case"b":c.t="b";break;case"e":c.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){o=St("v",""+Q0(n.Strings,e.v,n.revStrings)),c.t="s";break}c.t="str";break}if(e.t!=i&&(e.t=i,e.v=l),typeof e.f=="string"&&e.f){var u=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;o=de("f",Ie(e.f),u)+(e.v!=null?o:"")}return e.l&&r["!links"].push([t,e.l]),e.D&&(c.cm=1),de("c",o,c)}function A_(e,t,r,n){var s=[],i=[],l=Xe(e["!ref"]),o="",c,d="",u=[],f=0,h=0,m=e["!rows"],p=Array.isArray(e),x={r:d},v,y=-1;for(h=l.s.c;h<=l.e.c;++h)u[h]=Pt(h);for(f=l.s.r;f<=l.e.r;++f){for(i=[],d=Et(f),h=l.s.c;h<=l.e.c;++h){c=u[h]+d;var g=p?(e[f]||[])[h]:e[c];g!==void 0&&(o=k_(g,c,e,t))!=null&&i.push(o)}(i.length>0||m&&m[f])&&(x={r:d},m&&m[f]&&(v=m[f],v.hidden&&(x.hidden=1),y=-1,v.hpx?y=fo(v.hpx):v.hpt&&(y=v.hpt),y>-1&&(x.ht=y,x.customHeight=1),v.level&&(x.outlineLevel=v.level)),s[s.length]=de("row",i.join(""),x))}if(m)for(;f<m.length;++f)m&&m[f]&&(x={r:f+1},v=m[f],v.hidden&&(x.hidden=1),y=-1,v.hpx?y=fo(v.hpx):v.hpt&&(y=v.hpt),y>-1&&(x.ht=y,x.customHeight=1),v.level&&(x.outlineLevel=v.level),s[s.length]=de("row","",x));return s.join("")}function Bg(e,t,r,n){var s=[ct,de("worksheet",null,{xmlns:ga[0],"xmlns:r":mt.r})],i=r.SheetNames[e],l=0,o="",c=r.Sheets[i];c==null&&(c={});var d=c["!ref"]||"A1",u=Xe(d);if(u.e.c>16383||u.e.r>1048575){if(t.WTF)throw new Error("Range "+d+" exceeds format limit A1:XFD1048576");u.e.c=Math.min(u.e.c,16383),u.e.r=Math.min(u.e.c,1048575),d=ot(u)}n||(n={}),c["!comments"]=[];var f=[];b_(c,r,e,t,s),s[s.length]=de("dimension",null,{ref:d}),s[s.length]=C_(c,t,e,r),t.sheetFormat&&(s[s.length]=de("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),c["!cols"]!=null&&c["!cols"].length>0&&(s[s.length]=E_(c,c["!cols"])),s[l=s.length]="<sheetData/>",c["!links"]=[],c["!ref"]!=null&&(o=A_(c,t),o.length>0&&(s[s.length]=o)),s.length>l+1&&(s[s.length]="</sheetData>",s[l]=s[l].replace("/>",">")),c["!protect"]&&(s[s.length]=S_(c["!protect"])),c["!autofilter"]!=null&&(s[s.length]=T_(c["!autofilter"],c,r,e)),c["!merges"]!=null&&c["!merges"].length>0&&(s[s.length]=w_(c["!merges"]));var h=-1,m,p=-1;return c["!links"].length>0&&(s[s.length]="<hyperlinks>",c["!links"].forEach(function(x){x[1].Target&&(m={ref:x[0]},x[1].Target.charAt(0)!="#"&&(p=Re(n,-1,Ie(x[1].Target).replace(/#.*$/,""),Fe.HLINK),m["r:id"]="rId"+p),(h=x[1].Target.indexOf("#"))>-1&&(m.location=Ie(x[1].Target.slice(h+1))),x[1].Tooltip&&(m.tooltip=Ie(x[1].Tooltip)),s[s.length]=de("hyperlink",null,m))}),s[s.length]="</hyperlinks>"),delete c["!links"],c["!margins"]!=null&&(s[s.length]=__(c["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&(s[s.length]=St("ignoredErrors",de("ignoredError",null,{numberStoredAsText:1,sqref:d}))),f.length>0&&(p=Re(n,-1,"../drawings/drawing"+(e+1)+".xml",Fe.DRAW),s[s.length]=de("drawing",null,{"r:id":"rId"+p}),c["!drawing"]=f),c["!comments"].length>0&&(p=Re(n,-1,"../drawings/vmlDrawing"+(e+1)+".vml",Fe.VML),s[s.length]=de("legacyDrawing",null,{"r:id":"rId"+p}),c["!legacy"]=p),s.length>1&&(s[s.length]="</worksheet>",s[1]=s[1].replace("/>",">")),s.join("")}function F_(e,t){var r={},n=e.l+t;r.r=e.read_shift(4),e.l+=4;var s=e.read_shift(2);e.l+=1;var i=e.read_shift(1);return e.l=n,i&7&&(r.level=i&7),i&16&&(r.hidden=!0),i&32&&(r.hpt=s/20),r}function O_(e,t,r){var n=J(145),s=(r["!rows"]||[])[e]||{};n.write_shift(4,e),n.write_shift(4,0);var i=320;s.hpx?i=fo(s.hpx)*20:s.hpt&&(i=s.hpt*20),n.write_shift(2,i),n.write_shift(1,0);var l=0;s.level&&(l|=s.level),s.hidden&&(l|=16),(s.hpx||s.hpt)&&(l|=32),n.write_shift(1,l),n.write_shift(1,0);var o=0,c=n.l;n.l+=4;for(var d={r:e,c:0},u=0;u<16;++u)if(!(t.s.c>u+1<<10||t.e.c<u<<10)){for(var f=-1,h=-1,m=u<<10;m<u+1<<10;++m){d.c=m;var p=Array.isArray(r)?(r[d.r]||[])[d.c]:r[Le(d)];p&&(f<0&&(f=m),h=m)}f<0||(++o,n.write_shift(4,f),n.write_shift(4,h))}var x=n.l;return n.l=c,n.write_shift(4,o),n.l=x,n.length>n.l?n.slice(0,n.l):n}function P_(e,t,r,n){var s=O_(n,r,t);(s.length>17||(t["!rows"]||[])[n])&&re(e,0,s)}var R_=js,I_=ya;function D_(){}function L_(e,t){var r={},n=e[e.l];return++e.l,r.above=!(n&64),r.left=!(n&128),e.l+=18,r.name=XN(e),r}function M_(e,t,r){r==null&&(r=J(84+4*e.length));var n=192;t&&(t.above&&(n&=-65),t.left&&(n&=-129)),r.write_shift(1,n);for(var s=1;s<3;++s)r.write_shift(1,0);return lo({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),eg(e,r),r.slice(0,r.l)}function B_(e){var t=wr(e);return[t]}function U_(e,t,r){return r==null&&(r=J(8)),ws(t,r)}function z_(e){var t=bs(e);return[t]}function $_(e,t,r){return r==null&&(r=J(4)),Ns(t,r)}function W_(e){var t=wr(e),r=e.read_shift(1);return[t,r,"b"]}function H_(e,t,r){return r==null&&(r=J(9)),ws(t,r),r.write_shift(1,e.v?1:0),r}function V_(e){var t=bs(e),r=e.read_shift(1);return[t,r,"b"]}function G_(e,t,r){return r==null&&(r=J(5)),Ns(t,r),r.write_shift(1,e.v?1:0),r}function X_(e){var t=wr(e),r=e.read_shift(1);return[t,r,"e"]}function K_(e,t,r){return r==null&&(r=J(9)),ws(t,r),r.write_shift(1,e.v),r}function Y_(e){var t=bs(e),r=e.read_shift(1);return[t,r,"e"]}function J_(e,t,r){return r==null&&(r=J(8)),Ns(t,r),r.write_shift(1,e.v),r.write_shift(2,0),r.write_shift(1,0),r}function q_(e){var t=wr(e),r=e.read_shift(4);return[t,r,"s"]}function Q_(e,t,r){return r==null&&(r=J(12)),ws(t,r),r.write_shift(4,t.v),r}function Z_(e){var t=bs(e),r=e.read_shift(4);return[t,r,"s"]}function e3(e,t,r){return r==null&&(r=J(8)),Ns(t,r),r.write_shift(4,t.v),r}function t3(e){var t=wr(e),r=wa(e);return[t,r,"n"]}function r3(e,t,r){return r==null&&(r=J(16)),ws(t,r),xs(e.v,r),r}function n3(e){var t=bs(e),r=wa(e);return[t,r,"n"]}function s3(e,t,r){return r==null&&(r=J(12)),Ns(t,r),xs(e.v,r),r}function a3(e){var t=wr(e),r=tg(e);return[t,r,"n"]}function i3(e,t,r){return r==null&&(r=J(12)),ws(t,r),rg(e.v,r),r}function l3(e){var t=bs(e),r=tg(e);return[t,r,"n"]}function o3(e,t,r){return r==null&&(r=J(8)),Ns(t,r),rg(e.v,r),r}function c3(e){var t=wr(e),r=H0(e);return[t,r,"is"]}function u3(e){var t=wr(e),r=Rt(e);return[t,r,"str"]}function d3(e,t,r){return r==null&&(r=J(12+4*e.v.length)),ws(t,r),gt(e.v,r),r.length>r.l?r.slice(0,r.l):r}function f3(e){var t=bs(e),r=Rt(e);return[t,r,"str"]}function h3(e,t,r){return r==null&&(r=J(8+4*e.v.length)),Ns(t,r),gt(e.v,r),r.length>r.l?r.slice(0,r.l):r}function x3(e,t,r){var n=e.l+t,s=wr(e);s.r=r["!row"];var i=e.read_shift(1),l=[s,i,"b"];if(r.cellFormula){e.l+=2;var o=zo(e,n-e.l,r);l[3]=ca(o,null,s,r.supbooks,r)}else e.l=n;return l}function m3(e,t,r){var n=e.l+t,s=wr(e);s.r=r["!row"];var i=e.read_shift(1),l=[s,i,"e"];if(r.cellFormula){e.l+=2;var o=zo(e,n-e.l,r);l[3]=ca(o,null,s,r.supbooks,r)}else e.l=n;return l}function p3(e,t,r){var n=e.l+t,s=wr(e);s.r=r["!row"];var i=wa(e),l=[s,i,"n"];if(r.cellFormula){e.l+=2;var o=zo(e,n-e.l,r);l[3]=ca(o,null,s,r.supbooks,r)}else e.l=n;return l}function g3(e,t,r){var n=e.l+t,s=wr(e);s.r=r["!row"];var i=Rt(e),l=[s,i,"str"];if(r.cellFormula){e.l+=2;var o=zo(e,n-e.l,r);l[3]=ca(o,null,s,r.supbooks,r)}else e.l=n;return l}var v3=js,y3=ya;function w3(e,t){return t==null&&(t=J(4)),t.write_shift(4,e),t}function b3(e,t){var r=e.l+t,n=js(e),s=V0(e),i=Rt(e),l=Rt(e),o=Rt(e);e.l=r;var c={rfx:n,relId:s,loc:i,display:o};return l&&(c.Tooltip=l),c}function N3(e,t){var r=J(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));ya({s:pt(e[0]),e:pt(e[0])},r),G0("rId"+t,r);var n=e[1].Target.indexOf("#"),s=n==-1?"":e[1].Target.slice(n+1);return gt(s||"",r),gt(e[1].Tooltip||"",r),gt("",r),r.slice(0,r.l)}function j3(){}function S3(e,t,r){var n=e.l+t,s=ng(e),i=e.read_shift(1),l=[s];if(l[2]=i,r.cellFormula){var o=f_(e,n-e.l,r);l[1]=o}else e.l=n;return l}function _3(e,t,r){var n=e.l+t,s=js(e),i=[s];if(r.cellFormula){var l=x_(e,n-e.l,r);i[1]=l,e.l=n}else e.l=n;return i}function E3(e,t,r){r==null&&(r=J(18));var n=$o(e,t);r.write_shift(-4,e),r.write_shift(-4,e),r.write_shift(4,(n.width||10)*256),r.write_shift(4,0);var s=0;return t.hidden&&(s|=1),typeof n.width=="number"&&(s|=2),t.level&&(s|=t.level<<8),r.write_shift(2,s),r}var Ug=["left","right","top","bottom","header","footer"];function T3(e){var t={};return Ug.forEach(function(r){t[r]=wa(e)}),t}function C3(e,t){return t==null&&(t=J(6*8)),Mg(e),Ug.forEach(function(r){xs(e[r],t)}),t}function k3(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function A3(e,t,r){r==null&&(r=J(30));var n=924;return(((t||{}).Views||[])[0]||{}).RTL&&(n|=32),r.write_shift(2,n),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function F3(e){var t=J(24);return t.write_shift(4,4),t.write_shift(4,1),ya(e,t),t}function O3(e,t){return t==null&&(t=J(16*4+2)),t.write_shift(2,e.password?bg(e.password):0),t.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?t.write_shift(4,e[r[0]]!=null&&!e[r[0]]?1:0):t.write_shift(4,e[r[0]]!=null&&e[r[0]]?0:1)}),t}function P3(){}function R3(){}function I3(e,t,r,n,s,i,l){if(t.v===void 0)return!1;var o="";switch(t.t){case"b":o=t.v?"1":"0";break;case"d":t=qt(t),t.z=t.z||nt[14],t.v=Jt(Ut(t.v)),t.t="n";break;case"n":case"e":o=""+t.v;break;default:o=t.v;break}var c={r,c:n};switch(c.s=Kn(s.cellXfs,t,s),t.l&&i["!links"].push([Le(c),t.l]),t.c&&i["!comments"].push([Le(c),t.c]),t.t){case"s":case"str":return s.bookSST?(o=Q0(s.Strings,t.v,s.revStrings),c.t="s",c.v=o,l?re(e,18,e3(t,c)):re(e,7,Q_(t,c))):(c.t="str",l?re(e,17,h3(t,c)):re(e,6,d3(t,c))),!0;case"n":return t.v==(t.v|0)&&t.v>-1e3&&t.v<1e3?l?re(e,13,o3(t,c)):re(e,2,i3(t,c)):l?re(e,16,s3(t,c)):re(e,5,r3(t,c)),!0;case"b":return c.t="b",l?re(e,15,G_(t,c)):re(e,4,H_(t,c)),!0;case"e":return c.t="e",l?re(e,14,J_(t,c)):re(e,3,K_(t,c)),!0}return l?re(e,12,$_(t,c)):re(e,1,U_(t,c)),!0}function D3(e,t,r,n){var s=Xe(t["!ref"]||"A1"),i,l="",o=[];re(e,145);var c=Array.isArray(t),d=s.e.r;t["!rows"]&&(d=Math.max(s.e.r,t["!rows"].length-1));for(var u=s.s.r;u<=d;++u){l=Et(u),P_(e,t,s,u);var f=!1;if(u<=s.e.r)for(var h=s.s.c;h<=s.e.c;++h){u===s.s.r&&(o[h]=Pt(h)),i=o[h]+l;var m=c?(t[u]||[])[h]:t[i];if(!m){f=!1;continue}f=I3(e,m,u,h,n,t,f)}}re(e,146)}function L3(e,t){!t||!t["!merges"]||(re(e,177,w3(t["!merges"].length)),t["!merges"].forEach(function(r){re(e,176,y3(r))}),re(e,178))}function M3(e,t){!t||!t["!cols"]||(re(e,390),t["!cols"].forEach(function(r,n){r&&re(e,60,E3(n,r))}),re(e,391))}function B3(e,t){!t||!t["!ref"]||(re(e,648),re(e,649,F3(Xe(t["!ref"]))),re(e,650))}function U3(e,t,r){t["!links"].forEach(function(n){if(n[1].Target){var s=Re(r,-1,n[1].Target.replace(/#.*$/,""),Fe.HLINK);re(e,494,N3(n,s))}}),delete t["!links"]}function z3(e,t,r,n){if(t["!comments"].length>0){var s=Re(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",Fe.VML);re(e,551,G0("rId"+s)),t["!legacy"]=s}}function $3(e,t,r,n){if(t["!autofilter"]){var s=t["!autofilter"],i=typeof s.ref=="string"?s.ref:ot(s.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var l=r.Workbook.Names,o=lr(i);o.s.r==o.e.r&&(o.e.r=lr(t["!ref"]).e.r,i=ot(o));for(var c=0;c<l.length;++c){var d=l[c];if(d.Name=="_xlnm._FilterDatabase"&&d.Sheet==n){d.Ref="'"+r.SheetNames[n]+"'!"+i;break}}c==l.length&&l.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+i}),re(e,161,ya(Xe(i))),re(e,162)}}function W3(e,t,r){re(e,133),re(e,137,A3(t,r)),re(e,138),re(e,134)}function H3(e,t){t["!protect"]&&re(e,535,O3(t["!protect"]))}function V3(e,t,r,n){var s=Kt(),i=r.SheetNames[e],l=r.Sheets[i]||{},o=i;try{r&&r.Workbook&&(o=r.Workbook.Sheets[e].CodeName||o)}catch{}var c=Xe(l["!ref"]||"A1");if(c.e.c>16383||c.e.r>1048575){if(t.WTF)throw new Error("Range "+(l["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");c.e.c=Math.min(c.e.c,16383),c.e.r=Math.min(c.e.c,1048575)}return l["!links"]=[],l["!comments"]=[],re(s,129),(r.vbaraw||l["!outline"])&&re(s,147,M_(o,l["!outline"])),re(s,148,I_(c)),W3(s,l,r.Workbook),M3(s,l),D3(s,l,e,t),H3(s,l),$3(s,l,r,e),L3(s,l),U3(s,l,n),l["!margins"]&&re(s,476,C3(l["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&B3(s,l),z3(s,l,e,n),re(s,130),s.end()}function G3(e,t){e.l+=10;var r=Rt(e);return{name:r}}var X3=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]];function K3(e){return!e.Workbook||!e.Workbook.WBProps?"false":_N(e.Workbook.WBProps.date1904)?"true":"false"}var Y3="][*?/\\".split("");function zg(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return Y3.forEach(function(n){if(e.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function J3(e,t,r){e.forEach(function(n,s){zg(n);for(var i=0;i<s;++i)if(n==e[i])throw new Error("Duplicate Sheet Name: "+n);if(r){var l=t&&t[s]&&t[s].CodeName||n;if(l.charCodeAt(0)==95&&l.length>22)throw new Error("Bad Code Name: Worksheet"+l)}})}function q3(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t=e.Workbook&&e.Workbook.Sheets||[];J3(e.SheetNames,t,!!e.vbaraw);for(var r=0;r<e.SheetNames.length;++r)y_(e.Sheets[e.SheetNames[r]],e.SheetNames[r],r)}function $g(e){var t=[ct];t[t.length]=de("workbook",null,{xmlns:ga[0],"xmlns:r":mt.r});var r=e.Workbook&&(e.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(X3.forEach(function(o){e.Workbook.WBProps[o[0]]!=null&&e.Workbook.WBProps[o[0]]!=o[1]&&(n[o[0]]=e.Workbook.WBProps[o[0]])}),e.Workbook.WBProps.CodeName&&(n.codeName=e.Workbook.WBProps.CodeName,delete n.CodeName)),t[t.length]=de("workbookPr",null,n);var s=e.Workbook&&e.Workbook.Sheets||[],i=0;if(s&&s[0]&&s[0].Hidden){for(t[t.length]="<bookViews>",i=0;i!=e.SheetNames.length&&!(!s[i]||!s[i].Hidden);++i);i==e.SheetNames.length&&(i=0),t[t.length]='<workbookView firstSheet="'+i+'" activeTab="'+i+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",i=0;i!=e.SheetNames.length;++i){var l={name:Ie(e.SheetNames[i].slice(0,31))};if(l.sheetId=""+(i+1),l["r:id"]="rId"+(i+1),s[i])switch(s[i].Hidden){case 1:l.state="hidden";break;case 2:l.state="veryHidden";break}t[t.length]=de("sheet",null,l)}return t[t.length]="</sheets>",r&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(o){var c={name:o.Name};o.Comment&&(c.comment=o.Comment),o.Sheet!=null&&(c.localSheetId=""+o.Sheet),o.Hidden&&(c.hidden="1"),o.Ref&&(t[t.length]=de("definedName",Ie(o.Ref),c))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function Q3(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=Pu(e),r.name=Rt(e),r}function Z3(e,t){return t||(t=J(127)),t.write_shift(4,e.Hidden),t.write_shift(4,e.iTabID),G0(e.strRelID,t),gt(e.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function eE(e,t){var r={},n=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var s=t>8?Rt(e):"";return s.length>0&&(r.CodeName=s),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function tE(e,t){t||(t=J(72));var r=0;return e&&e.filterPrivacy&&(r|=8),t.write_shift(4,r),t.write_shift(4,0),eg(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}function rE(e,t,r){var n=e.l+t;e.l+=4,e.l+=1;var s=e.read_shift(4),i=KN(e),l=h_(e,0,r),o=V0(e);e.l=n;var c={Name:i,Ptg:l};return s<268435455&&(c.Sheet=s),o&&(c.Comment=o),c}function nE(e,t){re(e,143);for(var r=0;r!=t.SheetNames.length;++r){var n=t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[r]&&t.Workbook.Sheets[r].Hidden||0,s={Hidden:n,iTabID:r+1,strRelID:"rId"+(r+1),name:t.SheetNames[r]};re(e,156,Z3(s))}re(e,144)}function sE(e,t){t||(t=J(127));for(var r=0;r!=4;++r)t.write_shift(4,0);return gt("SheetJS",t),gt(Zl.version,t),gt(Zl.version,t),gt("7262",t),t.length>t.l?t.slice(0,t.l):t}function aE(e,t){t||(t=J(29)),t.write_shift(-4,0),t.write_shift(-4,460),t.write_shift(4,28800),t.write_shift(4,17600),t.write_shift(4,500),t.write_shift(4,e),t.write_shift(4,e);var r=120;return t.write_shift(1,r),t.length>t.l?t.slice(0,t.l):t}function iE(e,t){if(!(!t.Workbook||!t.Workbook.Sheets)){for(var r=t.Workbook.Sheets,n=0,s=-1,i=-1;n<r.length;++n)!r[n]||!r[n].Hidden&&s==-1?s=n:r[n].Hidden==1&&i==-1&&(i=n);i>s||(re(e,135),re(e,158,aE(s)),re(e,136))}}function lE(e,t){var r=Kt();return re(r,131),re(r,128,sE()),re(r,153,tE(e.Workbook&&e.Workbook.WBProps||null)),iE(r,e),nE(r,e),re(r,132),r.end()}function oE(e,t,r){return(t.slice(-4)===".bin"?lE:$g)(e)}function cE(e,t,r,n,s){return(t.slice(-4)===".bin"?V3:Bg)(e,r,n,s)}function uE(e,t,r){return(t.slice(-4)===".bin"?Cj:Sg)(e,r)}function dE(e,t,r){return(t.slice(-4)===".bin"?tj:wg)(e,r)}function fE(e,t,r){return(t.slice(-4)===".bin"?Hj:kg)(e)}function hE(e){return(e.slice(-4)===".bin"?Dj:Tg)()}function xE(e,t){var r=[];return e.Props&&r.push(u4(e.Props,t)),e.Custprops&&r.push(d4(e.Props,e.Custprops)),r.join("")}function mE(){return""}function pE(e,t){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(n,s){var i=[];i.push(de("NumberFormat",null,{"ss:Format":Ie(nt[n.numFmtId])}));var l={"ss:ID":"s"+(21+s)};r.push(de("Style",i.join(""),l))}),de("Styles",r.join(""))}function Wg(e){return de("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+J0(e.Ref,{r:0,c:0})})}function gE(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,r=[],n=0;n<t.length;++n){var s=t[n];s.Sheet==null&&(s.Name.match(/^_xlfn\./)||r.push(Wg(s)))}return de("Names",r.join(""))}function vE(e,t,r,n){if(!e||!((n||{}).Workbook||{}).Names)return"";for(var s=n.Workbook.Names,i=[],l=0;l<s.length;++l){var o=s[l];o.Sheet==r&&(o.Name.match(/^_xlfn\./)||i.push(Wg(o)))}return i.join("")}function yE(e,t,r,n){if(!e)return"";var s=[];if(e["!margins"]&&(s.push("<PageSetup>"),e["!margins"].header&&s.push(de("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&s.push(de("Footer",null,{"x:Margin":e["!margins"].footer})),s.push(de("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),s.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[r])if(n.Workbook.Sheets[r].Hidden)s.push(de("Visible",n.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var i=0;i<r&&!(n.Workbook.Sheets[i]&&!n.Workbook.Sheets[i].Hidden);++i);i==r&&s.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&s.push("<DisplayRightToLeft/>"),e["!protect"]&&(s.push(St("ProtectContents","True")),e["!protect"].objects&&s.push(St("ProtectObjects","True")),e["!protect"].scenarios&&s.push(St("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?s.push(St("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&s.push(St("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(l){e["!protect"][l[0]]&&s.push("<"+l[1]+"/>")})),s.length==0?"":de("WorksheetOptions",s.join(""),{xmlns:tr.x})}function wE(e){return e.map(function(t){var r=SN(t.t||""),n=de("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return de("Comment",n,{"ss:Author":t.a})}).join("")}function bE(e,t,r,n,s,i,l){if(!e||e.v==null&&e.f==null)return"";var o={};if(e.f&&(o["ss:Formula"]="="+Ie(J0(e.f,l))),e.F&&e.F.slice(0,t.length)==t){var c=pt(e.F.slice(t.length+1));o["ss:ArrayRange"]="RC:R"+(c.r==l.r?"":"["+(c.r-l.r)+"]")+"C"+(c.c==l.c?"":"["+(c.c-l.c)+"]")}if(e.l&&e.l.Target&&(o["ss:HRef"]=Ie(e.l.Target),e.l.Tooltip&&(o["x:HRefScreenTip"]=Ie(e.l.Tooltip))),r["!merges"])for(var d=r["!merges"],u=0;u!=d.length;++u)d[u].s.c!=l.c||d[u].s.r!=l.r||(d[u].e.c>d[u].s.c&&(o["ss:MergeAcross"]=d[u].e.c-d[u].s.c),d[u].e.r>d[u].s.r&&(o["ss:MergeDown"]=d[u].e.r-d[u].s.r));var f="",h="";switch(e.t){case"z":if(!n.sheetStubs)return"";break;case"n":f="Number",h=String(e.v);break;case"b":f="Boolean",h=e.v?"1":"0";break;case"e":f="Error",h=Mi[e.v];break;case"d":f="DateTime",h=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||nt[14]);break;case"s":f="String",h=jN(e.v||"");break}var m=Kn(n.cellXfs,e,n);o["ss:StyleID"]="s"+(21+m),o["ss:Index"]=l.c+1;var p=e.v!=null?h:"",x=e.t=="z"?"":'<Data ss:Type="'+f+'">'+p+"</Data>";return(e.c||[]).length>0&&(x+=wE(e.c)),de("Cell",x,o)}function NE(e,t){var r='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=jg(t.hpt)),t.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(r+=' ss:Hidden="1"')),r+">"}function jE(e,t,r,n){if(!e["!ref"])return"";var s=Xe(e["!ref"]),i=e["!merges"]||[],l=0,o=[];e["!cols"]&&e["!cols"].forEach(function(v,y){K0(v);var g=!!v.width,w=$o(y,v),b={"ss:Index":y+1};g&&(b["ss:Width"]=co(w.width)),v.hidden&&(b["ss:Hidden"]="1"),o.push(de("Column",null,b))});for(var c=Array.isArray(e),d=s.s.r;d<=s.e.r;++d){for(var u=[NE(d,(e["!rows"]||[])[d])],f=s.s.c;f<=s.e.c;++f){var h=!1;for(l=0;l!=i.length;++l)if(!(i[l].s.c>f)&&!(i[l].s.r>d)&&!(i[l].e.c<f)&&!(i[l].e.r<d)){(i[l].s.c!=f||i[l].s.r!=d)&&(h=!0);break}if(!h){var m={r:d,c:f},p=Le(m),x=c?(e[d]||[])[f]:e[p];u.push(bE(x,p,e,t,r,n,m))}}u.push("</Row>"),u.length>2&&o.push(u.join(""))}return o.join("")}function SE(e,t,r){var n=[],s=r.SheetNames[e],i=r.Sheets[s],l=i?vE(i,t,e,r):"";return l.length>0&&n.push("<Names>"+l+"</Names>"),l=i?jE(i,t,e,r):"",l.length>0&&n.push("<Table>"+l+"</Table>"),n.push(yE(i,t,e,r)),n.join("")}function _E(e,t){t||(t={}),e.SSF||(e.SSF=qt(nt)),e.SSF&&(Lo(),Do(e.SSF),t.revssf=Mo(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],Kn(t.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(xE(e,t)),r.push(mE()),r.push(""),r.push("");for(var n=0;n<e.SheetNames.length;++n)r.push(de("Worksheet",SE(n,t,e),{"ss:Name":Ie(e.SheetNames[n])}));return r[2]=pE(e,t),r[3]=gE(e),ct+de("Workbook",r.join(""),{xmlns:tr.ss,"xmlns:o":tr.o,"xmlns:x":tr.x,"xmlns:ss":tr.ss,"xmlns:dt":tr.dt,"xmlns:html":tr.html})}var Cc={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function EE(e,t){var r=[],n=[],s=[],i=0,l,o=Yf(oh,"n"),c=Yf(ch,"n");if(e.Props)for(l=Ct(e.Props),i=0;i<l.length;++i)(Object.prototype.hasOwnProperty.call(o,l[i])?r:Object.prototype.hasOwnProperty.call(c,l[i])?n:s).push([l[i],e.Props[l[i]]]);if(e.Custprops)for(l=Ct(e.Custprops),i=0;i<l.length;++i)Object.prototype.hasOwnProperty.call(e.Props||{},l[i])||(Object.prototype.hasOwnProperty.call(o,l[i])?r:Object.prototype.hasOwnProperty.call(c,l[i])?n:s).push([l[i],e.Custprops[l[i]]]);var d=[];for(i=0;i<s.length;++i)hg.indexOf(s[i][0])>-1||ug.indexOf(s[i][0])>-1||s[i][1]!=null&&d.push(s[i]);n.length&&Be.utils.cfb_add(t,"/SummaryInformation",xh(n,Cc.SI,c,ch)),(r.length||d.length)&&Be.utils.cfb_add(t,"/DocumentSummaryInformation",xh(r,Cc.DSI,o,oh,d.length?d:null,Cc.UDI))}function TE(e,t){var r=t||{},n=Be.utils.cfb_new({root:"R"}),s="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":s="/Workbook",r.biff=8;break;case"biff5":s="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return Be.utils.cfb_add(n,s,Hg(e,r)),r.biff==8&&(e.Props||e.Custprops)&&EE(e,n),r.biff==8&&e.vbaraw&&Vj(n,Be.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),n}var CE={0:{f:F_},1:{f:B_},2:{f:a3},3:{f:X_},4:{f:W_},5:{f:t3},6:{f:u3},7:{f:q_},8:{f:g3},9:{f:p3},10:{f:x3},11:{f:m3},12:{f:z_},13:{f:l3},14:{f:Y_},15:{f:V_},16:{f:n3},17:{f:f3},18:{f:Z_},19:{f:H0},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:rE},40:{},42:{},43:{f:uj},44:{f:oj},45:{f:hj},46:{f:mj},47:{f:xj},48:{},49:{f:zN},50:{},51:{f:Fj},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:$4},62:{f:c3},63:{f:Lj},64:{f:P3},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Hr,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:k3},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:L_},148:{f:R_,p:16},151:{f:j3},152:{},153:{f:eE},154:{},155:{},156:{f:Q3},157:{},158:{},159:{T:1,f:Q4},160:{T:-1},161:{T:1,f:js},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:v3},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:kj},336:{T:-1},337:{f:Rj,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Pu},357:{},358:{},359:{},360:{T:1},361:{},362:{f:D4},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:S3},427:{f:_3},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:T3},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:D_},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:b3},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Pu},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:$j},633:{T:1},634:{T:-1},635:{T:1,f:Uj},636:{T:-1},637:{f:VN},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:G3},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:R3},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}};function fe(e,t,r,n){var s=t;if(!isNaN(s)){var i=n||(r||[]).length||0,l=e.next(4);l.write_shift(2,s),l.write_shift(2,i),i>0&&z0(r)&&e.push(r)}}function kE(e,t,r,n){var s=(r||[]).length||0;if(s<=8224)return fe(e,t,r,s);var i=t;if(!isNaN(i)){for(var l=r.parts||[],o=0,c=0,d=0;d+(l[o]||8224)<=8224;)d+=l[o]||8224,o++;var u=e.next(4);for(u.write_shift(2,i),u.write_shift(2,d),e.push(r.slice(c,c+d)),c+=d;c<s;){for(u=e.next(4),u.write_shift(2,60),d=0;d+(l[o]||8224)<=8224;)d+=l[o]||8224,o++;u.write_shift(2,d),e.push(r.slice(c,c+d)),c+=d}}}function Ui(e,t,r){return e||(e=J(7)),e.write_shift(2,t),e.write_shift(2,r),e.write_shift(2,0),e.write_shift(1,0),e}function AE(e,t,r,n){var s=J(9);return Ui(s,e,t),mg(r,n||"b",s),s}function FE(e,t,r){var n=J(8+2*r.length);return Ui(n,e,t),n.write_shift(1,r.length),n.write_shift(r.length,r,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function OE(e,t,r,n){if(t.v!=null)switch(t.t){case"d":case"n":var s=t.t=="d"?Jt(Ut(t.v)):t.v;s==(s|0)&&s>=0&&s<65536?fe(e,2,G4(r,n,s)):fe(e,3,V4(r,n,s));return;case"b":case"e":fe(e,5,AE(r,n,t.v,t.t));return;case"s":case"str":fe(e,4,FE(r,n,(t.v||"").slice(0,255)));return}fe(e,1,Ui(null,r,n))}function PE(e,t,r,n){var s=Array.isArray(t),i=Xe(t["!ref"]||"A1"),l,o="",c=[];if(i.e.c>255||i.e.r>16383){if(n.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");i.e.c=Math.min(i.e.c,255),i.e.r=Math.min(i.e.c,16383),l=ot(i)}for(var d=i.s.r;d<=i.e.r;++d){o=Et(d);for(var u=i.s.c;u<=i.e.c;++u){d===i.s.r&&(c[u]=Pt(u)),l=c[u]+o;var f=s?(t[d]||[])[u]:t[l];f&&OE(e,f,d,u)}}}function RE(e,t){for(var r=t||{},n=Kt(),s=0,i=0;i<e.SheetNames.length;++i)e.SheetNames[i]==r.sheet&&(s=i);if(s==0&&r.sheet&&e.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return fe(n,r.biff==4?1033:r.biff==3?521:9,X0(e,16,r)),PE(n,e.Sheets[e.SheetNames[s]],s,r),fe(n,10),n.end()}function IE(e,t,r){fe(e,49,C4({sz:12,name:"Arial"},r))}function DE(e,t,r){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var s=n[0];s<=n[1];++s)t[s]!=null&&fe(e,1054,F4(s,t[s],r))})}function LE(e,t){var r=J(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),fe(e,2151,r),r=J(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),vg(Xe(t["!ref"]||"A1"),r),r.write_shift(4,4),fe(e,2152,r)}function ME(e,t){for(var r=0;r<16;++r)fe(e,224,ph({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(n){fe(e,224,ph(n,0,t))})}function BE(e,t){for(var r=0;r<t["!links"].length;++r){var n=t["!links"][r];fe(e,440,B4(n)),n[1].Tooltip&&fe(e,2048,U4(n))}delete t["!links"]}function UE(e,t){if(t){var r=0;t.forEach(function(n,s){++r<=256&&n&&fe(e,125,W4($o(s,n),s))})}}function zE(e,t,r,n,s){var i=16+Kn(s.cellXfs,t,s);if(t.v==null&&!t.bf){fe(e,513,ms(r,n,i));return}if(t.bf)fe(e,6,d_(t,r,n,s,i));else switch(t.t){case"d":case"n":var l=t.t=="d"?Jt(Ut(t.v)):t.v;fe(e,515,I4(r,n,l,i));break;case"b":case"e":fe(e,517,R4(r,n,t.v,i,s,t.t));break;case"s":case"str":if(s.bookSST){var o=Q0(s.Strings,t.v,s.revStrings);fe(e,253,k4(r,n,o,i))}else fe(e,516,A4(r,n,(t.v||"").slice(0,255),i,s));break;default:fe(e,513,ms(r,n,i))}}function $E(e,t,r){var n=Kt(),s=r.SheetNames[e],i=r.Sheets[s]||{},l=(r||{}).Workbook||{},o=(l.Sheets||[])[e]||{},c=Array.isArray(i),d=t.biff==8,u,f="",h=[],m=Xe(i["!ref"]||"A1"),p=d?65536:16384;if(m.e.c>255||m.e.r>=p){if(t.WTF)throw new Error("Range "+(i["!ref"]||"A1")+" exceeds format limit A1:IV16384");m.e.c=Math.min(m.e.c,255),m.e.r=Math.min(m.e.c,p-1)}fe(n,2057,X0(r,16,t)),fe(n,13,dr(1)),fe(n,12,dr(100)),fe(n,15,Mt(!0)),fe(n,17,Mt(!1)),fe(n,16,xs(.001)),fe(n,95,Mt(!0)),fe(n,42,Mt(!1)),fe(n,43,Mt(!1)),fe(n,130,dr(1)),fe(n,128,P4()),fe(n,131,Mt(!1)),fe(n,132,Mt(!1)),d&&UE(n,i["!cols"]),fe(n,512,O4(m,t)),d&&(i["!links"]=[]);for(var x=m.s.r;x<=m.e.r;++x){f=Et(x);for(var v=m.s.c;v<=m.e.c;++v){x===m.s.r&&(h[v]=Pt(v)),u=h[v]+f;var y=c?(i[x]||[])[v]:i[u];y&&(zE(n,y,x,v,t),d&&y.l&&i["!links"].push([u,y.l]))}}var g=o.CodeName||o.name||s;return d&&fe(n,574,T4((l.Views||[])[0])),d&&(i["!merges"]||[]).length&&fe(n,229,M4(i["!merges"])),d&&BE(n,i),fe(n,442,gg(g)),d&&LE(n,i),fe(n,10),n.end()}function WE(e,t,r){var n=Kt(),s=(e||{}).Workbook||{},i=s.Sheets||[],l=s.WBProps||{},o=r.biff==8,c=r.biff==5;if(fe(n,2057,X0(e,5,r)),r.bookType=="xla"&&fe(n,135),fe(n,225,o?dr(1200):null),fe(n,193,x4(2)),c&&fe(n,191),c&&fe(n,192),fe(n,226),fe(n,92,j4("SheetJS",r)),fe(n,66,dr(o?1200:1252)),o&&fe(n,353,dr(0)),o&&fe(n,448),fe(n,317,H4(e.SheetNames.length)),o&&e.vbaraw&&fe(n,211),o&&e.vbaraw){var d=l.CodeName||"ThisWorkbook";fe(n,442,gg(d))}fe(n,156,dr(17)),fe(n,25,Mt(!1)),fe(n,18,Mt(!1)),fe(n,19,dr(0)),o&&fe(n,431,Mt(!1)),o&&fe(n,444,dr(0)),fe(n,61,E4()),fe(n,64,Mt(!1)),fe(n,141,dr(0)),fe(n,34,Mt(K3(e)=="true")),fe(n,14,Mt(!0)),o&&fe(n,439,Mt(!1)),fe(n,218,dr(0)),IE(n,e,r),DE(n,e.SSF,r),ME(n,r),o&&fe(n,352,Mt(!1));var u=n.end(),f=Kt();o&&fe(f,140,z4()),o&&r.Strings&&kE(f,252,_4(r.Strings)),fe(f,10);var h=f.end(),m=Kt(),p=0,x=0;for(x=0;x<e.SheetNames.length;++x)p+=(o?12:11)+(o?2:1)*e.SheetNames[x].length;var v=u.length+p+h.length;for(x=0;x<e.SheetNames.length;++x){var y=i[x]||{};fe(m,133,S4({pos:v,hs:y.Hidden||0,dt:0,name:e.SheetNames[x]},r)),v+=t[x].length}var g=m.end();if(p!=g.length)throw new Error("BS8 "+p+" != "+g.length);var w=[];return u.length&&w.push(u),g.length&&w.push(g),h.length&&w.push(h),jt(w)}function HE(e,t){var r=t||{},n=[];e&&!e.SSF&&(e.SSF=qt(nt)),e&&e.SSF&&(Lo(),Do(e.SSF),r.revssf=Mo(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,Z0(r),r.cellXfs=[],Kn(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var s=0;s<e.SheetNames.length;++s)n[n.length]=$E(s,r,e);return n.unshift(WE(e,n,r)),jt(n)}function Hg(e,t){for(var r=0;r<=e.SheetNames.length;++r){var n=e.Sheets[e.SheetNames[r]];if(!(!n||!n["!ref"])){var s=lr(n["!ref"]);s.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var i=t||{};switch(i.biff||2){case 8:case 5:return HE(e,t);case 4:case 3:case 2:return RE(e,t)}throw new Error("invalid type "+i.bookType+" for BIFF")}function VE(e,t,r,n){for(var s=e["!merges"]||[],i=[],l=t.s.c;l<=t.e.c;++l){for(var o=0,c=0,d=0;d<s.length;++d)if(!(s[d].s.r>r||s[d].s.c>l)&&!(s[d].e.r<r||s[d].e.c<l)){if(s[d].s.r<r||s[d].s.c<l){o=-1;break}o=s[d].e.r-s[d].s.r+1,c=s[d].e.c-s[d].s.c+1;break}if(!(o<0)){var u=Le({r,c:l}),f=n.dense?(e[r]||[])[l]:e[u],h=f&&f.v!=null&&(f.h||NN(f.w||(dn(f),f.w)||""))||"",m={};o>1&&(m.rowspan=o),c>1&&(m.colspan=c),n.editable?h='<span contenteditable="true">'+h+"</span>":f&&(m["data-t"]=f&&f.t||"z",f.v!=null&&(m["data-v"]=f.v),f.z!=null&&(m["data-z"]=f.z),f.l&&(f.l.Target||"#").charAt(0)!="#"&&(h='<a href="'+f.l.Target+'">'+h+"</a>")),m.id=(n.id||"sjs")+"-"+u,i.push(de("td",h,m))}}var p="<tr>";return p+i.join("")+"</tr>"}var GE='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',XE="</body></html>";function KE(e,t,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function Vg(e,t){var r=t||{},n=r.header!=null?r.header:GE,s=r.footer!=null?r.footer:XE,i=[n],l=lr(e["!ref"]);r.dense=Array.isArray(e),i.push(KE(e,l,r));for(var o=l.s.r;o<=l.e.r;++o)i.push(VE(e,l,o,r));return i.push("</table>"+s),i.join("")}function Gg(e,t,r){var n=r||{},s=0,i=0;if(n.origin!=null)if(typeof n.origin=="number")s=n.origin;else{var l=typeof n.origin=="string"?pt(n.origin):n.origin;s=l.r,i=l.c}var o=t.getElementsByTagName("tr"),c=Math.min(n.sheetRows||1e7,o.length),d={s:{r:0,c:0},e:{r:s,c:i}};if(e["!ref"]){var u=lr(e["!ref"]);d.s.r=Math.min(d.s.r,u.s.r),d.s.c=Math.min(d.s.c,u.s.c),d.e.r=Math.max(d.e.r,u.e.r),d.e.c=Math.max(d.e.c,u.e.c),s==-1&&(d.e.r=s=u.e.r+1)}var f=[],h=0,m=e["!rows"]||(e["!rows"]=[]),p=0,x=0,v=0,y=0,g=0,w=0;for(e["!cols"]||(e["!cols"]=[]);p<o.length&&x<c;++p){var b=o[p];if(jh(b)){if(n.display)continue;m[x]={hidden:!0}}var P=b.children;for(v=y=0;v<P.length;++v){var L=P[v];if(!(n.display&&jh(L))){var E=L.hasAttribute("data-v")?L.getAttribute("data-v"):L.hasAttribute("v")?L.getAttribute("v"):EN(L.innerHTML),I=L.getAttribute("data-z")||L.getAttribute("z");for(h=0;h<f.length;++h){var S=f[h];S.s.c==y+i&&S.s.r<x+s&&x+s<=S.e.r&&(y=S.e.c+1-i,h=-1)}w=+L.getAttribute("colspan")||1,((g=+L.getAttribute("rowspan")||1)>1||w>1)&&f.push({s:{r:x+s,c:y+i},e:{r:x+s+(g||1)-1,c:y+i+(w||1)-1}});var R={t:"s",v:E},U=L.getAttribute("data-t")||L.getAttribute("t")||"";E!=null&&(E.length==0?R.t=U||"z":n.raw||E.trim().length==0||U=="s"||(E==="TRUE"?R={t:"b",v:!0}:E==="FALSE"?R={t:"b",v:!1}:isNaN(nn(E))?isNaN(Si(E).getDate())||(R={t:"d",v:Ut(E)},n.cellDates||(R={t:"n",v:Jt(R.v)}),R.z=n.dateNF||nt[14]):R={t:"n",v:nn(E)})),R.z===void 0&&I!=null&&(R.z=I);var G="",se=L.getElementsByTagName("A");if(se&&se.length)for(var Ne=0;Ne<se.length&&!(se[Ne].hasAttribute("href")&&(G=se[Ne].getAttribute("href"),G.charAt(0)!="#"));++Ne);G&&G.charAt(0)!="#"&&(R.l={Target:G}),n.dense?(e[x+s]||(e[x+s]=[]),e[x+s][y+i]=R):e[Le({c:y+i,r:x+s})]=R,d.e.c<y+i&&(d.e.c=y+i),y+=w}}++x}return f.length&&(e["!merges"]=(e["!merges"]||[]).concat(f)),d.e.r=Math.max(d.e.r,x-1+s),e["!ref"]=ot(d),x>=c&&(e["!fullref"]=ot((d.e.r=o.length-p+x-1+s,d))),e}function Xg(e,t){var r=t||{},n=r.dense?[]:{};return Gg(n,e,t)}function YE(e,t){return ys(Xg(e,t),t)}function jh(e){var t="",r=JE(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function JE(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}var qE=function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+Ei({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return ct+t}}(),Sh=function(){var e=function(i){return Ie(i).replace(/  +/g,function(l){return'<text:s text:c="'+l.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,n=function(i,l,o){var c=[];c.push('      <table:table table:name="'+Ie(l.SheetNames[o])+`" table:style-name="ta1">
`);var d=0,u=0,f=lr(i["!ref"]||"A1"),h=i["!merges"]||[],m=0,p=Array.isArray(i);if(i["!cols"])for(u=0;u<=f.e.c;++u)c.push("        <table:table-column"+(i["!cols"][u]?' table:style-name="co'+i["!cols"][u].ods+'"':"")+`></table:table-column>
`);var x="",v=i["!rows"]||[];for(d=0;d<f.s.r;++d)x=v[d]?' table:style-name="ro'+v[d].ods+'"':"",c.push("        <table:table-row"+x+`></table:table-row>
`);for(;d<=f.e.r;++d){for(x=v[d]?' table:style-name="ro'+v[d].ods+'"':"",c.push("        <table:table-row"+x+`>
`),u=0;u<f.s.c;++u)c.push(t);for(;u<=f.e.c;++u){var y=!1,g={},w="";for(m=0;m!=h.length;++m)if(!(h[m].s.c>u)&&!(h[m].s.r>d)&&!(h[m].e.c<u)&&!(h[m].e.r<d)){(h[m].s.c!=u||h[m].s.r!=d)&&(y=!0),g["table:number-columns-spanned"]=h[m].e.c-h[m].s.c+1,g["table:number-rows-spanned"]=h[m].e.r-h[m].s.r+1;break}if(y){c.push(r);continue}var b=Le({r:d,c:u}),P=p?(i[d]||[])[u]:i[b];if(P&&P.f&&(g["table:formula"]=Ie(g_(P.f)),P.F&&P.F.slice(0,b.length)==b)){var L=lr(P.F);g["table:number-matrix-columns-spanned"]=L.e.c-L.s.c+1,g["table:number-matrix-rows-spanned"]=L.e.r-L.s.r+1}if(!P){c.push(t);continue}switch(P.t){case"b":w=P.v?"TRUE":"FALSE",g["office:value-type"]="boolean",g["office:boolean-value"]=P.v?"true":"false";break;case"n":w=P.w||String(P.v||0),g["office:value-type"]="float",g["office:value"]=P.v||0;break;case"s":case"str":w=P.v==null?"":P.v,g["office:value-type"]="string";break;case"d":w=P.w||Ut(P.v).toISOString(),g["office:value-type"]="date",g["office:date-value"]=Ut(P.v).toISOString(),g["table:style-name"]="ce1";break;default:c.push(t);continue}var E=e(w);if(P.l&&P.l.Target){var I=P.l.Target;I=I.charAt(0)=="#"?"#"+v_(I.slice(1)):I,I.charAt(0)!="#"&&!I.match(/^\w+:/)&&(I="../"+I),E=de("text:a",E,{"xlink:href":I.replace(/&/g,"&amp;")})}c.push("          "+de("table:table-cell",de("text:p",E,{}),g)+`
`)}c.push(`        </table:table-row>
`)}return c.push(`      </table:table>
`),c.join("")},s=function(i,l){i.push(` <office:automatic-styles>
`),i.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),i.push(`   <number:month number:style="long"/>
`),i.push(`   <number:text>/</number:text>
`),i.push(`   <number:day number:style="long"/>
`),i.push(`   <number:text>/</number:text>
`),i.push(`   <number:year/>
`),i.push(`  </number:date-style>
`);var o=0;l.SheetNames.map(function(d){return l.Sheets[d]}).forEach(function(d){if(d&&d["!cols"]){for(var u=0;u<d["!cols"].length;++u)if(d["!cols"][u]){var f=d["!cols"][u];if(f.width==null&&f.wpx==null&&f.wch==null)continue;K0(f),f.ods=o;var h=d["!cols"][u].wpx+"px";i.push('  <style:style style:name="co'+o+`" style:family="table-column">
`),i.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+h+`"/>
`),i.push(`  </style:style>
`),++o}}});var c=0;l.SheetNames.map(function(d){return l.Sheets[d]}).forEach(function(d){if(d&&d["!rows"]){for(var u=0;u<d["!rows"].length;++u)if(d["!rows"][u]){d["!rows"][u].ods=c;var f=d["!rows"][u].hpx+"px";i.push('  <style:style style:name="ro'+c+`" style:family="table-row">
`),i.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+f+`"/>
`),i.push(`  </style:style>
`),++c}}}),i.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),i.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),i.push(`  </style:style>
`),i.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),i.push(` </office:automatic-styles>
`)};return function(l,o){var c=[ct],d=Ei({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),u=Ei({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});o.bookType=="fods"?(c.push("<office:document"+d+u+`>
`),c.push(og().replace(/office:document-meta/g,"office:meta"))):c.push("<office:document-content"+d+`>
`),s(c,l),c.push(`  <office:body>
`),c.push(`    <office:spreadsheet>
`);for(var f=0;f!=l.SheetNames.length;++f)c.push(n(l.Sheets[l.SheetNames[f]],l,f));return c.push(`    </office:spreadsheet>
`),c.push(`  </office:body>
`),o.bookType=="fods"?c.push("</office:document>"):c.push("</office:document-content>"),c.join("")}}();function Kg(e,t){if(t.bookType=="fods")return Sh(e,t);var r=L0(),n="",s=[],i=[];return n="mimetype",Te(r,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",Te(r,n,Sh(e,t)),s.push([n,"text/xml"]),i.push([n,"ContentFile"]),n="styles.xml",Te(r,n,qE(e,t)),s.push([n,"text/xml"]),i.push([n,"StylesFile"]),n="meta.xml",Te(r,n,ct+og()),s.push([n,"text/xml"]),i.push([n,"MetadataFile"]),n="manifest.rdf",Te(r,n,c4(i)),s.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",Te(r,n,l4(s)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function ho(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function QE(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):Cr(_i(e))}function ZE(e,t){e:for(var r=0;r<=e.length-t.length;++r){for(var n=0;n<t.length;++n)if(e[r+n]!=t[n])continue e;return!0}return!1}function $n(e){var t=e.reduce(function(s,i){return s+i.length},0),r=new Uint8Array(t),n=0;return e.forEach(function(s){r.set(s,n),n+=s.length}),r}function eT(e,t,r){var n=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,s=r/Math.pow(10,n-6176);e[t+15]|=n>>7,e[t+14]|=(n&127)<<1;for(var i=0;s>=1;++i,s/=256)e[t+i]=s&255;e[t+15]|=r>=0?0:128}function Ti(e,t){var r=t?t[0]:0,n=e[r]&127;e:if(e[r++]>=128&&(n|=(e[r]&127)<<7,e[r++]<128||(n|=(e[r]&127)<<14,e[r++]<128)||(n|=(e[r]&127)<<21,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),n}function Pe(e){var t=new Uint8Array(7);t[0]=e&127;var r=1;e:if(e>127){if(t[r-1]|=128,t[r]=e>>7&127,++r,e<=16383||(t[r-1]|=128,t[r]=e>>14&127,++r,e<=2097151)||(t[r-1]|=128,t[r]=e>>21&127,++r,e<=268435455)||(t[r-1]|=128,t[r]=e/256>>>21&127,++r,e<=34359738367)||(t[r-1]|=128,t[r]=e/65536>>>21&127,++r,e<=4398046511103))break e;t[r-1]|=128,t[r]=e/16777216>>>21&127,++r}return t.slice(0,r)}function ea(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function ut(e){for(var t=[],r=[0];r[0]<e.length;){var n=r[0],s=Ti(e,r),i=s&7;s=Math.floor(s/8);var l=0,o;if(s==0)break;switch(i){case 0:{for(var c=r[0];e[r[0]++]>=128;);o=e.slice(c,r[0])}break;case 5:l=4,o=e.slice(r[0],r[0]+l),r[0]+=l;break;case 1:l=8,o=e.slice(r[0],r[0]+l),r[0]+=l;break;case 2:l=Ti(e,r),o=e.slice(r[0],r[0]+l),r[0]+=l;break;case 3:case 4:default:throw new Error("PB Type ".concat(i," for Field ").concat(s," at offset ").concat(n))}var d={data:o,type:i};t[s]==null?t[s]=[d]:t[s].push(d)}return t}function wt(e){var t=[];return e.forEach(function(r,n){r.forEach(function(s){s.data&&(t.push(Pe(n*8+s.type)),s.type==2&&t.push(Pe(s.data.length)),t.push(s.data))})}),$n(t)}function jr(e){for(var t,r=[],n=[0];n[0]<e.length;){var s=Ti(e,n),i=ut(e.slice(n[0],n[0]+s));n[0]+=s;var l={id:ea(i[1][0].data),messages:[]};i[2].forEach(function(o){var c=ut(o.data),d=ea(c[3][0].data);l.messages.push({meta:c,data:e.slice(n[0],n[0]+d)}),n[0]+=d}),(t=i[3])!=null&&t[0]&&(l.merge=ea(i[3][0].data)>>>0>0),r.push(l)}return r}function Ts(e){var t=[];return e.forEach(function(r){var n=[];n[1]=[{data:Pe(r.id),type:0}],n[2]=[],r.merge!=null&&(n[3]=[{data:Pe(+!!r.merge),type:0}]);var s=[];r.messages.forEach(function(l){s.push(l.data),l.meta[3]=[{type:0,data:Pe(l.data.length)}],n[2].push({data:wt(l.meta),type:2})});var i=wt(n);t.push(Pe(i.length)),t.push(i),s.forEach(function(l){return t.push(l)})}),$n(t)}function tT(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],n=Ti(t,r),s=[];r[0]<t.length;){var i=t[r[0]]&3;if(i==0){var l=t[r[0]++]>>2;if(l<60)++l;else{var o=l-59;l=t[r[0]],o>1&&(l|=t[r[0]+1]<<8),o>2&&(l|=t[r[0]+2]<<16),o>3&&(l|=t[r[0]+3]<<24),l>>>=0,l++,r[0]+=o}s.push(t.slice(r[0],r[0]+l)),r[0]+=l;continue}else{var c=0,d=0;if(i==1?(d=(t[r[0]]>>2&7)+4,c=(t[r[0]++]&224)<<3,c|=t[r[0]++]):(d=(t[r[0]++]>>2)+1,i==2?(c=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(c=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),s=[$n(s)],c==0)throw new Error("Invalid offset 0");if(c>s[0].length)throw new Error("Invalid offset beyond length");if(d>=c)for(s.push(s[0].slice(-c)),d-=c;d>=s[s.length-1].length;)s.push(s[s.length-1]),d-=s[s.length-1].length;s.push(s[0].slice(-c,-c+d))}}var u=$n(s);if(u.length!=n)throw new Error("Unexpected length: ".concat(u.length," != ").concat(n));return u}function Sr(e){for(var t=[],r=0;r<e.length;){var n=e[r++],s=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(tT(n,e.slice(r,r+s))),r+=s}if(r!==e.length)throw new Error("data is not a valid framed stream!");return $n(t)}function Cs(e){for(var t=[],r=0;r<e.length;){var n=Math.min(e.length-r,268435455),s=new Uint8Array(4);t.push(s);var i=Pe(n),l=i.length;t.push(i),n<=60?(l++,t.push(new Uint8Array([n-1<<2]))):n<=256?(l+=2,t.push(new Uint8Array([240,n-1&255]))):n<=65536?(l+=3,t.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(l+=4,t.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(l+=5,t.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),t.push(e.slice(r,r+n)),l+=n,s[0]=0,s[1]=l&255,s[2]=l>>8&255,s[3]=l>>16&255,r+=n}return $n(t)}function kc(e,t){var r=new Uint8Array(32),n=ho(r),s=12,i=0;switch(r[0]=5,e.t){case"n":r[1]=2,eT(r,s,e.v),i|=1,s+=16;break;case"b":r[1]=6,n.setFloat64(s,e.v?1:0,!0),i|=2,s+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[1]=3,n.setUint32(s,t.indexOf(e.v),!0),i|=8,s+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(8,i,!0),r.slice(0,s)}function Ac(e,t){var r=new Uint8Array(32),n=ho(r),s=12,i=0;switch(r[0]=3,e.t){case"n":r[2]=2,n.setFloat64(s,e.v,!0),i|=32,s+=8;break;case"b":r[2]=6,n.setFloat64(s,e.v?1:0,!0),i|=32,s+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[2]=3,n.setUint32(s,t.indexOf(e.v),!0),i|=16,s+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(4,i,!0),r.slice(0,s)}function vn(e){var t=ut(e);return Ti(t[1][0].data)}function rT(e,t,r){var n,s,i,l;if(!((n=e[6])!=null&&n[0])||!((s=e[7])!=null&&s[0]))throw"Mutation only works on post-BNC storages!";var o=((l=(i=e[8])==null?void 0:i[0])==null?void 0:l.data)&&ea(e[8][0].data)>0||!1;if(o)throw"Math only works with normal offsets";for(var c=0,d=ho(e[7][0].data),u=0,f=[],h=ho(e[4][0].data),m=0,p=[],x=0;x<t.length;++x){if(t[x]==null){d.setUint16(x*2,65535,!0),h.setUint16(x*2,65535);continue}d.setUint16(x*2,u,!0),h.setUint16(x*2,m,!0);var v,y;switch(typeof t[x]){case"string":v=kc({t:"s",v:t[x]},r),y=Ac({t:"s",v:t[x]},r);break;case"number":v=kc({t:"n",v:t[x]},r),y=Ac({t:"n",v:t[x]},r);break;case"boolean":v=kc({t:"b",v:t[x]},r),y=Ac({t:"b",v:t[x]},r);break;default:throw new Error("Unsupported value "+t[x])}f.push(v),u+=v.length,p.push(y),m+=y.length,++c}for(e[2][0].data=Pe(c);x<e[7][0].data.length/2;++x)d.setUint16(x*2,65535,!0),h.setUint16(x*2,65535,!0);return e[6][0].data=$n(f),e[3][0].data=$n(p),c}function nT(e,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=lr(r["!ref"]);n.s.r=n.s.c=0;var s=!1;n.e.c>9&&(s=!0,n.e.c=9),n.e.r>49&&(s=!0,n.e.r=49),s&&console.error("The Numbers writer is currently limited to ".concat(ot(n)));var i=xo(r,{range:n,header:1}),l=["~Sh33tJ5~"];i.forEach(function(M){return M.forEach(function(D){typeof D=="string"&&l.push(D)})});var o={},c=[],d=Be.read(t.numbers,{type:"base64"});d.FileIndex.map(function(M,D){return[M,d.FullPaths[D]]}).forEach(function(M){var D=M[0],B=M[1];if(D.type==2&&D.name.match(/\.iwa/)){var q=D.content,W=Sr(q),Z=jr(W);Z.forEach(function(ie){c.push(ie.id),o[ie.id]={deps:[],location:B,type:ea(ie.messages[0].meta[1][0].data)}})}}),c.sort(function(M,D){return M-D});var u=c.filter(function(M){return M>1}).map(function(M){return[M,Pe(M)]});d.FileIndex.map(function(M,D){return[M,d.FullPaths[D]]}).forEach(function(M){var D=M[0];if(M[1],!!D.name.match(/\.iwa/)){var B=jr(Sr(D.content));B.forEach(function(q){q.messages.forEach(function(W){u.forEach(function(Z){q.messages.some(function(ie){return ea(ie.meta[1][0].data)!=11006&&ZE(ie.data,Z[1])})&&o[Z[0]].deps.push(q.id)})})})}});for(var f=Be.find(d,o[1].location),h=jr(Sr(f.content)),m,p=0;p<h.length;++p){var x=h[p];x.id==1&&(m=x)}var v=vn(ut(m.messages[0].data)[1][0].data);for(f=Be.find(d,o[v].location),h=jr(Sr(f.content)),p=0;p<h.length;++p)x=h[p],x.id==v&&(m=x);for(v=vn(ut(m.messages[0].data)[2][0].data),f=Be.find(d,o[v].location),h=jr(Sr(f.content)),p=0;p<h.length;++p)x=h[p],x.id==v&&(m=x);for(v=vn(ut(m.messages[0].data)[2][0].data),f=Be.find(d,o[v].location),h=jr(Sr(f.content)),p=0;p<h.length;++p)x=h[p],x.id==v&&(m=x);var y=ut(m.messages[0].data);{y[6][0].data=Pe(n.e.r+1),y[7][0].data=Pe(n.e.c+1);var g=vn(y[46][0].data),w=Be.find(d,o[g].location),b=jr(Sr(w.content));{for(var P=0;P<b.length&&b[P].id!=g;++P);if(b[P].id!=g)throw"Bad ColumnRowUIDMapArchive";var L=ut(b[P].messages[0].data);L[1]=[],L[2]=[],L[3]=[];for(var E=0;E<=n.e.c;++E){var I=[];I[1]=I[2]=[{type:0,data:Pe(E+420690)}],L[1].push({type:2,data:wt(I)}),L[2].push({type:0,data:Pe(E)}),L[3].push({type:0,data:Pe(E)})}L[4]=[],L[5]=[],L[6]=[];for(var S=0;S<=n.e.r;++S)I=[],I[1]=I[2]=[{type:0,data:Pe(S+726270)}],L[4].push({type:2,data:wt(I)}),L[5].push({type:0,data:Pe(S)}),L[6].push({type:0,data:Pe(S)});b[P].messages[0].data=wt(L)}w.content=Cs(Ts(b)),w.size=w.content.length,delete y[46];var R=ut(y[4][0].data);{R[7][0].data=Pe(n.e.r+1);var U=ut(R[1][0].data),G=vn(U[2][0].data);w=Be.find(d,o[G].location),b=jr(Sr(w.content));{if(b[0].id!=G)throw"Bad HeaderStorageBucket";var se=ut(b[0].messages[0].data);for(S=0;S<i.length;++S){var Ne=ut(se[2][0].data);Ne[1][0].data=Pe(S),Ne[4][0].data=Pe(i[S].length),se[2][S]={type:se[2][0].type,data:wt(Ne)}}b[0].messages[0].data=wt(se)}w.content=Cs(Ts(b)),w.size=w.content.length;var ae=vn(R[2][0].data);w=Be.find(d,o[ae].location),b=jr(Sr(w.content));{if(b[0].id!=ae)throw"Bad HeaderStorageBucket";for(se=ut(b[0].messages[0].data),E=0;E<=n.e.c;++E)Ne=ut(se[2][0].data),Ne[1][0].data=Pe(E),Ne[4][0].data=Pe(n.e.r+1),se[2][E]={type:se[2][0].type,data:wt(Ne)};b[0].messages[0].data=wt(se)}w.content=Cs(Ts(b)),w.size=w.content.length;var xe=vn(R[4][0].data);(function(){for(var M=Be.find(d,o[xe].location),D=jr(Sr(M.content)),B,q=0;q<D.length;++q){var W=D[q];W.id==xe&&(B=W)}var Z=ut(B.messages[0].data);{Z[3]=[];var ie=[];l.forEach(function(me,Se){ie[1]=[{type:0,data:Pe(Se)}],ie[2]=[{type:0,data:Pe(1)}],ie[3]=[{type:2,data:QE(me)}],Z[3].push({type:2,data:wt(ie)})})}B.messages[0].data=wt(Z);var ce=Ts(D),ne=Cs(ce);M.content=ne,M.size=M.content.length})();var ee=ut(R[3][0].data);{var Y=ee[1][0];delete ee[2];var F=ut(Y.data);{var K=vn(F[2][0].data);(function(){for(var M=Be.find(d,o[K].location),D=jr(Sr(M.content)),B,q=0;q<D.length;++q){var W=D[q];W.id==K&&(B=W)}var Z=ut(B.messages[0].data);{delete Z[6],delete ee[7];var ie=new Uint8Array(Z[5][0].data);Z[5]=[];for(var ce=0,ne=0;ne<=n.e.r;++ne){var me=ut(ie);ce+=rT(me,i[ne],l),me[1][0].data=Pe(ne),Z[5].push({data:wt(me),type:2})}Z[1]=[{type:0,data:Pe(n.e.c+1)}],Z[2]=[{type:0,data:Pe(n.e.r+1)}],Z[3]=[{type:0,data:Pe(ce)}],Z[4]=[{type:0,data:Pe(n.e.r+1)}]}B.messages[0].data=wt(Z);var Se=Ts(D),je=Cs(Se);M.content=je,M.size=M.content.length})()}Y.data=wt(F)}R[3][0].data=wt(ee)}y[4][0].data=wt(R)}m.messages[0].data=wt(y);var te=Ts(h),T=Cs(te);return f.content=T,f.size=f.content.length,d}function sT(e){return function(r){for(var n=0;n!=e.length;++n){var s=e[n];r[s[0]]===void 0&&(r[s[0]]=s[1]),s[2]==="n"&&(r[s[0]]=Number(r[s[0]]))}}}function Z0(e){sT([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function aT(e,t){return t.bookType=="ods"?Kg(e,t):t.bookType=="numbers"?nT(e,t):t.bookType=="xlsb"?iT(e,t):lT(e,t)}function iT(e,t){Ws=1024,e&&!e.SSF&&(e.SSF=qt(nt)),e&&e.SSF&&(Lo(),Do(e.SSF),t.revssf=Mo(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,ri?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r=t.bookType=="xlsb"?"bin":"xml",n=Ag.indexOf(t.bookType)>-1,s=ag();Z0(t=t||{});var i=L0(),l="",o=0;if(t.cellXfs=[],Kn(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),l="docProps/core.xml",Te(i,l,cg(e.Props,t)),s.coreprops.push(l),Re(t.rels,2,l,Fe.CORE_PROPS),l="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var c=[],d=0;d<e.SheetNames.length;++d)(e.Workbook.Sheets[d]||{}).Hidden!=2&&c.push(e.SheetNames[d]);e.Props.SheetNames=c}for(e.Props.Worksheets=e.Props.SheetNames.length,Te(i,l,dg(e.Props)),s.extprops.push(l),Re(t.rels,3,l,Fe.EXT_PROPS),e.Custprops!==e.Props&&Ct(e.Custprops||{}).length>0&&(l="docProps/custom.xml",Te(i,l,fg(e.Custprops)),s.custprops.push(l),Re(t.rels,4,l,Fe.CUST_PROPS)),o=1;o<=e.SheetNames.length;++o){var u={"!id":{}},f=e.Sheets[e.SheetNames[o-1]],h=(f||{})["!type"]||"sheet";switch(h){case"chart":default:l="xl/worksheets/sheet"+o+"."+r,Te(i,l,cE(o-1,l,t,e,u)),s.sheets.push(l),Re(t.wbrels,-1,"worksheets/sheet"+o+"."+r,Fe.WS[0])}if(f){var m=f["!comments"],p=!1,x="";m&&m.length>0&&(x="xl/comments"+o+"."+r,Te(i,x,fE(m,x)),s.comments.push(x),Re(u,-1,"../comments"+o+"."+r,Fe.CMNT),p=!0),f["!legacy"]&&p&&Te(i,"xl/drawings/vmlDrawing"+o+".vml",Cg(o,f["!comments"])),delete f["!comments"],delete f["!legacy"]}u["!id"].rId1&&Te(i,lg(l),Qs(u))}return t.Strings!=null&&t.Strings.length>0&&(l="xl/sharedStrings."+r,Te(i,l,dE(t.Strings,l,t)),s.strs.push(l),Re(t.wbrels,-1,"sharedStrings."+r,Fe.SST)),l="xl/workbook."+r,Te(i,l,oE(e,l)),s.workbooks.push(l),Re(t.rels,1,l,Fe.WB),l="xl/theme/theme1.xml",Te(i,l,Eg(e.Themes,t)),s.themes.push(l),Re(t.wbrels,-1,"theme/theme1.xml",Fe.THEME),l="xl/styles."+r,Te(i,l,uE(e,l,t)),s.styles.push(l),Re(t.wbrels,-1,"styles."+r,Fe.STY),e.vbaraw&&n&&(l="xl/vbaProject.bin",Te(i,l,e.vbaraw),s.vba.push(l),Re(t.wbrels,-1,"vbaProject.bin",Fe.VBA)),l="xl/metadata."+r,Te(i,l,hE(l)),s.metadata.push(l),Re(t.wbrels,-1,"metadata."+r,Fe.XLMETA),Te(i,"[Content_Types].xml",ig(s,t)),Te(i,"_rels/.rels",Qs(t.rels)),Te(i,"xl/_rels/workbook."+r+".rels",Qs(t.wbrels)),delete t.revssf,delete t.ssf,i}function lT(e,t){Ws=1024,e&&!e.SSF&&(e.SSF=qt(nt)),e&&e.SSF&&(Lo(),Do(e.SSF),t.revssf=Mo(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,ri?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r="xml",n=Ag.indexOf(t.bookType)>-1,s=ag();Z0(t=t||{});var i=L0(),l="",o=0;if(t.cellXfs=[],Kn(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),l="docProps/core.xml",Te(i,l,cg(e.Props,t)),s.coreprops.push(l),Re(t.rels,2,l,Fe.CORE_PROPS),l="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var c=[],d=0;d<e.SheetNames.length;++d)(e.Workbook.Sheets[d]||{}).Hidden!=2&&c.push(e.SheetNames[d]);e.Props.SheetNames=c}e.Props.Worksheets=e.Props.SheetNames.length,Te(i,l,dg(e.Props)),s.extprops.push(l),Re(t.rels,3,l,Fe.EXT_PROPS),e.Custprops!==e.Props&&Ct(e.Custprops||{}).length>0&&(l="docProps/custom.xml",Te(i,l,fg(e.Custprops)),s.custprops.push(l),Re(t.rels,4,l,Fe.CUST_PROPS));var u=["SheetJ5"];for(t.tcid=0,o=1;o<=e.SheetNames.length;++o){var f={"!id":{}},h=e.Sheets[e.SheetNames[o-1]],m=(h||{})["!type"]||"sheet";switch(m){case"chart":default:l="xl/worksheets/sheet"+o+"."+r,Te(i,l,Bg(o-1,t,e,f)),s.sheets.push(l),Re(t.wbrels,-1,"worksheets/sheet"+o+"."+r,Fe.WS[0])}if(h){var p=h["!comments"],x=!1,v="";if(p&&p.length>0){var y=!1;p.forEach(function(g){g[1].forEach(function(w){w.T==!0&&(y=!0)})}),y&&(v="xl/threadedComments/threadedComment"+o+"."+r,Te(i,v,Mj(p,u,t)),s.threadedcomments.push(v),Re(f,-1,"../threadedComments/threadedComment"+o+"."+r,Fe.TCMNT)),v="xl/comments"+o+"."+r,Te(i,v,kg(p)),s.comments.push(v),Re(f,-1,"../comments"+o+"."+r,Fe.CMNT),x=!0}h["!legacy"]&&x&&Te(i,"xl/drawings/vmlDrawing"+o+".vml",Cg(o,h["!comments"])),delete h["!comments"],delete h["!legacy"]}f["!id"].rId1&&Te(i,lg(l),Qs(f))}return t.Strings!=null&&t.Strings.length>0&&(l="xl/sharedStrings."+r,Te(i,l,wg(t.Strings,t)),s.strs.push(l),Re(t.wbrels,-1,"sharedStrings."+r,Fe.SST)),l="xl/workbook."+r,Te(i,l,$g(e)),s.workbooks.push(l),Re(t.rels,1,l,Fe.WB),l="xl/theme/theme1.xml",Te(i,l,Eg(e.Themes,t)),s.themes.push(l),Re(t.wbrels,-1,"theme/theme1.xml",Fe.THEME),l="xl/styles."+r,Te(i,l,Sg(e,t)),s.styles.push(l),Re(t.wbrels,-1,"styles."+r,Fe.STY),e.vbaraw&&n&&(l="xl/vbaProject.bin",Te(i,l,e.vbaraw),s.vba.push(l),Re(t.wbrels,-1,"vbaProject.bin",Fe.VBA)),l="xl/metadata."+r,Te(i,l,Tg()),s.metadata.push(l),Re(t.wbrels,-1,"metadata."+r,Fe.XLMETA),u.length>1&&(l="xl/persons/person.xml",Te(i,l,Bj(u)),s.people.push(l),Re(t.wbrels,-1,"persons/person.xml",Fe.PEOPLE)),Te(i,"[Content_Types].xml",ig(s,t)),Te(i,"_rels/.rels",Qs(t.rels)),Te(i,"xl/_rels/workbook."+r+".rels",Qs(t.wbrels)),delete t.revssf,delete t.ssf,i}function oT(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=un(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function Yg(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return Di(t.file,Be.write(e,{type:Oe?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return Be.write(e,t)}function cT(e,t){var r=qt(t||{}),n=aT(e,r);return uT(n,r)}function uT(e,t){var r={},n=Oe?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(t.compression&&(r.compression="DEFLATE"),t.password)r.type=n;else switch(t.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":r.type=n;break;default:throw new Error("Unrecognized type "+t.type)}var s=e.FullPaths?Be.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!t.compression}):e.generate(r);if(typeof Deno<"u"&&typeof s=="string"){if(t.type=="binary"||t.type=="base64")return s;s=new Uint8Array(Io(s))}return t.password&&typeof encrypt_agile<"u"?Yg(encrypt_agile(s,t.password),t):t.type==="file"?Di(t.file,s):t.type=="string"?Qa(s):s}function dT(e,t){var r=t||{},n=TE(e,r);return Yg(n,r)}function Mr(e,t,r){r||(r="");var n=r+e;switch(t.type){case"base64":return ji(_i(n));case"binary":return _i(n);case"string":return e;case"file":return Di(t.file,n,"utf8");case"buffer":return Oe?xn(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):Mr(n,{type:"binary"}).split("").map(function(s){return s.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function fT(e,t){switch(t.type){case"base64":return ji(e);case"binary":return e;case"string":return e;case"file":return Di(t.file,e,"binary");case"buffer":return Oe?xn(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function xl(e,t){switch(t.type){case"string":case"base64":case"binary":for(var r="",n=0;n<e.length;++n)r+=String.fromCharCode(e[n]);return t.type=="base64"?ji(r):t.type=="string"?Qa(r):r;case"file":return Di(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function Jg(e,t){Ub(),q3(e);var r=qt(t||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=Jg(e,r);return r.type="array",Io(n)}var s=0;if(r.sheet&&(typeof r.sheet=="number"?s=r.sheet:s=e.SheetNames.indexOf(r.sheet),!e.SheetNames[s]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return Mr(_E(e,r),r);case"slk":case"sylk":return Mr(K4.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"htm":case"html":return Mr(Vg(e.Sheets[e.SheetNames[s]],r),r);case"txt":return fT(qg(e.Sheets[e.SheetNames[s]],r),r);case"csv":return Mr(ed(e.Sheets[e.SheetNames[s]],r),r,"\uFEFF");case"dif":return Mr(Y4.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"dbf":return xl(X4.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"prn":return Mr(J4.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"rtf":return Mr(nj.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"eth":return Mr(yg.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"fods":return Mr(Kg(e,r),r);case"wk1":return xl(gh.sheet_to_wk1(e.Sheets[e.SheetNames[s]],r),r);case"wk3":return xl(gh.book_to_wk3(e,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),xl(Hg(e,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),dT(e,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return cT(e,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function hT(e){if(!e.bookType){var t={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(e.bookType=r.slice(1)),e.bookType=t[e.bookType]||e.bookType}}function xT(e,t,r){var n={};return n.type="file",n.file=t,hT(n),Jg(e,n)}function mT(e,t,r,n,s,i,l,o){var c=Et(r),d=o.defval,u=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),f=!0,h=s===1?[]:{};if(s!==1)if(Object.defineProperty)try{Object.defineProperty(h,"__rowNum__",{value:r,enumerable:!1})}catch{h.__rowNum__=r}else h.__rowNum__=r;if(!l||e[r])for(var m=t.s.c;m<=t.e.c;++m){var p=l?e[r][m]:e[n[m]+c];if(p===void 0||p.t===void 0){if(d===void 0)continue;i[m]!=null&&(h[i[m]]=d);continue}var x=p.v;switch(p.t){case"z":if(x==null)break;continue;case"e":x=x==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+p.t)}if(i[m]!=null){if(x==null)if(p.t=="e"&&x===null)h[i[m]]=null;else if(d!==void 0)h[i[m]]=d;else if(u&&x===null)h[i[m]]=null;else continue;else h[i[m]]=u&&(p.t!=="n"||p.t==="n"&&o.rawNumbers!==!1)?x:dn(p,x,o);x!=null&&(f=!1)}}return{row:h,isempty:f}}function xo(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},n=0,s=1,i=[],l=0,o="",c={s:{r:0,c:0},e:{r:0,c:0}},d=t||{},u=d.range!=null?d.range:e["!ref"];switch(d.header===1?n=1:d.header==="A"?n=2:Array.isArray(d.header)?n=3:d.header==null&&(n=0),typeof u){case"string":c=Xe(u);break;case"number":c=Xe(e["!ref"]),c.s.r=u;break;default:c=u}n>0&&(s=0);var f=Et(c.s.r),h=[],m=[],p=0,x=0,v=Array.isArray(e),y=c.s.r,g=0,w={};v&&!e[y]&&(e[y]=[]);var b=d.skipHidden&&e["!cols"]||[],P=d.skipHidden&&e["!rows"]||[];for(g=c.s.c;g<=c.e.c;++g)if(!(b[g]||{}).hidden)switch(h[g]=Pt(g),r=v?e[y][g]:e[h[g]+f],n){case 1:i[g]=g-c.s.c;break;case 2:i[g]=h[g];break;case 3:i[g]=d.header[g-c.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),o=l=dn(r,null,d),x=w[l]||0,!x)w[l]=1;else{do o=l+"_"+x++;while(w[o]);w[l]=x,w[o]=1}i[g]=o}for(y=c.s.r+s;y<=c.e.r;++y)if(!(P[y]||{}).hidden){var L=mT(e,c,y,h,n,i,v,d);(L.isempty===!1||(n===1?d.blankrows!==!1:d.blankrows))&&(m[p++]=L.row)}return m.length=p,m}var _h=/"/g;function pT(e,t,r,n,s,i,l,o){for(var c=!0,d=[],u="",f=Et(r),h=t.s.c;h<=t.e.c;++h)if(n[h]){var m=o.dense?(e[r]||[])[h]:e[n[h]+f];if(m==null)u="";else if(m.v!=null){c=!1,u=""+(o.rawNumbers&&m.t=="n"?m.v:dn(m,null,o));for(var p=0,x=0;p!==u.length;++p)if((x=u.charCodeAt(p))===s||x===i||x===34||o.forceQuotes){u='"'+u.replace(_h,'""')+'"';break}u=="ID"&&(u='"ID"')}else m.f!=null&&!m.F?(c=!1,u="="+m.f,u.indexOf(",")>=0&&(u='"'+u.replace(_h,'""')+'"')):u="";d.push(u)}return o.blankrows===!1&&c?null:d.join(l)}function ed(e,t){var r=[],n=t??{};if(e==null||e["!ref"]==null)return"";var s=Xe(e["!ref"]),i=n.FS!==void 0?n.FS:",",l=i.charCodeAt(0),o=n.RS!==void 0?n.RS:`
`,c=o.charCodeAt(0),d=new RegExp((i=="|"?"\\|":i)+"+$"),u="",f=[];n.dense=Array.isArray(e);for(var h=n.skipHidden&&e["!cols"]||[],m=n.skipHidden&&e["!rows"]||[],p=s.s.c;p<=s.e.c;++p)(h[p]||{}).hidden||(f[p]=Pt(p));for(var x=0,v=s.s.r;v<=s.e.r;++v)(m[v]||{}).hidden||(u=pT(e,s,v,f,l,c,i,n),u!=null&&(n.strip&&(u=u.replace(d,"")),(u||n.blankrows!==!1)&&r.push((x++?o:"")+u)));return delete n.dense,r.join("")}function qg(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=ed(e,t);return r}function gT(e){var t="",r,n="";if(e==null||e["!ref"]==null)return[];var s=Xe(e["!ref"]),i="",l=[],o,c=[],d=Array.isArray(e);for(o=s.s.c;o<=s.e.c;++o)l[o]=Pt(o);for(var u=s.s.r;u<=s.e.r;++u)for(i=Et(u),o=s.s.c;o<=s.e.c;++o)if(t=l[o]+i,r=d?(e[u]||[])[o]:e[t],n="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;n=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}c[c.length]=t+"="+n}return c}function Qg(e,t,r){var n=r||{},s=+!n.skipHeader,i=e||{},l=0,o=0;if(i&&n.origin!=null)if(typeof n.origin=="number")l=n.origin;else{var c=typeof n.origin=="string"?pt(n.origin):n.origin;l=c.r,o=c.c}var d,u={s:{c:0,r:0},e:{c:o,r:l+t.length-1+s}};if(i["!ref"]){var f=Xe(i["!ref"]);u.e.c=Math.max(u.e.c,f.e.c),u.e.r=Math.max(u.e.r,f.e.r),l==-1&&(l=f.e.r+1,u.e.r=l+t.length-1+s)}else l==-1&&(l=0,u.e.r=t.length-1+s);var h=n.header||[],m=0;t.forEach(function(x,v){Ct(x).forEach(function(y){(m=h.indexOf(y))==-1&&(h[m=h.length]=y);var g=x[y],w="z",b="",P=Le({c:o+m,r:l+v+s});d=Ci(i,P),g&&typeof g=="object"&&!(g instanceof Date)?i[P]=g:(typeof g=="number"?w="n":typeof g=="boolean"?w="b":typeof g=="string"?w="s":g instanceof Date?(w="d",n.cellDates||(w="n",g=Jt(g)),b=n.dateNF||nt[14]):g===null&&n.nullError&&(w="e",g=0),d?(d.t=w,d.v=g,delete d.w,delete d.R,b&&(d.z=b)):i[P]=d={t:w,v:g},b&&(d.z=b))})}),u.e.c=Math.max(u.e.c,o+h.length-1);var p=Et(l);if(s)for(m=0;m<h.length;++m)i[Pt(m+o)+p]={t:"s",v:h[m]};return i["!ref"]=ot(u),i}function vT(e,t){return Qg(null,e,t)}function Ci(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var n=pt(t);return e[n.r]||(e[n.r]=[]),e[n.r][n.c]||(e[n.r][n.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?Ci(e,Le(t)):Ci(e,Le({r:t,c:r||0}))}function yT(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function wT(){return{SheetNames:[],Sheets:{}}}function bT(e,t,r,n){var s=1;if(!r)for(;s<=65535&&e.SheetNames.indexOf(r="Sheet"+s)!=-1;++s,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(r)>=0){var i=r.match(/(^.*?)(\d+)$/);s=i&&+i[2]||0;var l=i&&i[1]||r;for(++s;s<=65535&&e.SheetNames.indexOf(r=l+s)!=-1;++s);}if(zg(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function NT(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var n=yT(e,t);switch(e.Workbook.Sheets[n]||(e.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[n].Hidden=r}function jT(e,t){return e.z=t,e}function Zg(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function ST(e,t,r){return Zg(e,"#"+t,r)}function _T(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function ET(e,t,r,n){for(var s=typeof t!="string"?t:Xe(t),i=typeof t=="string"?t:ot(t),l=s.s.r;l<=s.e.r;++l)for(var o=s.s.c;o<=s.e.c;++o){var c=Ci(e,l,o);c.t="n",c.F=i,delete c.v,l==s.s.r&&o==s.s.c&&(c.f=r,n&&(c.D=!0))}return e}var Fc={encode_col:Pt,encode_row:Et,encode_cell:Le,encode_range:ot,decode_col:W0,decode_row:$0,split_cell:UN,decode_cell:pt,decode_range:lr,format_cell:dn,sheet_add_aoa:Zp,sheet_add_json:Qg,sheet_add_dom:Gg,aoa_to_sheet:va,json_to_sheet:vT,table_to_sheet:Xg,table_to_book:YE,sheet_to_csv:ed,sheet_to_txt:qg,sheet_to_json:xo,sheet_to_html:Vg,sheet_to_formulae:gT,sheet_to_row_object_array:xo,sheet_get_cell:Ci,book_new:wT,book_append_sheet:bT,book_set_sheet_visibility:NT,cell_set_number_format:jT,cell_set_hyperlink:Zg,cell_set_internal_link:ST,cell_add_comment:_T,sheet_set_array_formula:ET,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const Eh={pending:"bg-yellow-100 text-yellow-700",approved:"bg-green-100 text-green-700",rejected:"bg-red-100 text-red-700"},TT={pending:Yt,approved:ht,rejected:yr};function CT({timesheets:e,selectedIds:t,onSelect:r,onSelectAll:n,onRowClick:s}){const i=e.length>0&&t.length===e.length,l=t.length>0&&t.length<e.length,o=(f,h="INR")=>new Intl.NumberFormat("en-IN",{style:"currency",currency:h,minimumFractionDigits:0,maximumFractionDigits:0}).format(f),c=f=>f?new Date(f).toLocaleDateString("en-IN",{day:"numeric",month:"short",year:"numeric"}):"-",d=f=>{if(!f)return"0h";const h=Math.floor(f),m=Math.round((f-h)*60);return m===0?`${h}h`:`${h}h ${m}m`},u=f=>{const h=TT[f]||Yt;return a.jsxs("span",{className:`inline-flex items-center gap-1.5 px-2.5 py-1 rounded-full text-xs font-medium ${Eh[f]||Eh.pending}`,children:[a.jsx(h,{className:"w-3 h-3"}),f.charAt(0).toUpperCase()+f.slice(1)]})};return e.length===0?a.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-12 text-center",children:[a.jsx(Yt,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),a.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No timesheets found"}),a.jsx("p",{className:"text-sm text-gray-500",children:"Try adjusting your filters or create a new timesheet entry."})]}):a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full",children:[a.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-4 py-3 text-left",children:a.jsx("input",{type:"checkbox",checked:i,ref:f=>{f&&(f.indeterminate=l)},onChange:f=>n(f.target.checked),className:"w-4 h-4 text-gray-600 border-gray-300 rounded focus:ring-gray-500"})}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-700 uppercase tracking-wider",children:"Date"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-700 uppercase tracking-wider",children:"Employee"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-700 uppercase tracking-wider",children:"Project"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-700 uppercase tracking-wider",children:"Hours"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-700 uppercase tracking-wider",children:"Billable"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-700 uppercase tracking-wider",children:"Cost"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-700 uppercase tracking-wider",children:"Status"})]})}),a.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:e.map(f=>a.jsxs("tr",{onClick:()=>s(f),className:"hover:bg-gray-50 cursor-pointer",children:[a.jsx("td",{className:"px-4 py-3 whitespace-nowrap",onClick:h=>h.stopPropagation(),children:a.jsx("input",{type:"checkbox",checked:t.includes(f.id),onChange:h=>r(f.id,h.target.checked),className:"w-4 h-4 text-gray-600 border-gray-300 rounded focus:ring-gray-500"})}),a.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-900",children:c(f.workedOn)}),a.jsxs("td",{className:"px-4 py-3 whitespace-nowrap",children:[a.jsx("div",{className:"text-sm font-medium text-gray-900",children:f.userName||"Unknown"}),f.userEmail&&a.jsx("div",{className:"text-xs text-gray-500 truncate max-w-[180px]",children:f.userEmail})]}),a.jsxs("td",{className:"px-4 py-3 whitespace-nowrap",children:[a.jsx("div",{className:"text-sm text-gray-900",children:f.projectName||"-"}),f.taskTitle&&a.jsx("div",{className:"text-xs text-gray-500 truncate max-w-[180px]",children:f.taskTitle})]}),a.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-900 font-medium",children:d(f.hours)}),a.jsx("td",{className:"px-4 py-3 whitespace-nowrap",children:f.isBillable?a.jsx("span",{className:"inline-flex items-center px-2.5 py-1 rounded-full text-xs font-medium bg-green-100 text-green-800",children:"Yes"}):a.jsx("span",{className:"inline-flex items-center px-2.5 py-1 rounded-full text-xs font-medium bg-gray-100 text-gray-800",children:"No"})}),a.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-900 font-medium",children:o(f.cost||0)}),a.jsx("td",{className:"px-4 py-3 whitespace-nowrap",children:u(f.status||"pending")})]},f.id))})]})})}function kT({filters:e,projects:t,employees:r,onFilterChange:n,onSavedViewChange:s}){const[i,l]=C.useState(!1),o=[{id:"pending",label:"Pending Approval",filters:{status:"pending"}},{id:"billable-only",label:"Billable Only",filters:{is_billable:"true"}},{id:"this-week",label:"This Week",filters:d()}],c=[{key:"is_billable",label:"Billable",value:"true"},{key:"this_week",label:"This Week",value:d()},{key:"this_month",label:"This Month",value:u()}];function d(){const p=new Date,x=new Date(p);return x.setDate(p.getDate()-p.getDay()),{date_from:x.toISOString().split("T")[0],date_to:p.toISOString().split("T")[0]}}function u(){const p=new Date;return{date_from:new Date(p.getFullYear(),p.getMonth(),1).toISOString().split("T")[0],date_to:p.toISOString().split("T")[0]}}const f=p=>{p.value==="true"?n({[p.key]:p.value}):typeof p.value=="object"&&n(p.value)},h=p=>{n({[p]:void 0})},m=Object.keys(e).filter(p=>{const x=e[p];return!(x===void 0||x===""||x===null||Array.isArray(x)&&x.length===0)}).length;return a.jsxs("div",{className:"relative",children:[a.jsxs("button",{onClick:()=>l(!i),className:"flex items-center gap-2 px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",children:[a.jsx(Xn,{className:"w-4 h-4"}),a.jsx("span",{children:"Filters"}),m>0&&a.jsx("span",{className:"px-2 py-0.5 text-xs font-semibold text-white rounded-full",style:{backgroundColor:"#714b67"},children:m}),a.jsx(Bn,{className:`w-4 h-4 transition-transform ${i?"rotate-180":""}`})]}),i&&a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"fixed inset-0 z-10",onClick:()=>l(!1)}),a.jsxs("div",{className:"absolute right-0 mt-2 w-80 bg-white border border-gray-200 rounded-lg shadow-xl z-20",children:[a.jsxs("div",{className:"p-4 border-b border-gray-200",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsx("h3",{className:"text-sm font-semibold text-gray-900",children:"Filters"}),a.jsx("button",{onClick:()=>l(!1),className:"text-gray-400 hover:text-gray-600",children:a.jsx(Ue,{className:"w-4 h-4"})})]}),a.jsxs("div",{className:"mb-4",children:[a.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2",children:"Saved Views"}),a.jsxs("select",{onChange:p=>{if(p.target.value){const x=o.find(v=>v.id===p.target.value);x&&s(x.filters)}p.target.value=""},className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-400",children:[a.jsx("option",{value:"",children:"Select a view..."}),o.map(p=>a.jsx("option",{value:p.id,children:p.label},p.id))]})]}),a.jsxs("div",{className:"mb-4",children:[a.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2",children:"Quick Filters"}),a.jsx("div",{className:"flex flex-wrap gap-2",children:c.map(p=>a.jsx("button",{onClick:()=>f(p),className:"px-3 py-1 text-xs font-medium text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200",children:p.label},p.key))})]})]}),a.jsxs("div",{className:"p-4 space-y-4 max-h-96 overflow-y-auto",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Project"}),a.jsxs("select",{value:e.project_id||"",onChange:p=>n({project_id:p.target.value||void 0}),className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-400",children:[a.jsx("option",{value:"",children:"All Projects"}),t.map(p=>a.jsx("option",{value:p.id,children:p.name},p.id))]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Status"}),a.jsxs("select",{value:e.status||"",onChange:p=>n({status:p.target.value||void 0}),className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-400",children:[a.jsx("option",{value:"",children:"All Statuses"}),a.jsx("option",{value:"pending",children:"Pending"}),a.jsx("option",{value:"approved",children:"Approved"}),a.jsx("option",{value:"rejected",children:"Rejected"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Employee"}),a.jsxs("select",{value:e.user_id||"",onChange:p=>n({user_id:p.target.value||void 0}),className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-400",children:[a.jsx("option",{value:"",children:"All Employees"}),r.map(p=>a.jsx("option",{value:p.id,children:p.name},p.id))]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Billable"}),a.jsxs("select",{value:e.is_billable||"",onChange:p=>n({is_billable:p.target.value||void 0}),className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-400",children:[a.jsx("option",{value:"",children:"All"}),a.jsx("option",{value:"true",children:"Billable"}),a.jsx("option",{value:"false",children:"Not Billable"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Date From"}),a.jsx("input",{type:"date",value:e.date_from||"",onChange:p=>n({date_from:p.target.value||void 0}),className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-400"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Date To"}),a.jsx("input",{type:"date",value:e.date_to||"",onChange:p=>n({date_to:p.target.value||void 0}),className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-400"})]})]}),m>0&&a.jsxs("div",{className:"p-4 border-t border-gray-200",children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsx("span",{className:"text-xs font-medium text-gray-700",children:"Active Filters"}),a.jsx("button",{onClick:()=>n({}),className:"text-xs hover:underline",style:{color:"#714b67"},children:"Clear All"})]}),a.jsx("div",{className:"flex flex-wrap gap-2",children:Object.keys(e).map(p=>{const x=e[p];if(x===void 0||x===""||x===null||Array.isArray(x)&&x.length===0)return null;let v=x;Array.isArray(x)&&(v=x.join(", "));const y=p.replace(/_/g," ").replace(/\b\w/g,g=>g.toUpperCase());return a.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 text-xs bg-gray-100 text-gray-700 rounded",children:[a.jsxs("span",{children:[y,": ",v]}),a.jsx("button",{onClick:g=>{g.stopPropagation(),h(p)},className:"text-gray-500 hover:text-gray-700 ml-1",type:"button",children:a.jsx(Ue,{className:"w-3 h-3"})})]},p)})})]})]})]})]})}function AT({selectedCount:e,onBulkApprove:t,onBulkReject:r,onExportCSV:n,onExportExcel:s}){const[i,l]=C.useState(!1),[o,c]=C.useState("");if(e===0)return null;const d=()=>{o.trim()&&(r(o),c(""),l(!1))};return a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-3 mb-4",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("div",{className:"flex items-center gap-3",children:a.jsxs("span",{className:"text-sm font-medium text-gray-900",children:[e," timesheet",e!==1?"s":""," selected"]})}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsxs("button",{onClick:t,className:"flex items-center gap-2 px-4 py-2 text-sm font-medium text-white bg-green-600 rounded-lg hover:bg-green-700",children:[a.jsx(ht,{className:"w-4 h-4"}),"Approve"]}),a.jsxs("button",{onClick:()=>l(!0),className:"flex items-center gap-2 px-4 py-2 text-sm font-medium text-white bg-red-600 rounded-lg hover:bg-red-700",children:[a.jsx(yr,{className:"w-4 h-4"}),"Reject"]}),a.jsxs("button",{onClick:n,className:"flex items-center gap-2 px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",title:"Export as CSV",children:[a.jsx(oa,{className:"w-4 h-4"}),"CSV"]}),s&&a.jsxs("button",{onClick:s,className:"flex items-center gap-2 px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",title:"Export as Excel",children:[a.jsx(oa,{className:"w-4 h-4"}),"Excel"]})]})]})}),i&&a.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black bg-opacity-50",children:a.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full p-6",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Reject Timesheets"}),a.jsxs("p",{className:"text-sm text-gray-600 mb-4",children:["Please provide a reason for rejecting ",e," timesheet",e!==1?"s":"","."]}),a.jsx("textarea",{value:o,onChange:u=>c(u.target.value),placeholder:"Enter rejection reason...",rows:4,className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-red-500 mb-4"}),a.jsxs("div",{className:"flex items-center justify-end gap-3",children:[a.jsx("button",{onClick:()=>{l(!1),c("")},className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",children:"Cancel"}),a.jsx("button",{onClick:d,disabled:!o.trim(),className:"px-4 py-2 text-sm font-medium text-white bg-red-600 rounded-lg hover:bg-red-700 disabled:opacity-50 disabled:cursor-not-allowed",children:"Reject"})]})]})})]})}const Th={pending:"bg-yellow-100 text-yellow-700",approved:"bg-green-100 text-green-700",rejected:"bg-red-100 text-red-700"};function FT({timesheet:e,onClose:t,onUpdate:r,onApprove:n,onReject:s}){const[i,l]=C.useState(e),[o,c]=C.useState(!1),[d,u]=C.useState(!1),[f,h]=C.useState(""),[m,p]=C.useState(null);C.useEffect(()=>{p(gp()),e!=null&&e.id?x():l(e)},[e]);const x=async()=>{c(!0);try{const S=await zr.getById(e.id);S.success&&l(S.data)}catch(S){console.error("Error loading timesheet details:",S)}finally{c(!1)}},v=(S,R="INR")=>new Intl.NumberFormat("en-IN",{style:"currency",currency:R,minimumFractionDigits:0,maximumFractionDigits:0}).format(S),y=S=>S?new Date(S).toLocaleDateString("en-IN",{day:"numeric",month:"short",year:"numeric"}):"-",g=S=>S?new Date(S).toLocaleString("en-IN",{day:"numeric",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"}):"-",w=S=>{if(!S)return"0h";const R=Math.floor(S),U=Math.round((S-R)*60);return U===0?`${R}h`:`${R}h ${U}m`},b=S=>{const R=S==="pending"?Yt:S==="approved"?ht:yr;return a.jsxs("span",{className:`inline-flex items-center gap-1.5 px-3 py-1.5 rounded-full text-sm font-medium ${Th[S]||Th.pending}`,children:[a.jsx(R,{className:"w-4 h-4"}),S.charAt(0).toUpperCase()+S.slice(1)]})},P=(i==null?void 0:i.status)==="pending",L=(i==null?void 0:i.status)==="pending"||(i==null?void 0:i.status)==="approved";i==null||i.status;const E=async()=>{try{const S=await zr.approve(i.id);S.success?(n(i.id),r(),t()):alert(S.message||"Failed to approve timesheet")}catch(S){console.error("Error approving timesheet:",S),alert(S.message||"Failed to approve timesheet")}},I=async()=>{if(f.trim())try{const S=await zr.reject(i.id,f);S.success?(s(i.id),r(),u(!1),h(""),t()):alert(S.message||"Failed to reject timesheet")}catch(S){console.error("Error rejecting timesheet:",S),alert(S.message||"Failed to reject timesheet")}};return a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"fixed inset-0 z-40 bg-black bg-opacity-30",onClick:t}),a.jsx("div",{className:"fixed right-0 top-0 h-full w-full max-w-2xl bg-white shadow-xl z-50 overflow-y-auto",children:o?a.jsx("div",{className:"flex items-center justify-center h-full",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"inline-block animate-spin rounded-full h-12 w-12 border-b-2 border-gray-900 mb-4"}),a.jsx("p",{className:"text-gray-600",children:"Loading timesheet details..."})]})}):a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"sticky top-0 bg-white border-b border-gray-200 px-6 py-4 flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[b(i==null?void 0:i.status),a.jsxs("div",{children:[a.jsx("div",{className:"text-2xl font-semibold text-gray-900",children:w((i==null?void 0:i.hours)||0)}),a.jsx("div",{className:"text-sm text-gray-500",children:v((i==null?void 0:i.cost)||0)})]})]}),a.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-600",children:a.jsx(Ue,{className:"w-5 h-5"})})]}),a.jsxs("div",{className:"p-6 space-y-6",children:[a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"Project"}),a.jsx("p",{className:"text-sm font-medium text-gray-900",children:(i==null?void 0:i.projectName)||"-"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"Task"}),a.jsx("p",{className:"text-sm font-medium text-gray-900",children:(i==null?void 0:i.taskTitle)||"-"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"Employee"}),a.jsx("p",{className:"text-sm font-medium text-gray-900",children:(i==null?void 0:i.userName)||"-"}),(i==null?void 0:i.userEmail)&&a.jsx("p",{className:"text-xs text-gray-500",children:i.userEmail})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"Date Worked"}),a.jsx("p",{className:"text-sm font-medium text-gray-900",children:y(i==null?void 0:i.workedOn)})]}),(i==null?void 0:i.startTime)&&a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"Start Time"}),a.jsx("p",{className:"text-sm font-medium text-gray-900",children:g(i.startTime)})]}),(i==null?void 0:i.endTime)&&a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"End Time"}),a.jsx("p",{className:"text-sm font-medium text-gray-900",children:g(i.endTime)})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"Hours"}),a.jsx("p",{className:"text-sm font-medium text-gray-900",children:w((i==null?void 0:i.hours)||0)})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"Billable"}),a.jsx("p",{className:"text-sm font-medium text-gray-900",children:i!=null&&i.isBillable?"Yes":"No"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"Cost Rate"}),a.jsx("p",{className:"text-sm font-medium text-gray-900",children:i!=null&&i.costRate?v(i.costRate)+"/hr":"-"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"Total Cost"}),a.jsx("p",{className:"text-sm font-medium text-gray-900",children:v((i==null?void 0:i.cost)||0)})]})]}),(i==null?void 0:i.note)&&a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"Notes"}),a.jsx("p",{className:"text-sm text-gray-900 whitespace-pre-wrap",children:i.note})]}),(i==null?void 0:i.approvedBy)&&a.jsxs("div",{className:"border-t border-gray-200 pt-4",children:[a.jsx("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"Approved By"}),a.jsx("p",{className:"text-sm font-medium text-gray-900",children:i.approverName||"-"}),i.approvedAt&&a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:g(i.approvedAt)})]}),a.jsxs("div",{className:"flex items-center gap-3 pt-4 border-t border-gray-200",children:[P&&a.jsxs("button",{onClick:E,className:"flex items-center gap-2 px-4 py-2 text-sm font-medium text-white bg-green-600 rounded-lg hover:bg-green-700",children:[a.jsx(ht,{className:"w-4 h-4"}),"Approve"]}),L&&a.jsxs("button",{onClick:()=>u(!0),className:"flex items-center gap-2 px-4 py-2 text-sm font-medium text-white bg-red-600 rounded-lg hover:bg-red-700",children:[a.jsx(yr,{className:"w-4 h-4"}),"Reject"]})]})]})]})}),d&&a.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black bg-opacity-50",children:a.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full p-6",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Reject Timesheet"}),a.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Please provide a reason for rejecting this timesheet."}),a.jsx("textarea",{value:f,onChange:S=>h(S.target.value),placeholder:"Enter rejection reason...",rows:4,className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-red-500 mb-4"}),a.jsxs("div",{className:"flex items-center justify-end gap-3",children:[a.jsx("button",{onClick:()=>{u(!1),h("")},className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",children:"Cancel"}),a.jsx("button",{onClick:I,disabled:!f.trim(),className:"px-4 py-2 text-sm font-medium text-white bg-red-600 rounded-lg hover:bg-red-700 disabled:opacity-50 disabled:cursor-not-allowed",children:"Reject"})]})]})})]})}function OT({timesheet:e,projects:t,employees:r,onClose:n,onSave:s}){const[i,l]=C.useState({project_id:(e==null?void 0:e.projectId)||"",task_id:(e==null?void 0:e.taskId)||"",user_id:(e==null?void 0:e.userId)||"",worked_on:(e==null?void 0:e.workedOn)||new Date().toISOString().split("T")[0],start_time:e!=null&&e.startTime?e.startTime.slice(0,16):"",end_time:e!=null&&e.endTime?e.endTime.slice(0,16):"",hours:(e==null?void 0:e.hours)||"",is_billable:(e==null?void 0:e.isBillable)!==void 0?e.isBillable:!0,note:(e==null?void 0:e.note)||""}),[o,c]=C.useState([]),[d,u]=C.useState(!1),[f,h]=C.useState({}),[m,p]=C.useState(null);C.useEffect(()=>{if(i.start_time&&i.end_time){const y=new Date(i.start_time),w=(new Date(i.end_time)-y)/(1e3*60*60);w>0&&(p(w.toFixed(2)),i.hours||l(b=>({...b,hours:w.toFixed(2)})))}},[i.start_time,i.end_time]);const x=y=>{const{name:g,value:w,type:b,checked:P}=y.target;l(L=>({...L,[g]:b==="checkbox"?P:w})),f[g]&&h(L=>{const E={...L};return delete E[g],E})},v=async y=>{y.preventDefault();const g={};if(i.project_id||(g.project_id="Project is required"),i.user_id||(g.user_id="Employee is required"),i.worked_on||(g.worked_on="Date worked is required"),(!i.hours||parseFloat(i.hours)<=0)&&(g.hours="Valid hours are required"),Object.keys(g).length>0){h(g);return}u(!0);try{const w={...i,hours:parseFloat(i.hours),start_time:i.start_time||void 0,end_time:i.end_time||void 0,task_id:i.task_id||void 0};let b;e?b=await zr.update(e.id,w):b=await zr.create(w),b.success?(s(b.data),n()):h({submit:b.message||"Failed to save timesheet"})}catch(w){console.error("Error saving timesheet:",w),h({submit:w.message||"Failed to save timesheet"})}finally{u(!1)}};return a.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black bg-opacity-50",children:a.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[a.jsxs("div",{className:"sticky top-0 bg-white border-b border-gray-200 px-6 py-4 flex items-center justify-between",children:[a.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:e?"Edit Timesheet":"New Timesheet"}),a.jsx("button",{onClick:n,className:"text-gray-400 hover:text-gray-600",children:a.jsx(Ue,{className:"w-5 h-5"})})]}),a.jsxs("form",{onSubmit:v,className:"p-6 space-y-4",children:[f.submit&&a.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-3 text-sm text-red-800",children:f.submit}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Project ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsxs("select",{name:"project_id",value:i.project_id,onChange:x,className:`w-full px-3 py-2 text-sm border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-400 ${f.project_id?"border-red-300":"border-gray-300"}`,children:[a.jsx("option",{value:"",children:"Select project..."}),t.map(y=>a.jsx("option",{value:y.id,children:y.name},y.id))]}),f.project_id&&a.jsx("p",{className:"mt-1 text-xs text-red-600",children:f.project_id})]}),a.jsxs("div",{children:[a.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Employee ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsxs("select",{name:"user_id",value:i.user_id,onChange:x,className:`w-full px-3 py-2 text-sm border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-400 ${f.user_id?"border-red-300":"border-gray-300"}`,children:[a.jsx("option",{value:"",children:"Select employee..."}),r.map(y=>a.jsx("option",{value:y.id,children:y.name},y.id))]}),f.user_id&&a.jsx("p",{className:"mt-1 text-xs text-red-600",children:f.user_id})]}),a.jsxs("div",{children:[a.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Date Worked ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{type:"date",name:"worked_on",value:i.worked_on,onChange:x,className:`w-full px-3 py-2 text-sm border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-400 ${f.worked_on?"border-red-300":"border-gray-300"}`}),f.worked_on&&a.jsx("p",{className:"mt-1 text-xs text-red-600",children:f.worked_on})]}),a.jsxs("div",{children:[a.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Hours ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("input",{type:"number",name:"hours",value:i.hours,onChange:x,step:"0.25",min:"0",max:"24",className:`w-full px-3 py-2 text-sm border rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-400 ${f.hours?"border-red-300":"border-gray-300"}`}),m&&i.start_time&&i.end_time&&a.jsxs("p",{className:"mt-1 text-xs text-gray-500",children:["Calculated: ",m," hours"]}),f.hours&&a.jsx("p",{className:"mt-1 text-xs text-red-600",children:f.hours})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Start Time"}),a.jsx("input",{type:"datetime-local",name:"start_time",value:i.start_time,onChange:x,className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-400"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"End Time"}),a.jsx("input",{type:"datetime-local",name:"end_time",value:i.end_time,onChange:x,className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-400"})]})]}),a.jsxs("div",{className:"flex items-center",children:[a.jsx("input",{type:"checkbox",name:"is_billable",id:"is_billable",checked:i.is_billable,onChange:x,className:"w-4 h-4 text-gray-600 rounded focus:ring-gray-500"}),a.jsx("label",{htmlFor:"is_billable",className:"ml-2 text-sm font-medium text-gray-700",children:"Billable to customer"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description/Notes"}),a.jsx("textarea",{name:"note",value:i.note,onChange:x,rows:3,className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-400"})]}),a.jsxs("div",{className:"flex items-center justify-end gap-3 pt-4 border-t border-gray-200",children:[a.jsx("button",{type:"button",onClick:n,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",children:"Cancel"}),a.jsx("button",{type:"submit",disabled:d,className:"px-4 py-2 text-sm font-medium text-white rounded-lg hover:opacity-90 disabled:opacity-50",style:{backgroundColor:"#714b67"},children:d?"Saving...":e?"Update":"Create"})]})]})]})})}function PT(){const[e,t]=C.useState([]),[r,n]=C.useState([]),[s,i]=C.useState({totalHours:0,billableHours:0,pendingApprovals:0,totalCost:0}),[l,o]=C.useState({date_from:I(),date_to:new Date().toISOString().split("T")[0]}),[c,d]=C.useState(""),[u,f]=C.useState([]),[h,m]=C.useState(null),[p,x]=C.useState(!1),[v,y]=C.useState(!1),[g,w]=C.useState(null),[b,P]=C.useState(!0),[L,E]=C.useState(null);function I(){const W=new Date;return W.setDate(W.getDate()-90),W.toISOString().split("T")[0]}const S=async()=>{try{P(!0),E(null);const W=await kr.getAll();W.success&&n(W.data);const Z=await zr.getAll(l);Z.success?t(Z.data):E(Z.message||"Failed to load timesheets");const ie=await zr.getStats(l);ie.success&&i(ie.data)}catch(W){console.error("Error loading data:",W),E("Unable to connect to server. Please try again.")}finally{P(!1)}};C.useEffect(()=>{S()},[l]);const R=W=>{Object.keys(W).length===0?o({date_from:I(),date_to:new Date().toISOString().split("T")[0]}):o(Z=>{const ie={...Z};return Object.keys(W).forEach(ce=>{const ne=W[ce];ne===void 0||ne===""||ne===null||Array.isArray(ne)&&ne.length===0?delete ie[ce]:ie[ce]=ne}),ie}),f([])},U=W=>{o(W),f([])},G=(W,Z)=>{f(Z?ie=>[...ie,W]:ie=>ie.filter(ce=>ce!==W))},se=W=>{f(W?e.map(Z=>Z.id):[])},Ne=W=>{m(W),x(!0)},ae=async()=>{try{(await zr.bulkApprove(u)).success&&(f([]),S())}catch(W){console.error("Error bulk approving:",W)}},xe=async W=>{try{(await zr.bulkReject(u,W)).success&&(f([]),S())}catch(Z){console.error("Error bulk rejecting:",Z)}},ee=()=>(u.length>0?e.filter(Z=>u.includes(Z.id)):B).map(Z=>({Date:Z.workedOn||"",Employee:Z.userName||"",Email:Z.userEmail||"",Project:Z.projectName||"",Task:Z.taskTitle||"",Hours:Z.hours||0,Billable:Z.isBillable?"Yes":"No","Bill Rate":Z.billRate||"","Cost Rate":Z.costRate||"",Cost:Z.cost||0,Status:Z.status||"pending",Note:Z.note||"","Approved By":Z.approverName||"","Approved At":Z.approvedAt||""})),Y=()=>{const W=ee();if(W.length===0){alert("No data to export. Please select timesheets or adjust your filters.");return}const Z=Object.keys(W[0]||{}),ie=W.map(je=>Z.map($e=>je[$e]||"")),ce=[Z.join(","),...ie.map(je=>je.map($e=>`"${String($e).replace(/"/g,'""')}"`).join(","))].join(`
`),ne=new Blob([ce],{type:"text/csv;charset=utf-8;"}),me=window.URL.createObjectURL(ne),Se=document.createElement("a");Se.href=me,Se.download=`timesheets-${new Date().toISOString().split("T")[0]}.csv`,Se.click(),window.URL.revokeObjectURL(me)},F=()=>{const W=ee();if(W.length===0){alert("No data to export. Please select timesheets or adjust your filters.");return}const Z=Fc.json_to_sheet(W),ie=Fc.book_new();Fc.book_append_sheet(ie,Z,"Timesheets");const ce=15,ne=Object.keys(W[0]||{}).map(()=>({wch:ce}));Z["!cols"]=ne,xT(ie,`timesheets-${new Date().toISOString().split("T")[0]}.xlsx`)},K=W=>{f(Z=>Z.filter(ie=>ie!==W)),S()},te=W=>{f(Z=>Z.filter(ie=>ie!==W)),S()},T=()=>{S(),y(!1),w(null)},M=W=>new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR",minimumFractionDigits:0,maximumFractionDigits:0}).format(W),D=W=>{if(!W)return"0h";const Z=Math.floor(W),ie=Math.round((W-Z)*60);return ie===0?`${Z}h`:`${Z}h ${ie}m`},B=e.filter(W=>{var ie,ce,ne,me;if(!c.trim())return!0;const Z=c.toLowerCase();return((ie=W.userName)==null?void 0:ie.toLowerCase().includes(Z))||((ce=W.projectName)==null?void 0:ce.toLowerCase().includes(Z))||((ne=W.taskTitle)==null?void 0:ne.toLowerCase().includes(Z))||((me=W.note)==null?void 0:me.toLowerCase().includes(Z))}),q=e.reduce((W,Z)=>(Z.userId&&!W.find(ie=>ie.id===Z.userId)&&W.push({id:Z.userId,name:Z.userName||"Unknown"}),W),[]);return a.jsxs("div",{className:"h-full bg-gray-50",children:[a.jsxs("header",{className:"bg-white border-b border-gray-200 px-6 py-4",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsxs("div",{className:"flex items-center gap-5 flex-1",children:[a.jsx("h1",{className:"text-2xl font-semibold text-gray-900",children:"Timesheets"}),a.jsxs("div",{className:"relative flex-1 max-w-md",children:[a.jsx(hn,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),a.jsx("input",{value:c,onChange:W=>d(W.target.value),type:"text",placeholder:"Search timesheets...",className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-400 focus:border-transparent text-sm",disabled:b})]})]}),a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsxs("button",{onClick:Y,className:"flex items-center gap-2 px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",title:"Export as CSV",children:[a.jsx(oa,{className:"w-4 h-4"}),a.jsx("span",{className:"hidden sm:inline",children:"CSV"})]}),a.jsxs("button",{onClick:F,className:"flex items-center gap-2 px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",title:"Export as Excel",children:[a.jsx(oa,{className:"w-4 h-4"}),a.jsx("span",{className:"hidden sm:inline",children:"Excel"})]}),a.jsx(kT,{filters:l,projects:r,employees:q,onFilterChange:R,onSavedViewChange:U}),a.jsxs("button",{onClick:()=>{w(null),y(!0)},className:"px-4 py-2 text-sm font-medium text-white rounded-lg hover:opacity-90 transition-opacity disabled:opacity-50",style:{backgroundColor:"#714b67"},disabled:b,children:[a.jsx(ar,{className:"inline w-4 h-4 mr-2"})," New Timesheet"]})]})]}),a.jsxs("div",{className:"grid grid-cols-4 gap-3 mb-4",children:[a.jsxs("div",{className:"bg-gray-50 rounded-lg p-3",children:[a.jsx("div",{className:"text-sm text-gray-600 mb-1",children:"Total Hours"}),a.jsx("div",{className:"text-xl font-semibold",style:{color:"#714b67"},children:D(s.totalHours)})]}),a.jsxs("div",{className:"bg-gray-50 rounded-lg p-3",children:[a.jsx("div",{className:"text-sm text-gray-600 mb-1",children:"Billable Hours"}),a.jsx("div",{className:"text-xl font-semibold text-gray-900",children:D(s.billableHours)})]}),a.jsxs("div",{className:"bg-gray-50 rounded-lg p-3",children:[a.jsx("div",{className:"text-sm text-gray-600 mb-1",children:"Pending Approvals"}),a.jsx("div",{className:"text-xl font-semibold text-gray-900",children:s.pendingApprovals})]}),a.jsxs("div",{className:"bg-gray-50 rounded-lg p-3",children:[a.jsx("div",{className:"text-sm text-gray-600 mb-1",children:"Total Cost"}),a.jsx("div",{className:"text-xl font-semibold text-gray-900",children:M(s.totalCost)})]})]}),a.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[a.jsx("button",{onClick:()=>R({status:"pending"}),className:`px-3 py-1.5 text-sm font-medium rounded-lg transition-colors ${l.status==="pending"?"text-white":"bg-white text-gray-700 border border-gray-300 hover:bg-gray-50"}`,style:l.status==="pending"?{backgroundColor:"#714b67"}:{},children:"Pending"}),a.jsx("button",{onClick:()=>R({status:"approved"}),className:`px-3 py-1.5 text-sm font-medium rounded-lg transition-colors ${l.status==="approved"?"text-white":"bg-white text-gray-700 border border-gray-300 hover:bg-gray-50"}`,style:l.status==="approved"?{backgroundColor:"#714b67"}:{},children:"Approved"}),a.jsx("button",{onClick:()=>R({status:"rejected"}),className:`px-3 py-1.5 text-sm font-medium rounded-lg transition-colors ${l.status==="rejected"?"text-white":"bg-white text-gray-700 border border-gray-300 hover:bg-gray-50"}`,style:l.status==="rejected"?{backgroundColor:"#714b67"}:{},children:"Rejected"}),a.jsx("button",{onClick:()=>{const{status:W,...Z}=l;R(Z)},className:`px-3 py-1.5 text-sm font-medium rounded-lg transition-colors ${l.status?"bg-white text-gray-700 border border-gray-300 hover:bg-gray-50":"text-white"}`,style:l.status?{}:{backgroundColor:"#714b67"},children:"All"})]})]}),a.jsxs("div",{className:"p-6",children:[b&&a.jsx("div",{className:"flex items-center justify-center h-64",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"inline-block animate-spin rounded-full h-10 w-10 border-b-2 border-gray-900 mb-3"}),a.jsx("p",{className:"text-sm text-gray-600",children:"Loading timesheets..."})]})}),L&&!b&&a.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 mb-4",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("svg",{className:"w-5 h-5 text-red-600",fill:"currentColor",viewBox:"0 0 20 20",children:a.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})}),a.jsx("span",{className:"text-sm text-red-800 font-medium",children:L})]}),a.jsx("button",{onClick:S,className:"text-sm text-red-600 hover:text-red-800 font-medium",children:"Retry"})]})}),!b&&!L&&a.jsx(AT,{selectedCount:u.length,onBulkApprove:ae,onBulkReject:xe,onExportCSV:Y,onExportExcel:F}),!b&&!L&&a.jsx(a.Fragment,{children:B.length===0?a.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-12 text-center",children:[a.jsx(Yt,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),a.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No timesheets found"}),a.jsx("p",{className:"text-sm text-gray-500 mb-4",children:l.status?`No timesheets with status: ${l.status}`:"Try adjusting your filters or create a new timesheet entry."}),a.jsxs("div",{className:"flex items-center justify-center gap-3",children:[a.jsx("button",{onClick:()=>o({date_from:I(),date_to:new Date().toISOString().split("T")[0]}),className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",children:"Clear Filters"}),a.jsx("button",{onClick:()=>{w(null),y(!0)},className:"px-4 py-2 text-sm font-medium text-white rounded-lg hover:opacity-90",style:{backgroundColor:"#714b67"},children:"New Timesheet"})]})]}):a.jsx("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:a.jsx(CT,{timesheets:B,selectedIds:u,onSelect:G,onSelectAll:se,onRowClick:Ne})})})]}),p&&h&&a.jsx(FT,{timesheet:h,onClose:()=>{x(!1),m(null)},onUpdate:async()=>{if(await S(),h!=null&&h.id)try{const W=await zr.getById(h.id);W.success&&m(W.data)}catch(W){console.error("Error refreshing timesheet:",W)}},onApprove:K,onReject:te}),v&&a.jsx(OT,{timesheet:g,projects:r,employees:q,onClose:()=>{y(!1),w(null)},onSave:T})]})}const RT=[{icon:cp,label:"Sales Orders",path:"/settings/sales-orders",description:"Manage customer sales orders"},{icon:yt,label:"Purchase Orders",path:"/settings/purchase-orders",description:"Manage vendor purchase orders"},{icon:ap,label:"Invoices",path:"/settings/invoices",description:"Manage customer invoices"},{icon:Po,label:"Vendor Bills",path:"/settings/vendor-bills",description:"Manage vendor bills"}];function IT(){const e=xa(),t=r=>{const n=`/app${r}`;return e.pathname===n};return a.jsx("div",{className:"p-8",children:a.jsxs("div",{className:"max-w-6xl mx-auto",children:[a.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-8",children:"Settings"}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:RT.map(r=>{const n=r.icon,s=t(r.path);return a.jsxs(Ql,{to:`/app${r.path}`,className:Ba("flex items-start gap-4 p-6 rounded-lg border-2 transition-all",s?"border-blue-500 bg-blue-50":"border-gray-200 bg-white hover:border-gray-300 hover:shadow-md"),children:[a.jsx("div",{className:Ba("p-3 rounded-lg",s?"bg-blue-100":"bg-gray-100"),children:a.jsx(n,{className:Ba("w-6 h-6",s?"text-blue-600":"text-gray-600")})}),a.jsxs("div",{className:"flex-1",children:[a.jsx("h3",{className:Ba("text-lg font-semibold mb-1",s?"text-blue-900":"text-gray-900"),children:r.label}),a.jsx("p",{className:"text-sm text-gray-600",children:r.description})]})]},r.path)})})]})})}const Ch={draft:"bg-gray-100 text-gray-700",confirmed:"bg-green-100 text-green-700",fulfilled:"bg-blue-100 text-blue-700",closed:"bg-purple-100 text-purple-700",cancelled:"bg-red-100 text-red-700"},DT={draft:yt,confirmed:ht,fulfilled:Yt,closed:ht,cancelled:yr};function LT({salesOrders:e,selectedIds:t,onSelect:r,onSelectAll:n,onRowClick:s}){const i=e.length>0&&t.length===e.length,l=t.length>0&&t.length<e.length,o=(u,f="INR")=>new Intl.NumberFormat("en-IN",{style:"currency",currency:f,minimumFractionDigits:0,maximumFractionDigits:0}).format(u),c=u=>u?new Date(u).toLocaleDateString("en-IN",{day:"numeric",month:"short",year:"numeric"}):"-",d=u=>{const f=DT[u]||yt;return a.jsxs("span",{className:`inline-flex items-center gap-1.5 px-2.5 py-1 rounded-full text-xs font-medium ${Ch[u]||Ch.draft}`,children:[a.jsx(f,{className:"w-3 h-3"}),u.charAt(0).toUpperCase()+u.slice(1)]})};return e.length===0?a.jsx("div",{className:"text-center py-12",children:a.jsx("p",{className:"text-gray-500",children:"No sales orders found"})}):a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full border-collapse",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"border-b border-gray-200",children:[a.jsx("th",{className:"px-4 py-3 text-left",children:a.jsx("input",{type:"checkbox",checked:i,ref:u=>{u&&(u.indeterminate=l)},onChange:u=>n(u.target.checked),className:"w-4 h-4 text-purple-600 rounded focus:ring-purple-500"})}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Number"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Date"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Customer"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Project"}),a.jsx("th",{className:"px-4 py-3 text-right text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Amount"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Status"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Reference"})]})}),a.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:e.map(u=>a.jsxs("tr",{onClick:()=>s(u),className:"hover:bg-gray-50 cursor-pointer transition-colors",children:[a.jsx("td",{className:"px-4 py-3",onClick:f=>f.stopPropagation(),children:a.jsx("input",{type:"checkbox",checked:t.includes(u.id),onChange:f=>{f.stopPropagation(),r(u.id,f.target.checked)},className:"w-4 h-4 text-purple-600 rounded focus:ring-purple-500"})}),a.jsx("td",{className:"px-4 py-3 text-sm font-medium text-gray-900",children:u.number||"-"}),a.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:c(u.orderDate)}),a.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:u.customerName||"-"}),a.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:u.projectName||"-"}),a.jsx("td",{className:"px-4 py-3 text-sm text-right font-medium text-gray-900",children:o(u.grandTotal,u.currency)}),a.jsx("td",{className:"px-4 py-3",children:d(u.status)}),a.jsx("td",{className:"px-4 py-3 text-sm text-gray-500",children:u.reference||"-"})]},u.id))})]})})}function MT({filters:e,projects:t,onFilterChange:r}){const[n,s]=C.useState(!1),i=(o,c)=>{r({[o]:c})},l=()=>{r({})};return a.jsxs("div",{className:"relative",children:[a.jsxs("button",{onClick:()=>s(!n),className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 flex items-center gap-2",children:[a.jsx(Xn,{className:"w-4 h-4"}),"Filters"]}),n&&a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"fixed inset-0 z-10",onClick:()=>s(!1)}),a.jsxs("div",{className:"absolute right-0 mt-2 w-80 bg-white border border-gray-200 rounded-lg shadow-lg z-20 p-4",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsx("h3",{className:"text-sm font-semibold text-gray-900",children:"Filters"}),a.jsx("button",{onClick:()=>s(!1),className:"text-gray-400 hover:text-gray-600",children:a.jsx(Ue,{className:"w-4 h-4"})})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Project"}),a.jsxs("select",{value:e.project_id||"",onChange:o=>i("project_id",o.target.value||void 0),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm",children:[a.jsx("option",{value:"",children:"All Projects"}),t.map(o=>a.jsx("option",{value:o.id,children:o.name},o.id))]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Status"}),a.jsxs("select",{value:Array.isArray(e.status)?e.status[0]:e.status||"",onChange:o=>i("status",o.target.value?[o.target.value]:void 0),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm",children:[a.jsx("option",{value:"",children:"All Statuses"}),a.jsx("option",{value:"draft",children:"Draft"}),a.jsx("option",{value:"confirmed",children:"Confirmed"}),a.jsx("option",{value:"fulfilled",children:"Fulfilled"}),a.jsx("option",{value:"closed",children:"Closed"}),a.jsx("option",{value:"cancelled",children:"Cancelled"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date From"}),a.jsx("input",{type:"date",value:e.date_from||"",onChange:o=>i("date_from",o.target.value||void 0),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date To"}),a.jsx("input",{type:"date",value:e.date_to||"",onChange:o=>i("date_to",o.target.value||void 0),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm"})]}),a.jsxs("div",{className:"flex gap-2 pt-2",children:[a.jsx("button",{onClick:l,className:"flex-1 px-3 py-2 text-sm font-medium text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200",children:"Clear"}),a.jsx("button",{onClick:()=>s(!1),className:"flex-1 px-3 py-2 text-sm font-medium text-white rounded-lg hover:opacity-90",style:{backgroundColor:"#714b67"},children:"Apply"})]})]})]})]})]})}function BT({selectedCount:e,onBulkConfirm:t,onBulkCancel:r}){return e===0?null:a.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-4 flex items-center justify-between",children:[a.jsx("div",{className:"flex items-center gap-2",children:a.jsxs("span",{className:"text-sm font-medium text-blue-900",children:[e," order",e!==1?"s":""," selected"]})}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("button",{onClick:t,className:"px-3 py-1.5 text-sm font-medium text-white rounded-lg hover:opacity-90",style:{backgroundColor:"#714b67"},children:"Confirm"}),a.jsx("button",{onClick:r,className:"px-3 py-1.5 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",children:"Cancel"})]})]})}function UT({order:e,onClose:t,onUpdate:r}){const n=(o,c="INR")=>new Intl.NumberFormat("en-IN",{style:"currency",currency:c,minimumFractionDigits:0,maximumFractionDigits:0}).format(o),s=o=>o?new Date(o).toLocaleDateString("en-IN",{day:"numeric",month:"short",year:"numeric"}):"-",i=async()=>{try{await Yr.confirm(e.id),r()}catch(o){console.error("Error confirming order:",o)}},l=async()=>{try{await Yr.cancel(e.id),r()}catch(o){console.error("Error cancelling order:",o)}};return a.jsxs("div",{className:"fixed inset-0 z-50 overflow-hidden",children:[a.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-50",onClick:t}),a.jsx("div",{className:"absolute right-0 top-0 bottom-0 w-full max-w-2xl bg-white shadow-xl",children:a.jsxs("div",{className:"h-full flex flex-col",children:[a.jsxs("div",{className:"px-6 py-4 border-b border-gray-200 flex items-center justify-between",children:[a.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Sales Order Details"}),a.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-600",children:a.jsx(Ue,{className:"w-5 h-5"})})]}),a.jsx("div",{className:"flex-1 overflow-y-auto p-6",children:a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"text-sm font-medium text-gray-500 mb-2",children:"Order Information"}),a.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 space-y-2",children:[a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-sm text-gray-600",children:"Number:"}),a.jsx("span",{className:"text-sm font-medium text-gray-900",children:e.number||"-"})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-sm text-gray-600",children:"Date:"}),a.jsx("span",{className:"text-sm font-medium text-gray-900",children:s(e.orderDate)})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-sm text-gray-600",children:"Customer:"}),a.jsx("span",{className:"text-sm font-medium text-gray-900",children:e.customerName||"-"})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-sm text-gray-600",children:"Project:"}),a.jsx("span",{className:"text-sm font-medium text-gray-900",children:e.projectName||"-"})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-sm text-gray-600",children:"Status:"}),a.jsx("span",{className:"text-sm font-medium text-gray-900 capitalize",children:e.status||"-"})]})]})]}),e.lines&&e.lines.length>0&&a.jsxs("div",{children:[a.jsx("h3",{className:"text-sm font-medium text-gray-500 mb-2",children:"Line Items"}),a.jsx("div",{className:"border border-gray-200 rounded-lg overflow-hidden",children:a.jsxs("table",{className:"w-full",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-4 py-2 text-left text-xs font-semibold text-gray-600",children:"Description"}),a.jsx("th",{className:"px-4 py-2 text-right text-xs font-semibold text-gray-600",children:"Quantity"}),a.jsx("th",{className:"px-4 py-2 text-right text-xs font-semibold text-gray-600",children:"Price"}),a.jsx("th",{className:"px-4 py-2 text-right text-xs font-semibold text-gray-600",children:"Total"})]})}),a.jsx("tbody",{className:"divide-y divide-gray-200",children:e.lines.map(o=>a.jsxs("tr",{children:[a.jsx("td",{className:"px-4 py-2 text-sm text-gray-900",children:o.description}),a.jsx("td",{className:"px-4 py-2 text-sm text-right text-gray-900",children:o.quantity}),a.jsx("td",{className:"px-4 py-2 text-sm text-right text-gray-900",children:n(o.unitPrice,e.currency)}),a.jsx("td",{className:"px-4 py-2 text-sm text-right font-medium text-gray-900",children:n(o.lineTotal,e.currency)})]},o.id))})]})})]}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-sm font-medium text-gray-500 mb-2",children:"Totals"}),a.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 space-y-2",children:[a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-sm text-gray-600",children:"Subtotal:"}),a.jsx("span",{className:"text-sm font-medium text-gray-900",children:n(e.subtotal||0,e.currency)})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-sm text-gray-600",children:"Tax:"}),a.jsx("span",{className:"text-sm font-medium text-gray-900",children:n(e.taxTotal||0,e.currency)})]}),a.jsxs("div",{className:"flex justify-between border-t border-gray-300 pt-2",children:[a.jsx("span",{className:"text-sm font-semibold text-gray-900",children:"Grand Total:"}),a.jsx("span",{className:"text-sm font-semibold text-gray-900",children:n(e.grandTotal||0,e.currency)})]})]})]})]})}),a.jsxs("div",{className:"px-6 py-4 border-t border-gray-200 flex items-center justify-end gap-3",children:[e.status==="draft"&&a.jsxs(a.Fragment,{children:[a.jsx("button",{onClick:i,className:"px-4 py-2 text-sm font-medium text-white rounded-lg hover:opacity-90",style:{backgroundColor:"#714b67"},children:"Confirm"}),a.jsx("button",{onClick:l,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",children:"Cancel Order"})]}),a.jsx("button",{onClick:t,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",children:"Close"})]})]})})]})}function zT({order:e,projects:t,onClose:r,onSave:n}){const[s,i]=C.useState({project_id:"",customer_partner_id:"",order_date:new Date().toISOString().split("T")[0],currency:"INR",lines:[{description:"",quantity:1,unit_price:0}]}),[l,o]=C.useState(!1);C.useEffect(()=>{var f;e&&i({project_id:e.projectId||"",customer_partner_id:e.customerPartnerId||"",order_date:e.orderDate||new Date().toISOString().split("T")[0],currency:e.currency||"INR",lines:((f=e.lines)==null?void 0:f.map(h=>({description:h.description,quantity:h.quantity,unit_price:h.unitPrice})))||[{description:"",quantity:1,unit_price:0}]})},[e]);const c=async f=>{f.preventDefault(),o(!0);try{e?await Yr.update(e.id,s):await Yr.create(s),n()}catch(h){console.error("Error saving sales order:",h),alert("Failed to save sales order")}finally{o(!1)}},d=()=>{i(f=>({...f,lines:[...f.lines,{description:"",quantity:1,unit_price:0}]}))},u=(f,h,m)=>{i(p=>({...p,lines:p.lines.map((x,v)=>v===f?{...x,[h]:m}:x)}))};return a.jsxs("div",{className:"fixed inset-0 z-50 overflow-hidden",children:[a.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-50",onClick:r}),a.jsx("div",{className:"absolute inset-0 flex items-center justify-center p-4",children:a.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-4xl max-h-[90vh] overflow-hidden flex flex-col",children:[a.jsxs("div",{className:"px-6 py-4 border-b border-gray-200 flex items-center justify-between",children:[a.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:e?"Edit Sales Order":"New Sales Order"}),a.jsx("button",{onClick:r,className:"text-gray-400 hover:text-gray-600",children:a.jsx(Ue,{className:"w-5 h-5"})})]}),a.jsx("form",{onSubmit:c,className:"flex-1 overflow-y-auto p-6",children:a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Project"}),a.jsxs("select",{value:s.project_id,onChange:f=>i(h=>({...h,project_id:f.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm",children:[a.jsx("option",{value:"",children:"Select Project"}),t.map(f=>a.jsx("option",{value:f.id,children:f.name},f.id))]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Order Date"}),a.jsx("input",{type:"date",value:s.order_date,onChange:f=>i(h=>({...h,order_date:f.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm",required:!0})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Customer Partner ID"}),a.jsx("input",{type:"text",value:s.customer_partner_id,onChange:f=>i(h=>({...h,customer_partner_id:f.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm",placeholder:"Enter customer partner ID",required:!0})]}),a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Line Items"}),a.jsx("button",{type:"button",onClick:d,className:"text-sm text-blue-600 hover:text-blue-800",children:"+ Add Line"})]}),a.jsx("div",{className:"border border-gray-200 rounded-lg overflow-hidden",children:a.jsxs("table",{className:"w-full",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-4 py-2 text-left text-xs font-semibold text-gray-600",children:"Description"}),a.jsx("th",{className:"px-4 py-2 text-right text-xs font-semibold text-gray-600",children:"Quantity"}),a.jsx("th",{className:"px-4 py-2 text-right text-xs font-semibold text-gray-600",children:"Unit Price"})]})}),a.jsx("tbody",{className:"divide-y divide-gray-200",children:s.lines.map((f,h)=>a.jsxs("tr",{children:[a.jsx("td",{className:"px-4 py-2",children:a.jsx("input",{type:"text",value:f.description,onChange:m=>u(h,"description",m.target.value),className:"w-full px-2 py-1 border border-gray-300 rounded text-sm",required:!0})}),a.jsx("td",{className:"px-4 py-2",children:a.jsx("input",{type:"number",value:f.quantity,onChange:m=>u(h,"quantity",parseFloat(m.target.value)||0),className:"w-full px-2 py-1 border border-gray-300 rounded text-sm text-right",min:"0",step:"0.01",required:!0})}),a.jsx("td",{className:"px-4 py-2",children:a.jsx("input",{type:"number",value:f.unit_price,onChange:m=>u(h,"unit_price",parseFloat(m.target.value)||0),className:"w-full px-2 py-1 border border-gray-300 rounded text-sm text-right",min:"0",step:"0.01",required:!0})})]},h))})]})})]})]})}),a.jsxs("div",{className:"px-6 py-4 border-t border-gray-200 flex items-center justify-end gap-3",children:[a.jsx("button",{onClick:r,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",children:"Cancel"}),a.jsx("button",{onClick:c,disabled:l,className:"px-4 py-2 text-sm font-medium text-white rounded-lg hover:opacity-90 disabled:opacity-50",style:{backgroundColor:"#714b67"},children:l?"Saving...":"Save"})]})]})})]})}function $T(){const[e,t]=C.useState([]),[r,n]=C.useState([]),[s,i]=C.useState({totalCount:0,draftCount:0,confirmedCount:0,fulfilledCount:0,totalAmount:0,confirmedAmount:0}),[l,o]=C.useState({date_from:I(),date_to:new Date().toISOString().split("T")[0]}),[c,d]=C.useState(""),[u,f]=C.useState([]),[h,m]=C.useState(null),[p,x]=C.useState(!1),[v,y]=C.useState(!1),[g,w]=C.useState(null),[b,P]=C.useState(!0),[L,E]=C.useState(null);function I(){const F=new Date;return F.setDate(F.getDate()-90),F.toISOString().split("T")[0]}C.useEffect(()=>{S()},[l]);const S=async()=>{try{P(!0),E(null);const F=await kr.getAll();F.success&&n(F.data);const K=await Yr.getAll(l);K.success?t(K.data):E(K.message||"Failed to load sales orders");const te=await Yr.getStats(l);te.success&&i(te.data)}catch(F){console.error("Error loading data:",F),E("Unable to connect to server. Please try again.")}finally{P(!1)}},R=F=>{Object.keys(F).length===0?o({date_from:I(),date_to:new Date().toISOString().split("T")[0]}):o(K=>{const te={...K};return Object.keys(F).forEach(T=>{const M=F[T];M===void 0||M===""||M===null||Array.isArray(M)&&M.length===0?delete te[T]:te[T]=M}),te}),f([])},U=(F,K)=>{f(K?te=>[...te,F]:te=>te.filter(T=>T!==F))},G=F=>{f(F?e.map(K=>K.id):[])},se=F=>{m(F),x(!0)},Ne=async()=>{try{for(const F of u)await Yr.confirm(F);f([]),S()}catch(F){console.error("Error bulk confirming:",F)}},ae=async()=>{try{for(const F of u)await Yr.cancel(F);f([]),S()}catch(F){console.error("Error bulk cancelling:",F)}},xe=()=>{S(),y(!1),w(null)},ee=F=>new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR",minimumFractionDigits:0,maximumFractionDigits:0}).format(F),Y=e.filter(F=>{var te,T,M,D;if(!c.trim())return!0;const K=c.toLowerCase();return((te=F.number)==null?void 0:te.toLowerCase().includes(K))||((T=F.customerName)==null?void 0:T.toLowerCase().includes(K))||((M=F.projectName)==null?void 0:M.toLowerCase().includes(K))||((D=F.reference)==null?void 0:D.toLowerCase().includes(K))});return a.jsxs("div",{className:"h-full bg-gray-50",children:[a.jsxs("header",{className:"bg-white border-b border-gray-200 px-8 py-6",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsxs("div",{className:"flex items-center gap-6 flex-1",children:[a.jsx("h1",{className:"text-2xl font-semibold text-gray-900",children:"Sales Orders"}),a.jsxs("div",{className:"relative flex-1 max-w-md",children:[a.jsx(hn,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),a.jsx("input",{value:c,onChange:F=>d(F.target.value),type:"text",placeholder:"Search sales orders...",className:"w-full pl-10 pr-4 py-2.5 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-400 focus:border-transparent text-sm",disabled:b})]})]}),a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx(MT,{filters:l,projects:r,onFilterChange:R}),a.jsxs("button",{onClick:()=>{w(null),y(!0)},className:"px-4 py-2 text-sm font-medium text-white rounded-lg hover:opacity-90 transition-opacity disabled:opacity-50",style:{backgroundColor:"#714b67"},disabled:b,children:[a.jsx(ar,{className:"inline w-4 h-4 mr-2"})," New Sales Order"]})]})]}),a.jsxs("div",{className:"grid grid-cols-4 gap-4 mb-4",children:[a.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[a.jsx("div",{className:"text-sm text-gray-600 mb-1",children:"Total Orders"}),a.jsx("div",{className:"text-2xl font-semibold",style:{color:"#714b67"},children:s.totalCount})]}),a.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[a.jsx("div",{className:"text-sm text-gray-600 mb-1",children:"Draft"}),a.jsx("div",{className:"text-2xl font-semibold text-gray-900",children:s.draftCount})]}),a.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[a.jsx("div",{className:"text-sm text-gray-600 mb-1",children:"Confirmed"}),a.jsx("div",{className:"text-2xl font-semibold text-gray-900",children:s.confirmedCount})]}),a.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[a.jsx("div",{className:"text-sm text-gray-600 mb-1",children:"Total Amount"}),a.jsx("div",{className:"text-2xl font-semibold text-gray-900",children:ee(s.totalAmount)})]})]}),a.jsxs("div",{className:"flex items-center gap-2 mb-4 flex-wrap",children:[a.jsx("button",{onClick:()=>R({status:["draft"]}),className:`px-3 py-1.5 text-sm font-medium rounded-lg transition-colors ${JSON.stringify(l.status)===JSON.stringify(["draft"])?"text-white":"bg-white text-gray-700 border border-gray-300 hover:bg-gray-50"}`,style:JSON.stringify(l.status)===JSON.stringify(["draft"])?{backgroundColor:"#714b67"}:{},children:"Draft"}),a.jsx("button",{onClick:()=>R({status:["confirmed"]}),className:`px-3 py-1.5 text-sm font-medium rounded-lg transition-colors ${JSON.stringify(l.status)===JSON.stringify(["confirmed"])?"text-white":"bg-white text-gray-700 border border-gray-300 hover:bg-gray-50"}`,style:JSON.stringify(l.status)===JSON.stringify(["confirmed"])?{backgroundColor:"#714b67"}:{},children:"Confirmed"}),a.jsx("button",{onClick:()=>{const{status:F,...K}=l;R(K)},className:`px-3 py-1.5 text-sm font-medium rounded-lg transition-colors ${l.status?"bg-white text-gray-700 border border-gray-300 hover:bg-gray-50":"text-white"}`,style:l.status?{}:{backgroundColor:"#714b67"},children:"All"})]})]}),a.jsxs("div",{className:"p-6",children:[b&&a.jsx("div",{className:"flex items-center justify-center h-64",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"inline-block animate-spin rounded-full h-12 w-12 border-b-2 border-gray-900 mb-4"}),a.jsx("p",{className:"text-gray-600",children:"Loading sales orders..."})]})}),L&&!b&&a.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 mb-4",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"text-red-800 font-medium",children:L}),a.jsx("button",{onClick:S,className:"text-red-600 hover:text-red-800 font-medium text-sm",children:"Retry"})]})}),!b&&!L&&a.jsx(BT,{selectedCount:u.length,onBulkConfirm:Ne,onBulkCancel:ae}),!b&&!L&&a.jsx(a.Fragment,{children:Y.length===0?a.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-12 text-center",children:[a.jsx(cp,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),a.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No sales orders found"}),a.jsx("p",{className:"text-sm text-gray-500 mb-4",children:"Try adjusting your filters or create a new sales order."}),a.jsx("button",{onClick:()=>{w(null),y(!0)},className:"px-4 py-2 text-sm font-medium text-white rounded-lg hover:opacity-90",style:{backgroundColor:"#714b67"},children:"New Sales Order"})]}):a.jsx("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:a.jsx(LT,{salesOrders:Y,selectedIds:u,onSelect:U,onSelectAll:G,onRowClick:se})})})]}),p&&h&&a.jsx(UT,{order:h,onClose:()=>{x(!1),m(null)},onUpdate:async()=>{if(await S(),h!=null&&h.id)try{const F=await Yr.getById(h.id);F.success&&m(F.data)}catch(F){console.error("Error refreshing order:",F)}}}),v&&a.jsx(zT,{order:g,projects:r,onClose:()=>{y(!1),w(null)},onSave:xe})]})}const kh={draft:"bg-gray-100 text-gray-700",confirmed:"bg-green-100 text-green-700",fulfilled:"bg-blue-100 text-blue-700",closed:"bg-purple-100 text-purple-700",cancelled:"bg-red-100 text-red-700"},WT={draft:yt,confirmed:ht,fulfilled:Yt,closed:ht,cancelled:yr};function HT({purchaseOrders:e,selectedIds:t,onSelect:r,onSelectAll:n,onRowClick:s}){const i=e.length>0&&t.length===e.length,l=t.length>0&&t.length<e.length,o=(u,f="INR")=>new Intl.NumberFormat("en-IN",{style:"currency",currency:f,minimumFractionDigits:0,maximumFractionDigits:0}).format(u),c=u=>u?new Date(u).toLocaleDateString("en-IN",{day:"numeric",month:"short",year:"numeric"}):"-",d=u=>{const f=WT[u]||yt;return a.jsxs("span",{className:`inline-flex items-center gap-1.5 px-2.5 py-1 rounded-full text-xs font-medium ${kh[u]||kh.draft}`,children:[a.jsx(f,{className:"w-3 h-3"}),u.charAt(0).toUpperCase()+u.slice(1)]})};return e.length===0?a.jsx("div",{className:"text-center py-12",children:a.jsx("p",{className:"text-gray-500",children:"No purchase orders found"})}):a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full border-collapse",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"border-b border-gray-200",children:[a.jsx("th",{className:"px-4 py-3 text-left",children:a.jsx("input",{type:"checkbox",checked:i,ref:u=>{u&&(u.indeterminate=l)},onChange:u=>n(u.target.checked),className:"w-4 h-4 text-purple-600 rounded focus:ring-purple-500"})}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Number"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Date"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Vendor"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Project"}),a.jsx("th",{className:"px-4 py-3 text-right text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Amount"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Status"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Reference"})]})}),a.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:e.map(u=>a.jsxs("tr",{onClick:()=>s(u),className:"hover:bg-gray-50 cursor-pointer transition-colors",children:[a.jsx("td",{className:"px-4 py-3",onClick:f=>f.stopPropagation(),children:a.jsx("input",{type:"checkbox",checked:t.includes(u.id),onChange:f=>{f.stopPropagation(),r(u.id,f.target.checked)},className:"w-4 h-4 text-purple-600 rounded focus:ring-purple-500"})}),a.jsx("td",{className:"px-4 py-3 text-sm font-medium text-gray-900",children:u.number||"-"}),a.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:c(u.orderDate)}),a.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:u.vendorName||"-"}),a.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:u.projectName||"-"}),a.jsx("td",{className:"px-4 py-3 text-sm text-right font-medium text-gray-900",children:o(u.grandTotal,u.currency)}),a.jsx("td",{className:"px-4 py-3",children:d(u.status)}),a.jsx("td",{className:"px-4 py-3 text-sm text-gray-500",children:u.reference||"-"})]},u.id))})]})})}function VT({filters:e,projects:t,onFilterChange:r}){const[n,s]=C.useState(!1),i=(o,c)=>{r({[o]:c})},l=()=>{r({})};return a.jsxs("div",{className:"relative",children:[a.jsxs("button",{onClick:()=>s(!n),className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 flex items-center gap-2",children:[a.jsx(Xn,{className:"w-4 h-4"}),"Filters"]}),n&&a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"fixed inset-0 z-10",onClick:()=>s(!1)}),a.jsxs("div",{className:"absolute right-0 mt-2 w-80 bg-white border border-gray-200 rounded-lg shadow-lg z-20 p-4",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsx("h3",{className:"text-sm font-semibold text-gray-900",children:"Filters"}),a.jsx("button",{onClick:()=>s(!1),className:"text-gray-400 hover:text-gray-600",children:a.jsx(Ue,{className:"w-4 h-4"})})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Project"}),a.jsxs("select",{value:e.project_id||"",onChange:o=>i("project_id",o.target.value||void 0),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm",children:[a.jsx("option",{value:"",children:"All Projects"}),t.map(o=>a.jsx("option",{value:o.id,children:o.name},o.id))]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Status"}),a.jsxs("select",{value:Array.isArray(e.status)?e.status[0]:e.status||"",onChange:o=>i("status",o.target.value?[o.target.value]:void 0),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm",children:[a.jsx("option",{value:"",children:"All Statuses"}),a.jsx("option",{value:"draft",children:"Draft"}),a.jsx("option",{value:"confirmed",children:"Confirmed"}),a.jsx("option",{value:"fulfilled",children:"Fulfilled"}),a.jsx("option",{value:"closed",children:"Closed"}),a.jsx("option",{value:"cancelled",children:"Cancelled"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date From"}),a.jsx("input",{type:"date",value:e.date_from||"",onChange:o=>i("date_from",o.target.value||void 0),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date To"}),a.jsx("input",{type:"date",value:e.date_to||"",onChange:o=>i("date_to",o.target.value||void 0),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm"})]}),a.jsxs("div",{className:"flex gap-2 pt-2",children:[a.jsx("button",{onClick:l,className:"flex-1 px-3 py-2 text-sm font-medium text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200",children:"Clear"}),a.jsx("button",{onClick:()=>s(!1),className:"flex-1 px-3 py-2 text-sm font-medium text-white rounded-lg hover:opacity-90",style:{backgroundColor:"#714b67"},children:"Apply"})]})]})]})]})]})}function GT({selectedCount:e,onBulkConfirm:t,onBulkCancel:r}){return e===0?null:a.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-4 flex items-center justify-between",children:[a.jsx("div",{className:"flex items-center gap-2",children:a.jsxs("span",{className:"text-sm font-medium text-blue-900",children:[e," order",e!==1?"s":""," selected"]})}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("button",{onClick:t,className:"px-3 py-1.5 text-sm font-medium text-white rounded-lg hover:opacity-90",style:{backgroundColor:"#714b67"},children:"Confirm"}),a.jsx("button",{onClick:r,className:"px-3 py-1.5 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",children:"Cancel"})]})]})}function XT({order:e,onClose:t,onUpdate:r}){const n=(o,c="INR")=>new Intl.NumberFormat("en-IN",{style:"currency",currency:c,minimumFractionDigits:0,maximumFractionDigits:0}).format(o),s=o=>o?new Date(o).toLocaleDateString("en-IN",{day:"numeric",month:"short",year:"numeric"}):"-",i=async()=>{try{await Jr.confirm(e.id),r()}catch(o){console.error("Error confirming order:",o)}},l=async()=>{try{await Jr.cancel(e.id),r()}catch(o){console.error("Error cancelling order:",o)}};return a.jsxs("div",{className:"fixed inset-0 z-50 overflow-hidden",children:[a.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-50",onClick:t}),a.jsx("div",{className:"absolute right-0 top-0 bottom-0 w-full max-w-2xl bg-white shadow-xl",children:a.jsxs("div",{className:"h-full flex flex-col",children:[a.jsxs("div",{className:"px-6 py-4 border-b border-gray-200 flex items-center justify-between",children:[a.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Purchase Order Details"}),a.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-600",children:a.jsx(Ue,{className:"w-5 h-5"})})]}),a.jsx("div",{className:"flex-1 overflow-y-auto p-6",children:a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"text-sm font-medium text-gray-500 mb-2",children:"Order Information"}),a.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 space-y-2",children:[a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-sm text-gray-600",children:"Number:"}),a.jsx("span",{className:"text-sm font-medium text-gray-900",children:e.number||"-"})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-sm text-gray-600",children:"Date:"}),a.jsx("span",{className:"text-sm font-medium text-gray-900",children:s(e.orderDate)})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-sm text-gray-600",children:"Vendor:"}),a.jsx("span",{className:"text-sm font-medium text-gray-900",children:e.vendorName||"-"})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-sm text-gray-600",children:"Project:"}),a.jsx("span",{className:"text-sm font-medium text-gray-900",children:e.projectName||"-"})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-sm text-gray-600",children:"Status:"}),a.jsx("span",{className:"text-sm font-medium text-gray-900 capitalize",children:e.status||"-"})]})]})]}),e.lines&&e.lines.length>0&&a.jsxs("div",{children:[a.jsx("h3",{className:"text-sm font-medium text-gray-500 mb-2",children:"Line Items"}),a.jsx("div",{className:"border border-gray-200 rounded-lg overflow-hidden",children:a.jsxs("table",{className:"w-full",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-4 py-2 text-left text-xs font-semibold text-gray-600",children:"Description"}),a.jsx("th",{className:"px-4 py-2 text-right text-xs font-semibold text-gray-600",children:"Quantity"}),a.jsx("th",{className:"px-4 py-2 text-right text-xs font-semibold text-gray-600",children:"Price"}),a.jsx("th",{className:"px-4 py-2 text-right text-xs font-semibold text-gray-600",children:"Total"})]})}),a.jsx("tbody",{className:"divide-y divide-gray-200",children:e.lines.map(o=>a.jsxs("tr",{children:[a.jsx("td",{className:"px-4 py-2 text-sm text-gray-900",children:o.description}),a.jsx("td",{className:"px-4 py-2 text-sm text-right text-gray-900",children:o.quantity}),a.jsx("td",{className:"px-4 py-2 text-sm text-right text-gray-900",children:n(o.unitPrice,e.currency)}),a.jsx("td",{className:"px-4 py-2 text-sm text-right font-medium text-gray-900",children:n(o.lineTotal,e.currency)})]},o.id))})]})})]}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-sm font-medium text-gray-500 mb-2",children:"Totals"}),a.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 space-y-2",children:[a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-sm text-gray-600",children:"Subtotal:"}),a.jsx("span",{className:"text-sm font-medium text-gray-900",children:n(e.subtotal||0,e.currency)})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-sm text-gray-600",children:"Tax:"}),a.jsx("span",{className:"text-sm font-medium text-gray-900",children:n(e.taxTotal||0,e.currency)})]}),a.jsxs("div",{className:"flex justify-between border-t border-gray-300 pt-2",children:[a.jsx("span",{className:"text-sm font-semibold text-gray-900",children:"Grand Total:"}),a.jsx("span",{className:"text-sm font-semibold text-gray-900",children:n(e.grandTotal||0,e.currency)})]})]})]})]})}),a.jsxs("div",{className:"px-6 py-4 border-t border-gray-200 flex items-center justify-end gap-3",children:[e.status==="draft"&&a.jsxs(a.Fragment,{children:[a.jsx("button",{onClick:i,className:"px-4 py-2 text-sm font-medium text-white rounded-lg hover:opacity-90",style:{backgroundColor:"#714b67"},children:"Confirm"}),a.jsx("button",{onClick:l,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",children:"Cancel Order"})]}),a.jsx("button",{onClick:t,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",children:"Close"})]})]})})]})}function KT({order:e,projects:t,onClose:r,onSave:n}){const[s,i]=C.useState({project_id:"",vendor_partner_id:"",order_date:new Date().toISOString().split("T")[0],currency:"INR",lines:[{description:"",quantity:1,unit_price:0}]}),[l,o]=C.useState(!1);C.useEffect(()=>{var f;e&&i({project_id:e.projectId||"",vendor_partner_id:e.vendorPartnerId||"",order_date:e.orderDate||new Date().toISOString().split("T")[0],currency:e.currency||"INR",lines:((f=e.lines)==null?void 0:f.map(h=>({description:h.description,quantity:h.quantity,unit_price:h.unitPrice})))||[{description:"",quantity:1,unit_price:0}]})},[e]);const c=async f=>{f.preventDefault(),o(!0);try{e?await Jr.update(e.id,s):await Jr.create(s),n()}catch(h){console.error("Error saving purchase order:",h),alert("Failed to save purchase order")}finally{o(!1)}},d=()=>{i(f=>({...f,lines:[...f.lines,{description:"",quantity:1,unit_price:0}]}))},u=(f,h,m)=>{i(p=>({...p,lines:p.lines.map((x,v)=>v===f?{...x,[h]:m}:x)}))};return a.jsxs("div",{className:"fixed inset-0 z-50 overflow-hidden",children:[a.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-50",onClick:r}),a.jsx("div",{className:"absolute inset-0 flex items-center justify-center p-4",children:a.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-4xl max-h-[90vh] overflow-hidden flex flex-col",children:[a.jsxs("div",{className:"px-6 py-4 border-b border-gray-200 flex items-center justify-between",children:[a.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:e?"Edit Purchase Order":"New Purchase Order"}),a.jsx("button",{onClick:r,className:"text-gray-400 hover:text-gray-600",children:a.jsx(Ue,{className:"w-5 h-5"})})]}),a.jsx("form",{onSubmit:c,className:"flex-1 overflow-y-auto p-6",children:a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Project"}),a.jsxs("select",{value:s.project_id,onChange:f=>i(h=>({...h,project_id:f.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm",children:[a.jsx("option",{value:"",children:"Select Project"}),t.map(f=>a.jsx("option",{value:f.id,children:f.name},f.id))]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Order Date"}),a.jsx("input",{type:"date",value:s.order_date,onChange:f=>i(h=>({...h,order_date:f.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm",required:!0})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Vendor Partner ID"}),a.jsx("input",{type:"text",value:s.vendor_partner_id,onChange:f=>i(h=>({...h,vendor_partner_id:f.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm",placeholder:"Enter vendor partner ID",required:!0})]}),a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Line Items"}),a.jsx("button",{type:"button",onClick:d,className:"text-sm text-blue-600 hover:text-blue-800",children:"+ Add Line"})]}),a.jsx("div",{className:"border border-gray-200 rounded-lg overflow-hidden",children:a.jsxs("table",{className:"w-full",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-4 py-2 text-left text-xs font-semibold text-gray-600",children:"Description"}),a.jsx("th",{className:"px-4 py-2 text-right text-xs font-semibold text-gray-600",children:"Quantity"}),a.jsx("th",{className:"px-4 py-2 text-right text-xs font-semibold text-gray-600",children:"Unit Price"})]})}),a.jsx("tbody",{className:"divide-y divide-gray-200",children:s.lines.map((f,h)=>a.jsxs("tr",{children:[a.jsx("td",{className:"px-4 py-2",children:a.jsx("input",{type:"text",value:f.description,onChange:m=>u(h,"description",m.target.value),className:"w-full px-2 py-1 border border-gray-300 rounded text-sm",required:!0})}),a.jsx("td",{className:"px-4 py-2",children:a.jsx("input",{type:"number",value:f.quantity,onChange:m=>u(h,"quantity",parseFloat(m.target.value)||0),className:"w-full px-2 py-1 border border-gray-300 rounded text-sm text-right",min:"0",step:"0.01",required:!0})}),a.jsx("td",{className:"px-4 py-2",children:a.jsx("input",{type:"number",value:f.unit_price,onChange:m=>u(h,"unit_price",parseFloat(m.target.value)||0),className:"w-full px-2 py-1 border border-gray-300 rounded text-sm text-right",min:"0",step:"0.01",required:!0})})]},h))})]})})]})]})}),a.jsxs("div",{className:"px-6 py-4 border-t border-gray-200 flex items-center justify-end gap-3",children:[a.jsx("button",{onClick:r,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",children:"Cancel"}),a.jsx("button",{onClick:c,disabled:l,className:"px-4 py-2 text-sm font-medium text-white rounded-lg hover:opacity-90 disabled:opacity-50",style:{backgroundColor:"#714b67"},children:l?"Saving...":"Save"})]})]})})]})}function YT(){const[e,t]=C.useState([]),[r,n]=C.useState([]),[s,i]=C.useState({totalCount:0,draftCount:0,confirmedCount:0,fulfilledCount:0,totalAmount:0,confirmedAmount:0}),[l,o]=C.useState({date_from:I(),date_to:new Date().toISOString().split("T")[0]}),[c,d]=C.useState(""),[u,f]=C.useState([]),[h,m]=C.useState(null),[p,x]=C.useState(!1),[v,y]=C.useState(!1),[g,w]=C.useState(null),[b,P]=C.useState(!0),[L,E]=C.useState(null);function I(){const F=new Date;return F.setDate(F.getDate()-90),F.toISOString().split("T")[0]}C.useEffect(()=>{S()},[l]);const S=async()=>{try{P(!0),E(null);const F=await kr.getAll();F.success&&n(F.data);const K=await Jr.getAll(l);K.success?t(K.data):E(K.message||"Failed to load purchase orders");const te=await Jr.getStats(l);te.success&&i(te.data)}catch(F){console.error("Error loading data:",F),E("Unable to connect to server. Please try again.")}finally{P(!1)}},R=F=>{Object.keys(F).length===0?o({date_from:I(),date_to:new Date().toISOString().split("T")[0]}):o(K=>{const te={...K};return Object.keys(F).forEach(T=>{const M=F[T];M===void 0||M===""||M===null||Array.isArray(M)&&M.length===0?delete te[T]:te[T]=M}),te}),f([])},U=(F,K)=>{f(K?te=>[...te,F]:te=>te.filter(T=>T!==F))},G=F=>{f(F?e.map(K=>K.id):[])},se=F=>{m(F),x(!0)},Ne=async()=>{try{for(const F of u)await Jr.confirm(F);f([]),S()}catch(F){console.error("Error bulk confirming:",F)}},ae=async()=>{try{for(const F of u)await Jr.cancel(F);f([]),S()}catch(F){console.error("Error bulk cancelling:",F)}},xe=()=>{S(),y(!1),w(null)},ee=F=>new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR",minimumFractionDigits:0,maximumFractionDigits:0}).format(F),Y=e.filter(F=>{var te,T,M,D;if(!c.trim())return!0;const K=c.toLowerCase();return((te=F.number)==null?void 0:te.toLowerCase().includes(K))||((T=F.vendorName)==null?void 0:T.toLowerCase().includes(K))||((M=F.projectName)==null?void 0:M.toLowerCase().includes(K))||((D=F.reference)==null?void 0:D.toLowerCase().includes(K))});return a.jsxs("div",{className:"h-full bg-gray-50",children:[a.jsxs("header",{className:"bg-white border-b border-gray-200 px-8 py-6",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsxs("div",{className:"flex items-center gap-6 flex-1",children:[a.jsx("h1",{className:"text-2xl font-semibold text-gray-900",children:"Purchase Orders"}),a.jsxs("div",{className:"relative flex-1 max-w-md",children:[a.jsx(hn,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),a.jsx("input",{value:c,onChange:F=>d(F.target.value),type:"text",placeholder:"Search purchase orders...",className:"w-full pl-10 pr-4 py-2.5 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-400 focus:border-transparent text-sm",disabled:b})]})]}),a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx(VT,{filters:l,projects:r,onFilterChange:R}),a.jsxs("button",{onClick:()=>{w(null),y(!0)},className:"px-4 py-2 text-sm font-medium text-white rounded-lg hover:opacity-90 transition-opacity disabled:opacity-50",style:{backgroundColor:"#714b67"},disabled:b,children:[a.jsx(ar,{className:"inline w-4 h-4 mr-2"})," New Purchase Order"]})]})]}),a.jsxs("div",{className:"grid grid-cols-4 gap-4 mb-4",children:[a.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[a.jsx("div",{className:"text-sm text-gray-600 mb-1",children:"Total Orders"}),a.jsx("div",{className:"text-2xl font-semibold",style:{color:"#714b67"},children:s.totalCount})]}),a.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[a.jsx("div",{className:"text-sm text-gray-600 mb-1",children:"Draft"}),a.jsx("div",{className:"text-2xl font-semibold text-gray-900",children:s.draftCount})]}),a.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[a.jsx("div",{className:"text-sm text-gray-600 mb-1",children:"Confirmed"}),a.jsx("div",{className:"text-2xl font-semibold text-gray-900",children:s.confirmedCount})]}),a.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[a.jsx("div",{className:"text-sm text-gray-600 mb-1",children:"Total Amount"}),a.jsx("div",{className:"text-2xl font-semibold text-gray-900",children:ee(s.totalAmount)})]})]}),a.jsxs("div",{className:"flex items-center gap-2 mb-4 flex-wrap",children:[a.jsx("button",{onClick:()=>R({status:["draft"]}),className:`px-3 py-1.5 text-sm font-medium rounded-lg transition-colors ${JSON.stringify(l.status)===JSON.stringify(["draft"])?"text-white":"bg-white text-gray-700 border border-gray-300 hover:bg-gray-50"}`,style:JSON.stringify(l.status)===JSON.stringify(["draft"])?{backgroundColor:"#714b67"}:{},children:"Draft"}),a.jsx("button",{onClick:()=>R({status:["confirmed"]}),className:`px-3 py-1.5 text-sm font-medium rounded-lg transition-colors ${JSON.stringify(l.status)===JSON.stringify(["confirmed"])?"text-white":"bg-white text-gray-700 border border-gray-300 hover:bg-gray-50"}`,style:JSON.stringify(l.status)===JSON.stringify(["confirmed"])?{backgroundColor:"#714b67"}:{},children:"Confirmed"}),a.jsx("button",{onClick:()=>{const{status:F,...K}=l;R(K)},className:`px-3 py-1.5 text-sm font-medium rounded-lg transition-colors ${l.status?"bg-white text-gray-700 border border-gray-300 hover:bg-gray-50":"text-white"}`,style:l.status?{}:{backgroundColor:"#714b67"},children:"All"})]})]}),a.jsxs("div",{className:"p-6",children:[b&&a.jsx("div",{className:"flex items-center justify-center h-64",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"inline-block animate-spin rounded-full h-12 w-12 border-b-2 border-gray-900 mb-4"}),a.jsx("p",{className:"text-gray-600",children:"Loading purchase orders..."})]})}),L&&!b&&a.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 mb-4",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"text-red-800 font-medium",children:L}),a.jsx("button",{onClick:S,className:"text-red-600 hover:text-red-800 font-medium text-sm",children:"Retry"})]})}),!b&&!L&&a.jsx(GT,{selectedCount:u.length,onBulkConfirm:Ne,onBulkCancel:ae}),!b&&!L&&a.jsx(a.Fragment,{children:Y.length===0?a.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-12 text-center",children:[a.jsx(yt,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),a.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No purchase orders found"}),a.jsx("p",{className:"text-sm text-gray-500 mb-4",children:"Try adjusting your filters or create a new purchase order."}),a.jsx("button",{onClick:()=>{w(null),y(!0)},className:"px-4 py-2 text-sm font-medium text-white rounded-lg hover:opacity-90",style:{backgroundColor:"#714b67"},children:"New Purchase Order"})]}):a.jsx("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:a.jsx(HT,{purchaseOrders:Y,selectedIds:u,onSelect:U,onSelectAll:G,onRowClick:se})})})]}),p&&h&&a.jsx(XT,{order:h,onClose:()=>{x(!1),m(null)},onUpdate:async()=>{if(await S(),h!=null&&h.id)try{const F=await Jr.getById(h.id);F.success&&m(F.data)}catch(F){console.error("Error refreshing order:",F)}}}),v&&a.jsx(KT,{order:g,projects:r,onClose:()=>{y(!1),w(null)},onSave:xe})]})}const Ah={draft:"bg-gray-100 text-gray-700",posted:"bg-green-100 text-green-700",fulfilled:"bg-blue-100 text-blue-700",closed:"bg-purple-100 text-purple-700",cancelled:"bg-red-100 text-red-700"},JT={draft:yt,posted:ht,fulfilled:Yt,closed:ht,cancelled:yr};function qT({customerInvoices:e,selectedIds:t,onSelect:r,onSelectAll:n,onRowClick:s}){const i=e.length>0&&t.length===e.length,l=t.length>0&&t.length<e.length,o=(u,f="INR")=>new Intl.NumberFormat("en-IN",{style:"currency",currency:f,minimumFractionDigits:0,maximumFractionDigits:0}).format(u),c=u=>u?new Date(u).toLocaleDateString("en-IN",{day:"numeric",month:"short",year:"numeric"}):"-",d=u=>{const f=JT[u]||yt;return a.jsxs("span",{className:`inline-flex items-center gap-1.5 px-2.5 py-1 rounded-full text-xs font-medium ${Ah[u]||Ah.draft}`,children:[a.jsx(f,{className:"w-3 h-3"}),u.charAt(0).toUpperCase()+u.slice(1)]})};return e.length===0?a.jsx("div",{className:"text-center py-12",children:a.jsx("p",{className:"text-gray-500",children:"No customer invoices found"})}):a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full border-collapse",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"border-b border-gray-200",children:[a.jsx("th",{className:"px-4 py-3 text-left",children:a.jsx("input",{type:"checkbox",checked:i,ref:u=>{u&&(u.indeterminate=l)},onChange:u=>n(u.target.checked),className:"w-4 h-4 text-purple-600 rounded focus:ring-purple-500"})}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Number"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Date"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Customer"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Project"}),a.jsx("th",{className:"px-4 py-3 text-right text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Amount"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Status"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Reference"})]})}),a.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:e.map(u=>a.jsxs("tr",{onClick:()=>s(u),className:"hover:bg-gray-50 cursor-pointer transition-colors",children:[a.jsx("td",{className:"px-4 py-3",onClick:f=>f.stopPropagation(),children:a.jsx("input",{type:"checkbox",checked:t.includes(u.id),onChange:f=>{f.stopPropagation(),r(u.id,f.target.checked)},className:"w-4 h-4 text-purple-600 rounded focus:ring-purple-500"})}),a.jsx("td",{className:"px-4 py-3 text-sm font-medium text-gray-900",children:u.number||"-"}),a.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:c(u.invoiceDate)}),a.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:u.customerName||"-"}),a.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:u.projectName||"-"}),a.jsx("td",{className:"px-4 py-3 text-sm text-right font-medium text-gray-900",children:o(u.grandTotal,u.currency)}),a.jsx("td",{className:"px-4 py-3",children:d(u.status)}),a.jsx("td",{className:"px-4 py-3 text-sm text-gray-500",children:u.reference||"-"})]},u.id))})]})})}function QT({filters:e,projects:t,onFilterChange:r}){const[n,s]=C.useState(!1),i=(o,c)=>{r({[o]:c})},l=()=>{r({})};return a.jsxs("div",{className:"relative",children:[a.jsxs("button",{onClick:()=>s(!n),className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 flex items-center gap-2",children:[a.jsx(Xn,{className:"w-4 h-4"}),"Filters"]}),n&&a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"fixed inset-0 z-10",onClick:()=>s(!1)}),a.jsxs("div",{className:"absolute right-0 mt-2 w-80 bg-white border border-gray-200 rounded-lg shadow-lg z-20 p-4",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsx("h3",{className:"text-sm font-semibold text-gray-900",children:"Filters"}),a.jsx("button",{onClick:()=>s(!1),className:"text-gray-400 hover:text-gray-600",children:a.jsx(Ue,{className:"w-4 h-4"})})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Project"}),a.jsxs("select",{value:e.project_id||"",onChange:o=>i("project_id",o.target.value||void 0),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm",children:[a.jsx("option",{value:"",children:"All Projects"}),t.map(o=>a.jsx("option",{value:o.id,children:o.name},o.id))]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Status"}),a.jsxs("select",{value:Array.isArray(e.status)?e.status[0]:e.status||"",onChange:o=>i("status",o.target.value?[o.target.value]:void 0),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm",children:[a.jsx("option",{value:"",children:"All Statuses"}),a.jsx("option",{value:"draft",children:"Draft"}),a.jsx("option",{value:"posted",children:"Posted"}),a.jsx("option",{value:"fulfilled",children:"Fulfilled"}),a.jsx("option",{value:"closed",children:"Closed"}),a.jsx("option",{value:"cancelled",children:"Cancelled"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date From"}),a.jsx("input",{type:"date",value:e.date_from||"",onChange:o=>i("date_from",o.target.value||void 0),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date To"}),a.jsx("input",{type:"date",value:e.date_to||"",onChange:o=>i("date_to",o.target.value||void 0),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm"})]}),a.jsxs("div",{className:"flex gap-2 pt-2",children:[a.jsx("button",{onClick:l,className:"flex-1 px-3 py-2 text-sm font-medium text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200",children:"Clear"}),a.jsx("button",{onClick:()=>s(!1),className:"flex-1 px-3 py-2 text-sm font-medium text-white rounded-lg hover:opacity-90",style:{backgroundColor:"#714b67"},children:"Apply"})]})]})]})]})]})}function ZT({selectedCount:e,onBulkConfirm:t,onBulkCancel:r}){return e===0?null:a.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-4 flex items-center justify-between",children:[a.jsx("div",{className:"flex items-center gap-2",children:a.jsxs("span",{className:"text-sm font-medium text-blue-900",children:[e," invoice",e!==1?"s":""," selected"]})}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("button",{onClick:t,className:"px-3 py-1.5 text-sm font-medium text-white rounded-lg hover:opacity-90",style:{backgroundColor:"#714b67"},children:"Post"}),a.jsx("button",{onClick:r,className:"px-3 py-1.5 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",children:"Cancel"})]})]})}function eC({order:e,onClose:t,onUpdate:r}){const n=(o,c="INR")=>new Intl.NumberFormat("en-IN",{style:"currency",currency:c,minimumFractionDigits:0,maximumFractionDigits:0}).format(o),s=o=>o?new Date(o).toLocaleDateString("en-IN",{day:"numeric",month:"short",year:"numeric"}):"-",i=async()=>{try{await qr.post(e.id),r()}catch(o){console.error("Error posting invoice:",o)}},l=async()=>{try{await qr.cancel(e.id),r()}catch(o){console.error("Error cancelling order:",o)}};return a.jsxs("div",{className:"fixed inset-0 z-50 overflow-hidden",children:[a.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-50",onClick:t}),a.jsx("div",{className:"absolute right-0 top-0 bottom-0 w-full max-w-2xl bg-white shadow-xl",children:a.jsxs("div",{className:"h-full flex flex-col",children:[a.jsxs("div",{className:"px-6 py-4 border-b border-gray-200 flex items-center justify-between",children:[a.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Customer Invoice Details"}),a.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-600",children:a.jsx(Ue,{className:"w-5 h-5"})})]}),a.jsx("div",{className:"flex-1 overflow-y-auto p-6",children:a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"text-sm font-medium text-gray-500 mb-2",children:"Order Information"}),a.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 space-y-2",children:[a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-sm text-gray-600",children:"Number:"}),a.jsx("span",{className:"text-sm font-medium text-gray-900",children:e.number||"-"})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-sm text-gray-600",children:"Date:"}),a.jsx("span",{className:"text-sm font-medium text-gray-900",children:s(e.invoiceDate)})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-sm text-gray-600",children:"Customer:"}),a.jsx("span",{className:"text-sm font-medium text-gray-900",children:e.customerName||"-"})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-sm text-gray-600",children:"Project:"}),a.jsx("span",{className:"text-sm font-medium text-gray-900",children:e.projectName||"-"})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-sm text-gray-600",children:"Status:"}),a.jsx("span",{className:"text-sm font-medium text-gray-900 capitalize",children:e.status||"-"})]})]})]}),e.lines&&e.lines.length>0&&a.jsxs("div",{children:[a.jsx("h3",{className:"text-sm font-medium text-gray-500 mb-2",children:"Line Items"}),a.jsx("div",{className:"border border-gray-200 rounded-lg overflow-hidden",children:a.jsxs("table",{className:"w-full",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-4 py-2 text-left text-xs font-semibold text-gray-600",children:"Description"}),a.jsx("th",{className:"px-4 py-2 text-right text-xs font-semibold text-gray-600",children:"Quantity"}),a.jsx("th",{className:"px-4 py-2 text-right text-xs font-semibold text-gray-600",children:"Price"}),a.jsx("th",{className:"px-4 py-2 text-right text-xs font-semibold text-gray-600",children:"Total"})]})}),a.jsx("tbody",{className:"divide-y divide-gray-200",children:e.lines.map(o=>a.jsxs("tr",{children:[a.jsx("td",{className:"px-4 py-2 text-sm text-gray-900",children:o.description}),a.jsx("td",{className:"px-4 py-2 text-sm text-right text-gray-900",children:o.quantity}),a.jsx("td",{className:"px-4 py-2 text-sm text-right text-gray-900",children:n(o.unitPrice,e.currency)}),a.jsx("td",{className:"px-4 py-2 text-sm text-right font-medium text-gray-900",children:n(o.lineTotal,e.currency)})]},o.id))})]})})]}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-sm font-medium text-gray-500 mb-2",children:"Totals"}),a.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 space-y-2",children:[a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-sm text-gray-600",children:"Subtotal:"}),a.jsx("span",{className:"text-sm font-medium text-gray-900",children:n(e.subtotal||0,e.currency)})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-sm text-gray-600",children:"Tax:"}),a.jsx("span",{className:"text-sm font-medium text-gray-900",children:n(e.taxTotal||0,e.currency)})]}),a.jsxs("div",{className:"flex justify-between border-t border-gray-300 pt-2",children:[a.jsx("span",{className:"text-sm font-semibold text-gray-900",children:"Grand Total:"}),a.jsx("span",{className:"text-sm font-semibold text-gray-900",children:n(e.grandTotal||0,e.currency)})]})]})]})]})}),a.jsxs("div",{className:"px-6 py-4 border-t border-gray-200 flex items-center justify-end gap-3",children:[e.status==="draft"&&a.jsxs(a.Fragment,{children:[a.jsx("button",{onClick:i,className:"px-4 py-2 text-sm font-medium text-white rounded-lg hover:opacity-90",style:{backgroundColor:"#714b67"},children:"Post"}),a.jsx("button",{onClick:l,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",children:"Cancel Invoice"})]}),a.jsx("button",{onClick:t,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",children:"Close"})]})]})})]})}function tC({order:e,projects:t,onClose:r,onSave:n}){const[s,i]=C.useState({project_id:"",customer_partner_id:"",invoice_date:new Date().toISOString().split("T")[0],currency:"INR",lines:[{description:"",quantity:1,unit_price:0}]}),[l,o]=C.useState(!1);C.useEffect(()=>{var f;e&&i({project_id:e.projectId||"",customer_partner_id:e.customerPartnerId||"",invoice_date:e.invoiceDate||new Date().toISOString().split("T")[0],currency:e.currency||"INR",lines:((f=e.lines)==null?void 0:f.map(h=>({description:h.description,quantity:h.quantity,unit_price:h.unitPrice})))||[{description:"",quantity:1,unit_price:0}]})},[e]);const c=async f=>{f.preventDefault(),o(!0);try{e?await qr.update(e.id,s):await qr.create(s),n()}catch(h){console.error("Error saving customer invoice:",h),alert("Failed to save customer invoice")}finally{o(!1)}},d=()=>{i(f=>({...f,lines:[...f.lines,{description:"",quantity:1,unit_price:0}]}))},u=(f,h,m)=>{i(p=>({...p,lines:p.lines.map((x,v)=>v===f?{...x,[h]:m}:x)}))};return a.jsxs("div",{className:"fixed inset-0 z-50 overflow-hidden",children:[a.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-50",onClick:r}),a.jsx("div",{className:"absolute inset-0 flex items-center justify-center p-4",children:a.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-4xl max-h-[90vh] overflow-hidden flex flex-col",children:[a.jsxs("div",{className:"px-6 py-4 border-b border-gray-200 flex items-center justify-between",children:[a.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:e?"Edit Customer Invoice":"New Customer Invoice"}),a.jsx("button",{onClick:r,className:"text-gray-400 hover:text-gray-600",children:a.jsx(Ue,{className:"w-5 h-5"})})]}),a.jsx("form",{onSubmit:c,className:"flex-1 overflow-y-auto p-6",children:a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Project"}),a.jsxs("select",{value:s.project_id,onChange:f=>i(h=>({...h,project_id:f.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm",children:[a.jsx("option",{value:"",children:"Select Project"}),t.map(f=>a.jsx("option",{value:f.id,children:f.name},f.id))]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Invoice Date"}),a.jsx("input",{type:"date",value:s.invoice_date,onChange:f=>i(h=>({...h,invoice_date:f.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm",required:!0})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Customer Partner ID"}),a.jsx("input",{type:"text",value:s.customer_partner_id,onChange:f=>i(h=>({...h,customer_partner_id:f.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm",placeholder:"Enter customer partner ID",required:!0})]}),a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Line Items"}),a.jsx("button",{type:"button",onClick:d,className:"text-sm text-blue-600 hover:text-blue-800",children:"+ Add Line"})]}),a.jsx("div",{className:"border border-gray-200 rounded-lg overflow-hidden",children:a.jsxs("table",{className:"w-full",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-4 py-2 text-left text-xs font-semibold text-gray-600",children:"Description"}),a.jsx("th",{className:"px-4 py-2 text-right text-xs font-semibold text-gray-600",children:"Quantity"}),a.jsx("th",{className:"px-4 py-2 text-right text-xs font-semibold text-gray-600",children:"Unit Price"})]})}),a.jsx("tbody",{className:"divide-y divide-gray-200",children:s.lines.map((f,h)=>a.jsxs("tr",{children:[a.jsx("td",{className:"px-4 py-2",children:a.jsx("input",{type:"text",value:f.description,onChange:m=>u(h,"description",m.target.value),className:"w-full px-2 py-1 border border-gray-300 rounded text-sm",required:!0})}),a.jsx("td",{className:"px-4 py-2",children:a.jsx("input",{type:"number",value:f.quantity,onChange:m=>u(h,"quantity",parseFloat(m.target.value)||0),className:"w-full px-2 py-1 border border-gray-300 rounded text-sm text-right",min:"0",step:"0.01",required:!0})}),a.jsx("td",{className:"px-4 py-2",children:a.jsx("input",{type:"number",value:f.unit_price,onChange:m=>u(h,"unit_price",parseFloat(m.target.value)||0),className:"w-full px-2 py-1 border border-gray-300 rounded text-sm text-right",min:"0",step:"0.01",required:!0})})]},h))})]})})]})]})}),a.jsxs("div",{className:"px-6 py-4 border-t border-gray-200 flex items-center justify-end gap-3",children:[a.jsx("button",{onClick:r,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",children:"Cancel"}),a.jsx("button",{onClick:c,disabled:l,className:"px-4 py-2 text-sm font-medium text-white rounded-lg hover:opacity-90 disabled:opacity-50",style:{backgroundColor:"#714b67"},children:l?"Saving...":"Save"})]})]})})]})}function rC(){const[e,t]=C.useState([]),[r,n]=C.useState([]),[s,i]=C.useState({totalCount:0,draftCount:0,postedCount:0,fulfilledCount:0,totalAmount:0,postedAmount:0}),[l,o]=C.useState({date_from:I(),date_to:new Date().toISOString().split("T")[0]}),[c,d]=C.useState(""),[u,f]=C.useState([]),[h,m]=C.useState(null),[p,x]=C.useState(!1),[v,y]=C.useState(!1),[g,w]=C.useState(null),[b,P]=C.useState(!0),[L,E]=C.useState(null);function I(){const F=new Date;return F.setDate(F.getDate()-90),F.toISOString().split("T")[0]}C.useEffect(()=>{S()},[l]);const S=async()=>{try{P(!0),E(null);const F=await kr.getAll();F.success&&n(F.data);const K=await qr.getAll(l);K.success?t(K.data):E(K.message||"Failed to load customer invoices");const te=await qr.getStats(l);te.success&&i(te.data)}catch(F){console.error("Error loading data:",F),E("Unable to connect to server. Please try again.")}finally{P(!1)}},R=F=>{Object.keys(F).length===0?o({date_from:I(),date_to:new Date().toISOString().split("T")[0]}):o(K=>{const te={...K};return Object.keys(F).forEach(T=>{const M=F[T];M===void 0||M===""||M===null||Array.isArray(M)&&M.length===0?delete te[T]:te[T]=M}),te}),f([])},U=(F,K)=>{f(K?te=>[...te,F]:te=>te.filter(T=>T!==F))},G=F=>{f(F?e.map(K=>K.id):[])},se=F=>{m(F),x(!0)},Ne=async()=>{try{for(const F of u)await qr.post(F);f([]),S()}catch(F){console.error("Error bulk posting:",F)}},ae=async()=>{try{for(const F of u)await qr.cancel(F);f([]),S()}catch(F){console.error("Error bulk cancelling:",F)}},xe=()=>{S(),y(!1),w(null)},ee=F=>new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR",minimumFractionDigits:0,maximumFractionDigits:0}).format(F),Y=e.filter(F=>{var te,T,M,D;if(!c.trim())return!0;const K=c.toLowerCase();return((te=F.number)==null?void 0:te.toLowerCase().includes(K))||((T=F.customerName)==null?void 0:T.toLowerCase().includes(K))||((M=F.projectName)==null?void 0:M.toLowerCase().includes(K))||((D=F.reference)==null?void 0:D.toLowerCase().includes(K))});return a.jsxs("div",{className:"h-full bg-gray-50",children:[a.jsxs("header",{className:"bg-white border-b border-gray-200 px-8 py-6",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsxs("div",{className:"flex items-center gap-6 flex-1",children:[a.jsx("h1",{className:"text-2xl font-semibold text-gray-900",children:"Customer Invoices"}),a.jsxs("div",{className:"relative flex-1 max-w-md",children:[a.jsx(hn,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),a.jsx("input",{value:c,onChange:F=>d(F.target.value),type:"text",placeholder:"Search customer invoices...",className:"w-full pl-10 pr-4 py-2.5 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-400 focus:border-transparent text-sm",disabled:b})]})]}),a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx(QT,{filters:l,projects:r,onFilterChange:R}),a.jsxs("button",{onClick:()=>{w(null),y(!0)},className:"px-4 py-2 text-sm font-medium text-white rounded-lg hover:opacity-90 transition-opacity disabled:opacity-50",style:{backgroundColor:"#714b67"},disabled:b,children:[a.jsx(ar,{className:"inline w-4 h-4 mr-2"})," New Customer Invoice"]})]})]}),a.jsxs("div",{className:"grid grid-cols-4 gap-4 mb-4",children:[a.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[a.jsx("div",{className:"text-sm text-gray-600 mb-1",children:"Total Orders"}),a.jsx("div",{className:"text-2xl font-semibold",style:{color:"#714b67"},children:s.totalCount})]}),a.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[a.jsx("div",{className:"text-sm text-gray-600 mb-1",children:"Draft"}),a.jsx("div",{className:"text-2xl font-semibold text-gray-900",children:s.draftCount})]}),a.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[a.jsx("div",{className:"text-sm text-gray-600 mb-1",children:"Posted"}),a.jsx("div",{className:"text-2xl font-semibold text-gray-900",children:s.postedCount})]}),a.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[a.jsx("div",{className:"text-sm text-gray-600 mb-1",children:"Total Amount"}),a.jsx("div",{className:"text-2xl font-semibold text-gray-900",children:ee(s.totalAmount)})]})]}),a.jsxs("div",{className:"flex items-center gap-2 mb-4 flex-wrap",children:[a.jsx("button",{onClick:()=>R({status:["draft"]}),className:`px-3 py-1.5 text-sm font-medium rounded-lg transition-colors ${JSON.stringify(l.status)===JSON.stringify(["draft"])?"text-white":"bg-white text-gray-700 border border-gray-300 hover:bg-gray-50"}`,style:JSON.stringify(l.status)===JSON.stringify(["draft"])?{backgroundColor:"#714b67"}:{},children:"Draft"}),a.jsx("button",{onClick:()=>R({status:["posted"]}),className:`px-3 py-1.5 text-sm font-medium rounded-lg transition-colors ${JSON.stringify(l.status)===JSON.stringify(["posted"])?"text-white":"bg-white text-gray-700 border border-gray-300 hover:bg-gray-50"}`,style:JSON.stringify(l.status)===JSON.stringify(["posted"])?{backgroundColor:"#714b67"}:{},children:"Posted"}),a.jsx("button",{onClick:()=>{const{status:F,...K}=l;R(K)},className:`px-3 py-1.5 text-sm font-medium rounded-lg transition-colors ${l.status?"bg-white text-gray-700 border border-gray-300 hover:bg-gray-50":"text-white"}`,style:l.status?{}:{backgroundColor:"#714b67"},children:"All"})]})]}),a.jsxs("div",{className:"p-6",children:[b&&a.jsx("div",{className:"flex items-center justify-center h-64",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"inline-block animate-spin rounded-full h-12 w-12 border-b-2 border-gray-900 mb-4"}),a.jsx("p",{className:"text-gray-600",children:"Loading customer invoices..."})]})}),L&&!b&&a.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 mb-4",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"text-red-800 font-medium",children:L}),a.jsx("button",{onClick:S,className:"text-red-600 hover:text-red-800 font-medium text-sm",children:"Retry"})]})}),!b&&!L&&a.jsx(ZT,{selectedCount:u.length,onBulkConfirm:Ne,onBulkCancel:ae}),!b&&!L&&a.jsx(a.Fragment,{children:Y.length===0?a.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-12 text-center",children:[a.jsx(ap,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),a.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No customer invoices found"}),a.jsx("p",{className:"text-sm text-gray-500 mb-4",children:"Try adjusting your filters or create a new customer invoice."}),a.jsx("button",{onClick:()=>{w(null),y(!0)},className:"px-4 py-2 text-sm font-medium text-white rounded-lg hover:opacity-90",style:{backgroundColor:"#714b67"},children:"New Customer Invoice"})]}):a.jsx("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:a.jsx(qT,{customerInvoices:Y,selectedIds:u,onSelect:U,onSelectAll:G,onRowClick:se})})})]}),p&&h&&a.jsx(eC,{order:h,onClose:()=>{x(!1),m(null)},onUpdate:async()=>{if(await S(),h!=null&&h.id)try{const F=await qr.getById(h.id);F.success&&m(F.data)}catch(F){console.error("Error refreshing order:",F)}}}),v&&a.jsx(tC,{order:g,projects:r,onClose:()=>{y(!1),w(null)},onSave:xe})]})}const Fh={draft:"bg-gray-100 text-gray-700",posted:"bg-green-100 text-green-700",fulfilled:"bg-blue-100 text-blue-700",closed:"bg-purple-100 text-purple-700",cancelled:"bg-red-100 text-red-700"},nC={draft:yt,posted:ht,fulfilled:Yt,closed:ht,cancelled:yr};function sC({vendorBills:e,selectedIds:t,onSelect:r,onSelectAll:n,onRowClick:s}){const i=e.length>0&&t.length===e.length,l=t.length>0&&t.length<e.length,o=(u,f="INR")=>new Intl.NumberFormat("en-IN",{style:"currency",currency:f,minimumFractionDigits:0,maximumFractionDigits:0}).format(u),c=u=>u?new Date(u).toLocaleDateString("en-IN",{day:"numeric",month:"short",year:"numeric"}):"-",d=u=>{const f=nC[u]||yt;return a.jsxs("span",{className:`inline-flex items-center gap-1.5 px-2.5 py-1 rounded-full text-xs font-medium ${Fh[u]||Fh.draft}`,children:[a.jsx(f,{className:"w-3 h-3"}),u.charAt(0).toUpperCase()+u.slice(1)]})};return e.length===0?a.jsx("div",{className:"text-center py-12",children:a.jsx("p",{className:"text-gray-500",children:"No vendor bills found"})}):a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full border-collapse",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"border-b border-gray-200",children:[a.jsx("th",{className:"px-4 py-3 text-left",children:a.jsx("input",{type:"checkbox",checked:i,ref:u=>{u&&(u.indeterminate=l)},onChange:u=>n(u.target.checked),className:"w-4 h-4 text-purple-600 rounded focus:ring-purple-500"})}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Number"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Date"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Vendor"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Project"}),a.jsx("th",{className:"px-4 py-3 text-right text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Amount"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Status"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Reference"})]})}),a.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:e.map(u=>a.jsxs("tr",{onClick:()=>s(u),className:"hover:bg-gray-50 cursor-pointer transition-colors",children:[a.jsx("td",{className:"px-4 py-3",onClick:f=>f.stopPropagation(),children:a.jsx("input",{type:"checkbox",checked:t.includes(u.id),onChange:f=>{f.stopPropagation(),r(u.id,f.target.checked)},className:"w-4 h-4 text-purple-600 rounded focus:ring-purple-500"})}),a.jsx("td",{className:"px-4 py-3 text-sm font-medium text-gray-900",children:u.number||"-"}),a.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:c(u.billDate)}),a.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:u.vendorName||"-"}),a.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:u.projectName||"-"}),a.jsx("td",{className:"px-4 py-3 text-sm text-right font-medium text-gray-900",children:o(u.grandTotal,u.currency)}),a.jsx("td",{className:"px-4 py-3",children:d(u.status)}),a.jsx("td",{className:"px-4 py-3 text-sm text-gray-500",children:u.reference||"-"})]},u.id))})]})})}function aC({filters:e,projects:t,onFilterChange:r}){const[n,s]=C.useState(!1),i=(o,c)=>{r({[o]:c})},l=()=>{r({})};return a.jsxs("div",{className:"relative",children:[a.jsxs("button",{onClick:()=>s(!n),className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 flex items-center gap-2",children:[a.jsx(Xn,{className:"w-4 h-4"}),"Filters"]}),n&&a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"fixed inset-0 z-10",onClick:()=>s(!1)}),a.jsxs("div",{className:"absolute right-0 mt-2 w-80 bg-white border border-gray-200 rounded-lg shadow-lg z-20 p-4",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsx("h3",{className:"text-sm font-semibold text-gray-900",children:"Filters"}),a.jsx("button",{onClick:()=>s(!1),className:"text-gray-400 hover:text-gray-600",children:a.jsx(Ue,{className:"w-4 h-4"})})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Project"}),a.jsxs("select",{value:e.project_id||"",onChange:o=>i("project_id",o.target.value||void 0),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm",children:[a.jsx("option",{value:"",children:"All Projects"}),t.map(o=>a.jsx("option",{value:o.id,children:o.name},o.id))]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Status"}),a.jsxs("select",{value:Array.isArray(e.status)?e.status[0]:e.status||"",onChange:o=>i("status",o.target.value?[o.target.value]:void 0),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm",children:[a.jsx("option",{value:"",children:"All Statuses"}),a.jsx("option",{value:"draft",children:"Draft"}),a.jsx("option",{value:"posted",children:"Posted"}),a.jsx("option",{value:"fulfilled",children:"Fulfilled"}),a.jsx("option",{value:"closed",children:"Closed"}),a.jsx("option",{value:"cancelled",children:"Cancelled"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date From"}),a.jsx("input",{type:"date",value:e.date_from||"",onChange:o=>i("date_from",o.target.value||void 0),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date To"}),a.jsx("input",{type:"date",value:e.date_to||"",onChange:o=>i("date_to",o.target.value||void 0),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm"})]}),a.jsxs("div",{className:"flex gap-2 pt-2",children:[a.jsx("button",{onClick:l,className:"flex-1 px-3 py-2 text-sm font-medium text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200",children:"Clear"}),a.jsx("button",{onClick:()=>s(!1),className:"flex-1 px-3 py-2 text-sm font-medium text-white rounded-lg hover:opacity-90",style:{backgroundColor:"#714b67"},children:"Apply"})]})]})]})]})]})}function iC({selectedCount:e,onBulkConfirm:t,onBulkCancel:r}){return e===0?null:a.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-4 flex items-center justify-between",children:[a.jsx("div",{className:"flex items-center gap-2",children:a.jsxs("span",{className:"text-sm font-medium text-blue-900",children:[e," bill",e!==1?"s":""," selected"]})}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("button",{onClick:t,className:"px-3 py-1.5 text-sm font-medium text-white rounded-lg hover:opacity-90",style:{backgroundColor:"#714b67"},children:"Post"}),a.jsx("button",{onClick:r,className:"px-3 py-1.5 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",children:"Cancel"})]})]})}function lC({order:e,onClose:t,onUpdate:r}){const n=(o,c="INR")=>new Intl.NumberFormat("en-IN",{style:"currency",currency:c,minimumFractionDigits:0,maximumFractionDigits:0}).format(o),s=o=>o?new Date(o).toLocaleDateString("en-IN",{day:"numeric",month:"short",year:"numeric"}):"-",i=async()=>{try{await Qr.post(e.id),r()}catch(o){console.error("Error posting bill:",o)}},l=async()=>{try{await Qr.cancel(e.id),r()}catch(o){console.error("Error cancelling order:",o)}};return a.jsxs("div",{className:"fixed inset-0 z-50 overflow-hidden",children:[a.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-50",onClick:t}),a.jsx("div",{className:"absolute right-0 top-0 bottom-0 w-full max-w-2xl bg-white shadow-xl",children:a.jsxs("div",{className:"h-full flex flex-col",children:[a.jsxs("div",{className:"px-6 py-4 border-b border-gray-200 flex items-center justify-between",children:[a.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Vendor Bill Details"}),a.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-600",children:a.jsx(Ue,{className:"w-5 h-5"})})]}),a.jsx("div",{className:"flex-1 overflow-y-auto p-6",children:a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"text-sm font-medium text-gray-500 mb-2",children:"Order Information"}),a.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 space-y-2",children:[a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-sm text-gray-600",children:"Number:"}),a.jsx("span",{className:"text-sm font-medium text-gray-900",children:e.number||"-"})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-sm text-gray-600",children:"Date:"}),a.jsx("span",{className:"text-sm font-medium text-gray-900",children:s(e.billDate)})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-sm text-gray-600",children:"Vendor:"}),a.jsx("span",{className:"text-sm font-medium text-gray-900",children:e.vendorName||"-"})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-sm text-gray-600",children:"Project:"}),a.jsx("span",{className:"text-sm font-medium text-gray-900",children:e.projectName||"-"})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-sm text-gray-600",children:"Status:"}),a.jsx("span",{className:"text-sm font-medium text-gray-900 capitalize",children:e.status||"-"})]})]})]}),e.lines&&e.lines.length>0&&a.jsxs("div",{children:[a.jsx("h3",{className:"text-sm font-medium text-gray-500 mb-2",children:"Line Items"}),a.jsx("div",{className:"border border-gray-200 rounded-lg overflow-hidden",children:a.jsxs("table",{className:"w-full",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-4 py-2 text-left text-xs font-semibold text-gray-600",children:"Description"}),a.jsx("th",{className:"px-4 py-2 text-right text-xs font-semibold text-gray-600",children:"Quantity"}),a.jsx("th",{className:"px-4 py-2 text-right text-xs font-semibold text-gray-600",children:"Price"}),a.jsx("th",{className:"px-4 py-2 text-right text-xs font-semibold text-gray-600",children:"Total"})]})}),a.jsx("tbody",{className:"divide-y divide-gray-200",children:e.lines.map(o=>a.jsxs("tr",{children:[a.jsx("td",{className:"px-4 py-2 text-sm text-gray-900",children:o.description}),a.jsx("td",{className:"px-4 py-2 text-sm text-right text-gray-900",children:o.quantity}),a.jsx("td",{className:"px-4 py-2 text-sm text-right text-gray-900",children:n(o.unitPrice,e.currency)}),a.jsx("td",{className:"px-4 py-2 text-sm text-right font-medium text-gray-900",children:n(o.lineTotal,e.currency)})]},o.id))})]})})]}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-sm font-medium text-gray-500 mb-2",children:"Totals"}),a.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 space-y-2",children:[a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-sm text-gray-600",children:"Subtotal:"}),a.jsx("span",{className:"text-sm font-medium text-gray-900",children:n(e.subtotal||0,e.currency)})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-sm text-gray-600",children:"Tax:"}),a.jsx("span",{className:"text-sm font-medium text-gray-900",children:n(e.taxTotal||0,e.currency)})]}),a.jsxs("div",{className:"flex justify-between border-t border-gray-300 pt-2",children:[a.jsx("span",{className:"text-sm font-semibold text-gray-900",children:"Grand Total:"}),a.jsx("span",{className:"text-sm font-semibold text-gray-900",children:n(e.grandTotal||0,e.currency)})]})]})]})]})}),a.jsxs("div",{className:"px-6 py-4 border-t border-gray-200 flex items-center justify-end gap-3",children:[e.status==="draft"&&a.jsxs(a.Fragment,{children:[a.jsx("button",{onClick:i,className:"px-4 py-2 text-sm font-medium text-white rounded-lg hover:opacity-90",style:{backgroundColor:"#714b67"},children:"Post"}),a.jsx("button",{onClick:l,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",children:"Cancel Bill"})]}),a.jsx("button",{onClick:t,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",children:"Close"})]})]})})]})}function oC({order:e,projects:t,onClose:r,onSave:n}){const[s,i]=C.useState({project_id:"",vendor_partner_id:"",bill_date:new Date().toISOString().split("T")[0],currency:"INR",lines:[{description:"",quantity:1,unit_price:0}]}),[l,o]=C.useState(!1);C.useEffect(()=>{var f;e&&i({project_id:e.projectId||"",vendor_partner_id:e.vendorPartnerId||"",bill_date:e.billDate||new Date().toISOString().split("T")[0],currency:e.currency||"INR",lines:((f=e.lines)==null?void 0:f.map(h=>({description:h.description,quantity:h.quantity,unit_price:h.unitPrice})))||[{description:"",quantity:1,unit_price:0}]})},[e]);const c=async f=>{f.preventDefault(),o(!0);try{e?await Qr.update(e.id,s):await Qr.create(s),n()}catch(h){console.error("Error saving vendor bill:",h),alert("Failed to save vendor bill")}finally{o(!1)}},d=()=>{i(f=>({...f,lines:[...f.lines,{description:"",quantity:1,unit_price:0}]}))},u=(f,h,m)=>{i(p=>({...p,lines:p.lines.map((x,v)=>v===f?{...x,[h]:m}:x)}))};return a.jsxs("div",{className:"fixed inset-0 z-50 overflow-hidden",children:[a.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-50",onClick:r}),a.jsx("div",{className:"absolute inset-0 flex items-center justify-center p-4",children:a.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-4xl max-h-[90vh] overflow-hidden flex flex-col",children:[a.jsxs("div",{className:"px-6 py-4 border-b border-gray-200 flex items-center justify-between",children:[a.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:e?"Edit Vendor Bill":"New Vendor Bill"}),a.jsx("button",{onClick:r,className:"text-gray-400 hover:text-gray-600",children:a.jsx(Ue,{className:"w-5 h-5"})})]}),a.jsx("form",{onSubmit:c,className:"flex-1 overflow-y-auto p-6",children:a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Project"}),a.jsxs("select",{value:s.project_id,onChange:f=>i(h=>({...h,project_id:f.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm",children:[a.jsx("option",{value:"",children:"Select Project"}),t.map(f=>a.jsx("option",{value:f.id,children:f.name},f.id))]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Bill Date"}),a.jsx("input",{type:"date",value:s.bill_date,onChange:f=>i(h=>({...h,bill_date:f.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm",required:!0})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Vendor Partner ID"}),a.jsx("input",{type:"text",value:s.vendor_partner_id,onChange:f=>i(h=>({...h,vendor_partner_id:f.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm",placeholder:"Enter vendor partner ID",required:!0})]}),a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Line Items"}),a.jsx("button",{type:"button",onClick:d,className:"text-sm text-blue-600 hover:text-blue-800",children:"+ Add Line"})]}),a.jsx("div",{className:"border border-gray-200 rounded-lg overflow-hidden",children:a.jsxs("table",{className:"w-full",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-4 py-2 text-left text-xs font-semibold text-gray-600",children:"Description"}),a.jsx("th",{className:"px-4 py-2 text-right text-xs font-semibold text-gray-600",children:"Quantity"}),a.jsx("th",{className:"px-4 py-2 text-right text-xs font-semibold text-gray-600",children:"Unit Price"})]})}),a.jsx("tbody",{className:"divide-y divide-gray-200",children:s.lines.map((f,h)=>a.jsxs("tr",{children:[a.jsx("td",{className:"px-4 py-2",children:a.jsx("input",{type:"text",value:f.description,onChange:m=>u(h,"description",m.target.value),className:"w-full px-2 py-1 border border-gray-300 rounded text-sm",required:!0})}),a.jsx("td",{className:"px-4 py-2",children:a.jsx("input",{type:"number",value:f.quantity,onChange:m=>u(h,"quantity",parseFloat(m.target.value)||0),className:"w-full px-2 py-1 border border-gray-300 rounded text-sm text-right",min:"0",step:"0.01",required:!0})}),a.jsx("td",{className:"px-4 py-2",children:a.jsx("input",{type:"number",value:f.unit_price,onChange:m=>u(h,"unit_price",parseFloat(m.target.value)||0),className:"w-full px-2 py-1 border border-gray-300 rounded text-sm text-right",min:"0",step:"0.01",required:!0})})]},h))})]})})]})]})}),a.jsxs("div",{className:"px-6 py-4 border-t border-gray-200 flex items-center justify-end gap-3",children:[a.jsx("button",{onClick:r,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",children:"Cancel"}),a.jsx("button",{onClick:c,disabled:l,className:"px-4 py-2 text-sm font-medium text-white rounded-lg hover:opacity-90 disabled:opacity-50",style:{backgroundColor:"#714b67"},children:l?"Saving...":"Save"})]})]})})]})}function cC(){const[e,t]=C.useState([]),[r,n]=C.useState([]),[s,i]=C.useState({totalCount:0,draftCount:0,postedCount:0,fulfilledCount:0,totalAmount:0,postedAmount:0}),[l,o]=C.useState({date_from:I(),date_to:new Date().toISOString().split("T")[0]}),[c,d]=C.useState(""),[u,f]=C.useState([]),[h,m]=C.useState(null),[p,x]=C.useState(!1),[v,y]=C.useState(!1),[g,w]=C.useState(null),[b,P]=C.useState(!0),[L,E]=C.useState(null);function I(){const F=new Date;return F.setDate(F.getDate()-90),F.toISOString().split("T")[0]}C.useEffect(()=>{S()},[l]);const S=async()=>{try{P(!0),E(null);const F=await kr.getAll();F.success&&n(F.data);const K=await Qr.getAll(l);K.success?t(K.data):E(K.message||"Failed to load vendor bills");const te=await Qr.getStats(l);te.success&&i(te.data)}catch(F){console.error("Error loading data:",F),E("Unable to connect to server. Please try again.")}finally{P(!1)}},R=F=>{Object.keys(F).length===0?o({date_from:I(),date_to:new Date().toISOString().split("T")[0]}):o(K=>{const te={...K};return Object.keys(F).forEach(T=>{const M=F[T];M===void 0||M===""||M===null||Array.isArray(M)&&M.length===0?delete te[T]:te[T]=M}),te}),f([])},U=(F,K)=>{f(K?te=>[...te,F]:te=>te.filter(T=>T!==F))},G=F=>{f(F?e.map(K=>K.id):[])},se=F=>{m(F),x(!0)},Ne=async()=>{try{for(const F of u)await Qr.post(F);f([]),S()}catch(F){console.error("Error bulk posting:",F)}},ae=async()=>{try{for(const F of u)await Qr.cancel(F);f([]),S()}catch(F){console.error("Error bulk cancelling:",F)}},xe=()=>{S(),y(!1),w(null)},ee=F=>new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR",minimumFractionDigits:0,maximumFractionDigits:0}).format(F),Y=e.filter(F=>{var te,T,M,D;if(!c.trim())return!0;const K=c.toLowerCase();return((te=F.number)==null?void 0:te.toLowerCase().includes(K))||((T=F.vendorName)==null?void 0:T.toLowerCase().includes(K))||((M=F.projectName)==null?void 0:M.toLowerCase().includes(K))||((D=F.reference)==null?void 0:D.toLowerCase().includes(K))});return a.jsxs("div",{className:"h-full bg-gray-50",children:[a.jsxs("header",{className:"bg-white border-b border-gray-200 px-8 py-6",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsxs("div",{className:"flex items-center gap-6 flex-1",children:[a.jsx("h1",{className:"text-2xl font-semibold text-gray-900",children:"Vendor Bills"}),a.jsxs("div",{className:"relative flex-1 max-w-md",children:[a.jsx(hn,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),a.jsx("input",{value:c,onChange:F=>d(F.target.value),type:"text",placeholder:"Search vendor bills...",className:"w-full pl-10 pr-4 py-2.5 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-400 focus:border-transparent text-sm",disabled:b})]})]}),a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx(aC,{filters:l,projects:r,onFilterChange:R}),a.jsxs("button",{onClick:()=>{w(null),y(!0)},className:"px-4 py-2 text-sm font-medium text-white rounded-lg hover:opacity-90 transition-opacity disabled:opacity-50",style:{backgroundColor:"#714b67"},disabled:b,children:[a.jsx(ar,{className:"inline w-4 h-4 mr-2"})," New Vendor Bill"]})]})]}),a.jsxs("div",{className:"grid grid-cols-4 gap-4 mb-4",children:[a.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[a.jsx("div",{className:"text-sm text-gray-600 mb-1",children:"Total Orders"}),a.jsx("div",{className:"text-2xl font-semibold",style:{color:"#714b67"},children:s.totalCount})]}),a.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[a.jsx("div",{className:"text-sm text-gray-600 mb-1",children:"Draft"}),a.jsx("div",{className:"text-2xl font-semibold text-gray-900",children:s.draftCount})]}),a.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[a.jsx("div",{className:"text-sm text-gray-600 mb-1",children:"Posted"}),a.jsx("div",{className:"text-2xl font-semibold text-gray-900",children:s.postedCount})]}),a.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[a.jsx("div",{className:"text-sm text-gray-600 mb-1",children:"Total Amount"}),a.jsx("div",{className:"text-2xl font-semibold text-gray-900",children:ee(s.totalAmount)})]})]}),a.jsxs("div",{className:"flex items-center gap-2 mb-4 flex-wrap",children:[a.jsx("button",{onClick:()=>R({status:["draft"]}),className:`px-3 py-1.5 text-sm font-medium rounded-lg transition-colors ${JSON.stringify(l.status)===JSON.stringify(["draft"])?"text-white":"bg-white text-gray-700 border border-gray-300 hover:bg-gray-50"}`,style:JSON.stringify(l.status)===JSON.stringify(["draft"])?{backgroundColor:"#714b67"}:{},children:"Draft"}),a.jsx("button",{onClick:()=>R({status:["posted"]}),className:`px-3 py-1.5 text-sm font-medium rounded-lg transition-colors ${JSON.stringify(l.status)===JSON.stringify(["posted"])?"text-white":"bg-white text-gray-700 border border-gray-300 hover:bg-gray-50"}`,style:JSON.stringify(l.status)===JSON.stringify(["posted"])?{backgroundColor:"#714b67"}:{},children:"Posted"}),a.jsx("button",{onClick:()=>{const{status:F,...K}=l;R(K)},className:`px-3 py-1.5 text-sm font-medium rounded-lg transition-colors ${l.status?"bg-white text-gray-700 border border-gray-300 hover:bg-gray-50":"text-white"}`,style:l.status?{}:{backgroundColor:"#714b67"},children:"All"})]})]}),a.jsxs("div",{className:"p-6",children:[b&&a.jsx("div",{className:"flex items-center justify-center h-64",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"inline-block animate-spin rounded-full h-12 w-12 border-b-2 border-gray-900 mb-4"}),a.jsx("p",{className:"text-gray-600",children:"Loading vendor bills..."})]})}),L&&!b&&a.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 mb-4",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"text-red-800 font-medium",children:L}),a.jsx("button",{onClick:S,className:"text-red-600 hover:text-red-800 font-medium text-sm",children:"Retry"})]})}),!b&&!L&&a.jsx(iC,{selectedCount:u.length,onBulkConfirm:Ne,onBulkCancel:ae}),!b&&!L&&a.jsx(a.Fragment,{children:Y.length===0?a.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-12 text-center",children:[a.jsx(Po,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),a.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No vendor bills found"}),a.jsx("p",{className:"text-sm text-gray-500 mb-4",children:"Try adjusting your filters or create a new vendor bill."}),a.jsx("button",{onClick:()=>{w(null),y(!0)},className:"px-4 py-2 text-sm font-medium text-white rounded-lg hover:opacity-90",style:{backgroundColor:"#714b67"},children:"New Vendor Bill"})]}):a.jsx("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:a.jsx(sC,{vendorBills:Y,selectedIds:u,onSelect:U,onSelectAll:G,onRowClick:se})})})]}),p&&h&&a.jsx(lC,{order:h,onClose:()=>{x(!1),m(null)},onUpdate:async()=>{if(await S(),h!=null&&h.id)try{const F=await Qr.getById(h.id);F.success&&m(F.data)}catch(F){console.error("Error refreshing order:",F)}}}),v&&a.jsx(oC,{order:g,projects:r,onClose:()=>{y(!1),w(null)},onSave:xe})]})}function uC(){return a.jsx(V2,{children:a.jsxs(M2,{children:[a.jsx(Ke,{path:"/",element:a.jsx(Tb,{})}),a.jsx(Ke,{path:"/login",element:a.jsx(_b,{})}),a.jsx(Ke,{path:"/signup",element:a.jsx(Eb,{})}),a.jsxs(Ke,{path:"/app",element:a.jsx(Qw,{}),children:[a.jsx(Ke,{index:!0,element:a.jsx(Lf,{})}),a.jsx(Ke,{path:"dashboard",element:a.jsx(Lf,{})}),a.jsx(Ke,{path:"notes",element:a.jsx(rb,{})}),a.jsx(Ke,{path:"projects",element:a.jsx(lb,{})}),a.jsx(Ke,{path:"notifications",element:a.jsx(mb,{})}),a.jsx(Ke,{path:"tasks",element:a.jsx(hb,{})}),a.jsx(Ke,{path:"expenses",element:a.jsx(Lb,{})}),a.jsx(Ke,{path:"timesheets",element:a.jsx(PT,{})}),a.jsx(Ke,{path:"emails",element:a.jsx("div",{className:"p-8",children:a.jsx("h1",{children:"Emails"})})}),a.jsx(Ke,{path:"calendars",element:a.jsx("div",{className:"p-8",children:a.jsx("h1",{children:"Calendars"})})}),a.jsx(Ke,{path:"analytics",element:a.jsx(Sb,{})}),a.jsx(Ke,{path:"contacts",element:a.jsx("div",{className:"p-8",children:a.jsx("h1",{children:"Contacts"})})}),a.jsx(Ke,{path:"companies",element:a.jsx("div",{className:"p-8",children:a.jsx("h1",{children:"Companies"})})}),a.jsx(Ke,{path:"integrations",element:a.jsx("div",{className:"p-8",children:a.jsx("h1",{children:"Integrations"})})}),a.jsx(Ke,{path:"settings",element:a.jsx(IT,{})}),a.jsx(Ke,{path:"settings/sales-orders",element:a.jsx($T,{})}),a.jsx(Ke,{path:"settings/purchase-orders",element:a.jsx(YT,{})}),a.jsx(Ke,{path:"settings/invoices",element:a.jsx(rC,{})}),a.jsx(Ke,{path:"settings/vendor-bills",element:a.jsx(cC,{})})]})]})})}Oc.createRoot(document.getElementById("root")).render(a.jsx($h.StrictMode,{children:a.jsx(uC,{})}));
